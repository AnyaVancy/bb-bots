{"version":3,"sources":["model/playerProfile.ts","model/powerRanking.ts","model/houseguest.ts","utils/utilities.ts","utils/relationshipMap.ts","components/playerPortrait/selectedPortrait.ts","model/color.ts","components/playerPortrait/houseguestPortraitController.ts","components/playerPortrait/houseguestPortrait.tsx","components/playerPortrait/houseguestToPortrait.tsx","components/tooltip/tooltip.tsx","components/playerPortrait/portraits.tsx","components/memoryWall/memoryWall.tsx","components/nextEpisodeButton/nextEpisodeButton.tsx","components/playerPortrait/setupPortrait.tsx","utils/ai/classifyRelationship.ts","components/castingScreen/importLinks.tsx","components/playerPortrait/subtitle.tsx","model/portraitDisplayMode.ts","components/viewsBar/viewBarTag.tsx","components/viewsBar/viewBar.tsx","components/episode/episodes.tsx","components/episode/pregameEpisode.tsx","components/castingScreen/randomXButton.tsx","components/layout/text.ts","components/layout/centered.tsx","components/castingScreen/castingScreen.tsx","subjects/subjects.tsx","theme/theme.ts","components/topbar/themeSwitch.tsx","components/layout/box.tsx","components/deckScreen/deckScreen.tsx","components/topbar/topBar.tsx","components/pregameScreen/pregameScreen.tsx","utils/BbRandomGenerator.ts","model/gameState.ts","model/season.ts","components/episode/scene.tsx","utils/ai/aiUtils.ts","utils/ai/aiApi.ts","components/mainPage/fullscreenButton.tsx","components/episode/scenes/votingTable.tsx","model/logging/voteType.tsx","components/episode/scenes/juryVoteScene.tsx","components/episode/bigBrotherFinale.tsx","components/episode/scenes/finalHohCompScene.tsx","components/episode/scenes/finalEvictionScene.tsx","components/episode/gameOver.tsx","model/logging/episodelog.ts","utils/generateGraph.ts","utils/graphTest.ts","utils/ai/targets.ts","components/episode/episodeFactory.ts","components/episode/bigBrotherEpisode.tsx","components/episode/scenes/hohCompScene.tsx","components/episode/scenes/nomCeremonyScene.tsx","components/episode/scenes/vetoCompScene.tsx","components/episode/scenes/vetoCeremonyScene.tsx","components/episode/scenes/evictionScene.tsx","components/episode/allianceList.tsx","components/episode/bigBrotherWeekstartWrapper.tsx","components/sidebar/sidebarController.ts","components/sidebar/sidebar.tsx","components/mainPage/mainContentArea.tsx","components/mainPage/mainPage.tsx","components/mainPage/mainPageController.ts","theme/globalTheme.ts","App.tsx","index.tsx"],"names":["PlayerProfile","init","Object","classCallCheck","this","name","imageURL","assign","PowerRanking","beats","outOf","Error","createClass","key","get","Houseguest","_PlayerProfile","_this","possibleConstructorReturn","getPrototypeOf","call","isEvicted","isJury","id","nominations","hohWins","povWins","popularity","deltaPopularity","relationships","targets","powerRanking","superiors","Set","friends","enemies","targetingMe","assertThisInitialized","inherits","value","villain","roundTwoDigits","number","Math","round","isWellDefined","x","undefined","isNotWellDefined","newRelationshipMap","size","exclude","result","i","selectPlayer","player","getSelectedPlayer","selectedPlayer$","next","componentToHex","c","hex","toString","length","Rgb","r","g","b","concat","interpolateColor","min","max","percent","toHex","selectedColor","HouseguestPortraitController","view","subs","refreshData","data","props","setState","comparePowerRankings","defaultState","selectedPlayer","state","displayMode","backgroundColor","_this2","push","subscribe","displayMode$","forEach","sub","unsubscribe","has","Subtitle","styled","small","_templateObject","MemoryWallPortrait","div","_templateObject2","_ref","theme","portraitBorder","Evicted","_templateObject3","Jury","_templateObject4","Normal","img","_templateObject5","Grayscale","_templateObject6","Sepia","_templateObject7","HouseguestPortrait","_React$Component","controller","subtitle","Img","imageClass","getImageClass","generateSubtitle","detailed","Portrait","react_default","a","createElement","onClick","style","src","height","width","React","Component","houseguestToPortrait","houseguest","houseguestPortrait_HouseguestPortrait","Text","p","tooltip_templateObject","Tooltip","visible","Popover_default","position","isOpen","content","text","onMouseEnter","onMouseLeave","children","PortraitWrapper","className","centered","tooltip","tooltip_Tooltip","Portraits","rows","houseguests","memoryWallPortrait","MemoryWall","margin","maxWidth","NextEpisodeButton","switchSceneRelative","RelationshipType","EditPortrait","setupPortrait_templateObject","Noselect","input","setupPortrait_templateObject2","setupPortrait_templateObject3","XButton","setupPortrait_templateObject4","SetupPortrait","textAlign","onDoubleClick","onDelete","imageUrl","ImportLinks","lines","split","profiles","line","temp","pop","replace","substr","indexOf","onSubmit","onChange","event","target","RelationshipTypeToSymbol","FRIEND","ENEMY","PAWN","QUEEN","classifyRelationship","heroPopularity","villainPopularity","relationship","benefitsHero","benefitsVillain","Friend","Pawn","Queen","Enemy","addPopularityLine","hero","popularitySubtitle","deltaPop","statePopularity","getDeltaPopularity","addCompsLine","compWins","lineHeight","popularityMinColor","popularityMaxColor","popularityMode","minColor","maxColor","extremePopularity","xSquared","extremeValues","_addFriendshipCountTi","titles","friendOrEnemyTitle","map","txt","count","Relationship","friendEnemyCountTitle","addFriendshipCountTitles","arguments","powerMaxColor","powerMinColor","powerMode","toFloat","_","ViewBarTag","selected","mode","_this3","disabled","background","toRgba","cursor","ViewsBar","inJury","gameState","marginBottom","viewBarTag_ViewBarTag","Episode","scenes","title","initialGameState","type","arrowsEnabled","initialGamestate","viewsBar","hasViewsbar","viewBar_ViewsBar","PregameEpisodeType","eliminates","canPlayWith","n","PregameEpisode","_Episode","pregameScreen_PregameScreen","cast","RandomButton","_useState","useState","_useState2","slicedToArray","setNumber","random","parseInt","NumericInput","marginLeft","test","HasText","text_templateObject","Input","text_templateObject2","_ref2","NoMargin","centered_templateObject","Center","centered_templateObject2","Centered","noMargin","CenteredBold","CenteredItallic","CastingScreen","appendProfiles","newState","objectSpread","profile","players","submit","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","newCast","cast$","mainContentStream$","newEpisode","GameState","stop","amount","shuffle","slice","handleUpload","handleFiles","files","handleDrop","newName","splice","_this4","setupPortrait_SetupPortrait","deleteMethod","handleChange","_this5","FileDrop","onDrop","importLinks_ImportLinks","text_Input","multiple","getFiles","file","match","lastIndexOf","URL","createObjectURL","lightTheme","bg","toggleBorder","gradient","bodyArea","link","overlay","evictedCell","grayCell","lightGrayCell","winnerCell","runnerUpCell","nomineeCell","hohCell","tableCellBorder","darkTheme","ThemeSwitcher","window","matchMedia","matches","setTheme","theme$","ShadowBox","box_templateObject","StyledBox","box_templateObject2","_ref3","DividerBox","Box","decksPerPage","baseUrl","imageCache","DeckStyle","deckScreen_templateObject","deckScreen_templateObject2","DeckText","deckScreen_templateObject3","_callee2","folder","links","image","_context2","abrupt","fetch","sent","json","sample","_callee3","imageLinks","playerProfiles","_context3","url","castingScreen_CastingScreen","Deck","_React$useState","_React$useState2","setImage","_React$useState3","_React$useState4","loading","setLoading","deck","randomImageFromFolder","then","selectCast","DeckList","commentNodes","j","display","DeckScreen","handlePageClick","page","decks","_componentDidMount","apply","deckScreen_Centered","dist_default","previousLabel","nextLabel","breakLabel","breakClassName","pageCount","ceil","marginPagesDisplayed","pageRangeDisplayed","onPageChange","containerClassName","activeClassName","TopbarLink","topBar_templateObject","AdvancedEditLink","ChooseCastLink","deckScreen_DeckScreen","Topbar","PregameScreen","BehaviorSubject","episodes$","switchEpisode$","Subject","episode","weekStartTab$","isFullscreen$","BbRandomGenerator","seed","rng","prand","xorshift128plus","_this$rng$next","_this$rng$next2","_prand$uniformIntDist","uniformIntDistribution","_prand$uniformIntDist2","_this$rng$next3","_this$rng$next4","rng$","castNames","string","hash","charCodeAt","hashcode","getById","houseguestCache","inclusions","exclusions","excludedIds","hg","filter","includes","randomPlayer","options","randomInt","nonEvictedHouseguests","toConsumableArray","entries","getJurors","remainingPlayers","finalJurySize","phase","previousHOH","log","cliques","Array","add","MutableGameState","copy","cloneDeep","Scene","render","favouriteIndex","callback","highestIndex","highestScore","Infinity","currentScore","lowestScore","lowestIndex","doesHeroWinTheFinale","hgs","jury","heroVotes","villainVotes","juror","heroShouldTargetSuperiors","opponents","castEvictionVote","nominees","nom0","nom1","zeroIsInferior","oneIsInferior","cutthroatVote","nonVote","decision","reason","nonTarget","excuse","targetIsFriend","nonTargetIsNonFriend","nonTargetIsFriend","targetIsNonFriend","cutthroatVoteJury","r0","r1","nom0isTarget","nom1isTarget","vote","nominateNPlayers","hitlist","hitList","trueOptions","useGoldenVetoPreJury","save","rel0","relationshipWith","rel1","FullscreenIcon","fullscreenButton_templateObject","FullscreenButton","getValue","EndgameTableCell","td","votingTable_templateObject","EndgameTable","table","votingTable_templateObject2","Gray","votingTable_templateObject3","White","votingTable_templateObject4","_ref4","votingTable_templateObject5","_ref5","WinnerCell","votingTable_templateObject6","_ref6","RunnerUpCell","votingTable_templateObject7","_ref7","NomineeCell","_templateObject8","_ref8","HohCell","_templateObject9","_ref9","BlackRow","tr","_templateObject10","generateVotingTable","masterLog","houseguestCells","evictionOrder","topRowCells","preVetoCells","vetoCells","postVetoCells","evictedCells","winnerCells","cells","colSpan","generateTopRow","nominationsPreVeto","rowSpan","generatePreVetoRow","vetoWinner","generateVetoRow","nominationsPostVeto","generatePostVetoRow","voteTextLine1","soleVoter","votesInMajority","votingTable_Evicted","evicted","generateEvictedRow","runnerUp","winner","_arr","votes","_i","_ref12","_ref11","WinnerVote","RunnerUpVote","winnerRow","topRow","preVetoRow","vetoRow","postVetoRow","blackRow","houseguestRows","evictedRow","evictionColSpan","weeks","reverse","weekText","tempList","voteKey","getKey","NormalVote","NomineeVote","HoHVote","hohText","hohVote","juryVoteScene","newGameState","jurors","finalists","castJuryVote","currentLog","votesFor0","votesFor1","voteCountText","scene","BigBrotherFinale","generateBbFinale","currentGameState","hohCompScene","finalHoH","finalEviction","_finalHohCompScene","final3","enduranceWinner","enduranceLosers","skillWinner","portraits_Portrait","finalHohCompScene","_finalHohCompScene2","_finalEvictionScene","HoH","_castEvictionVote","evictee","survivor","hoh","evictHouseguest","finalEvictionScene","_finalEvictionScene2","_juryVoteScene","_juryVoteScene2","juryScene","BigBrotherFinaleEpisode","GameOver","GameOverEpisode","EpisodeLog","EdgeMap","generateGraph","nodes","edges","stringId","villainId","_generateEdge","generateEdge","_generateEdge2","edge","neighbors","v","generateCliques","bronKerbosch","values","from","keys","rPrime","pPrime","node","xPrime","delete","clique","sort","deadValue","doIWin","Targets","firstTarget","secondTarget","newTarget","isBetterTarget","old","neww","newRank","rankRelationshipSummary","oldRank","isBetterTargetPostJury","canDisplayCliques","updateFriendCounts","addTarget","getRelationshipSummary","getTargets","EpisodeFactory","episodeType","iMap","jMap","impression","randomFloat","firstImpressions","heroWinsTheFinale","populateSuperiors","house","sum","targetId","calculatePopularity","updatePopularity","finalState","BigBrotherVanilla","nomCeremonyScene","_generateHohCompScene","previousHoh","newHoH","generateHohCompScene","_generateHohCompScene2","vetoCompScene","povWinner","_generateNomCeremonyS","nom2","noms","generateNomCeremonyScene","_generateNomCeremonyS2","vetoCeremonyScene","_generateVetoCompScen","choices","povPlayers","everyoneWillPlay","introText","extras","generateVetoCompScene","_generateVetoCompScen2","evictionScene","_generateVetoCeremony","initialNominees","povTarget","descisionText","vetoChoice","useGoldenVeto","replacementSpeech","nameAReplacement","finalNominees","HoHwonPoV","replacementNom","replacementIndex","findIndex","generateVetoCeremonyScene","_generateVetoCeremony2","_generateEvictionScen","lastVoter","logic","tieVote","tieBreaker","displayHoH","generateEvictionScene","_generateEvictionScen2","Tabs","bigBrotherWeekstartWrapper_WeekStartWrapper","BigBrotherVanillaEpisode","generateBbVanilla","generateGameOver","AllianceList","elements","WeekStartWrapper","tab","TabItem","li","bigBrotherEpisode_templateObject","Tab","active","setActive","paddingLeft","Season","factory","nextEpisode","whichEpisodeType","SidebarController","subscriptions","season","selectedEpisode","delta","selectedScene","renderedScenes","targetScene","lastEpisode","episodes","switchToScene","renderEpisode","onNewEpisode","_switchToScene","index","_x","keyCode","_handleKeyDown","bind","Sidebar","document","addEventListener","handleKeyDown","destroy","minWidth","getEpisodes","episodeKey","breakKey","getHighlight","getSelectedEpisode","MainContentAreaWrapper","mainContentArea_templateObject","MainContentArea","contentStream","prevProps","prevState","scrollTo","MainPage","fullscreen","inject","hideOnFullscreen","wrapperStyle","overflow","sidebar_Sidebar","overflowX","mainContentArea_MainContentArea","MainPageController","GlobalStyles","createGlobalStyle","globalTheme_templateObject","App","styled_components_browser_esm","Fragment","mainPage_MainPage","ReactDOM","src_App","getElementById"],"mappings":"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","file":"static/js/main.1e4f0446.chunk.js","sourcesContent":["export class PlayerProfile {\n    readonly name: string = \"\";\n    readonly imageURL: string = \"\";\n    constructor(init: PlayerProfile) {\n        if (!init) {\n            return;\n        }\n        Object.assign(this, init);\n    }\n}\n","export class PowerRanking {\n    readonly beats: number;\n    readonly outOf: number;\n    get toFloat(): number {\n        return this.beats / this.outOf;\n    }\n\n    constructor(beats: number, outOf: number) {\n        if (outOf === 0) throw new Error(\"Power ranking attempted to divide by zero\");\n        this.beats = beats;\n        this.outOf = outOf;\n    }\n}\n","import { PlayerProfile } from \"./playerProfile\";\nimport { RelationshipMap } from \"../utils\";\nimport { PowerRanking } from \"./powerRanking\";\n\ninterface HouseguestInit extends PlayerProfile {\n    id: number;\n    relationships: RelationshipMap;\n}\n\nexport class Houseguest extends PlayerProfile {\n    public isEvicted: boolean = false;\n    public isJury: boolean = false;\n\n    readonly id: number = 0;\n\n    public nominations: number = 0;\n    public hohWins: number = 0;\n    public povWins: number = 0;\n\n    // Popularity ranges from -1 to 1\n    public popularity: number = 0;\n    public deltaPopularity: number = 0;\n    readonly relationships: RelationshipMap = {};\n\n    public targets: [number, number] = [this.id, this.id];\n\n    // power rankings range from 0 to 1\n    public powerRanking: PowerRanking = new PowerRanking(0, 1);\n    readonly superiors: Set<number> = new Set<number>();\n\n    public relationshipWith(villain: Houseguest): number {\n        return this.relationships[villain.id];\n    }\n    public friends = 0;\n    public enemies = 0;\n    public targetingMe = 0;\n\n    constructor(init: HouseguestInit) {\n        super(init);\n        Object.assign(this, init);\n    }\n}\n","export function hashcode(string: string): number {\n    let hash = 0,\n        i,\n        chr;\n    if (string.length === 0) return hash;\n    for (i = 0; i < string.length; i++) {\n        chr = string.charCodeAt(i);\n        hash = (hash << 5) - hash + chr;\n        hash |= 0;\n    }\n    return hash;\n}\n\nexport function roundTwoDigits(number: number | undefined) {\n    if (!number) {\n        return 0;\n    }\n    return Math.round(number * 100);\n}\n\nexport function max(a: number, b: number) {\n    return a > b ? a : b;\n}\n\nexport function extremeValues(x: number | undefined): number {\n    if (!x) {\n        return 0;\n    }\n    const xSquared = x * x;\n    if (x >= 0) {\n        return -xSquared + 2 * x;\n    } else {\n        return xSquared + 2 * x;\n    }\n}\n\nexport function isWellDefined(x: any) {\n    return x !== null && x !== undefined;\n}\n\nexport function isNotWellDefined(x: any): x is null | undefined {\n    return x === null || x === undefined;\n}\n","export interface RelationshipMap {\n    [id: number]: number;\n}\n\nexport function newRelationshipMap(size: number, exclude: number): RelationshipMap {\n    const result: RelationshipMap = {};\n    for (let i = 0; i < size; i++) {\n        if (i !== exclude) result[i] = 0;\n    }\n    return result;\n}\n","import { Houseguest } from \"../../model\";\nimport { RelationshipMap } from \"../../utils\";\nimport { getSelectedPlayer, selectedPlayer$ } from \"../../subjects/subjects\";\n\nexport interface SelectedPlayerData {\n    id: number;\n    popularity: number;\n    relationships: RelationshipMap;\n    isEvicted: boolean;\n    superiors?: Set<number>;\n}\n\nexport function selectPlayer(player: SelectedPlayerData | null) {\n    if (!player || (getSelectedPlayer() && (getSelectedPlayer() as Houseguest).id === player.id)) {\n        selectedPlayer$.next(null);\n    } else {\n        selectedPlayer$.next(player);\n    }\n}\n","function componentToHex(c: any) {\n    var hex = Math.round(c).toString(16);\n    return hex.length == 1 ? \"0\" + hex : hex;\n}\n\nexport class Rgb {\n    public r: number;\n    public g: number;\n    public b: number;\n    public toHex() {\n        return \"#\" + componentToHex(this.r) + componentToHex(this.g) + componentToHex(this.b);\n    }\n    public toRgba(): string {\n        return `rgba(${this.r}, ${this.g}, ${this.b}, 1)`;\n    }\n    constructor(r: number, g: number, b: number) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n    }\n}\n\nexport function interpolateColor(min: Rgb, max: Rgb, percent: number): string {\n    return new Rgb(\n        min.r + percent * (max.r - min.r),\n        min.g + percent * (max.g - min.g),\n        min.b + percent * (max.b - min.b)\n    ).toHex();\n}\n","import { PortraitProps, HouseguestPortrait, PortraitState } from \"../memoryWall\";\nimport { Subscription } from \"rxjs\";\nimport { selectedPlayer$, displayMode$, getSelectedPlayer } from \"../../subjects/subjects\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport { Rgb } from \"../../model/color\";\nimport { PowerRanking } from \"../../model/powerRanking\";\n\nconst selectedColor = new Rgb(51, 255, 249);\n\nexport class HouseguestPortraitController {\n    private subs: Subscription[] = [];\n    private view: HouseguestPortrait;\n    constructor(view: HouseguestPortrait) {\n        this.view = view;\n    }\n\n    get defaultState() {\n        return {\n            popularity: this.view.props.popularity,\n            displayMode: displayMode$.value,\n            powerRanking: this.view.props.powerRanking\n        };\n    }\n\n    public backgroundColor(props: PortraitProps): undefined | string {\n        const selectedPlayer = getSelectedPlayer();\n        if (selectedPlayer !== null && selectedPlayer.id === props.id) {\n            return selectedColor.toHex();\n        }\n        return props.isEvicted ? undefined : this.view.state.displayMode.backgroundColor(this.view.state);\n    }\n\n    public subscribe() {\n        const subs: Subscription[] = [];\n        subs.push(\n            selectedPlayer$.subscribe({\n                next: this.refreshData\n            })\n        );\n        subs.push(\n            displayMode$.subscribe({\n                next: displayMode => this.view.setState({ displayMode })\n            })\n        );\n        this.subs = subs;\n    }\n\n    public unsubscribe() {\n        this.subs.forEach(sub => sub.unsubscribe());\n    }\n\n    private comparePowerRankings(data: SelectedPlayerData): PowerRanking {\n        // 0 is blue. 1 is orange\n        if (!data.superiors) return new PowerRanking(0, 1);\n        const id = this.view.props.id === undefined ? -1 : this.view.props.id;\n        return data.superiors.has(id) ? new PowerRanking(1, 1) : new PowerRanking(0, 1);\n    }\n\n    private refreshData = (data: SelectedPlayerData | null) => {\n        if (!data) {\n            this.view.setState(this.defaultState);\n        } else {\n            if (data.id !== this.view.props.id) {\n                this.view.setState({\n                    popularity: data.relationships[this.view.props.id!],\n                    powerRanking: this.comparePowerRankings(data)\n                });\n            } else {\n                this.view.setState({ popularity: 2, powerRanking: new PowerRanking(2, 1) });\n            }\n        }\n    };\n}\n","import React from \"react\";\nimport { selectPlayer } from \"./selectedPortrait\";\nimport { isNotWellDefined, RelationshipMap } from \"../../utils\";\nimport _ from \"lodash\";\nimport { HouseguestPortraitController } from \"./houseguestPortraitController\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport { PowerRanking } from \"../../model/powerRanking\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst Subtitle = styled.small`\n    font-weight: 100;\n    font-size: small;\n`;\n\nconst MemoryWallPortrait = styled.div`\n    margin: 5px;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.portraitBorder};\n    color: black;\n    border-radius: 5px;\n    text-align: center;\n    font-weight: 600;\n    width: 7rem;\n    word-wrap: break-word;\n    -webkit-transition-property: none;\n    -moz-transition-property: none;\n    -o-transition-property: none;\n    transition-property: none;\n`;\n\nconst Evicted = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: grey;\n    background-color: #111111;\n`;\n\nconst Jury = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: #c3ae88;\n    background-color: #5d5340;\n    filter: brightness(0.6);\n`;\n\nconst Normal = styled.img`\n    min-width: 100px;\n    width: 100%;\n    width: -moz-available; /* For Mozzila */\n    width: -webkit-fill-available; /* For Chrome */\n    width: stretch; /* Unprefixed */\n    -webkit-transition-property: none;\n    -moz-transition-property: none;\n    -o-transition-property: none;\n    transition-property: none;\n`;\n\nconst Grayscale = styled(Normal)`\n    filter: grayscale(100%);\n`;\n\nconst Sepia = styled(Normal)`\n    filter: sepia(100%);\n`;\n\nexport interface PortraitProps {\n    imageURL: string;\n    name: string;\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    powerRanking?: PowerRanking;\n    deltaPopularity?: number;\n    detailed?: boolean;\n    superiors?: Set<number>;\n    friends?: number;\n    enemies?: number;\n    targetingMe?: number;\n}\n\nexport interface PortraitState {\n    popularity?: number;\n    powerRanking?: PowerRanking;\n    displayMode: PortraitDisplayMode;\n}\nexport class HouseguestPortrait extends React.Component<PortraitProps, PortraitState> {\n    private controller: HouseguestPortraitController;\n\n    public constructor(props: PortraitProps) {\n        super(props);\n        this.controller = new HouseguestPortraitController(this);\n        this.state = this.controller.defaultState;\n    }\n\n    public componentDidMount() {\n        if (isNotWellDefined(this.props.id)) {\n            return;\n        }\n        this.controller.subscribe();\n    }\n\n    public componentWillUnmount() {\n        this.controller.unsubscribe();\n    }\n\n    private onClick(): void {\n        if (isNotWellDefined(this.props.id) || !this.props.relationships) {\n            return;\n        }\n        const data = {\n            id: this.props.id,\n            relationships: this.props.relationships,\n            isEvicted: !!this.props.isEvicted,\n            popularity: this.props.popularity || 0,\n            superiors: this.props.superiors,\n        };\n        selectPlayer(data);\n    }\n\n    public render() {\n        const props = this.props;\n        const Img = getImageClass(props);\n        let subtitle: any[] = [];\n        subtitle = this.state.displayMode.generateSubtitle(this.props, this.state, !!props.detailed);\n\n        let Portrait = MemoryWallPortrait;\n        if (props.isJury) {\n            Portrait = Jury;\n        } else if (props.isEvicted) {\n            Portrait = Evicted;\n        }\n        return (\n            <Portrait\n                onClick={() => this.onClick()}\n                style={{\n                    backgroundColor: this.controller.backgroundColor(props),\n                }}\n            >\n                <Img src={props.imageURL} style={{ height: 100, width: \"-moz-available\" }} />\n                <br />\n                {props.name}\n                <br />\n                {<Subtitle>{subtitle}</Subtitle>}\n            </Portrait>\n        );\n    }\n}\n\nfunction getImageClass(props: PortraitProps) {\n    let imageClass = props.isEvicted ? Grayscale : Normal;\n    imageClass = props.isJury ? Sepia : imageClass;\n    return imageClass;\n}\n","import { ProfileHouseguest, HouseguestPortrait } from \"../memoryWall\";\nimport React from \"react\";\n\nexport function houseguestToPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={false} />;\n}\n\nexport function memoryWallPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={true} />;\n}\n","import React from \"react\";\nimport Popover from \"react-tiny-popover\";\nimport styled from \"styled-components\";\n\nconst Text = styled.p`\n    max-width: 200px;\n    padding: 3px 8px;\n    color: #fff;\n    text-align: center;\n    background-color: #000;\n    border-radius: 4px;\n`;\n\ninterface TooltipProps {\n    text: string;\n    children: any;\n}\n\ninterface ToolTipState {\n    visible: boolean;\n}\n\nexport class Tooltip extends React.Component<TooltipProps, ToolTipState> {\n    constructor(props: TooltipProps) {\n        super(props);\n        this.state = { visible: false };\n    }\n\n    public render() {\n        return (\n            <Popover\n                position={[\"top\", \"bottom\"]}\n                isOpen={this.state.visible}\n                content={<Text>{this.props.text}</Text>}\n            >\n                <div\n                    onMouseEnter={() => this.setState({ visible: true })}\n                    onMouseLeave={() => this.setState({ visible: false })}\n                >\n                    {this.props.children}\n                </div>\n            </Popover>\n        );\n    }\n}\n","import React from \"react\";\nimport { ProfileHouseguest } from \"../memoryWall\";\nimport { houseguestToPortrait, memoryWallPortrait } from \"./houseguestToPortrait\";\nimport { Tooltip } from \"../tooltip/tooltip\";\n\nlet key = -1;\n\nfunction PortraitWrapper(props: { centered?: boolean; children: any }): JSX.Element {\n    return (\n        <div\n            key={key++}\n            className={`columns is-gapless is-mobile is-multiline ${props.centered ? \"is-centered\" : \"\"}`}\n        >\n            {props.children}\n        </div>\n    );\n}\n\nexport function Portrait(props: { houseguest: ProfileHouseguest; centered?: boolean }): JSX.Element {\n    const result = (\n        <PortraitWrapper centered={props.centered}>{houseguestToPortrait(props.houseguest)}</PortraitWrapper>\n    );\n    if (props.houseguest.tooltip) {\n        return (\n            <PortraitWrapper centered={props.centered}>\n                <Tooltip text={props.houseguest.tooltip}>{houseguestToPortrait(props.houseguest)}</Tooltip>\n            </PortraitWrapper>\n        );\n    }\n    return result;\n}\n\nexport function Portraits(props: {\n    houseguests: ProfileHouseguest[];\n    centered?: boolean;\n    detailed?: boolean;\n}): JSX.Element {\n    const rows: JSX.Element[] = [];\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    props.houseguests.forEach((houseguest: ProfileHouseguest) => {\n        let result;\n        if (props.detailed) {\n            result = memoryWallPortrait(houseguest, key++);\n        } else {\n            result = houseguestToPortrait(houseguest, key++);\n        }\n        if (houseguest.tooltip) {\n            result = (\n                <Tooltip key={key++} text={houseguest.tooltip}>\n                    {result}\n                </Tooltip>\n            );\n        }\n        rows.push(result);\n    });\n    return (\n        <div className={`columns is-gapless is-mobile is-multiline ${props.centered && \"is-centered\"}`}>\n            {rows}\n        </div>\n    );\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { Portraits } from \"../playerPortrait/portraits\";\nimport { RelationshipMap } from \"../../utils\";\nexport interface IMemoryWallProps {\n    readonly houseguests: ProfileHouseguest[];\n}\n\nexport interface ProfileHouseguest extends PlayerProfile {\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    deltaPopularity?: number;\n    hohWins?: number;\n    povWins?: number;\n    nominations?: number;\n    tooltip?: string;\n    friends?: number;\n    enemies?: number;\n    targetingMe?: number;\n}\n\nexport function MemoryWall(props: IMemoryWallProps): JSX.Element {\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    return (\n        // TODO: modulo magic. i dare you.\n        <div\n            style={{\n                margin: \"auto\",\n                maxWidth: props.houseguests.length < 26 ? 800 : -1,\n            }}\n        >\n            <Portraits houseguests={props.houseguests} centered={true} detailed={true} />\n        </div>\n    );\n}\n","import React from \"react\";\nimport { switchSceneRelative } from \"../../subjects/subjects\";\n\nexport function NextEpisodeButton(): JSX.Element {\n    return (\n        <button className=\"button is-primary\" onClick={() => switchSceneRelative(1)}>\n            Continue\n        </button>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\ninterface SetupPortraitProps {\n    name: string;\n    imageUrl: string;\n    onDelete: () => void;\n    onChange: (arg0: Event) => void;\n}\n\ninterface SetupPortraitState {\n    name: string;\n}\n\nconst EditPortrait = styled.div`\n    padding: 5px;\n    margin: 5px;\n    border: 1px solid grey;\n    background-color: grey;\n    color: black;\n    border-radius: 5px;\n    font-weight: 600;\n    width: 7rem;\n    word-wrap: break-word;\n`;\n\nconst Input = styled.input`\n    padding: 5px;\n    margin: 5px;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.portraitBorder};\n    color: black;\n    border-radius: 5px;\n    font-weight: 600;\n    width: 7rem;\n    word-wrap: break-word;\n`;\n\nconst Noselect = styled.div`\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -khtml-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n`;\n\nconst XButton = styled(Noselect)`\n    color: #300808;\n\n    :active {\n        color: #ff7133;\n        background-color: #ffd8c7;\n    }\n    :hover {\n        color: red;\n        background-color: #ffe1ea;\n    }\n`;\n\nexport class SetupPortrait extends React.Component<SetupPortraitProps, SetupPortraitState> {\n    public constructor(props: SetupPortraitProps) {\n        super(props);\n        this.state = { name: props.name };\n    }\n\n    public UNSAFE_componentWillReceiveProps(props: SetupPortraitProps) {\n        this.setState({ name: props.name });\n    }\n\n    public render() {\n        return (\n            <EditPortrait>\n                <div style={{ textAlign: \"center\" }}>\n                    <XButton onDoubleClick={() => this.props.onDelete()}>✘</XButton>\n                    <img src={this.props.imageUrl} style={{ width: 100, height: 100 }} />\n                    <br />\n                    <p>{this.state.name} </p>\n                </div>\n            </EditPortrait>\n        );\n    }\n}\n","export enum RelationshipType {\n    Friend = \"FRIEND\",\n    Queen = \"QUEEN\",\n    Pawn = \"PAWN\",\n    Enemy = \"ENEMY\"\n}\n\nexport const RelationshipTypeToSymbol = { FRIEND: \"♥\", ENEMY: \"💔\", PAWN: \"PAWN\", QUEEN: \"QUEEN\" };\n\nexport function classifyRelationship(\n    heroPopularity: number,\n    villainPopularity: number,\n    relationship: number\n): RelationshipType {\n    const benefitsHero = relationship > heroPopularity;\n    const benefitsVillain = relationship > villainPopularity;\n    if (benefitsHero && benefitsVillain) {\n        return RelationshipType.Friend;\n    } else if (benefitsHero && !benefitsVillain) {\n        return RelationshipType.Pawn;\n    } else if (!benefitsHero && benefitsVillain) {\n        return RelationshipType.Queen;\n    }\n    return RelationshipType.Enemy;\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\n\ninterface ImportLinksProps {\n    onSubmit: (profiles: PlayerProfile[]) => void;\n    className?: string;\n}\n\nexport class ImportLinks extends React.Component<ImportLinksProps, any> {\n    public constructor(props: ImportLinksProps) {\n        super(props);\n        this.state = { text: \"\" };\n    }\n\n    private onSubmit() {\n        const lines = this.state.text.split(/\\r?\\n/);\n        // ugly, but it works.\n        const profiles: PlayerProfile[] = [];\n        lines.forEach((line: string) => {\n            const temp = line.split(\"/\").pop();\n            let name = temp\n                ? temp\n                      .split(\"#\")[0]\n                      .split(\"?\")[0]\n                      .replace(/\\.[^/.]+$/, \"\")\n                      .replace(/[-_]/g, \" \")\n                : null;\n\n            if (line.substr(0, line.indexOf(\" \"))) {\n                name = line.substr(line.indexOf(\" \") + 1);\n            }\n            if (name) {\n                profiles.push({\n                    name,\n                    imageURL: line\n                });\n            }\n        });\n        this.props.onSubmit(profiles);\n        this.setState({ text: \"\" });\n    }\n\n    public render() {\n        return (\n            <div className={this.props.className}>\n                <textarea\n                    className=\"textarea\"\n                    onChange={event => {\n                        this.setState({ text: event.target.value });\n                    }}\n                    value={this.state.text}\n                />\n                <button onClick={() => this.onSubmit()}>Import links</button>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { isWellDefined, roundTwoDigits } from \"../../utils\";\nimport { ProfileHouseguest, PortraitProps, PortraitState } from \"../memoryWall\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport {\n    RelationshipTypeToSymbol,\n    RelationshipType as Relationship,\n    classifyRelationship,\n} from \"../../utils/ai/classifyRelationship\";\nimport { getSelectedPlayer } from \"../../subjects/subjects\";\n\nexport function generatePowerSubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    _: boolean | undefined\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    key = addPopularityLine(state, hero, !!_, subtitle, key);\n    key = addCompsLine(hero, subtitle, key);\n    if (!hero.isEvicted && state.powerRanking) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            subtitle.push(<div key={key++}>{`${state.powerRanking!.beats > 0 ? \"LOSE\" : \"WIN\"}`}</div>);\n        } else if (data && data.id === hero.id) {\n            subtitle.push(<div key={key++}>I WOULD</div>);\n        } else {\n            subtitle.push(\n                <div key={key++}>{`WIN ${state.powerRanking.beats}/${state.powerRanking.outOf}${\n                    hero.targetingMe ? ` | 🎯 ${hero.targetingMe}` : \"\"\n                }`}</div>\n            );\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return subtitle;\n}\n\nexport function generatePopularitySubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    detailed: boolean = false\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    // popularity\n    key = addPopularityLine(state, hero, detailed, subtitle, key);\n    // competition wins\n    key = addCompsLine(hero, subtitle, key);\n    // friendship count / relationship classification titles\n    ({ subtitle, key } = addFriendshipCountTitles(hero, subtitle, key));\n    return subtitle;\n}\n\nfunction addFriendshipCountTitles(hero: PortraitProps, subtitle: any[], key: number) {\n    if (!hero.isEvicted) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            const titles = friendOrEnemyTitle(hero, data);\n            subtitle = subtitle.concat(titles.map((txt) => <div key={key++}>{txt}</div>));\n        } else {\n            const titles = friendEnemyCountTitle(hero);\n            subtitle = subtitle.concat(titles.map((txt) => <div key={key++}>{txt}</div>));\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return { subtitle, key };\n}\n\nfunction addPopularityLine(\n    state: { popularity?: number },\n    hero: PortraitProps,\n    detailed: boolean,\n    subtitle: any[],\n    key: number\n) {\n    let popularity = state.popularity;\n    if (popularity && (popularity > 1 || popularity < -1)) {\n        popularity = hero.popularity;\n    }\n    if (popularity && !hero.isEvicted) {\n        let popularitySubtitle = `${roundTwoDigits(popularity)}%`;\n        const deltaPop = getDeltaPopularity(hero, popularity);\n        if (detailed && deltaPop !== 0) {\n            const arrow = deltaPop > 0 ? \" | ↑\" : \" | ↓\";\n            popularitySubtitle += `${arrow} ${deltaPop}%`;\n        }\n        subtitle.push(<div key={key++}>{popularitySubtitle}</div>);\n    }\n    return key;\n}\n\nfunction addCompsLine(hero: PortraitProps, subtitle: any[], key: number) {\n    if (compWins(hero)) {\n        subtitle.push(<div key={key++}>{`${compWins(hero)}`}</div>);\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return key;\n}\n\nfunction getDeltaPopularity(houseguest: PortraitProps, statePopularity: number) {\n    if (roundTwoDigits(houseguest.popularity) !== roundTwoDigits(statePopularity)) {\n        return 0;\n    }\n    return houseguest.deltaPopularity ? roundTwoDigits(houseguest.deltaPopularity) : 0;\n}\n\nfunction compWins(houseguest: ProfileHouseguest): string {\n    return `${houseguest.hohWins ? `♔ ${houseguest.hohWins}` : \"\"}${\n        houseguest.povWins && houseguest.hohWins\n            ? `|🛇 ${houseguest.povWins}`\n            : houseguest.povWins\n            ? `🛇 ${houseguest.povWins}`\n            : \"\"\n    }${(houseguest.hohWins || houseguest.povWins) && houseguest.nominations ? \"|\" : \"\"}${\n        houseguest.nominations ? `✘ ${houseguest.nominations}` : \"\"\n    }`;\n}\n\nfunction friendOrEnemyTitle(hero: PortraitProps, villain: SelectedPlayerData): string[] {\n    const titles: string[] = [];\n    titles.push(\n        RelationshipTypeToSymbol[\n            classifyRelationship(hero.popularity || 0, villain.popularity, hero.relationships![villain.id])\n        ]\n    );\n    return titles;\n}\n\nfunction friendEnemyCountTitle(hero: PortraitProps): string[] {\n    const titles: string[] = [];\n    const count =\n        isWellDefined(hero.friends) && isWellDefined(hero.enemies)\n            ? { friends: hero.friends, enemies: hero.enemies }\n            : { friends: 0, enemies: 0 };\n    titles.push(\n        `${count.friends} ${RelationshipTypeToSymbol[Relationship.Friend]}| ${count.enemies} ${\n            RelationshipTypeToSymbol[Relationship.Enemy]\n        }${hero.targetingMe ? `| 🎯 ${hero.targetingMe}` : \"\"}`\n    );\n    return titles;\n}\n","import { Rgb, interpolateColor } from \"./color\";\nimport { PortraitState, PortraitProps } from \"../components/memoryWall\";\nimport { extremeValues } from \"../utils\";\nimport { generatePopularitySubtitle, generatePowerSubtitle } from \"../components/playerPortrait/subtitle\";\n\nexport interface PortraitDisplayMode {\n    minColor: Rgb;\n    maxColor: Rgb;\n    backgroundColor: (state: PortraitState) => string;\n    generateSubtitle: (props: PortraitProps, state: PortraitState, detailed?: boolean) => any[];\n}\n\nconst popularityMinColor = new Rgb(252, 137, 137);\nconst popularityMaxColor = new Rgb(137, 252, 137);\n\nexport const popularityMode: PortraitDisplayMode = {\n    minColor: popularityMinColor,\n    maxColor: popularityMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const popularity = state.popularity;\n\n        const extremePopularity = extremeValues(popularity);\n        const percent = (extremePopularity + 1) / 2;\n        return interpolateColor(popularityMinColor, popularityMaxColor, percent);\n    },\n    generateSubtitle: generatePopularitySubtitle\n};\n\nconst powerMaxColor = new Rgb(255, 204, 94);\nconst powerMinColor = new Rgb(192, 181, 255);\nexport const powerMode: PortraitDisplayMode = {\n    minColor: powerMinColor,\n    maxColor: powerMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const powerRanking = state.powerRanking;\n        if (powerRanking === undefined) return \"\";\n\n        return interpolateColor(powerMinColor, powerMaxColor, powerRanking.toFloat);\n    },\n    generateSubtitle: generatePowerSubtitle\n};\n","import React from \"react\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nfunction setDisplayMode(p: PortraitDisplayMode) {\n    displayMode$.next(p);\n}\n\ninterface ViewBarTagProps {\n    mode: PortraitDisplayMode;\n    text: string;\n    disabled?: boolean;\n}\n\nexport class ViewBarTag extends React.Component<ViewBarTagProps, { selected: boolean }> {\n    private sub: Subscription | null = null;\n\n    public constructor(props: ViewBarTagProps) {\n        super(props);\n        this.state = { selected: props.mode === displayMode$.value };\n    }\n\n    public componentDidMount() {\n        this.sub = displayMode$.subscribe({\n            next: (mode) => {\n                if (mode !== this.props.mode) {\n                    this.setState({ selected: false });\n                } else {\n                    this.setState({ selected: true });\n                }\n            },\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    public render() {\n        const name = \"level-item tag is-medium is-light\";\n        const style = getStyle(this.props);\n        return (\n            <span\n                className={name}\n                style={style}\n                onClick={() => {\n                    !this.props.disabled && setDisplayMode(this.props.mode);\n                    !this.props.disabled && this.setState({ selected: true });\n                }}\n            >\n                {styleText(this.props.text, this.state.selected)}\n            </span>\n        );\n    }\n}\n\nfunction styleText(text: string, selected: boolean): JSX.Element {\n    return selected ? <b>{text}</b> : <i>{text}</i>;\n}\n\nfunction getStyle(props: ViewBarTagProps) {\n    return props.disabled\n        ? {}\n        : {\n              background: `linear-gradient(90deg, ${props.mode.minColor.toRgba()} 0%, ${props.mode.maxColor.toRgba()} 100%)`,\n              cursor: \"pointer\",\n          };\n}\n","import React from \"react\";\nimport { popularityMode, powerMode } from \"../../model/portraitDisplayMode\";\nimport { ViewBarTag } from \"./viewBarTag\";\nimport { GameState, inJury } from \"../../model\";\nimport { displayMode$ } from \"../../subjects/subjects\";\n\nexport class ViewsBar extends React.Component<{ gameState: GameState }, {}> {\n    public constructor(props: { gameState: GameState }) {\n        super(props);\n    }\n\n    componentDidUpdate() {\n        if (!inJury(this.props.gameState) && displayMode$.value === powerMode) {\n            displayMode$.next(popularityMode);\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"level is-mobile\" key=\"viewsbar\" style={{ marginBottom: 0 }}>\n                <ViewBarTag mode={popularityMode} text={\"Relationships\"}></ViewBarTag>\n                {inJury(this.props.gameState) && (\n                    <ViewBarTag mode={powerMode} text={\"Power Rankings\"}></ViewBarTag>\n                )}\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { Scene } from \"./scene\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\n\nexport interface InitEpisode {\n    scenes: Scene[];\n    title: string;\n    content: JSX.Element;\n    gameState: GameState;\n    initialGamestate?: GameState;\n    type: EpisodeType;\n}\n\nexport class Episode {\n    readonly scenes: Scene[];\n    readonly title: string;\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly initialGameState: GameState;\n    readonly type: EpisodeType;\n    readonly arrowsEnabled: boolean = true;\n    get render(): JSX.Element {\n        const viewsBar = this.type.hasViewsbar ? <ViewsBar gameState={this.initialGameState} /> : null;\n        return (\n            <div>\n                {viewsBar}\n                {this.content}\n            </div>\n        );\n    }\n\n    constructor(init: InitEpisode) {\n        this.scenes = init.scenes;\n        this.title = init.title;\n        this.content = init.content;\n        this.gameState = init.gameState;\n        this.initialGameState = init.initialGamestate || init.gameState;\n        this.type = init.type;\n    }\n}\n\nexport interface EpisodeType {\n    readonly canPlayWith: (n: number) => boolean;\n    readonly eliminates: number;\n    readonly arrowsEnabled: boolean;\n    readonly hasViewsbar: boolean;\n}\n","import React from \"react\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { GameState } from \"../../model/gameState\";\n\nconst PregameEpisodeType: EpisodeType = {\n    eliminates: 0,\n    canPlayWith: (n: number) => {\n        return n > 2;\n    },\n    arrowsEnabled: true,\n    hasViewsbar: false,\n};\n\nexport class PregameEpisode extends Episode {\n    readonly title = \"Pregame\";\n    readonly scenes = [];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = PregameEpisodeType;\n\n    public constructor(gameState: GameState) {\n        super({\n            title: \"Pregame\",\n            scenes: [],\n            content: <PregameScreen cast={gameState.houseguests} />,\n            gameState,\n            type: PregameEpisodeType,\n        });\n        this.gameState = gameState;\n        this.content = <PregameScreen cast={gameState.houseguests} />;\n    }\n}\n","import React, { useState } from \"react\";\n\ninterface RandomButtonProps {\n    random: (n: number) => void;\n}\n\nexport function RandomButton(props: RandomButtonProps): JSX.Element {\n    const [number, setNumber] = useState(\"16\");\n    return (\n        <div>\n            <button\n                disabled={number === \"\"}\n                className=\"button is-primary\"\n                onClick={() => props.random(parseInt(number))}\n            >\n                Random\n            </button>\n            <NumericInput value={number} onChange={setNumber} />\n        </div>\n    );\n}\n\ninterface NumericInputProps {\n    value: string;\n    onChange: (newValue: string) => void;\n}\n\nfunction NumericInput(props: NumericInputProps) {\n    return (\n        <input\n            className=\"input\"\n            type=\"text\"\n            style={{ width: \"3em\", marginLeft: 5 }}\n            value={props.value}\n            onChange={event => {\n                const value = event.target.value;\n                if (/^\\d*$/g.test(value)) {\n                    props.onChange(value);\n                }\n            }}\n        />\n    );\n}\n","import styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nexport const HasText = styled.div`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport const Input = styled.input`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\ninterface TextProps {\n    noMargin?: boolean;\n    children?: any;\n}\n\nconst NoMargin = styled.div`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\nconst Center = styled.p`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport function Centered(props: TextProps): JSX.Element {\n    if (props.noMargin) return <NoMargin>{props.children}</NoMargin>;\n    return <Center>{props.children} </Center>;\n}\n\nexport function CenteredBold(props: TextProps): JSX.Element {\n    return (\n        <Centered noMargin={props.noMargin}>\n            <b>{props.children} </b>\n        </Centered>\n    );\n}\n\nexport function CenteredItallic(props: TextProps): JSX.Element {\n    return (\n        <Centered noMargin={props.noMargin}>\n            <i>{props.children} </i>\n        </Centered>\n    );\n}\n","import React from \"react\";\nimport FileDrop from \"react-file-drop\";\nimport { PlayerProfile, GameState } from \"../../model\";\nimport { SetupPortrait } from \"../playerPortrait/setupPortrait\";\nimport { ImportLinks } from \"./importLinks\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { shuffle } from \"lodash\";\nimport { RandomButton } from \"./randomXButton\";\nimport { selectPlayer } from \"../playerPortrait/selectedPortrait\";\nimport { mainContentStream$, newEpisode, updateCast } from \"../../subjects/subjects\";\nimport { HasText, Input } from \"../layout/text\";\nimport { Centered } from \"../layout/centered\";\n\ninterface CastingScreenState {\n    players: PlayerProfile[];\n}\n\ninterface CastingScreenProps {\n    cast?: PlayerProfile[];\n}\n\nexport class CastingScreen extends React.Component<CastingScreenProps, CastingScreenState> {\n    constructor(props: CastingScreenProps) {\n        super(props);\n        this.state = { players: props.cast || [] };\n    }\n\n    private handleChange(i: number) {\n        return (event: any) => {\n            const newName = event.target.value.replace(/\\r?\\n|\\r/g, \"\");\n            const newState = { ...this.state };\n            newState.players[i] = new PlayerProfile({\n                imageURL: newState.players[i].imageURL,\n                name: newName,\n            });\n            this.setState(newState);\n        };\n    }\n\n    private deleteMethod(i: number) {\n        return () => {\n            const newState = { ...this.state };\n            newState.players.splice(i, 1);\n            this.setState(newState);\n        };\n    }\n\n    private getFiles() {\n        const players = this.state.players;\n        if (!players) {\n            return;\n        }\n        const rows: JSX.Element[] = [];\n        let i = 0;\n        players.forEach((player) =>\n            rows.push(\n                <SetupPortrait\n                    name={player.name}\n                    imageUrl={player.imageURL}\n                    onDelete={this.deleteMethod(i)}\n                    onChange={this.handleChange(i)}\n                    key={(++i).toString()}\n                />\n            )\n        );\n        return <div className=\"columns is-gapless is-mobile is-multiline is-centered\">{rows}</div>;\n    }\n\n    private appendProfiles = (profiles: PlayerProfile[]) => {\n        const newState = { ...this.state };\n        profiles.forEach((profile) => newState.players.push(profile));\n        this.setState(newState);\n    };\n\n    private submit = async () => {\n        updateCast(this.state.players);\n        mainContentStream$.next(<PregameScreen cast={this.state.players} />);\n        selectPlayer(null);\n        await newEpisode(null);\n        await newEpisode(new PregameEpisode(new GameState(this.state.players)));\n    };\n\n    private random = (amount: number) => {\n        let players = this.state.players;\n        players = shuffle(players);\n        players = players.slice(0, amount);\n        this.setState({ players });\n    };\n\n    public render() {\n        return (\n            <FileDrop onDrop={this.handleDrop}>\n                <HasText className=\"level\">\n                    <ImportLinks onSubmit={this.appendProfiles} />\n                    <div className=\"level-item\">\n                        <button className=\"button is-danger\" onClick={() => this.setState({ players: [] })}>\n                            Delete all\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <RandomButton random={this.random} />\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-primary\"\n                            disabled={this.state.players.length < 3}\n                            onClick={this.submit}\n                        >\n                            Submit\n                        </button>\n                    </div>\n                </HasText>\n                <Input type=\"file\" multiple onChange={this.handleUpload} />\n                {this.state.players.length === 0 && <Centered>~ Drop images ~</Centered>}\n                {this.getFiles()}\n            </FileDrop>\n        );\n    }\n\n    private handleUpload = (event: any) => {\n        this.handleFiles(event.target.files);\n    };\n\n    private handleDrop = (files: FileList | null, event: React.DragEvent) => {\n        if (!files) return;\n        this.handleFiles(files);\n    };\n\n    private handleFiles(files: FileList) {\n        const newState = { ...this.state };\n        for (let i = 0; i < files.length; i++) {\n            const file = files[i];\n            if (file.type.match(/image\\/*/)) {\n                newState.players.push(\n                    new PlayerProfile({\n                        name: file.name.substr(0, file.name.lastIndexOf(\".\")) || file.name,\n                        imageURL: URL.createObjectURL(file),\n                    })\n                );\n            }\n        }\n        this.setState(newState);\n    }\n}\n","import { BehaviorSubject, Subject } from \"rxjs\";\nimport { PregameScreen } from \"../components/pregameScreen/pregameScreen\";\nimport { Episode, PlayerProfile } from \"../model\";\nimport { SelectedPlayerData } from \"../components/playerPortrait/selectedPortrait\";\nimport React from \"react\";\nimport { PortraitDisplayMode, popularityMode } from \"../model/portraitDisplayMode\";\nimport { ColorTheme, lightTheme } from \"../theme/theme\";\n\n// What is currently being displayed.\nexport const mainContentStream$ = new BehaviorSubject(<PregameScreen cast={[]} />);\n// Push episodes to this subject to add them to the sidebar. Null resets everything.\nexport const episodes$ = new BehaviorSubject<Episode | null>(null);\n// Forcibly switches to an episode. Used when adding a new episode.\nexport const switchEpisode$ = new Subject<number>();\nexport function newEpisode(episode: Episode | null) {\n    episodes$.next(episode);\n}\nexport function switchSceneRelative(n: number) {\n    switchEpisode$.next(n);\n}\n// the list of players in the game\nexport const cast$ = new BehaviorSubject<PlayerProfile[]>([]);\nexport function updateCast(newCast: PlayerProfile[]) {\n    cast$.next(newCast);\n}\nexport function getCast(): PlayerProfile[] {\n    return cast$.value;\n}\n// The player that the user has clicked on.\nexport const selectedPlayer$ = new BehaviorSubject<SelectedPlayerData | null>(null);\nexport function getSelectedPlayer() {\n    return selectedPlayer$.value;\n}\n\n// The tab selected on the start of each week.\nexport const weekStartTab$ = new BehaviorSubject<number>(0);\n\n// The display mode selected by the viewsbar.\nexport const displayMode$ = new BehaviorSubject<PortraitDisplayMode>(popularityMode);\n\n// If the screen is fullscreen or not.\nexport const isFullscreen$ = new BehaviorSubject<boolean>(false);\n\n// dark or light mode.\nexport const theme$ = new Subject<ColorTheme>();\n","export interface ColorTheme {\n    name: string;\n    bg: string;\n    text: string;\n    toggleBorder: string;\n    gradient: string;\n    bodyArea: string;\n    link: string;\n    mark: string;\n    overlay: string;\n    evictedCell: string;\n    grayCell: string;\n    winnerCell: string;\n    lightGrayCell: string;\n    runnerUpCell: string;\n    nomineeCell: string;\n    hohCell: string;\n    portraitBorder: string;\n    tableCellBorder: string;\n}\n\nexport const lightTheme: ColorTheme = {\n    name: \"light\",\n    bg: \"#fff\",\n    text: \"#363537\",\n    toggleBorder: \"#FFF\",\n    gradient: \"linear-gradient(#39598A, #79D7ED)\",\n    bodyArea: \"#fff\",\n    link: \"blue\",\n    mark: \"yellow\",\n    overlay: \"fff\",\n    evictedCell: \"#fa8072\",\n    grayCell: \"#eaecf0\",\n    lightGrayCell: \"#f8f9fa\",\n    winnerCell: \"#73fb76\",\n    runnerUpCell: \"#d1e8ef\",\n    nomineeCell: \"#959ffd\",\n    hohCell: \"#CCFFCC\",\n    portraitBorder: \"gray\",\n    tableCellBorder: \"#a2a9b1\",\n};\n\nexport const darkTheme: ColorTheme = {\n    name: \"dark\",\n    bg: \"#121212\",\n    text: \"#FAFAFA\",\n    bodyArea: \"#363537\",\n    toggleBorder: \"#6B8096\",\n    gradient: \"linear-gradient(#091236, #1E215D)\",\n    link: \"lightblue\",\n    mark: \"#7e006d\",\n    overlay: \"#444346\",\n    evictedCell: \"#9d4c43\",\n    grayCell: \"#5e5e5e\",\n    lightGrayCell: \"#404040\",\n    runnerUpCell: \"#9fbec882\",\n    nomineeCell: \"#6c75d0\",\n    winnerCell: \"#00ac04\",\n    hohCell: \"#3f783f\",\n    portraitBorder: \"#484848\",\n    tableCellBorder: \"#53575b\",\n};\n","import React, { useState } from \"react\";\nimport { theme$ } from \"../../subjects/subjects\";\nimport { darkTheme, lightTheme } from \"../../theme/theme\";\n\nexport function ThemeSwitcher() {\n    const [theme, setTheme] = useState(\n        window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches ? \"dark\" : \"light\"\n    );\n    const toggleTheme = () => {\n        if (theme === \"light\") {\n            setTheme(\"dark\");\n            theme$.next(darkTheme);\n        } else {\n            setTheme(\"light\");\n            theme$.next(lightTheme);\n        }\n    };\n\n    const className = `button ${theme === \"dark\" ? `is-dark` : \"is-light\"}`;\n    return (\n        <div className={className} onClick={toggleTheme}>\n            {theme === \"light\" ? \"Dark mode\" : \"Light mode\"}\n        </div>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst ShadowBox = styled.div`\n    box-shadow: ${({ theme }: { theme: ColorTheme }) =>\n        theme.name === \"light\" ? \"0 2px 3px rgba(10, 10, 10, 0.1), 0 0 0 1px rgba(10, 10, 10, 0.1)\" : \"\"};\n    border-radius: 6px;\n    margin-left: 3px;\n    margin-right: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.overlay};\n`;\n\nconst StyledBox = styled.div`\n    margin-left: 3px;\n    margin-right: 3px;\n    margin-bottom: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bodyArea};\n`;\n\nexport function DividerBox(props: any): JSX.Element {\n    return <ShadowBox className={props.className || \"\"}>{props.children}</ShadowBox>;\n}\n\nexport function Box(props: any): JSX.Element {\n    return (\n        <StyledBox style={props.style} className={`box ${props.className || \"\"}`}>\n            {props.children}\n        </StyledBox>\n    );\n}\n","import React from \"react\";\nimport ReactPaginate from \"react-paginate\";\nimport { HasText } from \"../layout/text\";\nimport { shuffle, ceil } from \"lodash\";\nimport { PlayerProfile } from \"../../model\";\nimport { mainContentStream$ } from \"../../subjects/subjects\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport _ from \"lodash\";\nimport styled from \"styled-components\";\n\ninterface DeckScreenProps {}\n\ninterface DeckScreenState {\n    loading: boolean;\n    decks: string[];\n    i: number;\n}\n\nconst decksPerPage = 26;\nconst baseUrl = \"https://spaulmark.github.io/img/\";\n\nconst imageCache: { [id: string]: string } = {};\n\nconst DeckStyle = styled(HasText)`\n    display: flex;\n    cursor: pointer;\n    align-items: center;\n    :hover {\n        color: red;\n        background-color: #ffe1ea;\n    }\n`;\n\nconst Centered = styled.div`\n    display: flex;\n    justify-content: center;\n    align-items: center;\n`;\n\nconst DeckText = styled.p`\n    margin-left: 1rem;\n`;\n\n// TODO: add a search bar, add a sort alphebetically function.\n\nasync function randomImageFromFolder(folder: string) {\n    if (imageCache[folder]) return imageCache[folder];\n    const links = await (await fetch(`${baseUrl}${folder}/dir.json`)).json();\n    const image = _.sample(links[\"files\"]);\n    imageCache[folder] = `${baseUrl}${folder}/${image}`;\n    return `${baseUrl}${folder}/${image}`;\n}\n\nasync function selectCast(folder: string) {\n    const links = await (await fetch(`${baseUrl}${folder}/dir.json`)).json();\n    const imageLinks = links[\"files\"].map((file: string) => {\n        return { name: file, url: `${baseUrl}${folder}/${file}` };\n    });\n    const playerProfiles = imageLinks.map((image: { name: string; url: string }) => {\n        return new PlayerProfile({\n            name: image.name.substr(0, image.name.lastIndexOf(\".\")) || image.name,\n            imageURL: image.url,\n        });\n    });\n    mainContentStream$.next(<CastingScreen cast={playerProfiles} />);\n}\n\nfunction Deck(props: { deck: string }): JSX.Element {\n    const [img, setImage] = React.useState(\"\");\n    const [loading, setLoading] = React.useState(true);\n    const deck = props.deck;\n\n    if (loading)\n        randomImageFromFolder(deck).then((img) => {\n            setLoading(false);\n            setImage(img);\n        });\n    return (\n        <DeckStyle className=\"column is-6\" onClick={() => selectCast(deck)}>\n            <img src={img} style={{ width: 50, height: 50 }} />\n            <DeckText>{deck}</DeckText>\n        </DeckStyle>\n    );\n}\n\nfunction DeckList(props: { data: string[]; i: number }): JSX.Element {\n    let commentNodes: JSX.Element[] = [];\n    const i = props.i;\n    const data = props.data;\n    const min = i * decksPerPage;\n    for (let j = min; j < min + decksPerPage; j++) {\n        const deck = data[j];\n        if (!deck) continue;\n        commentNodes.push(<Deck key={`${deck}__${i}__${j}`} deck={deck} />);\n    }\n    return (\n        <div id=\"project-comments\" key={\"__commentList__\"} style={{ display: \"flex\" }}>\n            <div key={\"__ul__\"} className={\"columns is-multiline\"}>\n                {commentNodes}\n            </div>\n        </div>\n    );\n}\n\nexport class DeckScreen extends React.Component<DeckScreenProps, DeckScreenState> {\n    constructor(props: DeckScreenProps) {\n        super(props);\n        this.state = { loading: true, decks: [], i: 0 };\n    }\n    async componentDidMount() {\n        const data = await (await fetch(\"https://spaulmark.github.io/img/dir.json\")).json();\n        this.setState({ decks: shuffle(data.decks), loading: false });\n    }\n\n    private handlePageClick = (page: { selected: number }) => {\n        this.setState({ i: page.selected });\n    };\n\n    render() {\n        if (this.state.loading) return <div />;\n        return (\n            <div>\n                <DeckList key={\"comments\"} data={this.state.decks} i={this.state.i} />\n                <Centered>\n                    <ReactPaginate\n                        key={\"__list__\"}\n                        previousLabel={\"previous\"}\n                        nextLabel={\"next\"}\n                        breakLabel={\"...\"}\n                        breakClassName={\"break-me\"}\n                        pageCount={ceil(this.state.decks.length / decksPerPage)}\n                        marginPagesDisplayed={2}\n                        pageRangeDisplayed={3}\n                        onPageChange={this.handlePageClick}\n                        containerClassName={\"pagination\"}\n                        activeClassName={\"active\"}\n                    />\n                </Centered>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport { mainContentStream$, getCast } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\nimport { ThemeSwitcher } from \"./themeSwitch\";\nimport { ColorTheme } from \"../../theme/theme\";\nimport { Box } from \"../layout/box\";\nimport { DeckScreen } from \"../deckScreen/deckScreen\";\n\nconst TopbarLink = styled.div`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.link};\n    cursor: pointer;\n`;\n\nexport function AdvancedEditLink(): JSX.Element {\n    return (\n        <TopbarLink\n            onClick={() => {\n                mainContentStream$.next(<CastingScreen cast={getCast()} />);\n            }}\n        >\n            Edit / Upload Cast\n        </TopbarLink>\n    );\n}\n\nexport function ChooseCastLink(): JSX.Element {\n    return (\n        <TopbarLink\n            onClick={() => {\n                mainContentStream$.next(<DeckScreen />);\n            }}\n        >\n            Choose Cast\n        </TopbarLink>\n    );\n}\n\nexport function Topbar(props: { style?: any }): JSX.Element {\n    const style = { ...(props.style || {}) };\n    return (\n        <Box className=\"level is-mobile\" style={style}>\n            <div className=\"level-item\">\n                <ChooseCastLink />\n            </div>\n            <div className=\"level-item\">\n                <AdvancedEditLink />\n            </div>\n            <div className=\"level-item\">\n                <ThemeSwitcher />\n            </div>\n        </Box>\n    );\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { ChooseCastLink } from \"../topbar/topBar\";\nimport { HasText } from \"../layout/text\";\nimport { popularityMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$ } from \"../../subjects/subjects\";\n\ninterface PregameScreenProps {\n    cast: PlayerProfile[];\n}\n\nexport class PregameScreen extends React.Component<PregameScreenProps, {}> {\n    public componentDidMount() {\n        displayMode$.next(popularityMode);\n    }\n\n    public render() {\n        const props = this.props;\n        if (props.cast.length === 0) {\n            return (\n                <HasText>\n                    Cast is empty. <ChooseCastLink />\n                </HasText>\n            );\n        }\n        return (\n            <HasText>\n                <MemoryWall houseguests={props.cast} />\n                <p>\n                    <b> {\"You can use the <- and -> arrow keys to move forwards and backwards.\"}</b>\n                </p>\n                <NextEpisodeButton />\n            </HasText>\n        );\n    }\n}\n","import prand from \"pure-rand\";\nimport { BehaviorSubject } from \"rxjs\";\nimport { hashcode } from \"./utilities\";\nimport { cast$ } from \"../subjects/subjects\";\n\nexport class BbRandomGenerator {\n    private rng: prand.RandomGenerator;\n\n    public randomFloat(): number {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result / 2147483647.0;\n    }\n\n    public randomInt(a: number, b: number): number {\n        let result: number;\n        [result, this.rng] = prand.uniformIntDistribution(a, b, this.rng);\n        return result;\n    }\n\n    public flipCoin(): boolean {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result % 2 === 0;\n    }\n\n    public seed(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n\n    public constructor(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n}\n\nexport function rng() {\n    return rng$.value;\n}\n\nconst rng$ = new BehaviorSubject(new BbRandomGenerator(0));\n\nconst castSub = cast$.subscribe({\n    next: cast => {\n        let castNames = \"\";\n        cast.forEach(houseguest => (castNames += houseguest.name));\n        rng$.next(new BbRandomGenerator(hashcode(castNames)));\n    }\n});\n","import { Houseguest } from \"./houseguest\";\nimport { PlayerProfile } from \"./playerProfile\";\nimport _ from \"lodash\";\nimport { newRelationshipMap, rng } from \"../utils\";\nimport { finalJurySize, getFinalists } from \"./season\";\nimport { EpisodeLog } from \"./logging/episodelog\";\n\nexport function getById(gameState: GameState, id: number): Houseguest {\n    return gameState.houseguestCache[id];\n}\n\nexport function exclude(inclusions: Houseguest[], exclusions: Houseguest[]) {\n    const excludedIds = exclusions.map((hg) => hg.id);\n    return inclusions.filter((hg) => !excludedIds.includes(hg.id) && !hg.isEvicted);\n}\n\nexport function randomPlayer(inclusions: Houseguest[], exclusions: Houseguest[] = []): Houseguest {\n    if (inclusions.length === 0) {\n        throw new Error(\"Tried to get a random player from a list of 0 players.\");\n    }\n    const options = exclude(inclusions, exclusions);\n    const choice = rng().randomInt(0, options.length - 1);\n\n    return options[choice];\n}\n\nexport function nonEvictedHouseguests(gameState: GameState): Houseguest[] {\n    return [...gameState.nonEvictedHouseguests.entries()].map(([_, id]) => getById(gameState, id));\n}\nexport function getJurors(gameState: GameState): Houseguest[] {\n    return gameState.houseguests.filter((hg) => hg.isJury);\n}\n\nexport function inJury(gameState: GameState): Boolean {\n    return gameState.remainingPlayers - getFinalists() <= finalJurySize();\n}\n\nexport function calculatePopularity(hero: Houseguest, house: Houseguest[]) {\n    let sum = 0;\n    let count = 0;\n    const targetId = hero.id;\n    house.forEach((houseguest) => {\n        if (houseguest.id !== targetId) {\n            count++;\n            sum += houseguest.relationships[targetId];\n        }\n    });\n    return count === 0 ? 0 : sum / count;\n}\n\nexport class GameState {\n    // Current state of the game after a phase.\n\n    readonly houseguestCache: { [id: number]: Houseguest } = {};\n    readonly nonEvictedHouseguests: Set<number> = new Set<number>();\n    readonly houseguests: Houseguest[] = [];\n    readonly remainingPlayers: number = 0;\n    readonly phase: number = 0;\n    readonly previousHOH?: Houseguest;\n    readonly log: EpisodeLog[] = [];\n    readonly cliques: number[][] = [];\n    get currentLog() {\n        return this.log[this.phase];\n    }\n\n    public constructor(init: PlayerProfile[] | GameState) {\n        if (!(init instanceof Array)) {\n            Object.assign(this, init);\n        } else {\n            const profiles = init as PlayerProfile[];\n            this.remainingPlayers = profiles.length;\n            profiles.forEach((profile, i) => {\n                const hg: Houseguest = new Houseguest({\n                    ...profile,\n                    id: i,\n                    relationships: newRelationshipMap(profiles.length, i),\n                });\n                this.nonEvictedHouseguests.add(i);\n                this.houseguestCache[i] = hg;\n                this.houseguests.push(hg);\n            });\n        }\n    }\n}\n\nexport class MutableGameState {\n    public houseguests: Houseguest[] = [];\n    public houseguestCache: { [id: number]: Houseguest } = {};\n    readonly nonEvictedHouseguests: Set<number> = new Set<number>();\n    public remainingPlayers: number = 0;\n    public phase: number = 0;\n    public previousHOH?: Houseguest;\n    public cliques: number[][] = [];\n    public log: EpisodeLog[] = [];\n    get currentLog() {\n        return this.log[this.phase];\n    }\n\n    public constructor(init: GameState | MutableGameState) {\n        const copy = _.cloneDeep(init);\n        Object.assign(this, copy);\n    }\n}\n","import { BigBrotherVanilla } from \"../components/episode/bigBrotherEpisode\";\nimport { EpisodeFactory } from \"../components/episode/episodeFactory\";\nimport { GameState, nonEvictedHouseguests } from \"./gameState\";\nimport { Episode } from \".\";\nimport { BigBrotherFinale } from \"../components/episode/bigBrotherFinale\";\nimport { cast$ } from \"../subjects/subjects\";\nimport { GameOver } from \"../components/episode/gameOver\";\n\nexport function finalJurySize() {\n    return jurors;\n}\n\n// 7 is not a magic number: it is just an arbitrary value which is always overwritten by cast$ before it is read.\nlet jurors = 7;\n\nconst sub = cast$.subscribe({\n    next: (newCast) => {\n        let players = newCast.length;\n        players = Math.round(players * 0.55);\n        if (players % 2 === 0) {\n            players--;\n        }\n        jurors = players;\n    },\n});\n\nexport function getFinalists() {\n    return 2;\n}\n\nexport class Season {\n    private factory: EpisodeFactory;\n\n    public constructor() {\n        this.factory = new EpisodeFactory();\n    }\n\n    // In the future, this would all be customizable,\n    // and not just all big brother episodes by default.\n\n    // TODO: I think the way to do this would be to have season asnycronously generate all episodes here,\n    // and then store them in an array,\n    // and then when sidebar calls renderEpisode, I can just pluck them from a pre-calculated array.\n    // The problem being that if it's not there, it's just not there.\n\n    // then maybe renderEpisode needs to become async?\n    // wait\n    // maybe as i generate them\n    /// obviously i generate episode 1 first\n    // then i have a hanging async function that is like \"get episode 2\"\n    // and it literally just is an awaiting or something? idk\n\n    // like if its array of async () => episode\n    // then if there is NO episode\n    // and the generator is still generating episode 2, then\n\n    //maybe it uses subjects or something\n\n    public renderEpisode(gameState: GameState): Episode {\n        return this.factory.nextEpisode(gameState, this.whichEpisodeType(gameState.remainingPlayers));\n    }\n\n    public whichEpisodeType(players: number) {\n        if (players === 3) {\n            return BigBrotherFinale;\n        }\n        if (players === 2) {\n            return GameOver;\n        }\n        return BigBrotherVanilla;\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\ninterface InitScene {\n    readonly title: string;\n    readonly gameState: GameState;\n    readonly content: JSX.Element;\n}\nexport class Scene {\n    readonly title: string = \"\";\n    readonly gameState: GameState = new GameState([]);\n    readonly content: JSX.Element = (<div>{`Error while rendering ${this.title}`}</div>);\n    public render: JSX.Element;\n    public constructor(init: Partial<InitScene>) {\n        Object.assign(this, init);\n        this.render = (\n            <div>\n                <ViewsBar gameState={this.gameState} />\n                {this.content}\n            </div>\n        );\n    }\n}\n","import { Houseguest, inJury, GameState } from \"../../model\";\n\nexport const relationship = (hero: Houseguest, villain: Houseguest) => hero.relationships[villain.id];\n\nexport function favouriteIndex(hero: Houseguest, options: Houseguest[]) {\n    // Return the index of the houseguest that hero has the best relationship with.\n    return highestScore(hero, options, relationship);\n}\n\nexport function highestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let highestIndex = 0;\n    let highestScore = -Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore > highestScore) {\n            highestIndex = i;\n            highestScore = currentScore;\n        }\n    });\n    return highestIndex;\n}\nexport function lowestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let lowestIndex = 0;\n    let lowestScore = Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore < lowestScore) {\n            lowestIndex = i;\n            lowestScore = currentScore;\n        }\n    });\n    return lowestIndex;\n}\n\nexport function doesHeroWinTheFinale(\n    hgs: { hero: Houseguest; villain: Houseguest },\n    jury: Houseguest[]\n): boolean {\n    const hero = hgs.hero;\n    const villain = hgs.villain;\n    let heroVotes = 0;\n    let villainVotes = 0;\n    jury.forEach((juror) => {\n        if (juror.id === hero.id || juror.id === villain.id) {\n            return;\n        }\n        if (relationship(hero, juror) > relationship(villain, juror)) {\n            heroVotes++;\n        } else {\n            villainVotes++;\n        }\n    });\n    return heroVotes > villainVotes;\n}\n\nexport function heroShouldTargetSuperiors(hero: Houseguest, gameState: GameState): boolean {\n    const opponents = gameState.remainingPlayers - 1;\n    const superiors = hero.superiors.size;\n    const inferiors = opponents - superiors;\n\n    return inferiors < Math.ceil(opponents / 2) + 2;\n}\n\n// TODO: this function can just honestly die. it's only used in nomination logic (which sucks anyways)\nexport function hitList(hero: Houseguest, options: Houseguest[], gameState: GameState): Set<number> {\n    let result = options;\n    // jury logic is not affected by someone who is dead center in power rankings\n    if (inJury(gameState) && heroShouldTargetSuperiors(hero, gameState)) {\n        if (hero.superiors.size * 2 < gameState.remainingPlayers - 1) {\n            result = options.filter((hg) => !hero.superiors.has(hg.id));\n        } else {\n            result = options.filter((hg) => hero.superiors.has(hg.id));\n        }\n    } else {\n    }\n    return new Set(result.map((hg) => hg.id));\n}\n","import { Houseguest, GameState, nonEvictedHouseguests, inJury, exclude } from \"../../model\";\nimport { favouriteIndex, relationship, lowestScore, hitList, heroShouldTargetSuperiors } from \"./aiUtils\";\nimport { classifyRelationship, RelationshipType as Relationship } from \"./classifyRelationship\";\n\ninterface NumberWithLogic {\n    decision: number;\n    reason: string;\n}\n\ninterface HouseguestWithLogic {\n    decision: Houseguest | null;\n    reason: string;\n}\n\n// Return the index of the eviction target.\n// TODO: this function only works for 2 houseguests despite accepting an array.\nexport function castEvictionVote(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): NumberWithLogic {\n    if (inJury(gameState)) {\n        return cutthroatVoteJury(hero, nominees, gameState);\n    } else {\n        return cutthroatVote(hero, nominees);\n    }\n}\n\nfunction cutthroatVoteJury(hero: Houseguest, nominees: Houseguest[], gameState: GameState): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    const zeroIsInferior = !hero.superiors.has(nom0.id);\n    const oneIsInferior = !hero.superiors.has(nom1.id);\n    // if there is no sup/inf difference, no point in doing special logic for it\n    if (zeroIsInferior === oneIsInferior) {\n        return cutthroatVote(hero, nominees);\n    }\n\n    // Don't evict the last person in the game you can beat\n    if (gameState.remainingPlayers - hero.superiors.size - 1 === 1 && (zeroIsInferior || oneIsInferior)) {\n        const nonVote = zeroIsInferior ? 0 : 1;\n        return {\n            decision: zeroIsInferior ? 1 : 0,\n            reason: `I can't evict ${nominees[nonVote].name}, because they are the last person I can beat.`,\n        };\n    }\n    // the ultimate in omegalul technology\n    if (\n        heroShouldTargetSuperiors(hero, gameState) &&\n        ((zeroIsInferior && !oneIsInferior) || (!zeroIsInferior && oneIsInferior))\n    ) {\n        const decision = zeroIsInferior ? 1 : 0;\n        return {\n            decision,\n            reason: `I can't beat ${nominees[decision].name} in the end.`,\n        };\n    }\n\n    // everything below this line is basically 50% legacy code, feel free to completely rewrite it\n    const target = heroShouldTargetSuperiors(hero, gameState) === oneIsInferior ? 0 : 1;\n    const nonTarget = target ? 0 : 1;\n    const excuse = heroShouldTargetSuperiors(hero, gameState)\n        ? `I can't beat ${nominees[target].name} in the end.`\n        : `I need to keep ${nominees[nonTarget].name} around as a shield.`;\n    const targetIsFriend =\n        classifyRelationship(\n            hero.popularity,\n            nominees[target].popularity,\n            hero.relationships[nominees[target].id]\n        ) === Relationship.Friend;\n    const nonTargetIsNonFriend =\n        classifyRelationship(\n            hero.popularity,\n            nominees[nonTarget].popularity,\n            hero.relationships[nominees[nonTarget].id]\n        ) !== Relationship.Friend;\n    const nonTargetIsFriend = !nonTargetIsNonFriend;\n    const targetIsNonFriend = !targetIsFriend;\n    // the only reason to not evict your target is if he is your only friend on the block\n    if (targetIsFriend && nonTargetIsNonFriend) {\n        return { decision: nonTarget, reason: `${nominees[nonTarget].name} is my enemy.` };\n    } else if (targetIsFriend && nonTargetIsFriend) {\n        return { decision: target, reason: `Both noms are my friends, but ${excuse}` };\n    } else if (targetIsNonFriend && nonTargetIsNonFriend) {\n        return { decision: target, reason: `Neither of the noms are my friends, but ${excuse}` };\n    } else {\n        return { decision: target, reason: `${excuse}` };\n    }\n}\n\n// TODO: only works for 2 nominees\nfunction cutthroatVote(hero: Houseguest, nominees: Houseguest[]): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    const r0 = classifyRelationship(hero.popularity, nom0.popularity, hero.relationships[nom0.id]);\n    const r1 = classifyRelationship(hero.popularity, nom1.popularity, hero.relationships[nom1.id]);\n\n    const nom0isTarget = hero.targets[0] === nom0.id || hero.targets[1] === nom0.id;\n    const nom1isTarget = hero.targets[0] === nom1.id || hero.targets[1] === nom1.id;\n    // KILL TARGETS FIRST\n    if ((nom0isTarget && !nom1isTarget) || (nom1isTarget && !nom0isTarget)) {\n        const decision = nom0isTarget ? 0 : 1;\n        return {\n            decision,\n            reason: `I am targeting ${nominees[decision].name}.`,\n        };\n    }\n\n    if (r0 === Relationship.Enemy && r1 === Relationship.Enemy) {\n        return {\n            decision: nom0.popularity > nom1.popularity ? 0 : 1,\n            reason: \"Both noms are my enemies, so I voted for the more popular one.\",\n        };\n    } else if (\n        (r0 === Relationship.Enemy && r1 !== Relationship.Enemy) ||\n        (r1 === Relationship.Enemy && r0 !== Relationship.Enemy)\n    ) {\n        const vote = r0 === Relationship.Enemy ? 0 : 1;\n        return { decision: vote, reason: `${nominees[vote].name} is my enemy.` };\n    } else if (\n        (r0 !== Relationship.Friend && r1 === Relationship.Friend) ||\n        (r1 !== Relationship.Friend && r0 === Relationship.Friend)\n    ) {\n        const vote = r0 !== Relationship.Friend ? 0 : 1;\n        const nonVote = vote === 0 ? 1 : 0;\n        return { decision: vote, reason: `${nominees[nonVote].name} is my friend.` };\n    }\n    const vote = lowestScore(hero, nominees, relationship);\n    return {\n        decision: vote,\n        reason: `Both noms are my friends. but I like ${nominees[vote === 0 ? 1 : 0].name} more.`,\n    };\n}\n\nexport function nominateNPlayers(\n    hero: Houseguest,\n    options: Houseguest[],\n    gameState: GameState,\n    n: number\n): NumberWithLogic[] {\n    const result: NumberWithLogic[] = [];\n    const hitlist = hitList(hero, options, gameState);\n    let trueOptions = options.filter((hg) => hitlist.has(hg.id));\n    if (trueOptions.length === 0) {\n        // if there are no options, we must sadly deviate from the hit list\n        trueOptions = options;\n    }\n    while (result.length < n) {\n        const decision = trueOptions[lowestScore(hero, trueOptions, relationship)];\n        const reason = \"I think you are ugly\";\n        result.push({ decision: decision.id, reason });\n        trueOptions = exclude(trueOptions, [decision]);\n        if (trueOptions.length === 0) {\n            trueOptions = options.filter((hg) => !hitlist.has(hg.id));\n        }\n    }\n    return result;\n}\n\nexport function useGoldenVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): HouseguestWithLogic {\n    let result: HouseguestWithLogic;\n    if (hero.id == nominees[0].id || hero.id == nominees[1].id) {\n        result = { decision: hero, reason: \"I am going to save myself.\" };\n    } else {\n        if (inJury(gameState)) {\n            // Note that I am currently not using the post-jury veto logic, primarily because it sucks at the moment\n            result = useGoldenVetoPreJury(hero, nominees);\n        } else {\n            result = useGoldenVetoPreJury(hero, nominees);\n        }\n        if (gameState.remainingPlayers === 4) {\n            result = {\n                decision: null,\n                reason: \"It doesn't make sense to use the veto here.\",\n            };\n        }\n    }\n    return result || null;\n}\n\n// works with any number of nominees\nfunction useGoldenVetoPostJury(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): HouseguestWithLogic {\n    let save = -1;\n    let reason = \"No reason specified.\";\n    let potentialSave: Houseguest | null = null;\n    let alwaysSave: Houseguest | null = null;\n    // identify potential save targets\n    nominees.forEach((nominee: Houseguest) => {\n        const relationship = classifyRelationship(\n            hero.popularity,\n            nominee.popularity,\n            hero.relationships[nominee.id]\n        );\n        const shouldTargetSuperiors = heroShouldTargetSuperiors(hero, gameState);\n        const nomineeIsSuperior: boolean = hero.superiors.has(nominee.id);\n        // always save the last person you can beat\n        if (gameState.remainingPlayers - hero.superiors.size - 1 === 1 && !nomineeIsSuperior) {\n            alwaysSave = nominee;\n            reason = `I have to save ${nominee.name}, because they are the last person I can beat.`;\n        }\n        // must be a friend and a non-target\n        // TODO: some people have the entire game as targets. they shouldn't be affected. --------------------------\n        if (relationship === Relationship.Friend && nomineeIsSuperior !== shouldTargetSuperiors) {\n            const excuse = heroShouldTargetSuperiors(hero, gameState)\n                ? `I can beat them in the end.`\n                : `I need to keep them around as a shield.`;\n            if (potentialSave) {\n                potentialSave =\n                    hero.relationshipWith(nominee) > hero.relationshipWith(potentialSave)\n                        ? nominee\n                        : potentialSave;\n            } else {\n                reason = `${nominee.name} is my friend, and ${excuse} `;\n                potentialSave = nominee;\n            }\n        }\n    });\n    if (alwaysSave) {\n        return { decision: alwaysSave, reason };\n    } else if (potentialSave) {\n        return { decision: potentialSave, reason };\n    } else {\n        return { decision: null, reason: \"Not sure what to put here yet.\" };\n    }\n}\n\nfunction useGoldenVetoPreJury(hero: Houseguest, nominees: Houseguest[]): HouseguestWithLogic {\n    let save = -1;\n    let reason = \"Neither of these nominees are my friends.\";\n    const rel0 = classifyRelationship(\n        hero.popularity,\n        nominees[0].popularity,\n        hero.relationshipWith(nominees[0])\n    );\n    const rel1 = classifyRelationship(\n        hero.popularity,\n        nominees[1].popularity,\n        hero.relationshipWith(nominees[1])\n    );\n    // basic logic that only saves friends. Doesn't take into account jury stuff.\n    if (rel0 === Relationship.Friend && rel1 !== Relationship.Friend) {\n        save = 0;\n        reason = `${nominees[0].name} is my friend.`;\n    } else if (rel1 === Relationship.Friend && rel0 !== Relationship.Friend) {\n        save = 1;\n        reason = `${nominees[1].name} is my friend.`;\n    } else if (rel0 === Relationship.Friend && rel1 === Relationship.Friend) {\n        save = nominees[0].relationshipWith(hero) > nominees[1].relationshipWith(hero) ? 0 : 1;\n        reason = `Both nominees are my friends, but I like ${nominees[save].name} more.`;\n    }\n    return { decision: nominees[save], reason };\n}\n\n// Returns the index of the finalist with the highest relationship with juror\nexport function castJuryVote(juror: Houseguest, finalists: Houseguest[]): number {\n    return favouriteIndex(juror, finalists);\n}\n","import React from \"react\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\n\nconst FullscreenIcon = styled.img`\n    position: -webkit-sticky;\n    position: sticky;\n    top: 20px;\n    right: 20px;\n`;\n\nexport function FullscreenButton(): JSX.Element {\n    return (\n        <FullscreenIcon\n            src={\n                \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAASElEQVRIiWNgGAUEACMa/z+R6ohWz0Sqi0gFLIRcQAAQDAGa+2DoWzAKRgH1wX8G3OULWfqHfkYbsNIUPR5IrQ/gYLQsGngAAEPgCRZjAdYSAAAAAElFTkSuQmCC\"\n            }\n            className=\"button is-rounded\"\n            onClick={() => {\n                isFullscreen$.next(!isFullscreen$.getValue());\n            }}\n        />\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { EpisodeLog } from \"../../../model/logging/episodelog\";\nimport { CenteredBold, Centered, CenteredItallic } from \"../../layout/centered\";\nimport { GameState, getById } from \"../../../model\";\nimport { VoteType, WinnerVote, RunnerUpVote } from \"../../../model/logging/voteType\";\nimport { FullscreenButton } from \"../../mainPage/fullscreenButton\";\nimport { ColorTheme } from \"../../../theme/theme\";\n\nexport const EndgameTableCell = styled.td`\n    padding: 0.1em 0.4em;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n`;\n\nconst EndgameTable = styled.table`\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n    border-collapse: collapse;\n`;\n\nconst Gray = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.grayCell};\n`;\n\nconst White = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.lightGrayCell};\n`;\n\nconst Evicted = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.evictedCell};\n`;\n\nexport const WinnerCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.winnerCell};\n`;\n\nexport const RunnerUpCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.runnerUpCell};\n`;\n\nexport const NomineeCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.nomineeCell};\n`;\n\nexport const HohCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.hohCell};\n`;\n\nconst BlackRow = styled.tr`\n    height: 0.4em;\n    background-color: #000000;\n`;\n\nexport function generateVotingTable(gameState: GameState): JSX.Element {\n    const masterLog: EpisodeLog[] = gameState.log;\n    const houseguestCells: JSX.Element[][] = [];\n    gameState.houseguests.forEach((hg, i) => {\n        houseguestCells[hg.id] = [\n            <Gray key={`hg-name---${i}`}>\n                <CenteredBold noMargin={true}>{hg.name}</CenteredBold>\n            </Gray>,\n        ];\n    });\n    const evictionOrder: number[] = [];\n    const topRowCells: JSX.Element[] = [];\n    const preVetoCells: JSX.Element[] = [];\n    const vetoCells: JSX.Element[] = [];\n    const postVetoCells: JSX.Element[] = [];\n    const evictedCells: JSX.Element[] = [];\n    const winnerCells: JSX.Element[] = [];\n    masterLog.forEach((log, i) => {\n        generateTopRow(log, i, topRowCells, masterLog.length - 1);\n        generatePreVetoRow(log, i, preVetoCells);\n        generateVetoRow(log, i, vetoCells);\n        generatePostVetoRow(log, i, postVetoCells);\n        generateEvictedRow(log, i, evictedCells, gameState);\n        if (!log) return;\n        evictionOrder.push(log.evicted);\n        if (log.runnerUp !== undefined) evictionOrder.push(log.runnerUp);\n        if (log.winner !== undefined) evictionOrder.push(log.winner);\n        // add each of the votes to the houseguest cells\n        for (const [key, value] of Object.entries(log.votes)) {\n            // typescript for .. in loops kinda suck so i need to do a sketchy type conversion\n            const id: number = (key as unknown) as number;\n            const vote: VoteType = value;\n            houseguestCells[id].push(vote.render(gameState));\n        }\n        if (log.winner !== undefined && log.runnerUp !== undefined) {\n            houseguestCells[log.winner].push(new WinnerVote().render(gameState));\n            houseguestCells[log.runnerUp].push(new RunnerUpVote().render(gameState));\n            evictedCells.push(\n                <RunnerUpCell key={\"runnerUp\"}>\n                    <CenteredBold noMargin={true}>{getById(gameState, log.runnerUp).name}</CenteredBold>\n                    <Centered noMargin={true}>\n                        <small>Finalist</small> {/** TODO: put \"X votes\" here instead. */}\n                    </Centered>\n                </RunnerUpCell>\n            );\n            winnerCells.push(\n                <WinnerCell key={\"winner\"}>\n                    <CenteredBold noMargin={true}>{getById(gameState, log.winner).name}</CenteredBold>\n                    <Centered noMargin={true}>\n                        <small>Winner</small>\n                    </Centered>\n                </WinnerCell>\n            );\n        }\n    });\n    preVetoCells.push(\n        <White key={`preveto--finale`} rowSpan={3}>\n            <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n        </White>\n    );\n    const winnerRow = <tr>{winnerCells}</tr>;\n    const topRow = <tr>{topRowCells}</tr>;\n    const preVetoRow = <tr>{preVetoCells}</tr>;\n    const vetoRow = <tr>{vetoCells}</tr>;\n    const postVetoRow = <tr>{postVetoCells}</tr>;\n    const blackRow = (\n        <BlackRow>\n            <td colSpan={gameState.houseguests.length} />\n        </BlackRow>\n    );\n    const houseguestRows: JSX.Element[] = [];\n    const evictedRow = <tr>{evictedCells}</tr>;\n    let evictionColSpan = -1;\n    const weeks = evictionOrder.length;\n    evictionOrder.reverse().forEach((id, i) => {\n        if (evictionColSpan > 0) {\n            const weekText = i === 2 ? \"(Finale)\" : `(Week ${weeks - i})`;\n            const isJury = getById(gameState, id).isJury;\n            const colSpan = isJury ? evictionColSpan - 1 : evictionColSpan;\n            const evicted = (\n                <Evicted colSpan={colSpan} key={`evicted-week-${weeks - i}`}>\n                    <CenteredItallic noMargin={true}>Evicted</CenteredItallic>\n                    <CenteredItallic noMargin={true}>\n                        <small>{weekText}</small>\n                    </CenteredItallic>\n                </Evicted>\n            );\n            if (!isJury) {\n                houseguestCells[id].push(evicted); // not jury, they dead\n            } else {\n                const tempList = houseguestCells[id].slice(0, -1);\n                tempList.push(evicted);\n                tempList.push(houseguestCells[id][houseguestCells[id].length - 1]);\n                houseguestCells[id] = tempList;\n            }\n        }\n        houseguestRows.push(<tr key={`hgrow--${id}`}>{houseguestCells[id]}</tr>);\n        evictionColSpan++;\n    });\n\n    return (\n        <div>\n            <FullscreenButton />\n            <EndgameTable>\n                <tbody>\n                    {topRow}\n                    {preVetoRow}\n                    {vetoRow}\n                    {postVetoRow}\n                    {blackRow}\n                    {houseguestRows}\n                    {blackRow}\n                    {evictedRow}\n                    {winnerRow}\n                </tbody>\n            </EndgameTable>\n        </div>\n    );\n}\n\nfunction generateEvictedRow(\n    log: EpisodeLog | undefined,\n    i: number,\n    cells: JSX.Element[],\n    gameState: GameState\n) {\n    if (!log) {\n        cells.push(\n            <Gray key={i} rowSpan={2}>\n                <CenteredBold noMargin={true}>Evicted</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n\n    const voteTextLine1 =\n        log.soleVoter !== undefined\n            ? `${log.soleVoter}'s choice`\n            : `${log.votesInMajority} of ${log.outOf} votes`;\n\n    cells.push(\n        <Evicted key={i} rowSpan={2}>\n            <Centered noMargin={true}>\n                <b>{getById(gameState, log.evicted).name}</b>\n                <br />\n                <small>\n                    {voteTextLine1} <br />\n                    to evict\n                </small>\n            </Centered>\n        </Evicted>\n    );\n}\n\nfunction generatePostVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`postVeto--${i}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(post-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`postVeto--${i}`}>\n            <Centered noMargin={true}>\n                {log.nominationsPostVeto[0]}\n                <br /> {log.nominationsPostVeto[1]}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`veto--${i}`}>\n                <CenteredBold noMargin={true}>Veto Winner</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.vetoWinner === undefined) return;\n\n    cells.push(\n        <White key={`veto--${i}`}>\n            <Centered noMargin={true}>{log.vetoWinner}</Centered>\n        </White>\n    );\n}\n\nfunction generatePreVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`preveto--${i}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(pre-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.nominationsPreVeto.length === 0) {\n        cells.push(\n            <White key={`preveto--${i}`} rowSpan={2}>\n                <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n            </White>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`preveto--${i}`}>\n            <Centered noMargin={true}>\n                {log.nominationsPreVeto[0]}\n                <br /> {log.nominationsPreVeto[1]}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateTopRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[], max: number) {\n    if (!log) {\n        cells.push(<Gray key={`toprow--${i}`} />);\n        return;\n    }\n    if (i === max) {\n        cells.push(\n            <Gray key={`toprow--${i}`} colSpan={2}>\n                <CenteredBold noMargin={true}>Finale</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <Gray key={`toprow--${i}`}>\n            <CenteredBold noMargin={true}>Week {i}</CenteredBold>\n        </Gray>\n    );\n}\n","import React from \"react\";\nimport { GameState, getById } from \"../gameState\";\nimport { CenteredItallic, Centered } from \"../../components/layout/centered\";\nimport {\n    EndgameTableCell,\n    WinnerCell,\n    RunnerUpCell,\n    NomineeCell,\n    HohCell,\n} from \"../../components/episode/scenes/votingTable\";\n\nlet voteKey = 0;\n\nfunction getKey(): string {\n    return `${voteKey++}-- vote key`;\n}\n\nexport interface VoteType {\n    id: number;\n    render: (state: GameState) => JSX.Element;\n}\n\nexport class NormalVote implements VoteType {\n    id: number;\n    render = (state: GameState) => (\n        <EndgameTableCell key={getKey()}>\n            <Centered noMargin={true}>{getById(state, this.id).name}</Centered>\n        </EndgameTableCell>\n    );\n    constructor(id: number) {\n        this.id = id;\n    }\n}\n\nexport class WinnerVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <WinnerCell key={\"winner---\"}>\n            <Centered noMargin={true}>Winner</Centered>\n        </WinnerCell>\n    );\n}\n\nexport class RunnerUpVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <RunnerUpCell key={\"runnerUp---\"}>\n            <Centered noMargin={true}>Finalist</Centered>\n        </RunnerUpCell>\n    );\n}\n\nexport class NomineeVote implements VoteType {\n    id: number = -1;\n    evicted: boolean;\n    render = (state: GameState) => (\n        <NomineeCell key={getKey()}>\n            <CenteredItallic noMargin={true}>Nominated</CenteredItallic>\n        </NomineeCell>\n    );\n    constructor(evicted: boolean) {\n        this.evicted = evicted;\n    }\n}\n\nexport class HoHVote implements VoteType {\n    id: number;\n\n    get hohText(): JSX.Element {\n        return (\n            <CenteredItallic noMargin={true}>\n                Head of\n                <br />\n                Household\n            </CenteredItallic>\n        );\n    }\n\n    private hohVote(state: GameState): JSX.Element {\n        return <CenteredItallic noMargin={true}>{getById(state, this.id).name}</CenteredItallic>;\n    }\n\n    render = (state: GameState) => {\n        return <HohCell key={getKey()}>{this.id == -1 ? this.hohText : this.hohVote(state)}</HohCell>;\n    };\n    constructor(id?: number) {\n        this.id = id === undefined ? -1 : id;\n    }\n}\n","import { GameState, getJurors, nonEvictedHouseguests, MutableGameState, Houseguest } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { castJuryVote } from \"../../../utils/ai/aiApi\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport React from \"react\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport { NormalVote } from \"../../../model/logging/voteType\";\n\nexport function juryVoteScene(initialGameState: GameState): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const jurors: Houseguest[] = getJurors(newGameState);\n    const finalists = nonEvictedHouseguests(newGameState);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    jurors.forEach(juror => {\n        const decision = castJuryVote(juror, finalists);\n        const result: ProfileHouseguest = { ...juror };\n        votes[decision].push(result);\n        newGameState.currentLog.votes[juror.id] = new NormalVote(finalists[decision].id);\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const winner = votesFor0 > votesFor1 ? finalists[0] : finalists[1];\n    const runnerUp = votesFor0 < votesFor1 ? finalists[0] : finalists[1];\n    newGameState.currentLog.winner = winner.id;\n    newGameState.currentLog.runnerUp = runnerUp.id;\n    const scene = new Scene({\n        title: \"Jury Votes\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </DividerBox>\n                </div>\n                <Portraits houseguests={finalists} centered={true} />\n                <CenteredBold>{`Congratulations, ${winner.name}... you are the winner of Big Brother!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [newGameState, scene];\n}\n","import React from \"react\";\nimport { EpisodeType, Episode, InitEpisode } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { GameState } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { finalHohCompScene } from \"./scenes/finalHohCompScene\";\nimport { finalEvictionScene } from \"./scenes/finalEvictionScene\";\nimport { juryVoteScene } from \"./scenes/juryVoteScene\";\nimport { HasText } from \"../layout/text\";\n\nexport const BigBrotherFinale: EpisodeType = {\n    canPlayWith: (n: number) => n === 3,\n    eliminates: 2,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n};\n\nexport function generateBbFinale(initialGameState: GameState): BigBrotherFinaleEpisode {\n    const title = \"Finale\";\n    const content = (\n        <HasText>\n            <MemoryWall houseguests={initialGameState.houseguests} /> <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n    let currentGameState;\n    let hohCompScene;\n    let finalHoH;\n    const scenes = [];\n    [currentGameState, hohCompScene, finalHoH] = finalHohCompScene(initialGameState);\n    scenes.push(hohCompScene);\n    let finalEviction;\n    [currentGameState, finalEviction] = finalEvictionScene(currentGameState, finalHoH);\n    scenes.push(finalEviction);\n    const [gameState, juryScene] = juryVoteScene(currentGameState);\n    scenes.push(juryScene);\n    return new BigBrotherFinaleEpisode({ gameState, content, title, scenes, type: BigBrotherFinale });\n}\n\nexport class BigBrotherFinaleEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = BigBrotherFinale;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portraits, Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\n\nexport function finalHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n    const final3 = nonEvictedHouseguests(initialGameState);\n    const enduranceWinner = randomPlayer(final3);\n    const enduranceLosers = final3.filter(hg => hg.id !== enduranceWinner.id);\n    const skillWinner = randomPlayer(final3, [enduranceWinner]);\n    const finalHoH = getById(newGameState, randomPlayer([enduranceWinner, skillWinner]).id);\n    finalHoH.hohWins++;\n    const scene: Scene = new Scene({\n        title: \"Final HoH Competition\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>The final 3 houseguests compete in the endurance competition.</Centered>\n                <Portraits houseguests={final3} centered={true} />\n                <Portrait houseguest={enduranceWinner} centered={true} />\n                <CenteredBold>{`${enduranceWinner.name} has won the endurance competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceLosers[0].name} and ${enduranceLosers[1].name} compete in the skill competition.`}</Centered>\n                <Portraits houseguests={enduranceLosers} centered={true} />\n                <Portrait houseguest={skillWinner} centered={true} />\n                <CenteredBold>{`${skillWinner.name} has won the skill competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceWinner.name} and ${skillWinner.name} compete in the quiz competition.`}</Centered>\n                <Portraits houseguests={[enduranceWinner, skillWinner]} centered={true} />\n                <Portrait houseguest={finalHoH} centered={true} />\n                <CenteredBold>{`Congratulations ${finalHoH.name}, you are the final Head of Household!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene, finalHoH];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { evictHouseguest } from \"../bigBrotherEpisode\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { HoHVote, NomineeVote } from \"../../../model/logging/voteType\";\n\nexport function finalEvictionScene(initialGameState: GameState, HoH: Houseguest): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const nominees = nonEvictedHouseguests(newGameState).filter((hg) => hg.id !== HoH.id);\n    newGameState.currentLog.nominationsPostVeto = nominees.map((hg) => hg.name);\n    const { decision: vote, reason } = castEvictionVote(HoH, nominees, newGameState);\n    const evictee = nominees[vote];\n    const survivor = nominees[vote == 1 ? 0 : 1];\n    newGameState.currentLog.soleVoter = HoH.name;\n    newGameState.currentLog.votes[survivor.id] = new NomineeVote(false);\n    newGameState.currentLog.votes[HoH.id] = new HoHVote(evictee.id);\n    newGameState.currentLog.votesInMajority = 1;\n    newGameState.currentLog.outOf = 1;\n    const hoh: ProfileHouseguest = { ...HoH };\n    hoh.tooltip = reason;\n    evictHouseguest(newGameState, evictee.id);\n    const scene: Scene = new Scene({\n        title: \"Final Eviction\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    {`As the final HoH of the season, ${HoH.name}, you may now cast the sole vote to evict.`}\n                </Centered>\n                <Portrait houseguest={hoh} centered={true} />\n                <CenteredBold>{`I vote to evict ${evictee.name}.`}</CenteredBold>\n                <Portraits houseguests={nominees} centered={true} />\n                <Centered>\n                    It's official... {evictee.name}, you will be the final person leaving the Big Brother\n                    House.\n                </Centered>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene];\n}\n","import { Episode, InitEpisode, EpisodeType } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { GameState } from \"../../model\";\nimport { evictHouseguest } from \"./bigBrotherEpisode\";\nimport { generateVotingTable } from \"./scenes/votingTable\";\n\nexport const GameOver: EpisodeType = {\n    canPlayWith: (n: number) => n === 1,\n    eliminates: 1,\n    arrowsEnabled: false,\n    hasViewsbar: false\n};\n\nexport function generateGameOver(gameState: GameState): GameOverEpisode {\n    const title = \"Game Over\";\n    const scenes: Scene[] = [];\n    const content = generateVotingTable(gameState);\n    gameState.houseguests.forEach(hg => {\n        evictHouseguest(gameState, hg.id);\n    });\n    return new GameOverEpisode({ gameState, content, title, scenes, type: GameOver });\n}\n\nexport class GameOverEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import { VoteType } from \"./voteType\";\n\nexport class EpisodeLog {\n    public nominationsPreVeto: string[] = [];\n    public vetoWinner?: string;\n    public winner?: number;\n    public runnerUp?: number;\n    public nominationsPostVeto: string[] = [];\n    public evicted: number = -1;\n    public votes: { [id: string]: VoteType } = {};\n    public votesInMajority: number = -1;\n    public outOf: number = -1;\n    public soleVoter?: string;\n}\n","import { Houseguest, GameState, nonEvictedHouseguests, getById } from \"../model\";\n\nimport { classifyRelationship, RelationshipType } from \"./ai/classifyRelationship\";\n\nimport _ from \"lodash\";\nimport { Graph } from \"./graphTest\";\n\nclass EdgeMap {\n    public data: { [id: number]: Set<number> } = {};\n    public add(key: number, value: number) {\n        if (!this.data[key]) {\n            this.data[key] = new Set<number>([value]);\n        } else {\n            this.data[key].add(value);\n        }\n    }\n}\n\nfunction generateEdge(\n    hero: Houseguest,\n    villain: Houseguest,\n    relationship: number\n): [number[] | null, number] {\n    const relationshipType = classifyRelationship(hero.popularity, villain.popularity, relationship);\n    if (relationshipType === RelationshipType.Friend) {\n        return [[hero.id, villain.id], 1];\n    }\n    // no edge for non-mutual friends\n    return [null, 0];\n}\n\nexport default function generateGraph(gameState: GameState): Graph {\n    // TODO: this algorithm assumes every relationship is mutual,\n    // and will need a face lift once we start getting non-mutual relationships.\n    const players = nonEvictedHouseguests(gameState);\n    const nodes: number[] = [];\n    const edges: EdgeMap = new EdgeMap();\n    players.forEach(player => {\n        let friendCount = 0;\n        _.forEach(player.relationships, (relationship, stringId) => {\n            const villainId = parseInt(stringId);\n            const [edge, friends] = generateEdge(player, getById(gameState, villainId), relationship);\n            friendCount += friends;\n            if (villainId > player.id) {\n                if (edge) {\n                    edges.add(player.id, villainId);\n                    edges.add(villainId, player.id);\n                }\n            }\n        });\n        // nodes[player.id] = friendCount; TODO: for pivot later on, thats why friendcount is there unused\n        nodes.push(player.id);\n    });\n    return { nodes, neighbors: (v: number) => edges.data[v] || new Set([]) };\n}\n","import { GameState, getById } from \"../model\";\nimport generateGraph from \"./generateGraph\";\n\nlet result: number[][] = [];\nexport interface Graph {\n    nodes: number[];\n    neighbors: (v: number) => Set<number>;\n}\n\nexport function generateCliques(gameState: GameState): number[][] {\n    const g = generateGraph(gameState);\n    result = [];\n    bronKerbosch(new Set<number>([]), new Set(g.nodes), new Set<number>([]), g);\n    result.forEach((clique) => clique.map((id) => getById(gameState, id)));\n    result = result.filter((clique) => clique.length > 2).sort((a, b) => b.length - a.length);\n    return result;\n}\n\nfunction bronKerbosch(r: Set<number>, p: Set<number>, x: Set<number>, g: Graph) {\n    if (p.size === 0 && x.size === 0) {\n        const values = Array.from(r.values());\n        result.push(values);\n        return;\n    }\n    Array.from(p.keys()).forEach((v) => {\n        const rPrime = new Set(r.values()).add(v);\n        const pPrime = new Set([...p].filter((node) => g.neighbors(v).has(node)));\n        const xPrime = new Set([...x].filter((node) => g.neighbors(v).has(node)));\n        bronKerbosch(rPrime, pPrime, xPrime, g);\n        p.delete(v);\n        x.add(v);\n    });\n}\n","import { GameState, Houseguest, inJury } from \"../../model\";\nimport { heroShouldTargetSuperiors } from \"./aiUtils\";\nimport { classifyRelationship, RelationshipType } from \"./classifyRelationship\";\n\ninterface RelationshipSummary {\n    type: RelationshipType;\n    relationship: number;\n    id: number;\n    doIWin: boolean;\n}\n\nconst deadValue: RelationshipSummary = {\n    type: RelationshipType.Friend,\n    id: -1,\n    doIWin: true,\n    relationship: 2,\n};\n\nexport function getRelationshipSummary(hero: Houseguest, villain: Houseguest): RelationshipSummary {\n    const doIWin = !hero.superiors.has(villain.id);\n    const type = classifyRelationship(hero.popularity, villain.popularity, hero.relationshipWith(villain));\n    return { id: villain.id, relationship: villain.relationshipWith(hero), type, doIWin };\n}\n\nexport class Targets {\n    private firstTarget: RelationshipSummary = deadValue;\n    private secondTarget: RelationshipSummary = deadValue;\n    private hg: Houseguest;\n\n    constructor(hg: Houseguest) {\n        this.hg = hg;\n    }\n\n    public getTargets(): [number, number] {\n        return [this.firstTarget.id, this.secondTarget.id];\n    }\n    public addTarget(newTarget: RelationshipSummary, gameState: GameState) {\n        if (\n            !(\n                isBetterTarget(this.firstTarget, newTarget, this.hg, gameState) ||\n                isBetterTarget(this.secondTarget, newTarget, this.hg, gameState)\n            )\n        )\n            return;\n        isBetterTarget(this.firstTarget, this.secondTarget, this.hg, gameState)\n            ? (this.firstTarget = newTarget)\n            : (this.secondTarget = newTarget);\n    }\n}\n\nexport function isBetterTarget(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    hg: Houseguest,\n    gameState: GameState\n): boolean {\n    return isBetterTargetPostJury(old, neww, inJury(gameState) && heroShouldTargetSuperiors(hg, gameState));\n}\n\nfunction isBetterTargetPostJury(old: RelationshipSummary, neww: RelationshipSummary, jury: boolean) {\n    if (old.relationship === 2) return true;\n    const newRank = rankRelationshipSummary(neww, jury);\n    const oldRank = rankRelationshipSummary(old, jury);\n    if (newRank > oldRank) return false;\n    if (newRank < oldRank) return true;\n    return neww.relationship < old.relationship;\n}\n\n// when \"jury\" is FALSE, the r.doIWin condition is ignored, since !jury is always true.\n// This enables people who are at the top of the game to target people below them and play based on relationships.\nfunction rankRelationshipSummary(r: RelationshipSummary, jury: boolean): number {\n    if (r.type === RelationshipType.Enemy) return r.doIWin || !jury ? 4 : 1;\n    if (r.type === RelationshipType.Friend) return r.doIWin || !jury ? 6 : 3;\n    return r.doIWin || !jury ? 5 : 2;\n}\n","import {\n    GameState,\n    MutableGameState,\n    calculatePopularity,\n    nonEvictedHouseguests,\n    inJury,\n    getJurors,\n    getById,\n} from \"../../model/gameState\";\nimport { Episode, Houseguest } from \"../../model\";\nimport { EpisodeType } from \"./episodes\";\nimport { BigBrotherVanilla, generateBbVanilla } from \"./bigBrotherEpisode\";\nimport { BigBrotherFinale, generateBbFinale } from \"./bigBrotherFinale\";\nimport { rng, roundTwoDigits } from \"../../utils\";\nimport { doesHeroWinTheFinale as heroWinsTheFinale } from \"../../utils/ai/aiUtils\";\nimport { classifyRelationship, RelationshipType as Relationship } from \"../../utils/ai/classifyRelationship\";\nimport { PowerRanking } from \"../../model/powerRanking\";\nimport { GameOver, generateGameOver } from \"./gameOver\";\nimport { EpisodeLog } from \"../../model/logging/episodelog\";\nimport { generateCliques } from \"../../utils/graphTest\";\nimport { getRelationshipSummary, Targets } from \"../../utils/ai/targets\";\n\nexport function canDisplayCliques(newState: GameState): boolean {\n    return newState.remainingPlayers <= 30;\n}\n\nfunction firstImpressions(houseguests: Houseguest[]) {\n    for (let i = 0; i < houseguests.length; i++) {\n        const iMap = houseguests[i].relationships;\n        for (let j = i + 1; j < houseguests.length; j++) {\n            // creates a bunch of 100% random mutual relationships\n            const jMap = houseguests[j].relationships;\n            const impression = rng().randomFloat();\n            jMap[i] = impression;\n            iMap[j] = impression;\n        }\n    }\n}\n\nfunction populateSuperiors(houseguests: Houseguest[]) {\n    for (let i = 0; i < houseguests.length; i++) {\n        const hero = houseguests[i];\n        for (let j = i + 1; j < houseguests.length; j++) {\n            const villain = houseguests[j];\n            if (heroWinsTheFinale({ hero, villain }, houseguests)) {\n                villain.superiors.add(hero.id);\n            } else {\n                hero.superiors.add(villain.id);\n            }\n        }\n    }\n}\n\nfunction updatePowerRankings(houseguests: Houseguest[]) {\n    houseguests.forEach((hg) => {\n        hg.powerRanking = new PowerRanking(\n            houseguests.length - 1 - hg.superiors.size,\n            houseguests.length - 1\n        );\n    });\n}\n\nfunction updatePopularity(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach((hg) => {\n        hg.targetingMe = 0;\n        const result = calculatePopularity(hg, nonEvictedHouseguests(gameState));\n        hg.deltaPopularity = (roundTwoDigits(result) - roundTwoDigits(hg.popularity)) / 100;\n        hg.popularity = result;\n    });\n}\n\nfunction updateFriendCounts(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach((hero: Houseguest) => {\n        let targets = new Targets(hero);\n        let friends = 0;\n        let enemies = 0;\n        houseguests.forEach((villain) => {\n            if (hero.id === villain.id) return;\n            const type = classifyRelationship(\n                hero.popularity,\n                villain.popularity,\n                hero.relationshipWith(villain)\n            );\n            targets.addTarget(getRelationshipSummary(hero, villain), gameState);\n            if (type === Relationship.Friend) {\n                friends++;\n            } else if (type === Relationship.Enemy) {\n                enemies++;\n            }\n        });\n        hero.targets = targets.getTargets();\n        getById(gameState, hero.targets[0]).targetingMe++;\n        getById(gameState, hero.targets[1]).targetingMe++;\n        hero.friends = friends;\n        hero.enemies = enemies;\n    });\n}\n\nexport class EpisodeFactory {\n    public nextEpisode(gameState: GameState, episodeType: EpisodeType): Episode {\n        let newState = new MutableGameState(gameState);\n        if (gameState.phase === 0) {\n            firstImpressions(newState.houseguests);\n        }\n        newState.phase++;\n        if (gameState.remainingPlayers > 2) {\n            newState.log[newState.phase] = new EpisodeLog();\n        }\n        // If jury starts this episode, populate superior/inferior data. In the future, every jury ep. (dynamic rels)\n        if (inJury(gameState) && getJurors(gameState).length === 0) {\n            populateSuperiors(nonEvictedHouseguests(newState));\n        }\n        if (inJury(gameState)) {\n            updatePowerRankings(nonEvictedHouseguests(newState));\n        }\n        updatePopularity(newState);\n        gameState.remainingPlayers > 2 && updateFriendCounts(newState);\n        if (canDisplayCliques(newState)) newState.cliques = generateCliques(newState);\n        const finalState = new GameState(newState);\n        switch (episodeType) {\n            case BigBrotherVanilla:\n                return generateBbVanilla(finalState);\n            case BigBrotherFinale:\n                return generateBbFinale(finalState);\n            case GameOver:\n                return generateGameOver(finalState);\n            default:\n                throw new Error(\"Unsupported Episode Type\");\n        }\n    }\n}\n","import {\n    MutableGameState,\n    getById,\n    inJury,\n    nonEvictedHouseguests,\n    GameState,\n    Houseguest,\n    EpisodeType,\n    Episode,\n    InitEpisode,\n} from \"../../model\";\nimport { getFinalists, finalJurySize } from \"../../model/season\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateNomCeremonyScene } from \"./scenes/nomCeremonyScene\";\nimport { generateVetoCompScene } from \"./scenes/vetoCompScene\";\nimport { generateVetoCeremonyScene } from \"./scenes/vetoCeremonyScene\";\nimport { generateEvictionScene } from \"./scenes/evictionScene\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Scene } from \"./scene\";\nimport { HasText } from \"../layout/text\";\nimport styled from \"styled-components\";\nimport { weekStartTab$ } from \"../../subjects/subjects\";\nimport { WeekStartWrapper } from \"./bigBrotherWeekstartWrapper\";\n\nexport const BigBrotherVanilla: EpisodeType = {\n    canPlayWith: (n: number) => {\n        return n > 1;\n    },\n    eliminates: 1,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n};\n\nconst TabItem = styled.li`\n    cursor: pointer;\n`;\n\n// Refactoring ideas\n/**\n * Might be best to start passing ids instead of houseguests for HoH/nominees/veto winner\n */\n\nexport function evictHouseguest(gameState: MutableGameState, id: number) {\n    const evictee = getById(gameState, id);\n    if (gameState.currentLog) gameState.currentLog.evicted = evictee.id;\n    evictee.isEvicted = true;\n    if (gameState.remainingPlayers - getFinalists() <= finalJurySize()) {\n        evictee.isJury = true;\n    }\n    if (inJury(gameState)) {\n        nonEvictedHouseguests(gameState).forEach((hg) => {\n            hg.superiors.delete(evictee.id);\n        });\n    }\n    gameState.nonEvictedHouseguests.delete(evictee.id);\n    gameState.remainingPlayers--;\n}\n\nfunction Tab(props: { text: string; active: number; id: number; setActive: any }): JSX.Element {\n    return (\n        <TabItem\n            className={props.active === props.id ? \"is-active\" : \"\"}\n            onClick={() => {\n                props.setActive(props.id);\n                weekStartTab$.next(props.id);\n            }}\n        >\n            <a>{props.text}</a>\n        </TabItem>\n    );\n}\n\nfunction Tabs(): JSX.Element {\n    const [active, setActive] = React.useState(weekStartTab$.value);\n    return (\n        <div className=\"tabs is-centered is-fullwidth is-medium\" style={{ marginBottom: 0 }}>\n            <ul style={{ paddingLeft: 0 }}>\n                <Tab text={\"Memory Wall\"} active={active} setActive={setActive} id={0} />\n                <Tab text={\"Alliances\"} active={active} setActive={setActive} id={1} />\n            </ul>\n        </div>\n    );\n}\n\nexport function generateBbVanilla(initialGamestate: GameState): BigBrotherVanillaEpisode {\n    let currentGameState;\n    let hohCompScene;\n    let hoh: Houseguest;\n    const scenes = [];\n    [currentGameState, hohCompScene, hoh] = generateHohCompScene(initialGamestate);\n    scenes.push(hohCompScene);\n\n    let nomCeremonyScene;\n    let nominees: Houseguest[];\n    [currentGameState, nomCeremonyScene, nominees] = generateNomCeremonyScene(currentGameState, hoh);\n    scenes.push(nomCeremonyScene);\n\n    let vetoCompScene;\n    let povWinner: Houseguest;\n    [currentGameState, vetoCompScene, povWinner] = generateVetoCompScene(\n        currentGameState,\n        hoh,\n        nominees[0],\n        nominees[1]\n    );\n    scenes.push(vetoCompScene);\n    let vetoCeremonyScene;\n\n    [currentGameState, vetoCeremonyScene, nominees] = generateVetoCeremonyScene(\n        currentGameState,\n        hoh,\n        nominees,\n        povWinner\n    );\n    scenes.push(vetoCeremonyScene);\n\n    let evictionScene;\n    [currentGameState, evictionScene] = generateEvictionScene(currentGameState, hoh, nominees);\n    scenes.push(evictionScene);\n\n    const title = `Week ${currentGameState.phase}`;\n    const content = (\n        <HasText>\n            <Tabs />\n            <WeekStartWrapper gameState={initialGamestate} />\n            <br />\n            {currentGameState.phase === 1 && <b>Try clicking on houseguests to view their relationships.</b>}\n            <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n    const gameState = new GameState(currentGameState);\n    return new BigBrotherVanillaEpisode({\n        title,\n        scenes,\n        content,\n        gameState,\n        initialGamestate,\n        type: BigBrotherVanilla,\n    });\n}\nexport class BigBrotherVanillaEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly initialGamestate: GameState;\n    readonly gameState: GameState;\n    readonly type = BigBrotherVanilla;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n        this.initialGamestate = init.initialGamestate || init.gameState;\n    }\n}\n","import { GameState, Houseguest, MutableGameState, randomPlayer } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { HoHVote } from \"../../../model/logging/voteType\";\nimport { heroShouldTargetSuperiors } from \"../../../utils/ai/aiUtils\";\n\nexport function generateHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    const previousHoh = initialGameState.previousHOH ? [initialGameState.previousHOH] : [];\n    const newHoH: Houseguest = randomPlayer(newGameState.houseguests, previousHoh);\n    newGameState.previousHOH = newHoH;\n    newGameState.currentLog.votes[newHoH.id] = new HoHVote();\n    newHoH.hohWins += 1;\n    const scene = new Scene({\n        title: \"HoH Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>\n                    {previousHoh.length > 0 &&\n                        `Houseguests, it's time to find a new Head of Household. As outgoing HoH, ${previousHoh[0].name} will not compete. `}\n                </Centered>\n                <Portrait centered={true} houseguest={newHoH} />\n                <CenteredBold>{newHoH.name} has won Head of Household!</CenteredBold>\n                <br />\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n\n    return [new GameState(newGameState), scene, newHoH];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    exclude,\n    nonEvictedHouseguests,\n    getById,\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { shuffle } from \"lodash\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\n\nexport function generateNomCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest\n): [GameState, Scene, Houseguest[]] {\n    const newGameState = new MutableGameState(initialGameState);\n    const options = exclude(nonEvictedHouseguests(newGameState), [HoH]);\n    const [nom1, nom2] = [getById(newGameState, HoH.targets[0]), getById(newGameState, HoH.targets[1])];\n    nom1.nominations++;\n    nom2.nominations++;\n    newGameState.currentLog.nominationsPreVeto = [nom1.name, nom2.name];\n    const noms = shuffle([nom1, nom2]);\n    const scene = new Scene({\n        title: \"Nomination Ceremony\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    This is the nomination ceremony. It is my responsibility as the Head of Household to\n                    nominate two houseguests for eviction.\n                </Centered>\n                <Portrait centered={true} houseguest={HoH} />\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Centered> My first nominee is...</Centered>\n                        <Portrait centered={true} houseguest={noms[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Centered>My second nominee is...</Centered>\n                        <Portrait centered={true} houseguest={noms[1]} />\n                    </DividerBox>\n                </div>\n                <CenteredBold>{`I have nominated you, ${noms[0].name} and you, ${noms[1].name} for eviction.`}</CenteredBold>\n                <br />\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, [nom1, nom2]];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\n\nexport function generateVetoCompScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nom1: Houseguest,\n    nom2: Houseguest\n): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    // pick players\n    const choices = nonEvictedHouseguests(newGameState);\n    let povPlayers: any[] = [];\n    const everyoneWillPlay = choices.length <= 6;\n\n    if (everyoneWillPlay) {\n        povPlayers.push({ ...HoH });\n        povPlayers.push({ ...nom1 });\n        povPlayers.push({ ...nom2 });\n        while (povPlayers.length < choices.length) {\n            povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        }\n    } else {\n        // TODO: houseguests choice picks\n        povPlayers.push({ ...HoH });\n        povPlayers.push({ ...nom1 });\n        povPlayers.push({ ...nom2 });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n    }\n    let povWinner = randomPlayer(povPlayers);\n    povWinner = getById(newGameState, povWinner.id);\n    povWinner.povWins++;\n    newGameState.currentLog.vetoWinner = povWinner.name;\n    let introText: string;\n    if (everyoneWillPlay) {\n        introText = \"Everyone left in the house will compete in this challenge.\";\n    } else {\n        introText = `${HoH.name}, as Head of Household, and ${nom1.name} and ${nom2.name} as nominees, will compete, as well as 3 others chosen by random draw.`;\n    }\n    const extras = [povPlayers[3]];\n    povPlayers[4] && extras.push(povPlayers[4]);\n    povPlayers[5] && extras.push(povPlayers[5]);\n    const scene = new Scene({\n        title: \"Veto Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>It's time to pick players for the veto competition.</Centered>\n                <Portraits centered={true} houseguests={[HoH, nom1, nom2]} />\n                <Centered>{introText}</Centered>\n                <Portraits centered={true} houseguests={extras} />\n                <Centered>...</Centered>\n                <Portraits centered={true} houseguests={[povWinner]} />\n                <CenteredBold>{`${povWinner.name} has won the Golden Power of Veto!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene, povWinner];\n}\n","import { GameState, Houseguest, getById, exclude } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { useGoldenVeto, nominateNPlayers } from \"../../../utils/ai/aiApi\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\n\nexport function generateVetoCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    initialNominees: Houseguest[],\n    povWinner: Houseguest\n): [GameState, Scene, Houseguest[]] {\n    let povTarget: Houseguest | null = null;\n    let descisionText = \"\";\n    initialNominees[0] = getById(initialGameState, initialNominees[0].id);\n    initialNominees[1] = getById(initialGameState, initialNominees[1].id);\n    HoH = getById(initialGameState, HoH.id);\n    const vetoChoice = useGoldenVeto(povWinner, initialNominees, initialGameState);\n    povTarget = vetoChoice.decision;\n    if (!povTarget) {\n        descisionText += \"... not to use the power of veto.\";\n    } else if (povWinner.id == initialNominees[0].id || povWinner.id == initialNominees[1].id) {\n        descisionText += \"...to use the power of veto on myself.\";\n    } else {\n        descisionText += `...to use the power of veto on ${povTarget.name}.`;\n    }\n    let replacementSpeech = \"\";\n    let nameAReplacement = \"\";\n    let finalNominees: any[] = [...initialNominees];\n    if (povTarget) {\n        const HoHwonPoV = HoH.id === povWinner.id;\n        nameAReplacement += HoHwonPoV\n            ? `Since I have just vetoed one of my nominations, I must name a replacement nominee.`\n            : `${HoH.name}, since I have just vetoed one of your nominations, you must name a replacement nominee.`;\n        const replacementNom = {\n            ...getById(\n                initialGameState,\n                nominateNPlayers(\n                    HoH,\n                    exclude(initialGameState.houseguests, [\n                        HoH,\n                        initialNominees[0],\n                        initialNominees[1],\n                        povWinner,\n                    ]),\n                    initialGameState,\n                    1\n                )[0].decision\n            ),\n        };\n        const replacementIndex = initialNominees.findIndex((hg) => hg.id === vetoChoice.decision!.id);\n        finalNominees[replacementIndex] = replacementNom;\n        replacementNom.nominations++;\n        getById(initialGameState, replacementNom.id).nominations++;\n        replacementSpeech = `My replacement nominee is ${replacementNom.name}.`;\n    }\n    const scene = new Scene({\n        title: \"Veto Ceremony\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>This is the Veto Ceremony.</Centered>\n                <Centered>\n                    {`${initialNominees[0].name} and ${initialNominees[1].name} have been nominated for eviction, \n                    but I have the power to veto one of these nominations.`}\n                </Centered>\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={initialNominees[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={initialNominees[1]} />\n                    </DividerBox>\n                </div>\n                <CenteredBold>\n                    I have decided... <br />\n                </CenteredBold>\n                <Portrait centered={true} houseguest={{ ...povWinner, tooltip: vetoChoice.reason }} />\n                <CenteredBold noMargin={true}>{descisionText}</CenteredBold>\n                <Centered>{nameAReplacement}</Centered>\n                {replacementSpeech && <Portrait centered={true} houseguest={HoH} />}\n                <CenteredBold>{replacementSpeech}</CenteredBold>\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={finalNominees[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={finalNominees[1]} />\n                    </DividerBox>\n                </div>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    initialGameState.currentLog.nominationsPostVeto = [finalNominees[0].name, finalNominees[1].name];\n    return [initialGameState, scene, finalNominees];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests, getById } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { shuffle } from \"lodash\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { evictHouseguest } from \"../bigBrotherEpisode\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NomineeVote, NormalVote, HoHVote } from \"../../../model/logging/voteType\";\n\nexport function generateEvictionScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nominees: Houseguest[]\n): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    nominees = shuffle(nominees);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    let lastVoter: Houseguest;\n    nonEvictedHouseguests(newGameState).forEach(hg => {\n        if (hg.id !== nominees[0].id && hg.id !== nominees[1].id && hg.id !== HoH.id) {\n            const logic = castEvictionVote(hg, nominees, newGameState);\n            const result: ProfileHouseguest = { ...hg };\n            result.tooltip = logic.reason;\n            newGameState.currentLog.votes[hg.id] = new NormalVote(nominees[logic.decision].id);\n            votes[logic.decision].push(result);\n            lastVoter = hg;\n        }\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n    newGameState.currentLog.outOf = votesFor0 + votesFor1;\n    if (votesFor0 + votesFor1 === 1) {\n        newGameState.currentLog.soleVoter = lastVoter!!.name;\n    }\n    let tieVote = votesFor0 === votesFor1;\n    let tieBreaker = { decision: 0, reason: \"Error you should not be seeing this\" };\n    if (tieVote) {\n        newGameState.currentLog.outOf++;\n        tieBreaker = castEvictionVote(HoH, nominees, newGameState);\n        newGameState.currentLog.votes[HoH.id] = new HoHVote(nominees[tieBreaker.decision].id);\n    }\n    let evictee: Houseguest;\n    if (votesFor0 > votesFor1) {\n        evictee = nominees[0];\n        newGameState.currentLog.votesInMajority = votesFor0;\n    } else if (votesFor1 > votesFor0) {\n        evictee = nominees[1];\n        newGameState.currentLog.votesInMajority = votesFor1;\n    } else {\n        evictee = nominees[tieBreaker.decision];\n        newGameState.currentLog.votesInMajority = votesFor1 + 1;\n    }\n    newGameState.currentLog.votes[nominees[0].id] = new NomineeVote(evictee.id === nominees[0].id);\n    newGameState.currentLog.votes[nominees[1].id] = new NomineeVote(evictee.id !== nominees[0].id);\n\n    evictHouseguest(newGameState, evictee.id);\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const displayHoH: ProfileHouseguest = { ...HoH };\n    displayHoH.tooltip = tieBreaker.reason;\n    const scene = new Scene({\n        title: \"Live Eviction\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </DividerBox>\n                </div>\n                {tieVote && (\n                    <div>\n                        <CenteredBold> We have a tie.</CenteredBold>\n                        <Centered>{`${HoH.name}, as current Head of Household, you must cast the sole vote to evict.`}</Centered>\n                        <Portraits houseguests={[displayHoH]} centered={true} />\n                        <CenteredBold>I vote to evict {`${evictee.name}.`}</CenteredBold>\n                    </div>\n                )}\n                <Portraits\n                    houseguests={[\n                        getById(newGameState, nominees[0].id),\n                        getById(newGameState, nominees[1].id)\n                    ]}\n                    centered={true}\n                />\n                <CenteredBold>{`${evictee.name}... you have been evicted from the Big Brother House.`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [newGameState, scene];\n}\n","import React from \"react\";\nimport { canDisplayCliques, GameState, getById } from \"../../model\";\nimport { Centered } from \"../layout/centered\";\nimport { HasText } from \"../layout/text\";\nimport { Portraits } from \"../playerPortrait/portraits\";\n\ninterface AllianceListProps {\n    gameState: GameState;\n}\n\nexport function AllianceList(props: AllianceListProps) {\n    if (!canDisplayCliques(props.gameState))\n        return (\n            <HasText>\n                <Centered>\n                    ⚠️ There are too many players left in the game to display the alliances! Try again when\n                    there are 30 or less! ⚠️\n                </Centered>\n            </HasText>\n        );\n    const cliques = props.gameState.cliques;\n    const elements: JSX.Element[] = cliques.map((clique, i) => (\n        <Portraits\n            centered={true}\n            detailed={true}\n            key={`${clique}, ${i}, ${props.gameState.phase}`}\n            houseguests={clique.map((id) => getById(props.gameState, id))}\n        />\n    ));\n    return <div>{elements}</div>;\n}\n// TODO: clicking someone ON THE ALLIANCE PAGE shows only their alliances???\n","import React from \"react\";\nimport { GameState } from \"../../model\";\nimport { weekStartTab$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { AllianceList } from \"./allianceList\";\n\ninterface WeekStartWrapperProps {\n    gameState: GameState;\n}\n\ninterface WeekStartWrapperState {\n    tab: number;\n}\n\nexport class WeekStartWrapper extends React.Component<WeekStartWrapperProps, WeekStartWrapperState> {\n    private subs: Subscription[] = [];\n    constructor(props: Readonly<WeekStartWrapperProps>) {\n        super(props);\n        this.state = { tab: weekStartTab$.value };\n    }\n    componentDidMount() {\n        this.subs.push(weekStartTab$.subscribe((tab) => this.setState({ tab })));\n    }\n    componentWillUnmount() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    render() {\n        if (this.state.tab === 0) {\n            return <MemoryWall houseguests={this.props.gameState.houseguests} />;\n        }\n        return <AllianceList gameState={this.props.gameState} />;\n    }\n}\n","import { Subscription } from \"rxjs\";\nimport { Sidebar } from \"./sidebar\";\nimport { Season } from \"../../model/season\";\nimport { Episode, nonEvictedHouseguests, getById } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport {\n    mainContentStream$,\n    episodes$,\n    switchEpisode$,\n    newEpisode,\n    switchSceneRelative,\n    cast$,\n    getSelectedPlayer,\n    selectedPlayer$,\n    displayMode$,\n} from \"../../subjects/subjects\";\nimport { popularityMode } from \"../../model/portraitDisplayMode\";\n\ninterface IndexedScene {\n    scene: Scene;\n    index: number;\n}\n\nconst LEFT = 37;\nconst RIGHT = 39;\n\nexport class SidebarController {\n    private view: Sidebar;\n    private subscriptions: Subscription[] = [];\n    private season: Season = new Season();\n    private scenes: IndexedScene[] = [];\n    private selectedEpisode: number = 0;\n\n    public constructor(view: Sidebar) {\n        this.view = view;\n        this.subscriptions.push(\n            episodes$.subscribe({\n                next: (episode) => this.onNewEpisode(episode),\n            })\n        );\n        this.subscriptions.push(\n            switchEpisode$.subscribe({\n                next: (value: number) => {\n                    this.switchSceneRelative(value);\n                },\n            })\n        );\n        this.subscriptions.push(\n            cast$.subscribe({\n                next: () => {\n                    this.season = new Season();\n                    this.selectedEpisode = 0;\n                    displayMode$.next(popularityMode);\n                },\n            })\n        );\n    }\n\n    public getSelectedEpisode() {\n        return this.selectedEpisode;\n    }\n\n    public async switchToScene(id: number) {\n        mainContentStream$.next(this.scenes[id].scene.render);\n        this.selectedEpisode = this.scenes[id].index;\n        await this.view.setState({ selectedScene: id });\n        if (getSelectedPlayer() !== null) {\n            selectedPlayer$.next(\n                getById(this.scenes[this.view.state.selectedScene].scene.gameState, getSelectedPlayer()!.id)\n            );\n        }\n    }\n\n    private switchSceneRelative = (delta: number) => {\n        const selectedScene = this.view.state.selectedScene;\n        const renderedScenes = this.scenes.length;\n        const targetScene = selectedScene + delta;\n        if (targetScene < 0) {\n            return;\n        }\n        const lastEpisode = this.view.state.episodes[this.view.state.episodes.length - 1];\n        if (targetScene < renderedScenes) {\n            // Go back to an earlier scene\n            this.switchToScene(targetScene);\n        } else if (targetScene === renderedScenes) {\n            // Generate a new scene, then jump to it\n            const currentGameState = lastEpisode.gameState;\n            const newPlayerCount = nonEvictedHouseguests(lastEpisode.gameState).length;\n            if (newPlayerCount > 0) {\n                newEpisode(this.season.renderEpisode(currentGameState));\n                this.switchSceneRelative(1);\n            }\n        }\n    };\n\n    get handleKeyDown(): (e: any) => void {\n        return this._handleKeyDown.bind(this);\n    }\n\n    private _handleKeyDown(event: any) {\n        const state = this.view.state;\n        if (\n            state.episodes[this.selectedEpisode] === undefined ||\n            !state.episodes[this.selectedEpisode].type.arrowsEnabled\n        ) {\n            return;\n        }\n        if (event.keyCode === LEFT) {\n            switchSceneRelative(-1);\n        } else if (event.keyCode === RIGHT) {\n            switchSceneRelative(1);\n        }\n    }\n\n    private onNewEpisode(episode: Episode | null) {\n        if (!episode) {\n            this.view.setState({ episodes: [], selectedScene: 0 });\n            this.scenes = [];\n        } else {\n            const newState = { ...this.view.state };\n            // starts at -1: prevent OBOE\n            const latestIndex = this.scenes.length === 0 ? -1 : this.scenes[this.scenes.length - 1].index;\n            const index = latestIndex + 1;\n            this.scenes.push({ scene: episode, index });\n            episode.scenes.forEach((scene) => this.scenes.push({ scene, index }));\n            newState.episodes.push(episode);\n            this.view.setState(newState);\n        }\n    }\n\n    public destroy() {\n        this.subscriptions.forEach((sub) => sub.unsubscribe());\n    }\n}\n","import React from \"react\";\nimport { SidebarController } from \"./sidebarController\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { Episode, GameState } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport { newEpisode } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\nimport { HasText } from \"../layout/text\";\ninterface SidebarState {\n    episodes: Episode[];\n    selectedScene: number;\n}\n\nexport class Sidebar extends React.Component<{}, SidebarState> {\n    private controller: SidebarController;\n    public constructor(props: {}) {\n        super(props);\n        this.controller = new SidebarController(this);\n        this.state = { episodes: [], selectedScene: 0 };\n        newEpisode(new PregameEpisode(new GameState([])));\n    }\n\n    public componentDidMount() {\n        document.addEventListener(\"keydown\", this.controller.handleKeyDown);\n    }\n\n    public componentWillUnmount() {\n        this.controller.destroy();\n    }\n\n    public render() {\n        return (\n            <Box style={{ minWidth: 180 }}>\n                <HasText>{this.getEpisodes()}</HasText>\n            </Box>\n        );\n    }\n\n    private getHighlight(title: string, key: number) {\n        if (key === this.state.selectedScene) {\n            return <mark>{title}</mark>;\n        }\n        return title;\n    }\n\n    private getEpisodes() {\n        const result: JSX.Element[] = [];\n        // Weird OBOE to make keys start at 0\n        let episodeKey = -1;\n        let breakKey = 0;\n        this.state.episodes.forEach((episode: Episode) => {\n            const id = ++episodeKey;\n            result.push(\n                <b\n                    key={id}\n                    onClick={() => {\n                        this.controller.switchToScene(id);\n                    }}\n                >\n                    {this.getHighlight(episode.title, id)}\n                </b>\n            );\n            result.push(<br key={--breakKey} />);\n            episode.scenes.forEach((scene: Scene) => {\n                const id = ++episodeKey;\n                if (this.controller.getSelectedEpisode() === episode.gameState.phase) {\n                    result.push(\n                        <a key={id} onClick={() => this.controller.switchToScene(id)}>\n                            {this.getHighlight(scene.title, id)}\n                        </a>\n                    );\n                    result.push(<br key={--breakKey} />);\n                }\n            });\n        });\n        return result;\n    }\n}\n","import styled from \"styled-components\";\nimport React from \"react\";\nimport { mainContentStream$ } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\n\nconst MainContentAreaWrapper = styled(Box)`\n    overflow-x: auto;\n`;\n\nexport class MainContentArea extends React.Component<{}, { content: any }> {\n    // a simple class that displays whatever it gets fed through the main content stream.\n\n    private contentStream: any;\n\n    public constructor(props: any) {\n        super(props);\n        this.state = { content: null };\n    }\n\n    public componentDidMount() {\n        this.contentStream = mainContentStream$.subscribe((content) => {\n            this.setState({ content });\n        });\n    }\n\n    public componentDidUpdate(prevProps: never, prevState: any) {\n        if (prevState.content !== this.state.content) {\n            window.scrollTo(0, 0);\n        }\n    }\n\n    public componentWillUnmount() {\n        this.contentStream.unsubscribe();\n    }\n\n    public render() {\n        return <MainContentAreaWrapper>{this.state.content}</MainContentAreaWrapper>;\n    }\n}\n","import \"./bulma.scss\";\nimport React from \"react\";\nimport { Sidebar } from \"../sidebar/sidebar\";\nimport { Topbar } from \"../topbar/topBar\";\nimport { MainContentArea } from \"./mainContentArea\";\nimport { MainPageController } from \"./mainPageController\";\n\ninterface MainPageProps {\n    controller: MainPageController;\n}\n\ninterface MainPageState {\n    fullscreen: boolean;\n}\n\nexport class MainPage extends React.Component<MainPageProps, MainPageState> {\n    public constructor(props: MainPageProps) {\n        super(props);\n        this.state = { fullscreen: false };\n        props.controller.inject(this);\n    }\n    public componentDidMount() {\n        this.props.controller.subscribe();\n    }\n    public componentWillUnmount() {\n        this.props.controller.unsubscribe();\n    }\n\n    public render() {\n        const fullscreen = this.state.fullscreen;\n        const hideOnFullscreen = { display: fullscreen ? \"none\" : \"\" };\n        const wrapperStyle = fullscreen\n            ? { margin: \"auto\" }\n            : { margin: \"auto\", maxWidth: 1380, overflow: \"hidden\" };\n        return (\n            <div style={wrapperStyle}>\n                <Topbar style={hideOnFullscreen} />\n                <div className=\"columns\">\n                    <div className=\"column is-narrow\" style={hideOnFullscreen}>\n                        <Sidebar />\n                    </div>\n\n                    <div className=\"column\" style={{ overflowX: \"hidden\" }}>\n                        <MainContentArea />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","import { MainPage } from \"./mainPage\";\nimport { Subscription } from \"rxjs\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\n\nexport class MainPageController {\n    private view: MainPage = new MainPage({ controller: this });\n    private subscriptions: Subscription[] = [];\n    public inject(page: MainPage) {\n        this.view = page;\n    }\n\n    public subscribe(): void {\n        this.unsubscribe();\n        this.subscriptions.push(\n            isFullscreen$.subscribe((fullscreen: boolean) => {\n                this.view.setState({ fullscreen });\n            })\n        );\n    }\n\n    public unsubscribe(): void {\n        this.subscriptions.forEach(sub => sub.unsubscribe());\n    }\n}\n","import { createGlobalStyle } from \"styled-components\";\nimport { ColorTheme } from \"./theme\";\n\nexport const GlobalStyles = createGlobalStyle`\n  *,\n  *::after,\n  *::before {\n    box-sizing: border-box;\n  }\n\n  body {\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bg};\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n       transition: all 0.25s linear;\n  }`;\n","import React from \"react\";\nimport { MainPage } from \"./components/mainPage/mainPage\";\nimport { MainPageController } from \"./components/mainPage/mainPageController\";\nimport { ThemeProvider } from \"styled-components\";\nimport { lightTheme, ColorTheme, darkTheme } from \"./theme/theme\";\nimport { GlobalStyles } from \"./theme/globalTheme\";\nimport { theme$ } from \"./subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nclass App extends React.Component<{}, { theme: ColorTheme }> {\n    private sub: Subscription | null = null;\n    public constructor(props: any) {\n        super(props);\n        this.state = {\n            theme:\n                window.matchMedia && window.matchMedia(\"(prefers-color-scheme: light)\").matches\n                    ? lightTheme\n                    : darkTheme,\n        };\n    }\n\n    public componentDidMount() {\n        this.sub = theme$.subscribe((theme) => {\n            this.setState({ theme });\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    render() {\n        return (\n            <ThemeProvider theme={this.state.theme}>\n                <>\n                    <GlobalStyles />\n                    <MainPage controller={new MainPageController()} />\n                </>\n            </ThemeProvider>\n        );\n    }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}