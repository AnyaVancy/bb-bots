{"version":3,"sources":["model/houseguest.ts","model/playerProfile.ts","utils/utilities.ts","utils/relationshipMap.ts","model/color.ts","utils/ai/classifyRelationship.ts","components/playerPortrait/subtitle.tsx","model/portraitDisplayMode.ts","components/playerPortrait/selectedPortrait.ts","subjects/subjects.tsx","components/playerPortrait/houseguestPortraitController.ts","components/playerPortrait/houseguestPortrait.tsx","components/playerPortrait/houseguestToPortrait.tsx","components/tooltip/tooltip.tsx","components/playerPortrait/portraits.tsx","components/memoryWall/memoryWall.tsx","components/layout/text.ts","components/playerPortrait/setupPortrait.tsx","components/castingScreen/numericInput.tsx","components/castingScreen/randomXButton.tsx","components/layout/centered.tsx","components/episode/allianceList.tsx","components/viewsBar/viewBarTag.tsx","components/viewsBar/viewBar.tsx","components/episode/episodes.tsx","components/episode/bigBrotherEpisode.tsx","components/episode/scenes/scene.tsx","components/episode/veto/veto.tsx","components/episode/doubleEvictionEpisode.tsx","components/episode/instantEvictionEpisode.tsx","components/episode/pregameEpisode.tsx","components/nextEpisodeButton/nextEpisodeButton.tsx","components/mainPage/fullscreenButton.tsx","components/episode/scenes/votingTable.tsx","model/logging/voteType.tsx","components/episode/scenes/hohCompScene.tsx","components/layout/box.tsx","utils/fft.ts","utils/poissonbinomial.ts","utils/ai/aiUtils.ts","utils/ai/targets.ts","utils/ai/aiApi.ts","components/episode/scenes/nomCeremonyScene.tsx","utils/listStrings.ts","components/episode/scenes/vetoCompScene.tsx","components/episode/scenes/vetoCeremonyScene.tsx","components/episode/utilities/evictHouseguest.ts","model/season.ts","model/gameState.ts","components/episode/scenes/evictionScene.tsx","components/episode/tripleEvictionEpisodeCad.tsx","components/episode/tripleEvictionEpisodeUs.tsx","components/seasonEditor/twistAdder.tsx","components/seasonEditor/seasonEditorList.tsx","components/seasonEditor/seasonEditorPage.tsx","components/castingScreen/castingScreen.tsx","components/deckScreen/deckScreen.tsx","components/topbar/topBar.tsx","components/pregameScreen/pregameScreen.tsx","utils/BbRandomGenerator.ts","model/logging/episodelog.ts","utils/generateGraph.ts","utils/generateCliques.ts","components/episode/episodeFactory.ts","components/episode/bigBrotherWeekstartWrapper.tsx","components/episode/scenes/juryVoteScene.tsx","components/episode/bigBrotherFinale.tsx","components/episode/scenes/finalHohCompScene.tsx","components/episode/scenes/finalEvictionScene.tsx","components/episode/gameOver.tsx","components/sidebar/sidebarController.ts","components/sidebar/sidebar.tsx","components/mainPage/mainContentArea.tsx","components/mainPage/mainPage.tsx","components/mainPage/mainPageController.ts","theme/theme.ts","theme/globalTheme.ts","App.tsx","index.tsx"],"names":["Houseguest","_PlayerProfile","init","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","isEvicted","isJury","id","nominations","hohWins","povWins","compatibility","popularity","deltaPopularity","previousPopularity","relationships","targets","powerRanking","superiors","friends","enemies","targetingMe","assign","assertThisInitialized","inherits","createClass","key","value","villain","PlayerProfile","name","imageURL","castingScreenId","roundTwoDigits","number","Math","round","intersection","setA","setB","_intersection","Set","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","elem","has","add","err","return","difference","_difference","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","delete","isWellDefined","x","isNotWellDefined","magnitude","result","forEach","pow","angleBetween","y","length","Error","concat","acos","_","i","dot","removeFirstNMatching","array","n","match","splice","newRelationshipMap","size","exclude","componentToHex","c","hex","toString","RelationshipType","TwoWayRelationshipType","Rgb","r","g","b","interpolateColor","min","max","percent","toHex","RelationshipTypeToSymbol","FRIEND","ENEMY","PAWN","QUEEN","classifyRelationship","heroPopularity","villainPopularity","relationship","benefitsHero","benefitsVillain","Friend","Pawn","Queen","Enemy","classifyTwoWayRelationship","PawnQueen","heroIsPregame","hero","addPopularityLine","state","detailed","subtitle","popularitySubtitle","deltaPop","houseguest","statePopularity","getDeltaPopularity","push","react_default","a","createElement","addCompsLine","compWins","style","lineHeight","popularityMinColor","popularityMaxColor","popularityMode","minColor","maxColor","backgroundColor","extremePopularity","xSquared","extremeValues","generateSubtitle","_addFriendshipCountTi","data","getSelectedPlayer","titles","friendOrEnemyTitle","map","txt","count","Relationship","friendEnemyCountTitle","addFriendshipCountTitles","arguments","powerMaxColor","powerMinColor","powerMode","selectPlayer","player","selectedPlayer$","displayMode$","keys","selectCastPlayer","selectedCastPlayers","selectedCastPlayer$","selectedColor","HouseguestPortraitController","view","subs","refreshData","props","setState","comparePowerRankings","defaultState","shuffle","selectedPlayer","displayMode","_this2","subscribe","sub","unsubscribe","get","Subtitle","styled","small","_templateObject","MemoryWallPortrait","div","_templateObject2","_ref","theme","portraitBorder","Evicted","_templateObject3","Jury","_templateObject4","Normal","img","_templateObject5","Grayscale","_templateObject6","Sepia","_templateObject7","HouseguestPortrait","_React$Component","controller","Img","imageClass","getImageClass","Portrait","onClick","src","height","width","React","Component","houseguestToPortrait","houseguestPortrait_HouseguestPortrait","Text","p","tooltip_templateObject","Tooltip","visible","Popover_default","position","isOpen","content","text","onMouseEnter","onMouseLeave","children","PortraitWrapper","className","centered","tooltip","tooltip_Tooltip","Portraits","rows","houseguests","display","justifyContent","alignItems","memoryWallPortrait","MemoryWall","margin","maxWidth","HasText","text_templateObject","Input","input","text_templateObject2","_ref2","EditPortrait","setupPortrait_templateObject","Noselect","setupPortrait_templateObject2","XButton","setupPortrait_templateObject3","EditButton","setupPortrait_templateObject4","SetupPortrait","selected","textAlign","maxHeight","onDoubleClick","onDelete","event","stopPropagation","onRename","imageUrl","NumericInputStyle","numericInput_templateObject","NumericInput","type","placeholder","onChange","target","test","RandomButton","_useState","useState","_useState2","slicedToArray","setNumber","disabled","random","parseInt","NoMargin","centered_templateObject","Center","centered_templateObject2","Centered","noMargin","CenteredBold","CenteredItallic","HelpLink","allianceList_templateObject","link","AllianceList","canDisplayCliques","gameState","elements","cliques","clique","affiliates","phase","core","getById","entries","toConsumableArray","href","rel","ViewBarTag","mode","_this3","background","toRgba","cursor","setDisplayMode","ViewsBar","inJury","marginBottom","viewBarTag_ViewBarTag","Episode","initialGameState","scenes","title","arrowsEnabled","initialGamestate","Tabs","bigBrotherWeekstartWrapper_WeekStartWrapper","NextEpisodeButton","viewsBar","hasViewsbar","viewBar_ViewsBar","Scene","GameState","players","jury","render","GoldenVeto","DoubleEviction","canPlayWith","eliminates","generate","episode","generateBBVanillaScenes","currentGameState","incrementLogIndex","doubleEviction","scene","InstantEviction","PregameEpisodeType","PregameEpisode","_Episode","pregameScreen_PregameScreen","cast","switchSceneRelative","FullscreenIcon","fullscreenButton_templateObject","FullscreenButton","isFullscreen$","getValue","EndgameTableCell","td","votingTable_templateObject","tableCellBorder","EndgameTable","table","votingTable_templateObject2","Gray","votingTable_templateObject3","_ref3","grayCell","SaveCell","votingTable_templateObject4","_ref4","saveCell","White","votingTable_templateObject5","_ref5","lightGrayCell","votingTable_templateObject6","_ref6","evictedCell","WinnerCell","votingTable_templateObject7","_ref7","winnerCell","RunnerUpCell","_templateObject8","_ref8","runnerUpCell","NomineeCell","_templateObject9","_ref9","nomineeCell","HohCell","_templateObject10","_ref10","hohCell","BlackRow","tr","_templateObject11","anotherKey","generateVotingTable","masterLog","log","houseguestCells","hg","evictionOrder","topRowCells","preVetoCells","vetoCells","postVetoCells","evictedCells","winnerCells","logs","cells","colspan","colSpan","generateTopRow","nominationsPreVeto","vetoWinner","rowSpan","interleave","generatePreVetoRow","generateVetoRow","nominationsPostVeto","generatePostVetoRow","saveOrEvict","soleVoter","votingTo","toLowerCase","evicted","voteTextLine1","values","votes","filter","vote","votesInMajority","outOf","votingTable_Evicted","generateEvictedRow","runnerUp","winner","_arr","_i","_ref13","_ref12","WinnerVote","RunnerUpVote","winnerRow","topRow","preVetoRow","vetoRow","postVetoRow","blackRow","houseguestRows","evictedRow","desiredLength","reverse","_ref14","_ref15","week","weekText","tempList","slice","arr","thing","_ref16","apply","voteKey","getKey","SaveVote","NormalVote","NomineeVote","HoHVote","hohText","hohVote","generateHohCompScene","options","newGameState","MutableGameState","previousHoh","previousHOH","newHoH","randomPlayer","currentLog","customText","__logindex__","portraits_Portrait","ShadowBox","box_templateObject","overlay","StyledBox","box_templateObject2","bodyArea","DividerBox","Box","fft","real","imag","levels","cosTable","Array","sinTable","cos","PI","sin","j","reverseBits","temp","halfsize","tablestep","k","l","tpre","tpim","val","transformRadix2","m","areal","newArrayOfZeros","aimag","breal","bimag","creal","cimag","convolveComplex","transformBluestein","xreal","ximag","yreal","yimag","outreal","outimag","pbincdf","pp","zeros","ones","num","cdf","nPlusOne","ω","sigmaLogModulusZ","sum","p_j","e1","e2","sigmaPrincipalArgz","atan2","ceil","d","exp","sigmaArgZ","ξ","_pbincdf","pHeroWinsTheFinale","hgs","juror","pJurorVotesForHero","deadValue","pHeroWins","winrate","getRelationshipSummary","doIWin","relationshipWith","TargetStrategy","Targets","firstTarget","secondTarget","newTarget","isBetterTarget","old","neww","strategy","MoR","StatusQuo","Underdog","determineStrategy","newRank","rankRelationshipSummaryStatusQuo","oldRank","isBetterTargetStatusQuo","_computeLocalPopulari","computeLocalPopularity","oldPop","newPop","isBetterTargetMoR","_computeLocalPopulari2","isBetterTargetUnderdog","condition","nonFriends","from","nonEvictedHouseguests","oldHg","newHg","castVoteToSave","nominees","currentSave","decision","reason","nominee","evictionTarget","castEvictionVote","nom0","nom1","remainingPlayers","castF3Vote","HoH","evictNom0","winningOddsF3","evictNom1","castF4vote","houseguestCache","cutthroatVote","voteBasedOnWinrate","r0","r1","heroBeatsnom0","heroBeatsnom1","cutthroatVoteJury","villain1","villain2","heroVs1","heroVs2","v1Vs2","nom0isTarget","nom1isTarget","callback","lowestIndex","lowestScore","Infinity","currentScore","backdoorNPlayers","sortedOptions","sort","hg1","hg2","useGoldenVeto","nom","potentialSave","useGoldenVetoPreJury","generateNomCeremonyScene","nom3","nom2","thirdNominee","require","noms","finalStatement","listNames","names","join","generateVetoCompScene","veto","choices","povPlayers","everyoneWillPlay","objectSpread","introText","povWinner","extras","firstRow","generateVetoCeremonyScene","initialNominees","povTarget","descisionText","vetoChoice","nomineeWonPov","replacementSpeech","nameAReplacement","finalNominees","replacementNom","findIndex","nomineeNames","evictHouseguest","evictee","finalJurySize","refreshHgStats","updateDelta","getJurors","populateSuperiors","h","xi","average","house","targetId","calculatePopularity","updatePopularity","addTarget","getTargets","updateFriendCounts","generateEvictionScene","castVote","lastVoter","nonVoters","logic","voteCounts","pluralities","numbers","highest","reduce","acc","cur","getHighestIndicies","tieVote","tieBreaker","evictees","safe","evicteesSet","votesPerEvictee","voteCountText","listVotes","v","displayHoH","marginTop","voters","TripleEvictionCad","hoh","hohCompScene","nomCeremonyScene","tripleScenes","_generateHohCompScene","_generateHohCompScene2","vetoCompScene","_generateNomCeremonyS","_generateNomCeremonyS2","vetoCeremonyScene","_generateVetoCompScen","_generateVetoCompScen2","evictionScene","_generateVetoCeremony","_generateVetoCeremony2","_generateEvictionScen","_generateEvictionScen2","TripleEvictionUs","tripleEviction","twist$","Subject","TwistAdder","twistCount","twistCapacity","twistCapacity$","border","borderRadius","marginRight","Label","readOnly","DragItem","seasonEditorList_templateObject","_items","_castSize","getEpisodeLibrary","playersRemaining","item","BigBrotherVanilla","ListItem","provided","snapshot","ref","innerRef","draggableProps","dragHandleProps","BehaviorSubject","SeasonEditorList","castSize","items","newCapacity","twist","updateTwistCapacity","maxCapacity","newItems","unshift","refreshItems","addRemoveTwist","finalItems","playerCount","isValid","react_beautiful_dnd_esm","onDragEnd","destination","_newItems$splice","source","index","removed","droppableId","droppableProps","draggableId","seasonEditorList_ListItem","Subheader","h3","seasonEditorPage_templateObject","label","seasonEditorPage_templateObject2","twists","submit","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","season$","pushToMainContentStream","cast$","Screens","Other","newEpisode","stop","_x","SeasonEditorPage","castLength","defaultJurySize","jurySize","setJurySize","validJurySize","validateJurySize","seasonEditorList_SeasonEditorList","padding","twistAdder_TwistAdder","color","float","CastingScreen","newCast","Season","_amount","amount","allPlayers","unselectedPlayers","selectedPlayers","handleUpload","handleFiles","files","handleDrop","newState","_this4","newName","prompt","_this5","setupPortrait_SetupPortrait","deleteMethod","rename","_this6","FileDrop","onDrop","multiple","getFiles","file","substr","lastIndexOf","URL","createObjectURL","decksPerPage","baseUrl","imageCache","DeckStyle","deckScreen_templateObject","deckScreen_templateObject2","DeckText","deckScreen_templateObject3","_callee2","folder","links","image","_context2","abrupt","fetch","sent","json","sample","_callee3","casts","playerProfiles","_loop","_context4","imageLinks","folderProfiles","_context3","url","delegateYield","t1","finish","castingScreen_CastingScreen","Casting","Deck","_React$useState","_React$useState2","setImage","_React$useState3","_React$useState4","loading","setLoading","deck","randomImageFromFolder","then","selectDeckSubject","DeckList","decks","DeckScreen","handlePageClick","page","debounceSearch","debounce","nextValue","debouncedSearchText","handleSearch","searchText","selectedDecks","_componentDidMount","selectedDecks$","minWidth","submitCasts","deckScreen_Centered","dist_default","previousLabel","nextLabel","breakLabel","breakClassName","pageCount","marginPagesDisplayed","pageRangeDisplayed","onPageChange","containerClassName","activeClassName","activeScreen$","TopbarLink","topBar_templateObject","ActiveTopbarLink","topBar_templateObject2","CastingScreenLink","LinkStyle","JSON","parse","stringify","EditSeasonLink","ChooseCastLink","deckScreen_DeckScreen","Topbar","tab","PregameScreen","textShadow","mainContentStream$","episodes$","switchEpisode$","weekStartTab$","theme$","BbRandomGenerator","seed","rng","prand","xorshift128plus","_this$rng$next","_this$rng$next2","_prand$uniformIntDist","uniformIntDistribution","_prand$uniformIntDist2","_this$rng$next3","_this$rng$next4","rng$","EpisodeLog","castNames","string","hash","charCodeAt","hashcode","inclusions","exclusions","excludedIds","includes","randomInt","_GameState","jurors","_GameState2","_init","profiles","profile","_GameState3","copy","cloneDeep","EdgeMap","generateGraph","nodes","edges","stringId","villainId","_generateEdge","generateEdge","_generateEdge2","edge","neighbors","newCliquesLength","generateCliques","bronKerbosch","rPrime","pPrime","node","xPrime","mergeCandidates","clq","cliqueI","cliqueJ","affiliatesI","affiliatesJ","blacklist","candidate","nextEpisode","episodeType","u","randomFloat","abs","θ","φ","iMap","jMap","impression","firstImpressions","resetLogIndex","finalState","WeekStartWrapper","helpText1","helptext2","TabItem","li","bigBrotherEpisode_templateObject","Tab","active","setActive","paddingLeft","juryVoteScene","finalists","castJuryVote","votesFor0","votesFor1","BigBrotherFinale","finalHoH","finalEviction","_finalHohCompScene","final3","enduranceWinner","enduranceLosers","skillWinner","finalHohCompScene","_finalHohCompScene2","_finalEvictionScene","_castEvictionVote","survivor","finalEvictionScene","_finalEvictionScene2","_juryVoteScene","_juryVoteScene2","juryScene","GameOver","episodeLibrary","whichEpisodeType","SidebarController","subscriptions","season","selectedEpisode","delta","selectedScene","renderedScenes","targetScene","lastEpisode","episodes","switchToScene","renderEpisode","screen","selectionsActive","onNewEpisode","library","_switchToScene","keyCode","_handleKeyDown","bind","firstLoad","Sidebar","bb","allBBs","document","addEventListener","handleKeyDown","destroy","getEpisodes","episodeKey","breakKey","getHighlight","getSelectedEpisode","MainContentAreaWrapper","mainContentArea_templateObject","MainContentArea","contentStream","prevProps","prevState","window","scrollTo","MainPage","fullscreen","inject","hideOnFullscreen","wrapperStyle","overflow","topBar_Topbar","sidebar_Sidebar","overflowX","mainContentArea_MainContentArea","MainPageController","darkTheme","bg","toggleBorder","GlobalStyles","createGlobalStyle","globalTheme_templateObject","App","styled_components_browser_esm","Fragment","mainPage_MainPage","ReactDOM","src_App","getElementById"],"mappings":"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","file":"static/js/main.12d8f9b8.chunk.js","sourcesContent":["import { PlayerProfile } from \"./playerProfile\";\nimport { RelationshipMap } from \"../utils\";\n\ninterface HouseguestInit extends PlayerProfile {\n    id: number;\n    relationships: RelationshipMap;\n}\n\nexport class Houseguest extends PlayerProfile {\n    public isEvicted: boolean = false;\n    public isJury: boolean = false;\n\n    readonly id: number = 0;\n\n    public nominations: number = 0;\n    public hohWins: number = 0;\n    public povWins: number = 0;\n\n    // Popularity ranges from -1 to 1\n    public compatibility: [number, number, number] = [0, 0, 0];\n    public popularity: number = 0;\n    public deltaPopularity: number = 0;\n    public previousPopularity: number = 0;\n    readonly relationships: RelationshipMap = {};\n\n    public targets: [number, number] = [this.id, this.id];\n\n    // power rankings range from 0 to 1\n    public powerRanking: number = 0;\n    readonly superiors: { [id: number]: number } = {}; // { id : pHeroWins }\n\n    public relationshipWith(villain: Houseguest): number {\n        return this.relationships[villain.id];\n    }\n    public friends = 0;\n    public enemies = 0;\n    public targetingMe = 0;\n\n    constructor(init: HouseguestInit) {\n        super(init);\n        Object.assign(this, init);\n    }\n}\n","interface InitPlayerProfile {\n    readonly name: string;\n    readonly imageURL: string;\n}\n\nexport class PlayerProfile {\n    public name: string = \"\";\n    readonly imageURL: string = \"\";\n    public castingScreenId?: number | undefined = 0;\n    constructor(init: InitPlayerProfile) {\n        if (!init) {\n            return;\n        }\n        Object.assign(this, init);\n    }\n}\n","export function hashcode(string: string): number {\n    let hash = 0,\n        i,\n        chr;\n    if (string.length === 0) return hash;\n    for (i = 0; i < string.length; i++) {\n        chr = string.charCodeAt(i);\n        hash = (hash << 5) - hash + chr;\n        hash |= 0;\n    }\n    return hash;\n}\n\nexport function roundTwoDigits(number: number | undefined) {\n    if (!number) {\n        return 0;\n    }\n    return Math.round(number * 100);\n}\n\nexport function max(a: number, b: number) {\n    return a > b ? a : b;\n}\n\nexport function intersection<T>(setA: Set<T>, setB: Set<T>): Set<T> {\n    let _intersection = new Set<T>();\n    for (let elem of setB) {\n        if (setA.has(elem)) {\n            _intersection.add(elem);\n        }\n    }\n    return _intersection;\n}\nexport function difference<T>(setA: Set<T>, setB: Set<T>): Set<T> {\n    let _difference = new Set<T>(setA);\n    for (let elem of setB) {\n        _difference.delete(elem);\n    }\n    return _difference;\n}\n\nexport function extremeValues(x: number | undefined): number {\n    if (!x) {\n        return 0;\n    }\n    const xSquared = x * x;\n    if (x >= 0) {\n        return -xSquared + 2 * x;\n    } else {\n        return xSquared + 2 * x;\n    }\n}\n\nexport function average(x: number[]): number {\n    let sum = 0;\n    x.forEach((xi) => (sum += xi));\n    return sum / x.length;\n}\n\nexport function isWellDefined(x: any) {\n    return x !== null && x !== undefined;\n}\n\nexport function isNotWellDefined(x: any): x is null | undefined {\n    return x === null || x === undefined;\n}\n\nexport function dot(x: number[], y: number[]) {\n    if (x.length !== y.length)\n        throw new Error(\n            `Tried to get the dot product between two vectors of non-equal length: ${x.length} !== ${y.length}`\n        );\n    let result = 0;\n    x.forEach((_, i) => {\n        result += x[i] * y[i];\n    });\n    return result;\n}\n\nexport function magnitude(x: number[]): number {\n    let result = 0;\n    x.forEach((x) => (result += x ** 2));\n    return result;\n}\n\n// returns a value between 0 and pi\n\nexport function angleBetween(x: number[], y: number[]): number {\n    if (x.length !== y.length)\n        throw new Error(\n            `Tried to get the angle between two vectors of non-equal length: ${x.length} !== ${y.length}`\n        );\n    return Math.acos((dot(x, y) / magnitude(x)) * magnitude(y));\n}\n\n// takes in an array, a number n, and a match function, then removes the first n elements from the array for which the match function returns true\n\nexport function removeFirstNMatching(array: any[], n: number, match: (x: any) => boolean): any[] {\n    let i = 0;\n    while (i < array.length && n > 0) {\n        if (match(array[i])) {\n            n--;\n            array.splice(i, 1);\n            i--;\n        }\n        i++;\n    }\n    return array;\n}\n","export interface RelationshipMap {\n    [id: number]: number;\n}\n\nexport function newRelationshipMap(size: number, exclude: number): RelationshipMap {\n    const result: RelationshipMap = {};\n    for (let i = 0; i < size; i++) {\n        if (i !== exclude) result[i] = 0;\n    }\n    return result;\n}\n","function componentToHex(c: any) {\n    var hex = Math.round(c).toString(16);\n    return hex.length == 1 ? \"0\" + hex : hex;\n}\n\nexport class Rgb {\n    public r: number;\n    public g: number;\n    public b: number;\n    public toHex() {\n        return \"#\" + componentToHex(this.r) + componentToHex(this.g) + componentToHex(this.b);\n    }\n    public toRgba(): string {\n        return `rgba(${this.r}, ${this.g}, ${this.b}, 1)`;\n    }\n    constructor(r: number, g: number, b: number) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n    }\n}\n\nexport function interpolateColor(min: Rgb, max: Rgb, percent: number): string {\n    return new Rgb(\n        min.r + percent * (max.r - min.r),\n        min.g + percent * (max.g - min.g),\n        min.b + percent * (max.b - min.b)\n    ).toHex();\n}\n","export enum RelationshipType {\n    Friend = \"FRIEND\",\n    Queen = \"QUEEN\",\n    Pawn = \"PAWN\",\n    Enemy = \"ENEMY\",\n}\nexport enum TwoWayRelationshipType {\n    Friend = \"FRIEND\",\n    PawnQueen = \"PAWN/QUEEN\",\n    Enemy = \"ENEMY\",\n}\n\nexport const RelationshipTypeToSymbol = { FRIEND: \"♥\", ENEMY: \"💔\", PAWN: \"PAWN\", QUEEN: \"QUEEN\" };\n\nexport function classifyRelationship(\n    heroPopularity: number,\n    villainPopularity: number,\n    relationship: number\n): RelationshipType {\n    const benefitsHero = relationship > heroPopularity;\n    const benefitsVillain = relationship > villainPopularity;\n    if (benefitsHero && benefitsVillain) {\n        return RelationshipType.Friend;\n    } else if (benefitsHero && !benefitsVillain) {\n        return RelationshipType.Pawn;\n    } else if (!benefitsHero && benefitsVillain) {\n        return RelationshipType.Queen;\n    }\n    return RelationshipType.Enemy;\n}\n\nexport function classifyTwoWayRelationship(\n    heroPopularity: number,\n    villainPopularity: number,\n    relationship: number\n): TwoWayRelationshipType {\n    const benefitsHero = relationship > heroPopularity;\n    const benefitsVillain = relationship > villainPopularity;\n    if (benefitsHero && benefitsVillain) {\n        return TwoWayRelationshipType.Friend;\n    } else if (!benefitsHero && !benefitsVillain) {\n        return TwoWayRelationshipType.Enemy;\n    }\n    return TwoWayRelationshipType.PawnQueen;\n}\n","import React from \"react\";\nimport { isWellDefined, roundTwoDigits } from \"../../utils\";\nimport { ProfileHouseguest, PortraitProps, PortraitState } from \"../memoryWall\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport {\n    RelationshipTypeToSymbol,\n    RelationshipType as Relationship,\n    classifyRelationship,\n} from \"../../utils/ai/classifyRelationship\";\nimport { getSelectedPlayer } from \"../../subjects/subjects\";\n\nexport function heroIsPregame(hero: PortraitProps): boolean {\n    const heroIsZero =\n        hero.friends === 0 && hero.enemies === 0 && hero.popularity === 0 && hero.targetingMe === 0;\n    return heroIsZero || (hero.friends === undefined && hero.enemies === undefined);\n}\n\nexport function generatePowerSubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    _: boolean | undefined\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    key = addPopularityLine(state, hero, !!_, subtitle, key);\n    key = addCompsLine(hero, subtitle, key);\n    if (!hero.isEvicted && state.powerRanking !== undefined) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            subtitle.push(<div key={key++}>{`WIN ${roundTwoDigits(state.powerRanking!)}%`}</div>);\n        } else if (data && data.id === hero.id) {\n            subtitle.push(<div key={key++}>I WOULD</div>);\n        } else {\n            subtitle.push(\n                <div key={key++}>{`WIN ${roundTwoDigits(state.powerRanking)}%${\n                    hero.targetingMe ? ` | 🎯 ${hero.targetingMe}` : \"\"\n                }`}</div>\n            );\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return subtitle;\n}\n\nexport function generatePopularitySubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    detailed: boolean = false\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    // popularity\n    key = addPopularityLine(state, hero, detailed, subtitle, key);\n    // competition wins\n    key = addCompsLine(hero, subtitle, key);\n    // friendship count / relationship classification titles\n    ({ subtitle, key } = addFriendshipCountTitles(hero, subtitle, key));\n    return subtitle;\n}\n\nfunction addFriendshipCountTitles(hero: PortraitProps, subtitle: any[], key: number) {\n    if (heroIsPregame(hero)) {\n        subtitle = subtitle.concat(<br key={key++} />);\n        return { subtitle, key };\n    }\n    if (!hero.isEvicted) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            const titles = friendOrEnemyTitle(hero, data);\n            subtitle = subtitle.concat(titles.map((txt) => <div key={key++}>{txt}</div>));\n        } else {\n            const titles = friendEnemyCountTitle(hero);\n            subtitle = subtitle.concat(titles.map((txt) => <div key={key++}>{txt}</div>));\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return { subtitle, key };\n}\n\nfunction addPopularityLine(\n    state: { popularity?: number },\n    hero: PortraitProps,\n    detailed: boolean,\n    subtitle: any[],\n    key: number\n) {\n    let popularity = state.popularity;\n    if (popularity && (popularity > 1 || popularity < -1)) {\n        popularity = hero.popularity;\n    }\n    if (popularity && !hero.isEvicted) {\n        let popularitySubtitle = `${roundTwoDigits(popularity)}%`;\n        const deltaPop = getDeltaPopularity(hero, popularity);\n        if (detailed && deltaPop !== 0) {\n            const arrow = deltaPop > 0 ? \" | ↑\" : \" | ↓\";\n            popularitySubtitle += `${arrow} ${deltaPop}%`;\n        }\n        subtitle.push(<div key={key++}>{popularitySubtitle}</div>);\n    }\n    return key;\n}\n\nfunction addCompsLine(hero: PortraitProps, subtitle: any[], key: number) {\n    if (compWins(hero)) {\n        subtitle.push(<div key={key++}>{`${compWins(hero)}`}</div>);\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return key;\n}\n\nfunction getDeltaPopularity(houseguest: PortraitProps, statePopularity: number) {\n    if (roundTwoDigits(houseguest.popularity) !== roundTwoDigits(statePopularity)) {\n        return 0;\n    }\n    return houseguest.deltaPopularity ? roundTwoDigits(houseguest.deltaPopularity) : 0;\n}\n\nfunction compWins(houseguest: ProfileHouseguest): string {\n    return `${houseguest.hohWins ? `♔ ${houseguest.hohWins}` : \"\"}${\n        houseguest.povWins && houseguest.hohWins\n            ? `|🛇 ${houseguest.povWins}`\n            : houseguest.povWins\n            ? `🛇 ${houseguest.povWins}`\n            : \"\"\n    }${(houseguest.hohWins || houseguest.povWins) && houseguest.nominations ? \"|\" : \"\"}${\n        houseguest.nominations ? `✘ ${houseguest.nominations}` : \"\"\n    }`;\n}\n\nfunction friendOrEnemyTitle(hero: PortraitProps, villain: SelectedPlayerData): string[] {\n    const titles: string[] = [];\n    titles.push(\n        RelationshipTypeToSymbol[\n            classifyRelationship(hero.popularity || 0, villain.popularity, hero.relationships![villain.id])\n        ]\n    );\n    return titles;\n}\n\nfunction friendEnemyCountTitle(hero: PortraitProps): string[] {\n    const titles: string[] = [];\n    const count =\n        isWellDefined(hero.friends) && isWellDefined(hero.enemies)\n            ? { friends: hero.friends, enemies: hero.enemies }\n            : { friends: 0, enemies: 0 };\n    titles.push(\n        `${count.friends} ${RelationshipTypeToSymbol[Relationship.Friend]}| ${count.enemies} ${\n            RelationshipTypeToSymbol[Relationship.Enemy]\n        }${hero.targetingMe ? `| 🎯 ${hero.targetingMe}` : \"\"}`\n    );\n    return titles;\n}\n","import { Rgb, interpolateColor } from \"./color\";\nimport { PortraitState, PortraitProps } from \"../components/memoryWall\";\nimport { extremeValues } from \"../utils\";\nimport { generatePopularitySubtitle, generatePowerSubtitle } from \"../components/playerPortrait/subtitle\";\n\nexport interface PortraitDisplayMode {\n    minColor: Rgb;\n    maxColor: Rgb;\n    backgroundColor: (state: PortraitState) => string;\n    generateSubtitle: (props: PortraitProps, state: PortraitState, detailed?: boolean) => any[];\n}\n\nconst popularityMinColor = new Rgb(252, 137, 137);\nconst popularityMaxColor = new Rgb(137, 252, 137);\n\nexport const popularityMode: PortraitDisplayMode = {\n    minColor: popularityMinColor,\n    maxColor: popularityMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const popularity = state.popularity;\n\n        const extremePopularity = extremeValues(popularity);\n        const percent = (extremePopularity + 1) / 2;\n        return interpolateColor(popularityMinColor, popularityMaxColor, percent);\n    },\n    generateSubtitle: generatePopularitySubtitle,\n};\n\nconst powerMaxColor = new Rgb(255, 204, 94);\nconst powerMinColor = new Rgb(192, 181, 255);\nexport const powerMode: PortraitDisplayMode = {\n    minColor: powerMinColor,\n    maxColor: powerMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const powerRanking = state.powerRanking;\n        if (powerRanking === undefined) return \"\";\n\n        return interpolateColor(powerMinColor, powerMaxColor, powerRanking);\n    },\n    generateSubtitle: generatePowerSubtitle,\n};\n","import { Houseguest } from \"../../model\";\nimport { RelationshipMap } from \"../../utils\";\nimport {\n    displayMode$,\n    getSelectedCastPlayers,\n    getSelectedPlayer,\n    selectedCastPlayer$,\n    selectedPlayer$,\n} from \"../../subjects/subjects\";\nimport { powerMode } from \"../../model/portraitDisplayMode\";\n\nexport interface SelectedPlayerData {\n    id: number;\n    popularity: number;\n    relationships: RelationshipMap;\n    isEvicted: boolean;\n    superiors?: { [id: number]: number };\n}\n\nexport function selectPlayer(player: SelectedPlayerData | null) {\n    if (!player || (getSelectedPlayer() && (getSelectedPlayer() as Houseguest).id === player.id)) {\n        selectedPlayer$.next(null);\n        return;\n    }\n    if (\n        !player.superiors ||\n        (displayMode$.value === powerMode && Object.keys(player.superiors).length === 0)\n    ) {\n        selectedPlayer$.next(null);\n        return;\n    }\n    selectedPlayer$.next(player);\n}\n\nexport function selectCastPlayer(id: number | null) {\n    if (id === null) {\n        selectedCastPlayer$.next(new Set());\n        return;\n    }\n    const selectedCastPlayers = getSelectedCastPlayers();\n    if (selectedCastPlayers.has(id)) {\n        // remove if exists\n        selectedCastPlayers.delete(id);\n    } else {\n        // else add\n        selectedCastPlayers.add(id);\n    }\n    selectedCastPlayer$.next(selectedCastPlayers);\n}\n","import { BehaviorSubject, Subject } from \"rxjs\";\nimport { PregameScreen } from \"../components/pregameScreen/pregameScreen\";\nimport { Episode, PlayerProfile } from \"../model\";\nimport { SelectedPlayerData } from \"../components/playerPortrait/selectedPortrait\";\nimport React from \"react\";\nimport { PortraitDisplayMode, popularityMode } from \"../model/portraitDisplayMode\";\nimport { ColorTheme } from \"../theme/theme\";\nimport { EpisodeLibrary } from \"../model/season\";\nimport { activeScreen$, Screens } from \"../components/topbar/topBar\";\n\n// What is currently being displayed.\nexport const mainContentStream$ = new BehaviorSubject(<PregameScreen cast={[]} />);\n\nexport function pushToMainContentStream(content: JSX.Element, tab?: Screens) {\n    tab && activeScreen$.next(tab);\n    mainContentStream$.next(content);\n}\n\n// Push episodes to this subject to add them to the sidebar. Null resets everything.\nexport const episodes$ = new BehaviorSubject<Episode | null>(null);\n// Forcibly switches to an episode. Used when adding a new episode.\nexport const switchEpisode$ = new Subject<number>();\nexport function newEpisode(episode: Episode | null) {\n    episodes$.next(episode);\n}\nexport function switchSceneRelative(n: number) {\n    switchEpisode$.next(n);\n}\n\n// pushed when a new season is created (may need to be upgraded to behavior subject in the future)\nexport const season$ = new Subject<EpisodeLibrary>();\n\n// the list of players in the game\nexport const cast$ = new BehaviorSubject<PlayerProfile[]>([]);\nexport function updateCast(newCast: PlayerProfile[]) {\n    cast$.next(newCast);\n}\nexport function getCast(): PlayerProfile[] {\n    return cast$.value;\n}\n// The player that the user has clicked on.\nexport const selectedPlayer$ = new BehaviorSubject<SelectedPlayerData | null>(null);\nexport function getSelectedPlayer() {\n    return selectedPlayer$.value;\n}\n\n// The cast member(s) that the user has clicked on.\n// Used for the casting screen.\nexport const selectedCastPlayer$ = new BehaviorSubject<Set<number>>(new Set<number>());\n\nexport function getSelectedCastPlayers() {\n    return selectedCastPlayer$.value;\n}\n\n// The decks that have been selected on the casting screen.\nexport const selectedDecks$ = new BehaviorSubject<Set<string>>(new Set<string>());\n\nexport function selectDeckSubject(deck: string | null) {\n    if (deck === null) {\n        selectedDecks$.next(new Set());\n        return;\n    }\n    const selectedDecks = selectedDecks$.value;\n    if (selectedDecks.has(deck)) {\n        // remove if exists\n        selectedDecks.delete(deck);\n    } else {\n        // else add\n        selectedDecks.add(deck);\n    }\n    selectedDecks$.next(selectedDecks);\n}\n\n// The tab selected on the start of each week.\nexport const weekStartTab$ = new BehaviorSubject<number>(0);\n\n// The display mode selected by the viewsbar.\nexport const displayMode$ = new BehaviorSubject<PortraitDisplayMode>(popularityMode);\n\n// If the screen is fullscreen or not.\nexport const isFullscreen$ = new BehaviorSubject<boolean>(false);\n\n// dark or light mode.\nexport const theme$ = new Subject<ColorTheme>();\n","import { PortraitProps, HouseguestPortrait, PortraitState } from \"../memoryWall\";\nimport { Subscription } from \"rxjs\";\nimport { selectedPlayer$, displayMode$, getSelectedPlayer } from \"../../subjects/subjects\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport { Rgb } from \"../../model/color\";\nimport { heroIsPregame } from \"./subtitle\";\nimport { shuffle } from \"lodash\";\n\nexport const selectedColor = new Rgb(51, 255, 249);\n\nexport class HouseguestPortraitController {\n    private subs: Subscription[] = [];\n    private view: HouseguestPortrait;\n    constructor(view: HouseguestPortrait) {\n        this.view = view;\n    }\n\n    get defaultState() {\n        return {\n            popularity: this.view.props.popularity,\n            displayMode: displayMode$.value,\n            powerRanking: this.view.props.powerRanking,\n        };\n    }\n\n    public backgroundColor(props: PortraitProps): undefined | string {\n        if (heroIsPregame(props)) {\n            return shuffle([\n                \"#ca9389\",\n                \"#cab389\",\n                \"#c0ca89\",\n                \"#cabb89\",\n                \"#c0ca89\",\n                \"#cabb89\",\n                \"#b9ca89\",\n                \"#98ca89\",\n            ])[0];\n        }\n        const selectedPlayer = getSelectedPlayer();\n        if (selectedPlayer !== null && selectedPlayer.id === props.id) {\n            return selectedColor.toHex();\n        }\n        return props.isEvicted ? undefined : this.view.state.displayMode.backgroundColor(this.view.state);\n    }\n\n    public subscribe() {\n        const subs: Subscription[] = [];\n        subs.push(\n            selectedPlayer$.subscribe({\n                next: this.refreshData,\n            })\n        );\n        subs.push(\n            displayMode$.subscribe({\n                next: (displayMode) => this.view.setState({ displayMode }),\n            })\n        );\n        this.subs = subs;\n    }\n\n    public unsubscribe() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    private comparePowerRankings(data: SelectedPlayerData): number {\n        // 0 is blue. 1 is orange\n        if (!data.superiors) return 0;\n        const id = this.view.props.id === undefined ? -1 : this.view.props.id;\n        return data.superiors[id];\n    }\n\n    private refreshData = (data: SelectedPlayerData | null) => {\n        if (!data) {\n            this.view.setState(this.defaultState);\n        } else {\n            if (data.id !== this.view.props.id) {\n                this.view.setState({\n                    popularity: data.relationships[this.view.props.id!],\n                    powerRanking: this.comparePowerRankings(data),\n                });\n            } else {\n                this.view.setState({ popularity: 2, powerRanking: 2 });\n            }\n        }\n    };\n}\n","import React from \"react\";\nimport { selectPlayer } from \"./selectedPortrait\";\nimport { isNotWellDefined, RelationshipMap } from \"../../utils\";\nimport _ from \"lodash\";\nimport { HouseguestPortraitController } from \"./houseguestPortraitController\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst Subtitle = styled.small`\n    font-weight: 100;\n    font-size: small;\n`;\n\nconst MemoryWallPortrait = styled.div`\n    margin: 5px;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.portraitBorder};\n    color: black;\n    border-radius: 5px;\n    text-align: center;\n    font-weight: 600;\n    width: 7rem;\n    word-wrap: break-word;\n    -webkit-transition-property: none;\n    -moz-transition-property: none;\n    -o-transition-property: none;\n    transition-property: none;\n`;\n\nconst Evicted = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: grey;\n    background-color: #111111;\n`;\n\nconst Jury = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: #c3ae88;\n    background-color: #5d5340;\n    filter: brightness(0.6);\n`;\n\nconst Normal = styled.img`\n    min-width: 100px;\n    width: 100%;\n    width: -moz-available; /* For Mozzila */\n    width: -webkit-fill-available; /* For Chrome */\n    width: stretch; /* Unprefixed */\n    -webkit-transition-property: none;\n    -moz-transition-property: none;\n    -o-transition-property: none;\n    transition-property: none;\n`;\n\nconst Grayscale = styled(Normal)`\n    filter: grayscale(100%);\n`;\n\nconst Sepia = styled(Normal)`\n    filter: sepia(100%);\n`;\n\nexport interface PortraitProps {\n    imageURL: string;\n    name: string;\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    powerRanking?: number;\n    deltaPopularity?: number;\n    detailed?: boolean;\n    superiors?: { [id: number]: number };\n    friends?: number;\n    enemies?: number;\n    targetingMe?: number;\n    targets?: number[];\n}\n\nexport interface PortraitState {\n    popularity?: number;\n    powerRanking?: number;\n    displayMode: PortraitDisplayMode;\n}\nexport class HouseguestPortrait extends React.Component<PortraitProps, PortraitState> {\n    private controller: HouseguestPortraitController;\n\n    public constructor(props: PortraitProps) {\n        super(props);\n        this.controller = new HouseguestPortraitController(this);\n        this.state = this.controller.defaultState;\n    }\n\n    public componentDidMount() {\n        if (isNotWellDefined(this.props.id)) {\n            return;\n        }\n        this.controller.subscribe();\n    }\n\n    public componentWillUnmount() {\n        this.controller.unsubscribe();\n    }\n\n    private onClick(): void {\n        if (\n            (this.props.targets && this.props.targets[0] === 0 && this.props.targets[1] == 0) ||\n            isNotWellDefined(this.props.id) ||\n            !this.props.relationships\n        ) {\n            return;\n        }\n        const data = {\n            id: this.props.id,\n            relationships: this.props.relationships,\n            isEvicted: !!this.props.isEvicted,\n            popularity: this.props.popularity || 0,\n            superiors: this.props.superiors,\n        };\n        selectPlayer(data);\n    }\n\n    public render() {\n        const props = this.props;\n        const Img = getImageClass(props);\n        let subtitle: any[] = [];\n        subtitle = this.state.displayMode.generateSubtitle(this.props, this.state, !!props.detailed);\n\n        let Portrait = MemoryWallPortrait;\n        if (props.isJury) {\n            Portrait = Jury;\n        } else if (props.isEvicted) {\n            Portrait = Evicted;\n        }\n        return (\n            <Portrait\n                onClick={() => this.onClick()}\n                style={{\n                    backgroundColor: this.controller.backgroundColor(props),\n                }}\n            >\n                <Img src={props.imageURL} style={{ height: 100, width: \"-moz-available\" }} />\n                <br />\n                {props.name}\n                <br />\n                {<Subtitle>{subtitle}</Subtitle>}\n            </Portrait>\n        );\n    }\n}\n\nfunction getImageClass(props: PortraitProps) {\n    let imageClass = props.isEvicted ? Grayscale : Normal;\n    imageClass = props.isJury ? Sepia : imageClass;\n    return imageClass;\n}\n","import { ProfileHouseguest, HouseguestPortrait } from \"../memoryWall\";\nimport React from \"react\";\n\nexport function houseguestToPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={false} />;\n}\n\nexport function memoryWallPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={true} />;\n}\n","import React from \"react\";\nimport Popover from \"react-tiny-popover\";\nimport styled from \"styled-components\";\n\nconst Text = styled.p`\n    max-width: 200px;\n    padding: 3px 8px;\n    color: #fff;\n    text-align: center;\n    background-color: #000;\n    border-radius: 4px;\n`;\n\ninterface TooltipProps {\n    text: string;\n    children: any;\n}\n\ninterface ToolTipState {\n    visible: boolean;\n}\n\nexport class Tooltip extends React.Component<TooltipProps, ToolTipState> {\n    constructor(props: TooltipProps) {\n        super(props);\n        this.state = { visible: false };\n    }\n\n    public render() {\n        return (\n            <Popover\n                position={[\"top\", \"bottom\"]}\n                isOpen={this.state.visible}\n                content={<Text>{this.props.text}</Text>}\n            >\n                <div\n                    onMouseEnter={() => this.setState({ visible: true })}\n                    onMouseLeave={() => this.setState({ visible: false })}\n                >\n                    {this.props.children}\n                </div>\n            </Popover>\n        );\n    }\n}\n","import React from \"react\";\nimport { ProfileHouseguest } from \"../memoryWall\";\nimport { houseguestToPortrait, memoryWallPortrait } from \"./houseguestToPortrait\";\nimport { Tooltip } from \"../tooltip/tooltip\";\n\nlet key = -1;\n\nfunction PortraitWrapper(props: { centered?: boolean; children: any }): JSX.Element {\n    return (\n        <div\n            key={key++}\n            className={`columns is-gapless is-mobile is-multiline ${props.centered ? \"is-centered\" : \"\"}`}\n        >\n            {props.children}\n        </div>\n    );\n}\n\nexport function Portrait(props: { houseguest: ProfileHouseguest; centered?: boolean }): JSX.Element {\n    const result = (\n        <PortraitWrapper centered={props.centered}>{houseguestToPortrait(props.houseguest)}</PortraitWrapper>\n    );\n    if (props.houseguest.tooltip) {\n        return (\n            <PortraitWrapper centered={props.centered}>\n                <Tooltip text={props.houseguest.tooltip}>{houseguestToPortrait(props.houseguest)}</Tooltip>\n            </PortraitWrapper>\n        );\n    }\n    return result;\n}\n\nexport function Portraits(props: {\n    houseguests: (ProfileHouseguest | \"⬅️\" | \"➡️\")[];\n    centered?: boolean;\n    detailed?: boolean;\n}): JSX.Element {\n    const rows: JSX.Element[] = [];\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    props.houseguests.forEach((houseguest: ProfileHouseguest | \"⬅️\" | \"➡️\") => {\n        let result;\n        if (houseguest === \"⬅️\" || houseguest === \"➡️\") {\n            result = (\n                <div\n                    key={`plus-${key++}`}\n                    style={{ display: \"flex\", justifyContent: \"center\", alignItems: \"center\" }}\n                    className=\"column is-narrow\"\n                >\n                    <p>{houseguest}</p>\n                </div>\n            );\n        } else if (props.detailed) {\n            result = memoryWallPortrait(houseguest, key++);\n        } else {\n            result = houseguestToPortrait(houseguest, key++);\n        }\n        if (houseguest !== \"⬅️\" && houseguest !== \"➡️\" && houseguest.tooltip) {\n            result = (\n                <Tooltip key={key++} text={houseguest.tooltip}>\n                    {result}\n                </Tooltip>\n            );\n        }\n        rows.push(result);\n    });\n    return (\n        <div className={`columns is-gapless is-mobile is-multiline ${props.centered && \"is-centered\"}`}>\n            {rows}\n        </div>\n    );\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { Portraits } from \"../playerPortrait/portraits\";\nimport { RelationshipMap } from \"../../utils\";\nexport interface IMemoryWallProps {\n    readonly houseguests: ProfileHouseguest[];\n}\n\nexport interface ProfileHouseguest extends PlayerProfile {\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    deltaPopularity?: number;\n    hohWins?: number;\n    povWins?: number;\n    nominations?: number;\n    tooltip?: string;\n    friends?: number;\n    enemies?: number;\n    targetingMe?: number;\n}\n\nexport function MemoryWall(props: IMemoryWallProps): JSX.Element {\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    return (\n        <div\n            style={{\n                margin: \"auto\",\n                maxWidth: props.houseguests.length < 26 ? 800 : -1,\n            }}\n        >\n            <Portraits houseguests={props.houseguests} centered={true} detailed={true} />\n        </div>\n    );\n}\n","import styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nexport const HasText = styled.div`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport const Input = styled.input`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { selectedColor } from \"./houseguestPortraitController\";\n\nconst EditPortrait = styled.div`\n    padding: 5px;\n    margin: 5px;\n    border: 1px solid grey;\n    background-color: grey;\n    color: black;\n    border-radius: 5px;\n    font-weight: 600;\n    width: 7rem;\n    word-wrap: break-word;\n`;\n\nexport const Noselect = styled.div`\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -khtml-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n`;\n\nconst XButton = styled(Noselect)`\n    color: #300808;\n    width: 50%;\n\n    :active {\n        color: #ff7133;\n        background-color: #ffd8c7;\n    }\n    :hover {\n        color: red;\n        background-color: #ffe1ea;\n    }\n`;\n\nconst EditButton = styled(Noselect)`\n    color: #300808;\n    width: 50%;\n\n    :active {\n        color: #ff7133;\n        background-color: #ffd8c7;\n    }\n    :hover {\n        color: orange;\n        background-color: #fff6e1;\n    }\n`;\n\ninterface SetupPortraitProps {\n    name: string;\n    imageUrl: string;\n    onDelete: () => void;\n    onRename: () => void;\n    onClick: () => void;\n    selected: boolean;\n}\n\ninterface SetupPortraitState {\n    name: string;\n}\n\nexport class SetupPortrait extends React.Component<SetupPortraitProps, SetupPortraitState> {\n    public constructor(props: SetupPortraitProps) {\n        super(props);\n        this.state = { name: props.name };\n    }\n\n    public UNSAFE_componentWillReceiveProps(props: SetupPortraitProps) {\n        this.setState({ name: props.name });\n    }\n\n    public render() {\n        const style = this.props.selected ? { backgroundColor: selectedColor.toHex() } : {};\n        return (\n            <EditPortrait onClick={() => this.props.onClick()} style={style}>\n                <div style={{ textAlign: \"center\" }}>\n                    <div style={{ maxHeight: 20, display: \"flex\" }}>\n                        <XButton\n                            onDoubleClick={() => this.props.onDelete()}\n                            onClick={(event) => event.stopPropagation()}\n                        >\n                            ✘\n                        </XButton>\n                        <EditButton\n                            onClick={(event) => {\n                                event.stopPropagation();\n                                this.props.onRename();\n                            }}\n                        >\n                            ✎\n                        </EditButton>\n                    </div>\n                    <img src={this.props.imageUrl} style={{ width: 100, height: 100 }} />\n                    <br />\n                    <p>{this.state.name}</p>\n                </div>\n            </EditPortrait>\n        );\n    }\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\n\ninterface NumericInputProps {\n    value: string;\n    onChange: (newValue: string) => void;\n    style?: any;\n    className?: string;\n    placeholder?: string;\n}\n\nexport const NumericInputStyle = styled.input`\n    width: 3em;\n    marginleft: 5px;\n`;\n\nexport function NumericInput(props: NumericInputProps) {\n    const style = props.style || {};\n    return (\n        <NumericInputStyle\n            type=\"text\"\n            className={`input${props.className ? ` ${props.className}` : \"\"}`}\n            style={style}\n            value={props.value}\n            placeholder={props.placeholder || \"\"}\n            onChange={(event) => {\n                const value = event.target.value;\n                if (/^\\d*$/g.test(value)) {\n                    props.onChange(value);\n                }\n            }}\n        />\n    );\n}\n","import React, { useState } from \"react\";\nimport { Tooltip } from \"../tooltip/tooltip\";\nimport { NumericInput } from \"./numericInput\";\n\ninterface RandomButtonProps {\n    random: (n: number) => void;\n}\n\nexport function RandomButton(props: RandomButtonProps): JSX.Element {\n    const [number, setNumber] = useState(\"16\");\n    return (\n        <div className=\"field has-addons\" style={{ display: \"flex\" }}>\n            <div className=\"control\">\n                <Tooltip text={\"Selected cast members will always be chosen.\"}>\n                    <button\n                        disabled={number === \"\"}\n                        className=\"button is-primary\"\n                        onClick={() => props.random(parseInt(number))}\n                    >\n                        Random\n                    </button>\n                </Tooltip>\n            </div>\n            <div className=\"control\">\n                <NumericInput value={number} onChange={setNumber} />\n            </div>\n        </div>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\ninterface TextProps {\n    noMargin?: boolean;\n    children?: any;\n    style?: any;\n    className?: string;\n}\n\nconst NoMargin = styled.div`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\nconst Center = styled.p`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport function Centered(props: TextProps): JSX.Element {\n    if (props.noMargin) return <NoMargin>{props.children}</NoMargin>;\n    return (\n        <Center className={props.className || \"\"} style={props.style || {}}>\n            {props.children}\n        </Center>\n    );\n}\n\nexport function CenteredBold(props: TextProps): JSX.Element {\n    return (\n        <Centered className={props.className || \"\"} style={props.style || {}} noMargin={props.noMargin}>\n            <b>{props.children} </b>\n        </Centered>\n    );\n}\n\nexport function CenteredItallic(props: TextProps): JSX.Element {\n    return (\n        <Centered className={props.className || \"\"} style={props.style || {}} noMargin={props.noMargin}>\n            <i>{props.children} </i>\n        </Centered>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { canDisplayCliques, GameState, getById } from \"../../model\";\nimport { ColorTheme } from \"../../theme/theme\";\nimport { isNotWellDefined } from \"../../utils\";\nimport { Centered } from \"../layout/centered\";\nimport { HasText } from \"../layout/text\";\nimport { Portraits } from \"../playerPortrait/portraits\";\n\nexport const HelpLink = styled.a`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.link};\n    cursor: pointer;\n    font-weight: bold;\n    margin-top: 10px;\n    margin-bottom: 10px;\n`;\n\ninterface AllianceListProps {\n    gameState: GameState;\n}\n\nexport function AllianceList(props: AllianceListProps) {\n    if (!canDisplayCliques(props.gameState))\n        return (\n            <HasText>\n                <Centered>\n                    ⚠️ There are too many players left in the game to display the alliances! Try again when\n                    there are 30 or less! ⚠️\n                </Centered>\n            </HasText>\n        );\n    const cliques = props.gameState.cliques;\n    const elements: JSX.Element[] = cliques.map((clique, i) => {\n        if (isNotWellDefined(clique.affiliates)) {\n            return (\n                <Portraits\n                    centered={true}\n                    detailed={true}\n                    key={`${clique}, ${i}, ${props.gameState.phase}`}\n                    houseguests={clique.core.map((id) => getById(props.gameState, id))}\n                />\n            );\n        }\n        const entries: (number | \"⬅️\" | \"➡️\")[] = [\n            ...clique.affiliates[0],\n            \"➡️\",\n            ...clique.core,\n            \"⬅️\",\n            ...clique.affiliates[1],\n        ];\n        return (\n            <Portraits\n                centered={true}\n                detailed={true}\n                key={`${clique}, ${i}, ${props.gameState.phase}`}\n                houseguests={entries.map((id) => {\n                    if (id === \"⬅️\") return \"⬅️\";\n                    if (id === \"➡️\") return \"➡️\";\n                    return getById(props.gameState, id);\n                })}\n            />\n        );\n    });\n    return (\n        <div>\n            {elements}\n            {props.gameState.phase < 3 && (\n                <HelpLink\n                    href=\"https://github.com/spaulmark/bb-bots/blob/master/README.md#understanding-alliances-or-what-do-the-arrows-mean\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                >\n                    What do the arrows mean?\n                </HelpLink>\n            )}\n        </div>\n    );\n}\n","import React from \"react\";\nimport { PortraitDisplayMode, powerMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$, getSelectedPlayer, selectedPlayer$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nfunction setDisplayMode(p: PortraitDisplayMode) {\n    if (p === powerMode) {\n        const player = getSelectedPlayer();\n        if (player && (!player.superiors || Object.keys(player.superiors).length === 0)) {\n            selectedPlayer$.next(null);\n        }\n    }\n    displayMode$.next(p);\n}\n\ninterface ViewBarTagProps {\n    mode: PortraitDisplayMode;\n    text: string;\n    disabled?: boolean;\n}\n\nexport class ViewBarTag extends React.Component<ViewBarTagProps, { selected: boolean }> {\n    private sub: Subscription | null = null;\n\n    public constructor(props: ViewBarTagProps) {\n        super(props);\n        this.state = { selected: props.mode === displayMode$.value };\n    }\n\n    public componentDidMount() {\n        this.sub = displayMode$.subscribe({\n            next: (mode) => {\n                if (mode !== this.props.mode) {\n                    this.setState({ selected: false });\n                } else {\n                    this.setState({ selected: true });\n                }\n            },\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    public render() {\n        const name = \"level-item tag is-medium is-light\";\n        const style = getStyle(this.props);\n        return (\n            <span\n                className={name}\n                style={style}\n                onClick={() => {\n                    !this.props.disabled && setDisplayMode(this.props.mode);\n                    !this.props.disabled && this.setState({ selected: true });\n                }}\n            >\n                {styleText(this.props.text, this.state.selected)}\n            </span>\n        );\n    }\n}\n\nfunction styleText(text: string, selected: boolean): JSX.Element {\n    return selected ? <b>{text}</b> : <i>{text}</i>;\n}\n\nfunction getStyle(props: ViewBarTagProps) {\n    return props.disabled\n        ? {}\n        : {\n              background: `linear-gradient(90deg, ${props.mode.minColor.toRgba()} 0%, ${props.mode.maxColor.toRgba()} 100%)`,\n              cursor: \"pointer\",\n          };\n}\n","import React from \"react\";\nimport { popularityMode, powerMode } from \"../../model/portraitDisplayMode\";\nimport { ViewBarTag } from \"./viewBarTag\";\nimport { GameState, inJury } from \"../../model\";\nimport { displayMode$ } from \"../../subjects/subjects\";\n\nexport class ViewsBar extends React.Component<{ gameState: GameState }, {}> {\n    public constructor(props: { gameState: GameState }) {\n        super(props);\n        if (!inJury(this.props.gameState) && displayMode$.value === powerMode) {\n            displayMode$.next(popularityMode);\n        }\n    }\n\n    componentDidUpdate() {\n        if (!inJury(this.props.gameState) && displayMode$.value === powerMode) {\n            displayMode$.next(popularityMode);\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"level is-mobile\" key=\"viewsbar\" style={{ marginBottom: 0 }}>\n                <ViewBarTag mode={popularityMode} text={\"Relationships\"}></ViewBarTag>\n                {inJury(this.props.gameState) && (\n                    <ViewBarTag mode={powerMode} text={\"Endgame Winrate\"}></ViewBarTag>\n                )}\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { Scene } from \"./scenes/scene\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\nimport { defaultContent } from \"./bigBrotherEpisode\";\n\nexport interface InitEpisode {\n    scenes: Scene[];\n    title: string;\n    content?: JSX.Element;\n    gameState: GameState;\n    initialGamestate?: GameState;\n    type: EpisodeType;\n}\n\nexport class Episode {\n    readonly scenes: Scene[];\n    readonly title: string;\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly initialGameState: GameState;\n    readonly type: EpisodeType;\n    readonly arrowsEnabled: boolean = true;\n    get render(): JSX.Element {\n        const viewsBar = this.type.hasViewsbar ? <ViewsBar gameState={this.scenes[0].gameState} /> : null;\n        return (\n            <div>\n                {viewsBar}\n                {this.content}\n            </div>\n        );\n    }\n\n    constructor(init: InitEpisode) {\n        this.scenes = init.scenes;\n        this.title = init.title;\n        this.content = init.content || defaultContent(init.initialGamestate || init.gameState);\n        this.gameState = init.gameState;\n        this.initialGameState = init.initialGamestate || init.gameState;\n        this.type = init.type;\n    }\n}\n\nexport interface EpisodeType {\n    readonly canPlayWith: (n: number) => boolean;\n    readonly eliminates: number;\n    readonly arrowsEnabled: boolean;\n    readonly hasViewsbar: boolean;\n    readonly name: string;\n    readonly generate: (gameState: GameState) => Episode;\n}\n","import { GameState, Houseguest, EpisodeType, Episode } from \"../../model\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateNomCeremonyScene } from \"./scenes/nomCeremonyScene\";\nimport { generateVetoCompScene } from \"./scenes/vetoCompScene\";\nimport { generateVetoCeremonyScene } from \"./scenes/vetoCeremonyScene\";\nimport { generateEvictionScene } from \"./scenes/evictionScene\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Scene } from \"./scenes/scene\";\nimport { HasText } from \"../layout/text\";\nimport styled from \"styled-components\";\nimport { weekStartTab$ } from \"../../subjects/subjects\";\nimport { WeekStartWrapper } from \"./bigBrotherWeekstartWrapper\";\nimport { GoldenVeto, Veto } from \"./veto/veto\";\n\nexport const BigBrotherVanilla: EpisodeType = {\n    canPlayWith: (n: number) => {\n        return n > 3;\n    },\n    eliminates: 1,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n    name: \"BigBrotherVanilla\",\n    generate: generateBbVanilla,\n};\n\nconst TabItem = styled.li`\n    cursor: pointer;\n`;\n\n// Refactoring ideas\n/**\n * Might be best to start passing ids instead of houseguests for HoH/nominees/veto winner\n */\n\nfunction Tab(props: { text: string; active: number; id: number; setActive: any }): JSX.Element {\n    return (\n        <TabItem\n            className={props.active === props.id ? \"is-active\" : \"\"}\n            onClick={() => {\n                props.setActive(props.id);\n                weekStartTab$.next(props.id);\n            }}\n        >\n            <a>{props.text}</a>\n        </TabItem>\n    );\n}\n\nexport function Tabs(): JSX.Element {\n    const [active, setActive] = React.useState(weekStartTab$.value);\n    return (\n        <div className=\"tabs is-centered is-fullwidth is-medium\" style={{ marginBottom: 0 }}>\n            <ul style={{ paddingLeft: 0 }}>\n                <Tab text={\"Memory Wall\"} active={active} setActive={setActive} id={0} />\n                <Tab text={\"Alliances\"} active={active} setActive={setActive} id={1} />\n            </ul>\n        </div>\n    );\n}\n\nexport function defaultContent(initialGameState: GameState) {\n    return (\n        <HasText>\n            <Tabs />\n            <WeekStartWrapper gameState={initialGameState} />\n            <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n}\n\nexport function generateBbVanilla(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, GoldenVeto);\n    return new Episode({\n        title: episode.title,\n        scenes: episode.scenes,\n        gameState: new GameState(episode.gameState),\n        initialGamestate,\n        type: BigBrotherVanilla,\n    });\n}\n\nexport function generateBBVanillaScenes(\n    initialGamestate: GameState,\n    veto: Veto | null,\n    doubleEviction: boolean = false\n): {\n    gameState: GameState;\n    scenes: Scene[];\n    title: string;\n} {\n    let hoh: Houseguest;\n    let currentGameState: GameState;\n    let hohCompScene: Scene;\n    const scenes: Scene[] = [];\n\n    [currentGameState, hohCompScene, hoh] = generateHohCompScene(initialGamestate, { doubleEviction });\n    scenes.push(hohCompScene);\n\n    let nomCeremonyScene;\n    let nominees: Houseguest[];\n    [currentGameState, nomCeremonyScene, nominees] = generateNomCeremonyScene(currentGameState, hoh, {\n        doubleEviction,\n    });\n    scenes.push(nomCeremonyScene);\n\n    if (veto) {\n        let vetoCompScene;\n        let povWinner: Houseguest;\n        [currentGameState, vetoCompScene, povWinner] = generateVetoCompScene(\n            currentGameState,\n            hoh,\n            nominees,\n            veto,\n            doubleEviction\n        );\n        scenes.push(vetoCompScene);\n        let vetoCeremonyScene;\n\n        [currentGameState, vetoCeremonyScene, nominees] = generateVetoCeremonyScene(\n            currentGameState,\n            hoh,\n            nominees,\n            povWinner,\n            { doubleEviction, finalNominees: 2 }\n        );\n        scenes.push(vetoCeremonyScene);\n    }\n    let evictionScene;\n    [currentGameState, evictionScene] = generateEvictionScene(currentGameState, hoh, nominees, {\n        doubleEviction,\n        votingTo: \"Evict\",\n    });\n    if (veto === null) {\n        currentGameState.currentLog.nominationsPostVeto = currentGameState.currentLog.nominationsPreVeto;\n    }\n    scenes.push(evictionScene);\n    const title = `Week ${currentGameState.phase}`;\n    return { gameState: currentGameState, scenes, title };\n}\n","import React from \"react\";\nimport { GameState } from \"../../../model/gameState\";\nimport { ViewsBar } from \"../../viewsBar/viewBar\";\ninterface InitScene {\n    readonly title: string;\n    readonly gameState: GameState;\n    readonly content: JSX.Element;\n}\nexport class Scene {\n    readonly title: string = \"\";\n    readonly gameState: GameState = new GameState({ players: [], jury: -1 });\n    readonly content: JSX.Element = (<div>{`Error while rendering ${this.title}`}</div>);\n    public render: JSX.Element;\n    public constructor(init: Partial<InitScene>) {\n        Object.assign(this, init);\n        this.render = (\n            <div>\n                <ViewsBar gameState={this.gameState} />\n                {this.content}\n            </div>\n        );\n    }\n}\n","export interface Veto {\n    name: string;\n    // TODO: something like GenerateScenes() that returns veto comp scene\n}\n\nexport const GoldenVeto: Veto = {\n    name: \"Golden Power of Veto\",\n};\n","import { GameState } from \"../../model\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport React from \"react\";\nimport { Scene } from \"./scenes/scene\";\nimport { GoldenVeto } from \"./veto/veto\";\n\nexport const DoubleEviction: EpisodeType = {\n    canPlayWith: (n: number) => n >= 5,\n    eliminates: 2,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n    name: \"Double Eviction\",\n    generate: generateDoubleEviction,\n};\n\nfunction generateDoubleEviction(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, GoldenVeto);\n    let currentGameState = episode.gameState;\n    const scenes: Scene[] = episode.scenes;\n\n    currentGameState.incrementLogIndex();\n    const doubleEviction = generateBBVanillaScenes(currentGameState, GoldenVeto, true);\n    currentGameState = doubleEviction.gameState;\n    scenes.push(\n        new Scene({\n            title: \"Double Eviction\",\n            content: <div>{doubleEviction.scenes.map((scene) => scene.content)}</div>,\n            gameState: doubleEviction.gameState,\n        })\n    );\n\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        initialGamestate,\n        title: episode.title,\n        scenes,\n        type: DoubleEviction,\n    });\n}\n","import React from \"react\";\nimport { GameState } from \"../../model\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { DoubleEviction } from \"./doubleEvictionEpisode\";\nimport { EpisodeType, Episode } from \"./episodes\";\nimport { Scene } from \"./scenes/scene\";\nimport { GoldenVeto } from \"./veto/veto\";\n\nexport const InstantEviction: EpisodeType = {\n    canPlayWith: (n: number) => n >= 5,\n    eliminates: 2,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n    name: \"Instant Eviction\",\n    generate: generateInstantEviction,\n};\n\nfunction generateInstantEviction(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, GoldenVeto);\n    let currentGameState = episode.gameState;\n    const scenes: Scene[] = episode.scenes;\n\n    currentGameState.incrementLogIndex();\n    const doubleEviction = generateBBVanillaScenes(currentGameState, null, true);\n    currentGameState = doubleEviction.gameState;\n\n    scenes.push(\n        new Scene({\n            title: \"Instant Eviction\",\n            content: <div>{doubleEviction.scenes.map((scene) => scene.content)}</div>,\n            gameState: doubleEviction.gameState,\n        })\n    );\n\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        initialGamestate,\n        title: episode.title,\n        scenes,\n        type: DoubleEviction,\n    });\n}\n","import React from \"react\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { GameState } from \"../../model/gameState\";\n\nconst PregameEpisodeType: EpisodeType = {\n    eliminates: 0,\n    canPlayWith: (n: number) => {\n        return n > 2;\n    },\n    arrowsEnabled: true,\n    hasViewsbar: false,\n    name: \"Pregame\",\n    generate: (gameState: GameState) => new PregameEpisode(gameState),\n};\n\nexport class PregameEpisode extends Episode {\n    readonly title = \"Pregame\";\n    readonly scenes = [];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = PregameEpisodeType;\n\n    public constructor(gameState: GameState) {\n        super({\n            title: \"Pregame\",\n            scenes: [],\n            content: <PregameScreen cast={gameState.houseguests} />,\n            gameState,\n            type: PregameEpisodeType,\n        });\n        this.gameState = gameState;\n        this.content = <PregameScreen cast={gameState.houseguests} />;\n    }\n}\n","import React from \"react\";\nimport { switchSceneRelative } from \"../../subjects/subjects\";\n\nexport function NextEpisodeButton(): JSX.Element {\n    return (\n        <button className=\"button is-primary\" onClick={() => switchSceneRelative(1)}>\n            Continue\n        </button>\n    );\n}\n","import React from \"react\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\n\nconst FullscreenIcon = styled.img`\n    position: -webkit-sticky;\n    position: sticky;\n    top: 20px;\n    right: 20px;\n`;\n\nexport function FullscreenButton(): JSX.Element {\n    return (\n        <FullscreenIcon\n            src={\n                \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAASElEQVRIiWNgGAUEACMa/z+R6ohWz0Sqi0gFLIRcQAAQDAGa+2DoWzAKRgH1wX8G3OULWfqHfkYbsNIUPR5IrQ/gYLQsGngAAEPgCRZjAdYSAAAAAElFTkSuQmCC\"\n            }\n            className=\"button is-rounded\"\n            onClick={() => {\n                isFullscreen$.next(!isFullscreen$.getValue());\n            }}\n        />\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { EpisodeLog } from \"../../../model/logging/episodelog\";\nimport { CenteredBold, Centered, CenteredItallic } from \"../../layout/centered\";\nimport { GameState, getById } from \"../../../model\";\nimport { VoteType, WinnerVote, RunnerUpVote } from \"../../../model/logging/voteType\";\nimport { FullscreenButton } from \"../../mainPage/fullscreenButton\";\nimport { ColorTheme } from \"../../../theme/theme\";\nimport _ from \"lodash\";\n\nexport const EndgameTableCell = styled.td`\n    padding: 0.1em 0.4em;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n`;\n\nconst EndgameTable = styled.table`\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n    border-collapse: collapse;\n`;\n\nconst Gray = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.grayCell};\n`;\n\nexport const SaveCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.saveCell};\n`;\n\nconst White = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.lightGrayCell};\n`;\n\nconst Evicted = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.evictedCell};\n`;\n\nexport const WinnerCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.winnerCell};\n`;\n\nexport const RunnerUpCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.runnerUpCell};\n`;\n\nexport const NomineeCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.nomineeCell};\n`;\n\nexport const HohCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.hohCell};\n`;\n\nconst BlackRow = styled.tr`\n    height: 0.4em;\n    background-color: #000000;\n`;\nlet anotherKey = 0;\nexport function generateVotingTable(gameState: GameState): JSX.Element {\n    const masterLog: EpisodeLog[][] = gameState.log;\n    const houseguestCells: JSX.Element[][] = [];\n    gameState.houseguests.forEach((hg, i) => {\n        houseguestCells[hg.id] = [\n            <Gray key={`hg-name---${i}`}>\n                <CenteredBold noMargin={true}>{hg.name}</CenteredBold>\n            </Gray>,\n        ];\n    });\n    const evictionOrder: [number, number][] = [];\n    const topRowCells: JSX.Element[] = [];\n    const preVetoCells: JSX.Element[] = [];\n    const vetoCells: JSX.Element[] = [];\n    const postVetoCells: JSX.Element[] = [];\n    const evictedCells: JSX.Element[] = [];\n    const winnerCells: JSX.Element[] = [];\n    masterLog.forEach((logs: EpisodeLog[] | undefined, i) => {\n        // multiple entries (ie. a double eviction) will all share the same toprow\n        generateTopRow(\n            logs ? logs[0] : undefined,\n            i,\n            topRowCells,\n            masterLog.length - 1,\n            logs ? logs.length : -1 // -1 doesn't matter because its unread\n        );\n        const iterateLogs = logs ? logs : [undefined]; // this is incredibly dank\n        iterateLogs.forEach((log: EpisodeLog | undefined) => {\n            generatePreVetoRow(log, i, preVetoCells);\n            generateVetoRow(log, i, vetoCells);\n            generatePostVetoRow(log, i, postVetoCells);\n            generateEvictedRow(log, i, evictedCells, winnerCells, gameState);\n            if (!log) return;\n            log.evicted.forEach((evicted) => evictionOrder.push([evicted, i]));\n\n            if (log.runnerUp !== undefined) evictionOrder.push([log.runnerUp, i]);\n            if (log.winner !== undefined) evictionOrder.push([log.winner, i]);\n            // add each of the votes to the houseguest cells\n            for (const [key, value] of Object.entries(log.votes)) {\n                // typescript for .. in loops kinda suck so i need to do a sketchy type conversion\n                const id: number = key as unknown as number;\n                const vote: VoteType = value;\n                houseguestCells[id].push(vote.render(gameState));\n            }\n            if (log.winner !== undefined && log.runnerUp !== undefined) {\n                houseguestCells[log.winner].push(new WinnerVote().render(gameState));\n                houseguestCells[log.runnerUp].push(new RunnerUpVote().render(gameState));\n                evictedCells.push(\n                    <RunnerUpCell key={\"runnerUp\"}>\n                        <CenteredBold noMargin={true}>{getById(gameState, log.runnerUp).name}</CenteredBold>\n                        <Centered noMargin={true}>\n                            <small>Finalist</small>\n                        </Centered>\n                    </RunnerUpCell>\n                );\n                winnerCells.push(\n                    <WinnerCell key={\"winner\"}>\n                        <CenteredBold noMargin={true}>{getById(gameState, log.winner).name}</CenteredBold>\n                        <Centered noMargin={true}>\n                            <small>Winner</small>\n                        </Centered>\n                    </WinnerCell>\n                );\n            }\n        });\n    });\n    preVetoCells.push(\n        <White key={`preveto--finale`} rowSpan={3}>\n            <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n        </White>\n    );\n    const winnerRow = <tr>{winnerCells}</tr>;\n    const topRow = <tr>{topRowCells}</tr>;\n    const preVetoRow = <tr>{preVetoCells}</tr>;\n    const vetoRow = <tr>{vetoCells}</tr>;\n    const postVetoRow = <tr>{postVetoCells}</tr>;\n    const blackRow = (\n        <BlackRow>\n            <td colSpan={gameState.houseguests.length} />\n        </BlackRow>\n    );\n    const houseguestRows: JSX.Element[] = [];\n    const evictedRow = <tr>{evictedCells}</tr>;\n    let desiredLength = -1;\n    evictionOrder.reverse().forEach(([id, week], i) => {\n        if (i === 0) desiredLength = houseguestCells[id].length;\n        if (i > 1) {\n            const weekText = i === 2 ? \"(Finale)\" : `(Week ${week})`;\n            const evicted = (\n                <Evicted\n                    colSpan={desiredLength - houseguestCells[id].length}\n                    key={`evicted-week-${weekText}-${i}`}\n                >\n                    <CenteredItallic noMargin={true}>Evicted</CenteredItallic>\n                    <CenteredItallic noMargin={true}>\n                        <small>{weekText}</small>\n                    </CenteredItallic>\n                </Evicted>\n            );\n            if (!getById(gameState, id).isJury) {\n                houseguestCells[id].push(evicted); // not jury, they dead\n            } else {\n                const tempList = houseguestCells[id].slice(0, -1);\n                tempList.push(evicted);\n                tempList.push(houseguestCells[id][houseguestCells[id].length - 1]);\n                houseguestCells[id] = tempList;\n            }\n        }\n        houseguestRows.push(<tr key={`hgrow--${id}--${anotherKey++}`}>{houseguestCells[id]}</tr>);\n    });\n\n    return (\n        <div>\n            <FullscreenButton />\n            <EndgameTable>\n                <tbody>\n                    {topRow}\n                    {preVetoRow}\n                    {vetoRow}\n                    {postVetoRow}\n                    {blackRow}\n                    {houseguestRows}\n                    {blackRow}\n                    {evictedRow}\n                    {winnerRow}\n                </tbody>\n            </EndgameTable>\n        </div>\n    );\n}\n\nfunction generateEvictedRow(\n    log: EpisodeLog | undefined,\n    i: number,\n    cells: JSX.Element[],\n    winnerCells: JSX.Element[],\n    gameState: GameState\n) {\n    if (!log) {\n        cells.push(\n            <Gray key={`evicted${i}--${anotherKey++}`} rowSpan={2}>\n                <CenteredBold noMargin={true}>Evicted</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    const saveOrEvict =\n        log.soleVoter !== undefined ? \"evict\" : (log.votingTo && log.votingTo.toLowerCase()) || \"evict\";\n\n    const rowSpan = log.evicted.length === 1 ? 2 : 1;\n    log.evicted.forEach((evicted, i) => {\n        const voteTextLine1 =\n            log.soleVoter !== undefined\n                ? `${log.soleVoter}'s choice`\n                : `${\n                      log.votingTo === \"Save\"\n                          ? Object.values(log.votes).filter((vote) => vote.id === evicted).length\n                          : log.votesInMajority\n                  } of ${log.outOf} votes`;\n\n        const content = (\n            <Evicted key={`evicted${i}--${anotherKey++}`} rowSpan={rowSpan}>\n                <Centered noMargin={true}>\n                    <b>{getById(gameState, evicted).name}</b>\n                    <br />\n                    <small>\n                        {voteTextLine1} <br />\n                        to {saveOrEvict}\n                    </small>\n                </Centered>\n            </Evicted>\n        );\n        if (i === 0) cells.push(content);\n        else winnerCells.push(content);\n    });\n}\n\nfunction generatePostVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`postVeto--${i}-${anotherKey++}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(post-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`preveto--${i}-${anotherKey++}`}>\n            <Centered noMargin={true}>\n                {interleave(\n                    log.nominationsPostVeto as any,\n                    (key) => (\n                        <br key={`preveto--br--${i}-${key++}`} />\n                    ),\n                    anotherKey\n                )}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`veto--${i}-${anotherKey++}`}>\n                <CenteredBold noMargin={true}>Veto Winner</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.vetoWinner === undefined) return;\n\n    cells.push(\n        <White key={`veto--${i}-${anotherKey++}`}>\n            <Centered noMargin={true}>{log.vetoWinner}</Centered>\n        </White>\n    );\n}\n\n// javascript is my passion\nfunction interleave<T>(arr: T[], thing: (key: number) => T, key: number): T[] {\n    return ([] as T[]).concat(...arr.map((n: T) => [n, thing(key++)])).slice(0, -1);\n}\n\nfunction generatePreVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`preveto--${i}-${anotherKey++}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(pre-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.nominationsPreVeto.length === 0 || log.vetoWinner === undefined) {\n        cells.push(\n            <White key={`preveto--${i}-${anotherKey++}`} rowSpan={2}>\n                <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n            </White>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`preveto--${i}-${anotherKey++}`}>\n            <Centered noMargin={true}>\n                {interleave(\n                    log.nominationsPreVeto as any,\n                    (key) => (\n                        <br key={`preveto--br--${i}-${key++}`} />\n                    ),\n                    anotherKey\n                )}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateTopRow(\n    log: EpisodeLog | undefined,\n    i: number,\n    cells: JSX.Element[],\n    max: number,\n    colspan: number\n) {\n    if (!log) {\n        cells.push(<Gray key={`toprow--${i}`} />);\n        return;\n    }\n    if (i === max) {\n        cells.push(\n            <Gray key={`toprow--${i}`} colSpan={2}>\n                <CenteredBold noMargin={true}>Finale</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <Gray key={`toprow--${i}`} colSpan={colspan}>\n            <CenteredBold noMargin={true}>Week {i}</CenteredBold>\n        </Gray>\n    );\n}\n","import React from \"react\";\nimport { GameState, getById } from \"../gameState\";\nimport { CenteredItallic, Centered } from \"../../components/layout/centered\";\nimport {\n    EndgameTableCell,\n    WinnerCell,\n    RunnerUpCell,\n    NomineeCell,\n    HohCell,\n    SaveCell,\n} from \"../../components/episode/scenes/votingTable\";\n\nlet voteKey = 0;\n\nfunction getKey(): string {\n    return `${voteKey++}-- vote key`;\n}\n\nexport interface VoteType {\n    id: number;\n    render: (state: GameState) => JSX.Element;\n}\n\nexport class SaveVote implements VoteType {\n    id: number;\n    render = (state: GameState) => (\n        <SaveCell key={getKey()}>\n            <Centered noMargin={true}>{getById(state, this.id).name}</Centered>\n        </SaveCell>\n    );\n    constructor(id: number) {\n        this.id = id;\n    }\n}\n\nexport class NormalVote implements VoteType {\n    id: number;\n    render = (state: GameState) => (\n        <EndgameTableCell key={getKey()}>\n            <Centered noMargin={true}>{getById(state, this.id).name}</Centered>\n        </EndgameTableCell>\n    );\n    constructor(id: number) {\n        this.id = id;\n    }\n}\n\nexport class WinnerVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <WinnerCell key={\"winner---\"}>\n            <Centered noMargin={true}>Winner</Centered>\n        </WinnerCell>\n    );\n}\n\nexport class RunnerUpVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <RunnerUpCell key={\"runnerUp---\"}>\n            <Centered noMargin={true}>Finalist</Centered>\n        </RunnerUpCell>\n    );\n}\n\nexport class NomineeVote implements VoteType {\n    id: number = -1;\n    evicted: boolean;\n    render = (state: GameState) => (\n        <NomineeCell key={getKey()}>\n            <CenteredItallic noMargin={true}>Nominated</CenteredItallic>\n        </NomineeCell>\n    );\n    constructor(evicted: boolean) {\n        this.evicted = evicted;\n    }\n}\n\nexport class HoHVote implements VoteType {\n    id: number;\n\n    get hohText(): JSX.Element {\n        return (\n            <CenteredItallic noMargin={true}>\n                Head of\n                <br />\n                Household\n            </CenteredItallic>\n        );\n    }\n\n    private hohVote(state: GameState): JSX.Element {\n        return <CenteredItallic noMargin={true}>{getById(state, this.id).name}</CenteredItallic>;\n    }\n\n    render = (state: GameState) => {\n        return <HohCell key={getKey()}>{this.id == -1 ? this.hohText : this.hohVote(state)}</HohCell>;\n    };\n    constructor(id?: number) {\n        this.id = id === undefined ? -1 : id;\n    }\n}\n","import { GameState, Houseguest, MutableGameState, randomPlayer } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { HoHVote } from \"../../../model/logging/voteType\";\n\ninterface HohCompOptions {\n    doubleEviction: boolean;\n    customText?: string;\n}\n\nexport function generateHohCompScene(\n    initialGameState: GameState,\n    options: HohCompOptions\n): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n    const doubleEviction = options.doubleEviction;\n    const previousHoh = initialGameState.previousHOH ? [initialGameState.previousHOH] : [];\n    const newHoH: Houseguest = randomPlayer(newGameState.houseguests, previousHoh);\n    newGameState.previousHOH = newHoH;\n    newGameState.currentLog.votes[newHoH.id] = new HoHVote();\n    newHoH.hohWins += 1;\n    const scene = new Scene({\n        title: \"HoH Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                {options.customText ? (\n                    <CenteredBold>{options.customText}</CenteredBold>\n                ) : (\n                    previousHoh.length > 0 &&\n                    (doubleEviction ? (\n                        <CenteredBold>\n                            Houseguests, please return to the living room. Tonight will be a{\" \"}\n                            {initialGameState.__logindex__ === 1 ? \"double\" : \"triple\"} eviction.\n                        </CenteredBold>\n                    ) : (\n                        <Centered>\n                            {`Houseguests, it's time to find a new Head of Household. As outgoing HoH, ${previousHoh[0].name} will not compete.`}\n                        </Centered>\n                    ))\n                )}\n                <Portrait centered={true} houseguest={newHoH} />\n                <CenteredBold>{newHoH.name} has won Head of Household!</CenteredBold>\n                <br />\n                {!doubleEviction && <NextEpisodeButton />}\n            </div>\n        ),\n    });\n\n    return [new GameState(newGameState), scene, newHoH];\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst ShadowBox = styled.div`\n    box-shadow: ${({ theme }: { theme: ColorTheme }) =>\n        theme.name === \"light\" ? \"0 2px 3px rgba(10, 10, 10, 0.1), 0 0 0 1px rgba(10, 10, 10, 0.1)\" : \"\"};\n    border-radius: 6px;\n    margin-left: 3px;\n    margin-top: 3px;\n    margin-right: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.overlay};\n`;\n\nconst StyledBox = styled.div`\n    margin-left: 3px;\n    margin-right: 3px;\n    margin-bottom: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bodyArea};\n`;\n\nexport function DividerBox(props: any): JSX.Element {\n    return <ShadowBox className={props.className || \"\"}>{props.children}</ShadowBox>;\n}\n\nexport function Box(props: any): JSX.Element {\n    return (\n        <StyledBox style={props.style} className={`box ${props.className || \"\"}`}>\n            {props.children}\n        </StyledBox>\n    );\n}\n","/*\n * Free FFT and convolution (TypeScript)\n *\n * Copyright (c) 2020 Project Nayuki. (MIT License)\n * https://www.nayuki.io/page/free-small-fft-in-multiple-languages\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\n * this software and associated documentation files (the \"Software\"), to deal in\n * the Software without restriction, including without limitation the rights to\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\n * the Software, and to permit persons to whom the Software is furnished to do so,\n * subject to the following conditions:\n * - The above copyright notice and this permission notice shall be included in\n *   all copies or substantial portions of the Software.\n * - The Software is provided \"as is\", without warranty of any kind, express or\n *   implied, including but not limited to the warranties of merchantability,\n *   fitness for a particular purpose and noninfringement. In no event shall the\n *   authors or copyright holders be liable for any claim, damages or other\n *   liability, whether in an action of contract, tort or otherwise, arising from,\n *   out of or in connection with the Software or the use or other dealings in the\n *   Software.\n */\n\n/*\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\n * The vector can have any length. This is a wrapper function.\n */\nexport function fft(real: number[] | Float64Array, imag: number[] | Float64Array): void {\n    const n: number = real.length;\n    if (n != imag.length) throw \"Mismatched lengths\";\n    if (n == 0) return;\n    else if ((n & (n - 1)) == 0)\n        // Is power of 2\n        transformRadix2(real, imag);\n    // More complicated algorithm for arbitrary sizes\n    else transformBluestein(real, imag);\n}\n\n/*\n * Computes the inverse discrete Fourier transform (IDFT) of the given complex vector, storing the result back into the vector.\n * The vector can have any length. This is a wrapper function. This transform does not perform scaling, so the inverse is not a true inverse.\n */\nexport function inverseFFT(real: Array<number> | Float64Array, imag: Array<number> | Float64Array): void {\n    fft(imag, real);\n}\n\n/*\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\n * The vector's length must be a power of 2. Uses the Cooley-Tukey decimation-in-time radix-2 algorithm.\n */\nfunction transformRadix2(real: Array<number> | Float64Array, imag: Array<number> | Float64Array): void {\n    // Length variables\n    const n: number = real.length;\n    if (n != imag.length) throw \"Mismatched lengths\";\n    if (n == 1)\n        // Trivial transform\n        return;\n    let levels: number = -1;\n    for (let i = 0; i < 32; i++) {\n        if (1 << i == n) levels = i; // Equal to log2(n)\n    }\n    if (levels == -1) throw \"Length is not a power of 2\";\n\n    // Trigonometric tables\n    let cosTable = new Array<number>(n / 2);\n    let sinTable = new Array<number>(n / 2);\n    for (let i = 0; i < n / 2; i++) {\n        cosTable[i] = Math.cos((2 * Math.PI * i) / n);\n        sinTable[i] = Math.sin((2 * Math.PI * i) / n);\n    }\n\n    // Bit-reversed addressing permutation\n    for (let i = 0; i < n; i++) {\n        const j: number = reverseBits(i, levels);\n        if (j > i) {\n            let temp: number = real[i];\n            real[i] = real[j];\n            real[j] = temp;\n            temp = imag[i];\n            imag[i] = imag[j];\n            imag[j] = temp;\n        }\n    }\n\n    // Cooley-Tukey decimation-in-time radix-2 FFT\n    for (let size = 2; size <= n; size *= 2) {\n        const halfsize: number = size / 2;\n        const tablestep: number = n / size;\n        for (let i = 0; i < n; i += size) {\n            for (let j = i, k = 0; j < i + halfsize; j++, k += tablestep) {\n                const l: number = j + halfsize;\n                const tpre: number = real[l] * cosTable[k] + imag[l] * sinTable[k];\n                const tpim: number = -real[l] * sinTable[k] + imag[l] * cosTable[k];\n                real[l] = real[j] - tpre;\n                imag[l] = imag[j] - tpim;\n                real[j] += tpre;\n                imag[j] += tpim;\n            }\n        }\n    }\n\n    // Returns the integer whose value is the reverse of the lowest 'width' bits of the integer 'val'.\n    function reverseBits(val: number, width: number): number {\n        let result: number = 0;\n        for (let i = 0; i < width; i++) {\n            result = (result << 1) | (val & 1);\n            val >>>= 1;\n        }\n        return result;\n    }\n}\n\n/*\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\n * The vector can have any length. This requires the convolution function, which in turn requires the radix-2 FFT function.\n * Uses Bluestein's chirp z-transform algorithm.\n */\nfunction transformBluestein(real: Array<number> | Float64Array, imag: Array<number> | Float64Array): void {\n    // Find a power-of-2 convolution length m such that m >= n * 2 + 1\n    const n: number = real.length;\n    if (n != imag.length) throw \"Mismatched lengths\";\n    let m: number = 1;\n    while (m < n * 2 + 1) m *= 2;\n\n    // Trigonometric tables\n    let cosTable = new Array<number>(n);\n    let sinTable = new Array<number>(n);\n    for (let i = 0; i < n; i++) {\n        const j: number = (i * i) % (n * 2); // This is more accurate than j = i * i\n        cosTable[i] = Math.cos((Math.PI * j) / n);\n        sinTable[i] = Math.sin((Math.PI * j) / n);\n    }\n\n    // Temporary vectors and preprocessing\n    let areal: Array<number> = newArrayOfZeros(m);\n    let aimag: Array<number> = newArrayOfZeros(m);\n    for (let i = 0; i < n; i++) {\n        areal[i] = real[i] * cosTable[i] + imag[i] * sinTable[i];\n        aimag[i] = -real[i] * sinTable[i] + imag[i] * cosTable[i];\n    }\n    let breal: Array<number> = newArrayOfZeros(m);\n    let bimag: Array<number> = newArrayOfZeros(m);\n    breal[0] = cosTable[0];\n    bimag[0] = sinTable[0];\n    for (let i = 1; i < n; i++) {\n        breal[i] = breal[m - i] = cosTable[i];\n        bimag[i] = bimag[m - i] = sinTable[i];\n    }\n\n    // Convolution\n    let creal = new Array<number>(m);\n    let cimag = new Array<number>(m);\n    convolveComplex(areal, aimag, breal, bimag, creal, cimag);\n\n    // Postprocessing\n    for (let i = 0; i < n; i++) {\n        real[i] = creal[i] * cosTable[i] + cimag[i] * sinTable[i];\n        imag[i] = -creal[i] * sinTable[i] + cimag[i] * cosTable[i];\n    }\n}\n\n/*\n * Computes the circular convolution of the given real vectors. Each vector's length must be the same.\n */\nfunction convolveReal(\n    xvec: Array<number> | Float64Array,\n    yvec: Array<number> | Float64Array,\n    outvec: Array<number> | Float64Array\n): void {\n    const n: number = xvec.length;\n    if (n != yvec.length || n != outvec.length) throw \"Mismatched lengths\";\n    convolveComplex(xvec, newArrayOfZeros(n), yvec, newArrayOfZeros(n), outvec, newArrayOfZeros(n));\n}\n\n/*\n * Computes the circular convolution of the given complex vectors. Each vector's length must be the same.\n */\nfunction convolveComplex(\n    xreal: Array<number> | Float64Array,\n    ximag: Array<number> | Float64Array,\n    yreal: Array<number> | Float64Array,\n    yimag: Array<number> | Float64Array,\n    outreal: Array<number> | Float64Array,\n    outimag: Array<number> | Float64Array\n): void {\n    const n: number = xreal.length;\n    if (\n        n != ximag.length ||\n        n != yreal.length ||\n        n != yimag.length ||\n        n != outreal.length ||\n        n != outimag.length\n    )\n        throw \"Mismatched lengths\";\n\n    xreal = xreal.slice();\n    ximag = ximag.slice();\n    yreal = yreal.slice();\n    yimag = yimag.slice();\n    fft(xreal, ximag);\n    fft(yreal, yimag);\n\n    for (let i = 0; i < n; i++) {\n        const temp: number = xreal[i] * yreal[i] - ximag[i] * yimag[i];\n        ximag[i] = ximag[i] * yreal[i] + xreal[i] * yimag[i];\n        xreal[i] = temp;\n    }\n    inverseFFT(xreal, ximag);\n\n    for (let i = 0; i < n; i++) {\n        // Scaling (because this FFT implementation omits it)\n        outreal[i] = xreal[i] / n;\n        outimag[i] = ximag[i] / n;\n    }\n}\n\nfunction newArrayOfZeros(n: number): Array<number> {\n    let result: Array<number> = [];\n    for (let i = 0; i < n; i++) result.push(0);\n    return result;\n}\n","// Homebrew typescript implementation of this:\n// https://www.researchgate.net/publication/257017356_On_computing_the_distribution_function_for_the_Poisson_binomial_distribution?enrichId=rgreq-6ff78e1a69dcaf49a733e2dd0e9f2db6-XXX&enrichSource=Y292ZXJQYWdlOzI1NzAxNzM1NjtBUzo1NTg0MDU5OTE1MzA0OTZAMTUxMDE0NTc3MTQ0Mw%3D%3D&el=1_x_3&_esc=publicationCoverPdf\n\nimport _ from \"lodash\";\nimport { fft } from \"./fft\";\n\n// Due to the high complexity of this function, it has been optimized for readability.\n// And even then, it's still pretty spooky.\n\nexport function pbincdf(pp: number[]): number[] {\n    const p: number[] = [];\n    const zeros: number[] = [];\n    const ones: number[] = [];\n    pp.forEach((num) => {\n        num === 0 && zeros.push(0);\n        num === 1 && ones.push(1);\n        num !== 0 && num !== 1 && p.push(num);\n    });\n    const cdf = _pbincdf(p);\n    cdf.forEach((number, i) => (cdf[i] = 1 - number));\n    const result = ones.concat(cdf, zeros);\n    return result;\n}\n\nfunction _pbincdf(p: number[]): number[] {\n    const n = p.length;\n    const nPlusOne = n + 1;\n    const ω = (2 * Math.PI) / nPlusOne;\n    const a = [1];\n    const b = [0];\n    // STEP 1 OF THE ALGORITHM\n    const sigmaLogModulusZ = (l: number): number => {\n        let sum = 0;\n        p.forEach((p_j) => {\n            const e1 = (1 - p_j + p_j * Math.cos(ω * l)) ** 2;\n            const e2 = (p_j * Math.sin(ω * l)) ** 2;\n            sum += 0.5 * Math.log(e1 + e2);\n        });\n        return sum;\n    };\n    const sigmaPrincipalArgz = (l: number): number => {\n        let sum = 0;\n        p.forEach((p_j) => {\n            const y = p_j * Math.sin(ω * l);\n            const x = 1 - p_j + p_j * Math.cos(ω * l);\n            sum += Math.atan2(y, x);\n        });\n        return sum;\n    };\n    for (let l = 1; l <= Math.ceil(n / 2); l++) {\n        const d = Math.exp(sigmaLogModulusZ(l));\n        const sigmaArgZ = sigmaPrincipalArgz(l);\n        a[l] = d * Math.cos(sigmaArgZ);\n        b[l] = d * Math.sin(sigmaArgZ);\n    }\n    // STEP 2 OF THE ALGORITHM\n    for (let l = Math.ceil(n / 2) + 1; l <= n; l++) {\n        a[l] = a[nPlusOne - l];\n        b[l] = -b[nPlusOne - l];\n    }\n    // STEP 3 OF THE ALGORITHM\n    fft(a, b);\n    const ξ = a;\n    // STEP 4 OF THE ALGORITHM\n    const result: number[] = [];\n    ξ.forEach((a, i) => (ξ[i] = a / nPlusOne));\n    result[0] = ξ[0];\n    ξ.forEach((_, m) => {\n        if (m === 0) return;\n        result[m] = result[m - 1] + ξ[m];\n    });\n    return result;\n}\n","import { Houseguest, GameState } from \"../../model\";\nimport { pbincdf } from \"../poissonbinomial\";\nimport { pJurorVotesForHero } from \"./aiApi\";\nimport { classifyRelationship } from \"./classifyRelationship\";\n\nexport const relationship = (hero: Houseguest, villain: Houseguest) => hero.relationships[villain.id];\n\nexport const RelationshipTypeToNumber = { FRIEND: 10, ENEMY: -10, PAWN: 0, QUEEN: +5 };\n\nexport const friendship = (hero: Houseguest, villain: Houseguest) =>\n    hero.relationshipWith(villain) +\n    RelationshipTypeToNumber[\n        classifyRelationship(hero.popularity, villain.popularity, hero.relationshipWith(villain))\n    ];\n\nexport function getBestFriend(hero: Houseguest, options: Houseguest[]) {\n    // take in the players and return the favourite, taking friend/enemy/nonmutual into account.\n    return highestScore(hero, options, friendship);\n}\n\nexport function favouriteIndex(hero: Houseguest, options: Houseguest[]) {\n    // Return the index of the houseguest that hero has the highest relationship % with.\n    return highestScore(hero, options, relationship);\n}\n\nfunction highestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let highestIndex = 0;\n    let highestScore = -Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore > highestScore) {\n            highestIndex = i;\n            highestScore = currentScore;\n        }\n    });\n    return highestIndex;\n}\nexport function lowestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let lowestIndex = 0;\n    let lowestScore = Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore < lowestScore) {\n            lowestIndex = i;\n            lowestScore = currentScore;\n        }\n    });\n    return lowestIndex;\n}\n\n// returns the probability that the hero wins the f2 between hero and villian\nexport function pHeroWinsTheFinale(\n    hgs: { hero: Houseguest; villain: Houseguest },\n    jury: Houseguest[]\n): number {\n    const hero = hgs.hero;\n    const villain = hgs.villain;\n    const p: number[] = [];\n    jury.forEach((juror) => {\n        if (juror.id === hero.id || juror.id === villain.id) return;\n        p.push(pJurorVotesForHero(juror, hero, villain));\n    });\n    const cdf = pbincdf(p);\n    return cdf[Math.ceil((jury.length - 2) / 2) - 1];\n}\n","import _ from \"lodash\";\nimport { GameState, getById, Houseguest } from \"../../model\";\nimport { classifyRelationship, RelationshipType } from \"./classifyRelationship\";\n\ninterface RelationshipSummary {\n    type: RelationshipType;\n    relationship: number;\n    winrate: number;\n    id: number;\n    pHeroWins: number;\n    villainPopularity: number;\n}\n\nconst deadValue: RelationshipSummary = {\n    type: RelationshipType.Friend,\n    id: -1,\n    pHeroWins: -1,\n    winrate: -1,\n    relationship: 2,\n    villainPopularity: 2,\n};\n\nexport function getRelationshipSummary(hero: Houseguest, villain: Houseguest): RelationshipSummary {\n    const doIWin = hero.superiors[villain.id];\n    const type = classifyRelationship(hero.popularity, villain.popularity, hero.relationshipWith(villain));\n    return {\n        id: villain.id,\n        relationship: villain.relationshipWith(hero),\n        type,\n        winrate: hero.powerRanking,\n        pHeroWins: doIWin,\n        villainPopularity: villain.popularity,\n    };\n}\n\nexport class Targets {\n    private firstTarget: RelationshipSummary = deadValue;\n    private secondTarget: RelationshipSummary = deadValue;\n    private hg: Houseguest;\n\n    constructor(hg: Houseguest) {\n        this.hg = hg;\n    }\n\n    public getTargets(): [number, number] {\n        return [this.firstTarget.id, this.secondTarget.id];\n    }\n    public addTarget(newTarget: RelationshipSummary, gameState: GameState) {\n        if (\n            !(\n                isBetterTarget(this.firstTarget, newTarget, this.hg, gameState) ||\n                isBetterTarget(this.secondTarget, newTarget, this.hg, gameState)\n            )\n        )\n            return;\n        isBetterTarget(this.firstTarget, this.secondTarget, this.hg, gameState)\n            ? (this.firstTarget = newTarget)\n            : (this.secondTarget = newTarget);\n    }\n}\n\n// TODO: merge vote logic with nomination logic\n\n// Statusquo goes with the status quo, underdog tries to disrupt & go after big targets, MoR goes after his personal targets\nexport enum TargetStrategy {\n    StatusQuo,\n    Underdog,\n    MoR,\n}\n\nfunction determineStrategy(hero: Houseguest): TargetStrategy {\n    if (hero.friends === hero.enemies) return TargetStrategy.MoR;\n    return hero.friends > hero.enemies ? TargetStrategy.StatusQuo : TargetStrategy.Underdog;\n}\n\nexport function isBetterTarget(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    hero: Houseguest,\n    gameState: GameState\n): boolean {\n    if (old.relationship === 2) return true;\n    const strategy = determineStrategy(hero);\n    if (strategy === TargetStrategy.StatusQuo) return isBetterTargetStatusQuo(old, neww);\n    else if (strategy === TargetStrategy.MoR) {\n        return isBetterTargetMoR(old, neww, gameState, hero);\n    } else {\n        return isBetterTargetUnderdog(old, neww, gameState, hero);\n    }\n}\n\nfunction isBetterTargetMoR(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    gameState: GameState,\n    hero: Houseguest\n): boolean {\n    // Is the old target a non-enemy? Then neww is a better target if he is an enemy, or if he's a worse non-enemy.\n    if (old.type !== RelationshipType.Enemy) {\n        return neww.type === RelationshipType.Enemy ? true : neww.relationship < old.relationship;\n    }\n    // So, the old target is an enemy? Then neww must be an enemy to be a better target.\n    // If they are both enemies, the more popular enemy is a better target.\n    if (neww.type !== RelationshipType.Enemy) return false;\n\n    let { oldPop, newPop }: { oldPop: number; newPop: number } = computeLocalPopularity(\n        gameState,\n        hero,\n        old,\n        neww,\n        (x: RelationshipType) => x === RelationshipType.Enemy\n    );\n    return oldPop < newPop;\n}\n\nfunction isBetterTargetUnderdog(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    gameState: GameState,\n    hero: Houseguest\n): boolean {\n    // Is the old target a friend? Then neww is a better target if he is NOT a friend, or if he's a worse friend.\n    if (old.type === RelationshipType.Friend) {\n        return neww.type !== RelationshipType.Friend ? true : neww.relationship < old.relationship;\n    }\n    // So, the old target isn't a friend? Then neww will never be a better target if he is a friend.\n    if (neww.type === RelationshipType.Friend) return false;\n    // But if neww isn't a friend, then the best target is the more central of the two non-friends.\n    let { oldPop, newPop }: { oldPop: number; newPop: number } = computeLocalPopularity(\n        gameState,\n        hero,\n        old,\n        neww,\n        (x: RelationshipType) => x !== RelationshipType.Friend\n    );\n    return oldPop < newPop;\n}\n// computes the popularity of houseguests old and neww,\n// only taking into account houseguests that have relationship type x with hero\n// satisfying the boolean condition you pass in\nfunction computeLocalPopularity(\n    gameState: GameState,\n    hero: Houseguest,\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    condition: (x: RelationshipType) => boolean\n) {\n    const nonFriends: Houseguest[] = Array.from(gameState.nonEvictedHouseguests)\n        .map((hg) => getById(gameState, hg))\n        .filter(\n            (villain) =>\n                condition(\n                    classifyRelationship(hero.popularity, villain.popularity, hero.relationshipWith(villain))\n                ) && hero.id !== villain.id\n        );\n    let oldPop: number = 0;\n    const oldHg: Houseguest = getById(gameState, old.id);\n    let newPop: number = 0;\n    const newHg: Houseguest = getById(gameState, neww.id);\n    nonFriends.forEach((hg) => {\n        if (hg.id !== oldHg.id) {\n            oldPop += oldHg.relationshipWith(hg);\n        }\n        if (hg.id !== newHg.id) {\n            newPop += newHg.relationshipWith(hg);\n        }\n    });\n    return { oldPop, newPop };\n}\n\nfunction isBetterTargetStatusQuo(old: RelationshipSummary, neww: RelationshipSummary) {\n    const newRank = rankRelationshipSummaryStatusQuo(neww);\n    const oldRank = rankRelationshipSummaryStatusQuo(old);\n    if (newRank > oldRank) return false;\n    if (newRank < oldRank) return true;\n    return neww.relationship < old.relationship;\n}\n\nfunction rankRelationshipSummaryStatusQuo(r: RelationshipSummary): number {\n    if (r.type === RelationshipType.Enemy) return 1;\n    if (r.type === RelationshipType.Friend) return 3;\n    return 2;\n}\n","import { Houseguest, GameState, inJury, exclude } from \"../../model\";\nimport { rng } from \"../BbRandomGenerator\";\nimport { relationship, lowestScore } from \"./aiUtils\";\nimport {\n    classifyRelationship,\n    classifyTwoWayRelationship,\n    RelationshipType as Relationship,\n} from \"./classifyRelationship\";\nimport { getRelationshipSummary, isBetterTarget } from \"./targets\";\n\nexport interface NumberWithLogic {\n    decision: number;\n    reason: string;\n}\n\ninterface HouseguestWithLogic {\n    decision: Houseguest | null;\n    reason: string;\n}\n\n// Return the index of the eviction target.\n\n// vote to save, in the future, generalize this to n nominees instead of going 2 by 2\nexport function castVoteToSave(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): NumberWithLogic {\n    if (nominees.length === 0) throw new Error(\"Tried to cast a vote to save with no nominees.\");\n    let currentSave: NumberWithLogic = { decision: 0, reason: \"\" };\n    nominees.forEach((nominee, i) => {\n        if (i === 0) return;\n        const evictionTarget = castEvictionVote(hero, [nominee, nominees[currentSave.decision]], gameState);\n        if (!currentSave.reason) {\n            currentSave.reason = evictionTarget.reason;\n        }\n        if (evictionTarget.decision === 1) {\n            currentSave = { decision: i, reason: evictionTarget.reason };\n        }\n    });\n    return currentSave;\n}\n\n// returns the index in the array of the person you're voting to evict\nexport function castEvictionVote(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): NumberWithLogic {\n    if (inJury(gameState)) {\n        return cutthroatVoteJury(hero, nominees, gameState);\n    } else {\n        return cutthroatVote(hero, nominees);\n    }\n}\n\nfunction winningOddsF3(hero: Houseguest, villain1: Houseguest, villain2: Houseguest): number {\n    // chance that hero wins final HoH\n    const heroVs1: number = hero.superiors[villain1.id];\n    const heroVs2: number = hero.superiors[villain2.id];\n    const v1Vs2: number = villain1.superiors[villain2.id];\n\n    if (heroVs1 === undefined)\n        throw new Error(\n            `Tried to get a power comparison that does not exist between ${hero.name} and ${villain1.name} [1]`\n        );\n    if (heroVs2 === undefined)\n        throw new Error(\n            `Tried to get a power comparison that does not exist between ${hero.name} and ${villain2.name} [2]`\n        );\n    if (v1Vs2 === undefined)\n        throw new Error(\n            `Tried to get a power comparison that does not exist between ${villain1.name} and ${villain2.name} [3]`\n        );\n    const heroWins: number = Math.max(heroVs1, heroVs2); // evict the person who beats you more often\n    const v1wins: number = castF3Vote(villain1, hero, villain2).decision === 0 ? 0 : heroVs1;\n    const v2wins: number = castF3Vote(villain2, hero, villain1).decision === 0 ? 0 : heroVs2;\n    return (1 / 3) * heroWins + (1 / 3) * v1wins + (1 / 3) * v2wins;\n}\n\nfunction castF3Vote(hero: Houseguest, nom0: Houseguest, nom1: Houseguest): NumberWithLogic {\n    const decision = hero.superiors[nom0.id] < hero.superiors[nom1.id] ? 0 : 1;\n    return {\n        decision,\n        reason: `I have better odds of beating ${decision ? nom0.name : nom1.name} in the final 2.`,\n    };\n}\n\nfunction castF4vote(hero: Houseguest, nom0: Houseguest, nom1: Houseguest, HoH: Houseguest): NumberWithLogic {\n    const evictNom0 = winningOddsF3(hero, nom1, HoH);\n    const evictNom1 = winningOddsF3(hero, nom0, HoH);\n    const decision = evictNom0 > evictNom1 ? 0 : 1;\n    return {\n        decision,\n        reason: `Evicting ${\n            [nom0, nom1][decision].name\n        } gives me better odds of making it to the end and winning.`,\n    };\n}\n\nfunction cutthroatVoteJury(hero: Houseguest, nominees: Houseguest[], gameState: GameState): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    // In the F3 vote, take the person who you have better odds against to F2\n    if (gameState.remainingPlayers === 3) {\n        return castF3Vote(hero, nom0, nom1);\n    }\n    // In the F4 vote, do some genius level mathematics to predict what gives you the best odds of winning given that the\n    // person who wins the F3 HoH will evict the person they have the worst odds against\n    if (gameState.remainingPlayers === 4) {\n        return castF4vote(\n            hero,\n            nom0,\n            nom1,\n            // all this work just to get the HoH...\n            exclude(\n                Array.from(gameState.nonEvictedHouseguests.values()).map(\n                    (id) => gameState.houseguestCache[id]\n                ),\n                [nom0, nom1, hero]\n            )[0]\n        );\n    }\n    if (hero.powerRanking >= 0.45) {\n        // with a high enough winrate, vote normally\n        return cutthroatVote(hero, nominees);\n    } else if (hero.powerRanking <= 1 / 3) {\n        // with a very low winrate, vote based on winrate\n        return voteBasedOnWinrate();\n    } else {\n        // with a sort of low winrate, break ties with winrate\n        const r0 = classifyTwoWayRelationship(hero.popularity, nom0.popularity, hero.relationships[nom0.id]);\n        const r1 = classifyTwoWayRelationship(hero.popularity, nom1.popularity, hero.relationships[nom1.id]);\n        return r0 === r1 ? voteBasedOnWinrate() : cutthroatVote(hero, nominees);\n    }\n\n    function voteBasedOnWinrate() {\n        const heroBeatsnom0 = hero.powerRanking < hero.superiors[nom0.id];\n        const heroBeatsnom1 = hero.powerRanking < hero.superiors[nom1.id];\n\n        // if i am voting between 2 people who i can't beat, vote based on relationship\n        if (!heroBeatsnom0 && !heroBeatsnom1) {\n            return cutthroatVote(hero, nominees);\n        }\n        // otherwise, vote based on relationship\n\n        const decision = hero.superiors[nom0.id] < hero.superiors[nom1.id] ? 0 : 1;\n        return {\n            decision,\n            reason: `I can't beat ${nominees[decision].name} in the end.`,\n        };\n    }\n}\n\n// only works for 2 nominees\nfunction cutthroatVote(hero: Houseguest, nominees: Houseguest[]): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    const r0 = classifyRelationship(hero.popularity, nom0.popularity, hero.relationships[nom0.id]);\n    const r1 = classifyRelationship(hero.popularity, nom1.popularity, hero.relationships[nom1.id]);\n\n    const nom0isTarget = hero.targets[0] === nom0.id || hero.targets[1] === nom0.id;\n    const nom1isTarget = hero.targets[0] === nom1.id || hero.targets[1] === nom1.id;\n    // KILL TARGETS FIRST\n    if ((nom0isTarget && !nom1isTarget) || (nom1isTarget && !nom0isTarget)) {\n        const decision = nom0isTarget ? 0 : 1;\n        return {\n            decision,\n            reason: `I am targeting ${nominees[decision].name}.`,\n        };\n    }\n\n    if (r0 === Relationship.Enemy && r1 === Relationship.Enemy) {\n        const decision = hero.relationships[nom0.id] < hero.relationships[nom1.id] ? 0 : 1;\n        return {\n            decision,\n            reason: `I dislike ${nominees[decision].name} the most of these enemies.`,\n        };\n    } else if (\n        (r0 === Relationship.Enemy && r1 !== Relationship.Enemy) ||\n        (r1 === Relationship.Enemy && r0 !== Relationship.Enemy)\n    ) {\n        const vote = r0 === Relationship.Enemy ? 0 : 1;\n        return { decision: vote, reason: `${nominees[vote].name} is my enemy.` };\n    } else if (\n        (r0 !== Relationship.Friend && r1 === Relationship.Friend) ||\n        (r1 !== Relationship.Friend && r0 === Relationship.Friend)\n    ) {\n        const vote = r0 !== Relationship.Friend ? 0 : 1;\n        const nonVote = vote === 0 ? 1 : 0;\n        return { decision: vote, reason: `${nominees[nonVote].name} is my friend.` };\n    }\n    const vote = lowestScore(hero, nominees, relationship);\n    return {\n        decision: vote,\n        reason: `I like ${nominees[vote === 0 ? 1 : 0].name} the most of these friends.`,\n    };\n}\n\nexport function backdoorNPlayers(\n    hero: Houseguest,\n    options: Houseguest[],\n    gameState: GameState,\n    n: number\n): NumberWithLogic[] {\n    const result: NumberWithLogic[] = [];\n    const sortedOptions = [...options];\n    // negative value if first is less than second\n    sortedOptions.sort((hg1, hg2) => {\n        return isBetterTarget(\n            getRelationshipSummary(hero, hg1),\n            getRelationshipSummary(hero, hg2),\n            hero,\n            gameState\n        )\n            ? 1\n            : -1;\n    });\n\n    while (result.length < n) {\n        const decision = sortedOptions[result.length];\n        const reason = \"I think you are ugly\";\n        result.push({ decision: decision.id, reason });\n    }\n    return result;\n}\n\nexport function useGoldenVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState,\n    HoH: number\n): HouseguestWithLogic {\n    if (hero.id === HoH) {\n        return { decision: null, reason: \"I support my original nominations.\" };\n    }\n    for (const nom of nominees) {\n        if (hero.id === nom.id) return { decision: hero, reason: \"I am going to save myself.\" };\n    }\n    // if you're not nominated, don't use the veto if you are the only replacement nominee\n    if (gameState.remainingPlayers - 1 - nominees.length === 1) {\n        return {\n            decision: null,\n            reason: \"It doesn't make sense to use the veto here.\",\n        };\n    }\n    return useGoldenVetoPreJury(hero, nominees, gameState) || null;\n}\n\nfunction useGoldenVetoPreJury(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): HouseguestWithLogic {\n    let reason = \"None of these nominees are my friends.\";\n    let potentialSave: Houseguest | null = null;\n    let alwaysSave: Houseguest | null = null;\n    nominees.forEach((nominee) => {\n        // TODO: Save people who you can beat in the end if you are low winrate\n        const relationship = classifyRelationship(\n            hero.popularity,\n            nominee.popularity,\n            hero.relationshipWith(nominee)\n        );\n        if (relationship === Relationship.Friend) {\n            if (potentialSave) {\n                potentialSave =\n                    hero.relationshipWith(nominee) > hero.relationshipWith(potentialSave)\n                        ? nominee\n                        : potentialSave;\n                reason = `Of these noms, I like ${potentialSave.name} the most.`;\n            } else {\n                reason = `${nominee.name} is my friend.`;\n                potentialSave = nominee;\n            }\n        }\n    });\n    if (alwaysSave) {\n        return { decision: alwaysSave, reason };\n    } else if (potentialSave) {\n        return { decision: potentialSave, reason };\n    } else {\n        return { decision: null, reason };\n    }\n}\n\nexport function pJurorVotesForHero(juror: Houseguest, hero: Houseguest, villain: Houseguest): number {\n    const r1 = juror.relationshipWith(hero);\n    const r2 = juror.relationshipWith(villain);\n    const delta = (r1 - r2) / 2;\n    let result = 0.5 + delta;\n    if (result > 1) result = 1;\n    if (result < 0) result = 0;\n    return result;\n}\n\n// Returns the index of the finalist with the highest relationship with juror\n// only works with 2 finalists\nexport function castJuryVote(juror: Houseguest, finalists: Houseguest[]): number {\n    const choice = Math.abs(rng().randomFloat());\n    return choice > pJurorVotesForHero(juror, finalists[0], finalists[1]) ? 1 : 0;\n}\n","import { GameState, Houseguest, MutableGameState, getById, exclude } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { shuffle } from \"lodash\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { backdoorNPlayers } from \"../../../utils/ai/aiApi\";\n\ninterface NomCeremonyOptions {\n    doubleEviction: boolean;\n    thirdNominee?: boolean;\n}\n\nexport function generateNomCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    options: NomCeremonyOptions\n): [GameState, Scene, Houseguest[]] {\n    const newGameState = new MutableGameState(initialGameState);\n    const doubleEviction = options.doubleEviction;\n    const [nom1, nom2] = [getById(newGameState, HoH.targets[0]), getById(newGameState, HoH.targets[1])];\n    nom1.nominations++;\n    nom2.nominations++;\n    newGameState.currentLog.nominationsPreVeto = [nom1.name, nom2.name];\n    let nom3: Houseguest | undefined;\n    if (options.thirdNominee) {\n        nom3 = getById(\n            newGameState,\n            backdoorNPlayers(HoH, exclude(newGameState.houseguests, [HoH, nom1, nom2]), newGameState, 1)[0]\n                .decision\n        );\n        nom3.nominations++;\n        newGameState.currentLog.nominationsPreVeto.push(nom3.name);\n    }\n    newGameState.currentLog.nominationsPreVeto = require(\"alphanum-sort\")(\n        newGameState.currentLog.nominationsPreVeto\n    );\n    const noms = nom3 ? shuffle([nom1, nom2, nom3]) : shuffle([nom1, nom2]);\n    const finalStatement = options.thirdNominee\n        ? `I have nominated you, ${noms[0].name}, ${noms[1].name}, and ${noms[2].name} for eviction. `\n        : `I have nominated you, ${noms[0].name} and you, ${noms[1].name} for eviction.`;\n    const scene = new Scene({\n        title: \"Nomination Ceremony\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    {!doubleEviction &&\n                        `This is the nomination ceremony. It is my responsibility as the Head of Household to\n                    nominate ${options.thirdNominee ? `three` : `two`} houseguests for eviction.`}\n                </Centered>\n                {!doubleEviction && <Portrait centered={true} houseguest={HoH} />}\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Centered> My first nominee is...</Centered>\n                        <Portrait centered={true} houseguest={noms[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Centered>My second nominee is...</Centered>\n                        <Portrait centered={true} houseguest={noms[1]} />\n                    </DividerBox>\n                    {options.thirdNominee && (\n                        <DividerBox className=\"column\">\n                            <Centered>My third nominee is...</Centered>\n                            <Portrait centered={true} houseguest={noms[2]} />\n                        </DividerBox>\n                    )}\n                </div>\n                <CenteredBold>{finalStatement}</CenteredBold>\n                <br />\n                {!doubleEviction && <NextEpisodeButton />}\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, noms];\n}\n","export function listNames(names: string[]): string {\n    if (names.length === 0) {\n        return \"\";\n    }\n    if (names.length === 1) {\n        return names[0];\n    }\n    if (names.length === 2) {\n        return names[0] + \" and \" + names[1];\n    }\n    return names.slice(0, names.length - 1).join(\", \") + \", and \" + names[names.length - 1];\n}\n\nexport function listVotes(votes: string[]): string {\n    if (votes.length === 0) {\n        return \"\";\n    }\n    if (votes.length === 1) {\n        return votes[0];\n    }\n    if (votes.length === 2) {\n        return votes[0] + \" to \" + votes[1];\n    }\n    return votes.slice(0, votes.length - 1).join(` - `) + ` - ` + votes[votes.length - 1];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById,\n} from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { listNames } from \"../../../utils/listStrings\";\nimport { Veto } from \"../veto/veto\";\n\nexport function generateVetoCompScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nominees: Houseguest[],\n    veto: Veto,\n    doubleEviction: boolean = false\n): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    // pick players\n    const choices = nonEvictedHouseguests(newGameState);\n    let povPlayers: any[] = [];\n    const everyoneWillPlay = choices.length <= 6;\n\n    if (everyoneWillPlay) {\n        povPlayers.push({ ...HoH });\n        nominees.forEach((nominee) => povPlayers.push({ ...nominee }));\n        while (povPlayers.length < choices.length) {\n            povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        }\n    } else {\n        povPlayers.push({ ...HoH });\n        nominees.forEach((nominee) => povPlayers.push({ ...nominee }));\n        while (povPlayers.length < 6) {\n            povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        }\n    }\n    let povWinner = randomPlayer(povPlayers);\n    povWinner = getById(newGameState, povWinner.id);\n    povWinner.povWins++;\n    newGameState.currentLog.vetoWinner = povWinner.name;\n    let introText: string;\n    if (everyoneWillPlay) {\n        introText = \"Everyone left in the house will compete in this challenge.\";\n    } else {\n        introText = `${HoH.name}, as Head of Household, and ${listNames(\n            nominees.map((nom) => nom.name)\n        )} as nominees, will compete, as well as ${6 - 1 - nominees.length} others chosen by random draw.`; // this line assumes hoh plays in veto (-1)\n    }\n    const extras = nominees[2] ? [] : [povPlayers[3]];\n    const firstRow = [povPlayers[0], povPlayers[1], povPlayers[2]];\n    nominees[2] && firstRow.push(povPlayers[3]);\n    povPlayers[4] && extras.push(povPlayers[4]);\n    povPlayers[5] && extras.push(povPlayers[5]);\n    const scene = new Scene({\n        title: \"Veto Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>\n                    {doubleEviction\n                        ? \"The houseguests compete in the veto competition.\"\n                        : \"It's time to pick players for the veto competition.\"}\n                </Centered>\n                <Portraits centered={true} houseguests={firstRow} />\n                {!doubleEviction && <Centered>{introText}</Centered>}\n                <Portraits centered={true} houseguests={extras} />\n                <Centered>...</Centered>\n                <Portraits centered={true} houseguests={[povWinner]} />\n                <CenteredBold>{`${povWinner.name} has won the ${veto.name}!`}</CenteredBold>\n                {!doubleEviction && <NextEpisodeButton />}\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, povWinner];\n}\n","import { GameState, Houseguest, getById, exclude } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { useGoldenVeto, backdoorNPlayers } from \"../../../utils/ai/aiApi\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { listNames } from \"../../../utils/listStrings\";\nimport _ from \"lodash\";\n\ninterface VetoCeremonyOptions {\n    doubleEviction: boolean;\n    finalNominees: number; // TODO: this does nothing, replace with nameReplacement? / forceUse? idk.\n}\n\nexport function generateVetoCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    initialNominees: Houseguest[],\n    povWinner: Houseguest,\n    options: VetoCeremonyOptions\n): [GameState, Scene, Houseguest[]] {\n    const doubleEviction = options.doubleEviction;\n    let povTarget: Houseguest | null = null;\n    let descisionText = \"\";\n\n    initialNominees = initialNominees.map((nominee) => {\n        return getById(initialGameState, nominee.id);\n    });\n    HoH = getById(initialGameState, HoH.id);\n    const vetoChoice = useGoldenVeto(povWinner, initialNominees, initialGameState, HoH.id);\n\n    let nomineeWonPov = false;\n    initialNominees.forEach((nom) => nom.id === povWinner.id && (nomineeWonPov = true));\n\n    povTarget = vetoChoice.decision;\n    if (!povTarget) {\n        descisionText += \"... not to use the power of veto.\";\n    } else if (nomineeWonPov) {\n        descisionText += \"...to use the power of veto on myself.\";\n    } else {\n        descisionText += `...to use the power of veto on ${povTarget.name}.`;\n    }\n    let replacementSpeech = \"\";\n    let nameAReplacement = \"\";\n    let finalNominees: any[] = [...initialNominees];\n    if (povTarget) {\n        const HoHwonPoV = HoH.id === povWinner.id;\n        nameAReplacement += HoHwonPoV\n            ? `Since I have just vetoed one of my nominations, I must name a replacement nominee.`\n            : `${HoH.name}, since I have just vetoed one of your nominations, you must name a replacement nominee.`;\n        const replacementNom = {\n            ...getById(\n                initialGameState,\n                backdoorNPlayers(\n                    HoH,\n                    exclude(initialGameState.houseguests, [HoH, ...initialNominees, povWinner]),\n                    initialGameState,\n                    1\n                )[0].decision\n            ),\n        };\n        const replacementIndex = initialNominees.findIndex((hg) => hg.id === vetoChoice.decision!.id);\n        finalNominees[replacementIndex] = replacementNom;\n        replacementNom.nominations++;\n        getById(initialGameState, replacementNom.id).nominations++;\n        replacementSpeech = `My replacement nominee is ${replacementNom.name}.`;\n    }\n    const nomineeNames = initialNominees.map((nom) => nom.name);\n    const scene = new Scene({\n        title: \"Veto Ceremony\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                {!doubleEviction && <Centered>This is the Veto Ceremony.</Centered>}\n                {!doubleEviction && (\n                    <Centered>\n                        {`${listNames(nomineeNames)} have been nominated for eviction, \n                    but I have the power to veto one of these nominations.`}\n                    </Centered>\n                )}\n                <div className=\"columns is-marginless is-centered\">\n                    {initialNominees.map((nom, i) => (\n                        <DividerBox className=\"column\" key={`nominee-${i}`}>\n                            <Portrait centered={true} houseguest={nom} />\n                        </DividerBox>\n                    ))}\n                </div>\n                <CenteredBold>\n                    I have decided... <br />\n                </CenteredBold>\n                <Portrait centered={true} houseguest={{ ...povWinner, tooltip: vetoChoice.reason }} />\n                <CenteredBold noMargin={true}>{descisionText}</CenteredBold>\n                <Centered>{nameAReplacement}</Centered>\n                {replacementSpeech && <Portrait centered={true} houseguest={HoH} />}\n                <CenteredBold>{replacementSpeech}</CenteredBold>\n                <div className=\"columns is-marginless is-centered\">\n                    {finalNominees.map((nom, i) => (\n                        <DividerBox className=\"column\" key={`final-nominee-${i}`}>\n                            <Portrait centered={true} houseguest={nom} />\n                        </DividerBox>\n                    ))}\n                </div>\n                {!doubleEviction && <NextEpisodeButton />}\n            </div>\n        ),\n    });\n    initialGameState.currentLog.nominationsPostVeto = require(\"alphanum-sort\")(\n        finalNominees.map((nom) => nom.name)\n    );\n    return [initialGameState, scene, finalNominees];\n}\n","import _ from \"lodash\";\nimport {\n    Houseguest,\n    GameState,\n    nonEvictedHouseguests,\n    calculatePopularity,\n    getById,\n    getJurors,\n    inJury,\n    MutableGameState,\n} from \"../../../model\";\nimport { getFinalists } from \"../../../model/season\";\nimport { average, roundTwoDigits } from \"../../../utils\";\nimport { pHeroWinsTheFinale } from \"../../../utils/ai/aiUtils\";\nimport { classifyRelationship, RelationshipType } from \"../../../utils/ai/classifyRelationship\";\nimport { Targets, getRelationshipSummary } from \"../../../utils/ai/targets\";\n\nexport function evictHouseguest(gameState: MutableGameState, id: number): GameState {\n    const evictee = getById(gameState, id);\n    if (gameState.currentLog) gameState.currentLog.evicted.push(evictee.id);\n    evictee.isEvicted = true;\n    if (gameState.remainingPlayers - getFinalists() <= gameState.finalJurySize()) {\n        evictee.isJury = true;\n    }\n    gameState.nonEvictedHouseguests.delete(evictee.id);\n    gameState.remainingPlayers--;\n    refreshHgStats(gameState);\n    return gameState;\n}\n\nexport function refreshHgStats(gameState: MutableGameState, updateDelta: boolean = false) {\n    if (inJury(gameState) && getJurors(gameState).length === 0) {\n        populateSuperiors(nonEvictedHouseguests(gameState));\n    }\n    if (inJury(gameState)) {\n        updatePowerRankings(nonEvictedHouseguests(gameState));\n    }\n    updatePopularity(gameState, updateDelta);\n    gameState.remainingPlayers > 2 && updateFriendCounts(gameState);\n}\n\nfunction populateSuperiors(houseguests: Houseguest[]) {\n    for (let i = 0; i < houseguests.length; i++) {\n        const hero = houseguests[i];\n        for (let j = i + 1; j < houseguests.length; j++) {\n            const villain = houseguests[j];\n            const pHeroWins = pHeroWinsTheFinale({ hero, villain }, houseguests);\n            hero.superiors[villain.id] = pHeroWins;\n            villain.superiors[hero.id] = 1 - pHeroWins;\n        }\n    }\n}\n\nfunction updatePowerRankings(houseguests: Houseguest[]) {\n    houseguests.forEach((hg) => {\n        let superiors: { [id: number]: number } = { ...hg.superiors };\n        const nonEvictedHouseguests: Set<number> = new Set<number>(houseguests.map((h) => h.id));\n        superiors = _.filter(superiors, (_, id) => nonEvictedHouseguests.has(parseInt(id)));\n        hg.powerRanking = average(Object.values(superiors));\n    });\n}\n\nfunction updatePopularity(gameState: GameState, updateDelta: boolean = false) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach((hg) => {\n        hg.targetingMe = 0;\n        const result = calculatePopularity(hg, nonEvictedHouseguests(gameState));\n        if (updateDelta)\n            hg.deltaPopularity = (roundTwoDigits(result) - roundTwoDigits(hg.previousPopularity)) / 100;\n        hg.popularity = result;\n    });\n}\n\nfunction updateFriendCounts(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach((hero: Houseguest) => {\n        let targets = new Targets(hero);\n        let friends = 0;\n        let enemies = 0;\n        houseguests.forEach((villain) => {\n            if (hero.id === villain.id) return;\n            const type = classifyRelationship(\n                hero.popularity,\n                villain.popularity,\n                hero.relationshipWith(villain)\n            );\n            if (type === RelationshipType.Friend) {\n                friends++;\n            } else if (type === RelationshipType.Enemy) {\n                enemies++;\n            }\n        });\n        hero.friends = friends;\n        hero.enemies = enemies;\n        houseguests.forEach((villain) => {\n            if (hero.id === villain.id) return;\n            targets.addTarget(getRelationshipSummary(hero, villain), gameState);\n        });\n        hero.targets = targets.getTargets();\n        hero.targets.forEach((target) => {\n            getById(gameState, target).targetingMe++;\n        });\n    });\n}\n","import { BigBrotherVanilla } from \"../components/episode/bigBrotherEpisode\";\nimport { GameState } from \"./gameState\";\nimport { Episode, EpisodeType, nextEpisode } from \".\";\nimport { BigBrotherFinale } from \"../components/episode/bigBrotherFinale\";\nimport { GameOver } from \"../components/episode/gameOver\";\n\nexport function getFinalists() {\n    return 2;\n}\n\nexport interface EpisodeLibrary {\n    [id: number]: EpisodeType;\n}\n\nexport class Season {\n    private episodeLibrary: EpisodeLibrary = {};\n\n    public constructor(episodeLibrary?: EpisodeLibrary) {\n        if (episodeLibrary) this.episodeLibrary = episodeLibrary;\n    }\n\n    public renderEpisode(gameState: GameState): Episode {\n        return nextEpisode(gameState, this.whichEpisodeType(gameState.remainingPlayers));\n    }\n\n    public whichEpisodeType(players: number) {\n        if (players === 3) {\n            return BigBrotherFinale;\n        }\n        if (players === 2) {\n            return GameOver;\n        }\n        if (this.episodeLibrary[players]) {\n            return this.episodeLibrary[players];\n        }\n        return BigBrotherVanilla;\n    }\n}\n","import { Houseguest } from \"./houseguest\";\nimport { PlayerProfile } from \"./playerProfile\";\nimport _ from \"lodash\";\nimport { newRelationshipMap, rng } from \"../utils\";\nimport { getFinalists } from \"./season\";\nimport { EpisodeLog } from \"./logging/episodelog\";\nimport { Cliques } from \"../utils/generateCliques\";\n\nexport function getById(gameState: GameState, id: number): Houseguest {\n    return gameState.houseguestCache[id];\n}\n\nexport function exclude(inclusions: Houseguest[], exclusions: Houseguest[]) {\n    const excludedIds = exclusions.map((hg) => hg.id);\n    return inclusions.filter((hg) => !excludedIds.includes(hg.id) && !hg.isEvicted);\n}\n\nexport function randomPlayer(inclusions: Houseguest[], exclusions: Houseguest[] = []): Houseguest {\n    if (inclusions.length === 0) {\n        throw new Error(\"Tried to get a random player from a list of 0 players.\");\n    }\n    const options = exclude(inclusions, exclusions);\n    const choice = rng().randomInt(0, options.length - 1);\n\n    return options[choice];\n}\n\nexport function nonEvictedHouseguests(gameState: GameState): Houseguest[] {\n    return [...gameState.nonEvictedHouseguests.entries()].map(([_, id]) => getById(gameState, id));\n}\nexport function getJurors(gameState: GameState): Houseguest[] {\n    return gameState.houseguests.filter((hg) => hg.isJury);\n}\n\nexport function inJury(gameState: GameState): Boolean {\n    return gameState.remainingPlayers - getFinalists() <= gameState.finalJurySize();\n}\n\nexport function calculatePopularity(hero: Houseguest, house: Houseguest[]) {\n    let sum = 0;\n    let count = 0;\n    const targetId = hero.id;\n    house.forEach((houseguest) => {\n        if (houseguest.id !== targetId) {\n            count++;\n            sum += houseguest.relationships[targetId];\n        }\n    });\n    return count === 0 ? 0 : sum / count;\n}\n\nexport function defaultJurySize(castSize: number): number {\n    castSize = Math.round(castSize * 0.55);\n    if (castSize % 2 === 0) {\n        castSize--;\n    }\n    return castSize;\n}\n\nexport function validateJurySize(j: number, castSize: number): boolean {\n    return j >= 1 && j % 2 === 1 && castSize - 2 >= j;\n}\n\nclass _GameState {\n    private jurors: number = 0;\n    readonly houseguests: Houseguest[] = [];\n\n    public finalJurySize() {\n        return this.jurors;\n    }\n    set jurySize(j: number) {\n        if (!validateJurySize(j, this.houseguests.length)) {\n            return;\n        }\n        this.jurors = j;\n    }\n}\n\ninterface InitGameState {\n    players: PlayerProfile[];\n    jury: number;\n}\n\nexport class GameState extends _GameState {\n    // State of the game after a phase.\n\n    readonly houseguestCache: { [id: number]: Houseguest } = {};\n    readonly nonEvictedHouseguests: Set<number> = new Set<number>();\n    readonly remainingPlayers: number = 0;\n    readonly phase: number = 0;\n    readonly previousHOH?: Houseguest;\n    readonly log: EpisodeLog[][] = [];\n    readonly cliques: Cliques[] = [];\n\n    public __logindex__: number = 0;\n    get currentLog(): EpisodeLog {\n        if (!this.log[this.phase]) return new EpisodeLog(); // an unused episode log, kind of like /dev/null\n        return this.log[this.phase][this.__logindex__];\n    }\n    public incrementLogIndex() {\n        this.__logindex__++;\n        this.log[this.phase].push(new EpisodeLog());\n    }\n    public resetLogIndex() {\n        this.__logindex__ = 0;\n    }\n\n    public constructor(init: InitGameState | GameState) {\n        super();\n        if (init instanceof GameState || init instanceof MutableGameState) {\n            Object.assign(this, init);\n        } else {\n            const _init = init as InitGameState;\n            const profiles = _init.players;\n            this.remainingPlayers = profiles.length;\n            profiles.forEach((profile, i) => {\n                const hg: Houseguest = new Houseguest({\n                    ...profile,\n                    id: i,\n                    relationships: newRelationshipMap(profiles.length, i),\n                });\n                this.nonEvictedHouseguests.add(i);\n                this.houseguestCache[i] = hg;\n                this.houseguests.push(hg);\n            });\n            this.jurySize = _init.jury;\n        }\n        if (!this.finalJurySize()) {\n            this.jurySize = defaultJurySize(this.houseguests.length);\n        }\n    }\n}\n\nexport class MutableGameState extends _GameState {\n    public houseguestCache: { [id: number]: Houseguest } = {};\n    readonly nonEvictedHouseguests: Set<number> = new Set<number>();\n    public remainingPlayers: number = 0;\n    public phase: number = 0;\n    public previousHOH?: Houseguest;\n    public cliques: Cliques[] = [];\n    public log: EpisodeLog[][] = [];\n\n    public __logindex__: number = 0;\n    get currentLog(): EpisodeLog {\n        if (!this.log[this.phase]) return new EpisodeLog();\n        return this.log[this.phase][this.__logindex__];\n    }\n    public incrementLogIndex() {\n        this.__logindex__++;\n        this.log[this.phase].push(new EpisodeLog());\n    }\n    public resetLogIndex() {\n        this.__logindex__ = 0;\n    }\n\n    public constructor(init: GameState | MutableGameState) {\n        super();\n        const copy = _.cloneDeep(init);\n        Object.assign(this, copy);\n    }\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests, getById } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { shuffle } from \"lodash\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { castEvictionVote, castVoteToSave, NumberWithLogic } from \"../../../utils/ai/aiApi\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NomineeVote, NormalVote, HoHVote, SaveVote } from \"../../../model/logging/voteType\";\nimport { evictHouseguest } from \"../utilities/evictHouseguest\";\nimport { listNames, listVotes } from \"../../../utils/listStrings\";\n\nfunction getHighestIndicies(numbers: number[]): number[] {\n    const highest = Math.max(...numbers);\n    const highestIndicies = numbers.reduce((acc: any[], cur, i) => {\n        if (cur === highest) {\n            acc.push(i);\n        }\n        return acc;\n    }, []);\n    return highestIndicies;\n}\n\ninterface EvictionSceneOptions {\n    votingTo: \"Save\" | \"Evict\";\n    doubleEviction: boolean;\n}\n\nexport function generateEvictionScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nominees: Houseguest[],\n    options: EvictionSceneOptions\n): [GameState, Scene] {\n    const doubleEviction = options.doubleEviction;\n    const castVote: (hero: Houseguest, noms: Houseguest[], gameState: GameState) => NumberWithLogic =\n        options.votingTo === \"Save\" ? castVoteToSave : castEvictionVote;\n    let newGameState = new MutableGameState(initialGameState);\n    newGameState.currentLog.votingTo = options.votingTo;\n    nominees = shuffle(nominees);\n    const votes: Array<ProfileHouseguest[]> = nominees.map((_) => []);\n    let lastVoter: Houseguest;\n    let outOf = 0;\n    const nonVoters = new Set<number>(nominees.map((hg) => hg.id));\n    nonVoters.add(HoH.id);\n    nonEvictedHouseguests(newGameState).forEach((hg) => {\n        if (!nonVoters.has(hg.id)) {\n            const logic = castVote(hg, nominees, newGameState);\n            const result: ProfileHouseguest = { ...hg };\n            result.tooltip = logic.reason;\n            newGameState.currentLog.votes[hg.id] =\n                options.votingTo === \"Evict\"\n                    ? new NormalVote(nominees[logic.decision].id)\n                    : new SaveVote(nominees[logic.decision].id);\n            votes[logic.decision].push(result);\n            lastVoter = hg;\n            outOf++;\n        }\n    });\n    const voteCounts: number[] = votes.map((vote) => vote.length);\n    const pluralities = getHighestIndicies(voteCounts);\n    newGameState.currentLog.outOf = outOf;\n    if (outOf === 1) {\n        newGameState.currentLog.soleVoter = lastVoter!!.name;\n    }\n    let tieVote = pluralities.length > 1;\n    let tieBreaker = { decision: -1, reason: \"\" };\n    if (tieVote) {\n        newGameState.currentLog.outOf++;\n        tieBreaker = castVote(\n            HoH,\n            pluralities.map((p) => nominees[p]),\n            newGameState\n        );\n\n        newGameState.currentLog.votes[HoH.id] = new HoHVote(nominees[pluralities[tieBreaker.decision]].id);\n    }\n    let evictees: Houseguest[] = [];\n\n    if (options.votingTo === \"Evict\") {\n        // voting to evict\n        if (tieBreaker.decision > -1) {\n            // there was a tie\n            evictees.push(nominees[pluralities[tieBreaker.decision]]);\n            newGameState.currentLog.votesInMajority = voteCounts[pluralities[tieBreaker.decision]] + 1;\n        } else {\n            // there wasn't a tie\n            evictees.push(nominees[pluralities[0]]);\n            newGameState.currentLog.votesInMajority = voteCounts[pluralities[0]];\n        }\n    } else {\n        // voting to save\n        if (tieBreaker.decision > -1) {\n            // there was a tie\n            const safe = nominees[pluralities[tieBreaker.decision]];\n            newGameState.currentLog.votesInMajority = voteCounts[pluralities[tieBreaker.decision]] + 1;\n            nominees.forEach((nom) => {\n                if (nom.id !== safe.id) {\n                    evictees.push(nom);\n                }\n            });\n        } else {\n            // there wasn't a tie\n            const safe = nominees[pluralities[0]];\n            newGameState.currentLog.votesInMajority = voteCounts[pluralities[0]];\n            nominees.forEach((nom) => {\n                if (nom.id !== safe.id) {\n                    evictees.push(nom);\n                }\n            });\n        }\n    }\n    const evicteesSet = new Set<number>(evictees.map((hg) => hg.id));\n    nominees.forEach((hg) => {\n        newGameState.currentLog.votes[hg.id] = new NomineeVote(evicteesSet.has(hg.id));\n    });\n\n    const votesPerEvictee: any = {};\n    nominees.forEach((hg, i) => {\n        if (!evicteesSet.has(hg.id)) return;\n        votesPerEvictee[hg.id] = voteCounts[i] + (tieBreaker.decision === i ? 1 : 0);\n    });\n\n    if (options.votingTo === \"Evict\") evictees.sort((a, b) => votesPerEvictee[b.id] - votesPerEvictee[a.id]);\n    else evictees.sort((a, b) => votesPerEvictee[a.id] - votesPerEvictee[b.id]);\n\n    evictees.forEach((evictee) => {\n        newGameState = evictHouseguest(newGameState, evictee.id);\n    });\n    const isUnanimous = voteCounts.filter((n) => n !== 0).length === 1;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${listVotes(voteCounts.map((v) => `${v}`))}...`;\n\n    const displayHoH: ProfileHouseguest = { ...HoH };\n    displayHoH.tooltip = tieBreaker.reason;\n    const margin = doubleEviction ? { marginTop: 200 } : {};\n    const scene = new Scene({\n        title: \"Live Eviction\",\n        gameState: initialGameState,\n        content: (\n            <div style={margin}>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    {votes.map((voters, i) => (\n                        <DividerBox className=\"column\" key={`voters${i}`}>\n                            <Portraits houseguests={voters} centered={true} />\n                        </DividerBox>\n                    ))}\n                </div>\n                {tieVote && (\n                    <div>\n                        <CenteredBold> We have a tie.</CenteredBold>\n                        <Centered>{`${\n                            HoH.name\n                        }, as current Head of Household, you must cast the sole vote to ${options.votingTo.toLowerCase()}.`}</Centered>\n                        <Portraits houseguests={[displayHoH]} centered={true} />\n                        <CenteredBold>\n                            I vote to {options.votingTo.toLowerCase()}\n                            {` ${nominees[pluralities[tieBreaker.decision]].name}.`}\n                        </CenteredBold>\n                    </div>\n                )}\n                <Portraits houseguests={nominees.map((hg) => getById(newGameState, hg.id))} centered={true} />\n                {options.votingTo === \"Save\" && (\n                    <CenteredBold>{`${listNames(\n                        nominees.filter((nom) => !evicteesSet.has(nom.id)).map((hg) => hg.name)\n                    )}... you are safe.`}</CenteredBold>\n                )}\n                <CenteredBold>{`${options.votingTo === \"Save\" ? \"That means \" : \"\"}${listNames(\n                    evictees.map((hg) => hg.name)\n                )}... you have been evicted from the Big Brother House.`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [newGameState, scene];\n}\n","import { Episode, EpisodeType, GameState, Houseguest } from \"../../model\";\nimport React from \"react\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { Scene } from \"./scenes/scene\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateNomCeremonyScene } from \"./scenes/nomCeremonyScene\";\nimport { generateVetoCompScene } from \"./scenes/vetoCompScene\";\nimport { generateVetoCeremonyScene } from \"./scenes/vetoCeremonyScene\";\nimport { generateEvictionScene } from \"./scenes/evictionScene\";\nimport { GoldenVeto } from \"./veto/veto\";\n\nexport const TripleEvictionCad: EpisodeType = {\n    canPlayWith: (n: number) => n >= 6,\n    eliminates: 3,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n    name: \"Triple Eviction 🇨🇦\",\n    generate: generateTripleEvictionCad,\n};\n\nexport function generateTripleEvictionCad(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, GoldenVeto);\n    let currentGameState = episode.gameState;\n    const scenes: Scene[] = episode.scenes;\n\n    currentGameState.incrementLogIndex();\n\n    let hoh: Houseguest;\n    let hohCompScene: Scene;\n    const tripleScenes: Scene[] = [];\n    [currentGameState, hohCompScene, hoh] = generateHohCompScene(currentGameState, {\n        doubleEviction: true,\n        customText: \"Houseguests, please return to the living room. Tonight will be a triple eviction.\",\n    });\n    tripleScenes.push(hohCompScene);\n\n    let nomCeremonyScene;\n    let nominees: Houseguest[];\n    [currentGameState, nomCeremonyScene, nominees] = generateNomCeremonyScene(currentGameState, hoh, {\n        doubleEviction: true,\n        thirdNominee: true,\n    });\n    tripleScenes.push(nomCeremonyScene);\n\n    let vetoCompScene;\n    let povWinner: Houseguest;\n    [currentGameState, vetoCompScene, povWinner] = generateVetoCompScene(\n        currentGameState,\n        hoh,\n        nominees,\n        GoldenVeto,\n        true\n    );\n    tripleScenes.push(vetoCompScene);\n\n    let vetoCeremonyScene;\n\n    [currentGameState, vetoCeremonyScene, nominees] = generateVetoCeremonyScene(\n        currentGameState,\n        hoh,\n        nominees,\n        povWinner,\n        { doubleEviction: true, finalNominees: 3 }\n    );\n    tripleScenes.push(vetoCeremonyScene);\n\n    let evictionScene;\n    [currentGameState, evictionScene] = generateEvictionScene(currentGameState, hoh, nominees, {\n        doubleEviction: true,\n        votingTo: \"Save\",\n    });\n    tripleScenes.push(evictionScene);\n\n    scenes.push(\n        new Scene({\n            title: \"Triple Eviction\",\n            content: <div>{tripleScenes.map((scene) => scene.content)}</div>,\n            gameState: currentGameState,\n        })\n    );\n\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        initialGamestate,\n        title: episode.title,\n        scenes,\n        type: TripleEvictionCad,\n    });\n}\n","import { Episode, EpisodeType, GameState } from \"../../model\";\nimport React from \"react\";\nimport { generateBBVanillaScenes } from \"./bigBrotherEpisode\";\nimport { Scene } from \"./scenes/scene\";\nimport { GoldenVeto } from \"./veto/veto\";\n\nexport const TripleEvictionUs: EpisodeType = {\n    canPlayWith: (n: number) => n >= 6,\n    eliminates: 3,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n    name: \"Triple Eviction 🇺🇸\",\n    generate: generateTripleEvictionUs,\n};\n\nexport function generateTripleEvictionUs(initialGamestate: GameState): Episode {\n    const episode = generateBBVanillaScenes(initialGamestate, GoldenVeto);\n    let currentGameState = episode.gameState;\n    const scenes: Scene[] = episode.scenes;\n\n    currentGameState.incrementLogIndex();\n    const doubleEviction = generateBBVanillaScenes(currentGameState, GoldenVeto, true);\n    currentGameState = doubleEviction.gameState;\n    scenes.push(\n        new Scene({\n            title: \"Double Eviction\",\n            content: <div>{doubleEviction.scenes.map((scene) => scene.content)}</div>,\n            gameState: doubleEviction.gameState,\n        })\n    );\n    currentGameState.incrementLogIndex();\n    const tripleEviction = generateBBVanillaScenes(currentGameState, GoldenVeto, true);\n    currentGameState = tripleEviction.gameState;\n    scenes.push(\n        new Scene({\n            title: \"Triple Eviction\",\n            content: <div>{tripleEviction.scenes.map((scene) => scene.content)}</div>,\n            gameState: tripleEviction.gameState,\n        })\n    );\n    return new Episode({\n        gameState: new GameState(currentGameState),\n        initialGamestate,\n        title: episode.title,\n        scenes,\n        type: TripleEvictionUs,\n    });\n}\n","import React from \"react\";\nimport { Subject, Subscription } from \"rxjs\";\nimport { NumericInputStyle } from \"../castingScreen/numericInput\";\nimport { EpisodeType } from \"../episode/episodes\";\nimport { twistCapacity$ } from \"./seasonEditorList\";\nimport { Label } from \"./seasonEditorPage\";\n\nexport const twist$ = new Subject<{ type: EpisodeType; add: boolean }>();\n\ninterface TwistAdderProps {\n    type: EpisodeType;\n}\n\nexport class TwistAdder extends React.Component<\n    TwistAdderProps,\n    { twistCount: number; twistCapacity: number }\n> {\n    private subs: Subscription[];\n\n    public constructor(props: TwistAdderProps) {\n        super(props);\n        this.state = { twistCount: 0, twistCapacity: twistCapacity$.value };\n        this.subs = [];\n    }\n\n    public componentDidMount(): void {\n        this.subs.push(twistCapacity$.subscribe((twistCapacity) => this.setState({ twistCapacity })));\n    }\n\n    public componentWillUnmount(): void {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    public render(): JSX.Element {\n        const twistCount = this.state.twistCount;\n        return (\n            <div\n                className=\"column is-narrow\"\n                style={{\n                    border: \"1px solid #808080\",\n                    borderRadius: \"4px\",\n                    backgroundColor: \"#444346\",\n                    margin: \"10px\",\n                }}\n            >\n                <div className=\"field has-addons has-addons-centered\">\n                    <p\n                        className=\"field-label is-normal control\"\n                        style={{ textAlign: \"right\", marginRight: \"1em\" }}\n                    >\n                        <Label className=\"label\">{this.props.type.name}</Label>\n                    </p>\n                    <p className=\"control\">\n                        <button\n                            className=\"button is-danger\"\n                            disabled={twistCount === 0}\n                            onClick={() => {\n                                twist$.next({ type: this.props.type, add: false });\n                                this.setState({ twistCount: twistCount - 1 });\n                            }}\n                        >\n                            -\n                        </button>\n                    </p>\n                    <p className=\"control\">\n                        <NumericInputStyle className=\"input\" readOnly value={`${twistCount}`} />\n                    </p>\n                    <p className=\"control\">\n                        <button\n                            className=\"button is-success\"\n                            onClick={() => {\n                                twist$.next({ type: this.props.type, add: true });\n                                this.setState({ twistCount: twistCount + 1 });\n                            }}\n                            disabled={this.state.twistCapacity < this.props.type.eliminates}\n                        >\n                            +\n                        </button>\n                    </p>\n                </div>\n            </div>\n        );\n    }\n}\n","import { DragDropContext, Droppable } from \"react-beautiful-dnd\";\nimport { Draggable } from \"react-beautiful-dnd\";\nimport React from \"react\";\nimport styled from \"styled-components\";\nimport { EpisodeType } from \"../episode/episodes\";\nimport { BigBrotherVanilla } from \"../episode/bigBrotherEpisode\";\nimport { BehaviorSubject, Subscription } from \"rxjs\";\nimport { twist$ } from \"./twistAdder\";\nimport { min } from \"lodash\";\nimport { removeFirstNMatching } from \"../../utils\";\nimport { EpisodeLibrary } from \"../../model/season\";\n\nconst DragItem = styled.div`\n    padding: 10px;\n    border-radius: 6px;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);\n    background: #444346;\n    margin: 0 0 3px 0;\n    border: 1px solid #6c6c6c;\n    display: grid;\n    flex-direction: column;\n    color: #fff;\n`;\n\nlet _items: SeasonEditorListItem[] = [];\nlet _castSize: number = 0;\n\nexport function getEpisodeLibrary(): EpisodeLibrary {\n    const result: EpisodeLibrary = {};\n    let playersRemaining = _castSize;\n    for (const item of _items) {\n        if (item.episode !== BigBrotherVanilla) {\n            result[playersRemaining] = item.episode;\n        }\n        playersRemaining -= item.episode.eliminates;\n    }\n    return result;\n}\n\nconst ListItem = ({\n    item,\n    provided,\n    snapshot,\n}: {\n    item: SeasonEditorListItem;\n    provided: any;\n    snapshot: any;\n}): JSX.Element => {\n    return (\n        <DragItem\n            ref={provided.innerRef}\n            snapshot={snapshot}\n            {...provided.draggableProps}\n            {...provided.dragHandleProps}\n        >\n            <span>{`${item.weekText}${\n                item.episode !== BigBrotherVanilla ? ` | ${item.episode.name}` : \"\"\n            }`}</span>\n        </DragItem>\n    );\n};\n\ninterface SeasonEditorListProps {\n    castSize: number;\n}\n\ninterface SeasonEditorListState {\n    items: SeasonEditorListItem[];\n}\n\ninterface SeasonEditorListItem {\n    id: string;\n    weekText: string;\n    episode: EpisodeType;\n}\n\nexport const twistCapacity$ = new BehaviorSubject<number>(0);\n\nexport class SeasonEditorList extends React.Component<SeasonEditorListProps, SeasonEditorListState> {\n    private id: number = 0;\n    private subs: Subscription[] = [];\n\n    public constructor(props: SeasonEditorListProps) {\n        super(props);\n        _castSize = props.castSize;\n        const elements: SeasonEditorListItem[] = [];\n        let week: number = 0;\n        for (let i = props.castSize; i > 3; i--) {\n            week++;\n            elements.push({\n                id: (this.id++).toString(),\n                weekText: `Week ${week}: F${i}`,\n                episode: BigBrotherVanilla,\n            });\n        }\n        _items = elements;\n        this.state = { items: elements };\n    }\n\n    private maxCapacity(): number {\n        return this.props.castSize - 3;\n    }\n\n    private updateTwistCapacity(newCapacity: number) {\n        twistCapacity$.next(newCapacity);\n    }\n\n    private addRemoveTwist(twist: { type: EpisodeType; add: boolean }) {\n        this.updateTwistCapacity(\n            twist.add\n                ? min([twistCapacity$.value - twist.type.eliminates, this.maxCapacity()]) || 0\n                : twistCapacity$.value + twist.type.eliminates\n        );\n        // add or remove the twist\n        if (twist.add) {\n            // remove X vanilla episodes, then add the twist\n            const newItems = Array.from(this.state.items);\n            removeFirstNMatching(\n                newItems,\n                twist.type.eliminates,\n                (item) => item.episode === BigBrotherVanilla\n            );\n            newItems.unshift({\n                id: (this.id++).toString(),\n                weekText: `error lol`,\n                episode: twist.type,\n            });\n            this.refreshItems(newItems);\n        } else {\n            // remove the first instance of the twist, and add X vanilla episodes\n            const newItems = Array.from(this.state.items);\n            removeFirstNMatching(newItems, 1, (item) => item.episode === twist.type);\n            this.refreshItems(newItems);\n        }\n    }\n\n    public componentDidMount() {\n        twistCapacity$.next(this.maxCapacity());\n        this.subs.push(twist$.subscribe((twist) => this.addRemoveTwist(twist)));\n    }\n\n    public componentWillUnmount(): void {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    private refreshItems(newItems: SeasonEditorListItem[]) {\n        const finalItems = [];\n        let week: number = 0;\n        let playerCount: number = this.props.castSize;\n\n        for (const item of newItems) {\n            const isValid = item.episode.canPlayWith(playerCount);\n            if (isValid) week++;\n            item.weekText = `${isValid ? `Week ${week}: F${playerCount}` : \"N/A\"}`;\n            if (isValid) playerCount -= item.episode.eliminates;\n            // delete all vanilla big brother episodes if player count is below 3\n            if (isValid || item.episode !== BigBrotherVanilla) {\n                finalItems.push(item);\n            }\n        }\n        // if we have to add new vanilla episodes b/c we dont have enough to get to F4, add them\n        if (playerCount > 3) {\n            while (playerCount > 3) {\n                week++;\n                finalItems.unshift({\n                    id: (this.id++).toString(),\n                    weekText: `Week ${week}: F${playerCount}`,\n                    episode: BigBrotherVanilla,\n                });\n                playerCount--;\n            }\n            this.refreshItems(finalItems);\n        }\n        _items = finalItems;\n        this.setState({ items: finalItems });\n    }\n    public render() {\n        const onDragEnd = (result: any) => {\n            if (!result.destination) {\n                return;\n            }\n            const newItems = Array.from(this.state.items);\n            const [removed] = newItems.splice(result.source.index, 1);\n            newItems.splice(result.destination.index, 0, removed);\n            this.refreshItems(newItems);\n        };\n        const items = this.state.items;\n        return (\n            <DragDropContext onDragEnd={onDragEnd}>\n                <Droppable droppableId=\"droppable\">\n                    {(provided) => (\n                        <div {...provided.droppableProps} ref={provided.innerRef}>\n                            {items.map((item, index) => (\n                                <Draggable key={item.id} draggableId={item.id} index={index}>\n                                    {(provided, snapshot) => (\n                                        <ListItem provided={provided} snapshot={snapshot} item={item} />\n                                    )}\n                                </Draggable>\n                            ))}\n                            {provided.placeholder}\n                        </div>\n                    )}\n                </Droppable>\n            </DragDropContext>\n        );\n    }\n}\n","import React, { useState } from \"react\";\nimport styled from \"styled-components\";\nimport { defaultJurySize, GameState, validateJurySize } from \"../../model/gameState\";\nimport { cast$, newEpisode, pushToMainContentStream, season$ } from \"../../subjects/subjects\";\nimport { NumericInput } from \"../castingScreen/numericInput\";\nimport { DoubleEviction } from \"../episode/doubleEvictionEpisode\";\nimport { EpisodeType } from \"../episode/episodes\";\nimport { InstantEviction } from \"../episode/instantEvictionEpisode\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { TripleEvictionCad } from \"../episode/tripleEvictionEpisodeCad\";\nimport { TripleEvictionUs } from \"../episode/tripleEvictionEpisodeUs\";\nimport { HasText } from \"../layout/text\";\nimport { selectPlayer } from \"../playerPortrait/selectedPortrait\";\nimport { Noselect } from \"../playerPortrait/setupPortrait\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { Screens } from \"../topbar/topBar\";\nimport { getEpisodeLibrary, SeasonEditorList } from \"./seasonEditorList\";\nimport { TwistAdder } from \"./twistAdder\";\n\nconst Subheader = styled.h3`\n    text-align: center;\n    color: #fff;\n`;\n\nexport const Label = styled.label`\n    color: #fff;\n`;\n\nconst twists: EpisodeType[] = [DoubleEviction, TripleEvictionCad, TripleEvictionUs, InstantEviction];\n\nconst submit = async (jury: number): Promise<void> => {\n    season$.next(getEpisodeLibrary());\n\n    // reset stuff and start a new game\n    pushToMainContentStream(<PregameScreen cast={cast$.value} />, Screens.Other);\n    selectPlayer(null);\n    // vscode says the awaits are unnessecary here,\n    // but if you remove them then bad things happen\n    await newEpisode(null);\n    await newEpisode(new PregameEpisode(new GameState({ players: cast$.value, jury })));\n};\n\nexport function SeasonEditorPage(): JSX.Element {\n    const castLength = cast$.value.length;\n    const [jurySize, setJurySize] = useState(`${defaultJurySize(castLength)}`);\n    const validJurySize = validateJurySize(parseInt(jurySize), castLength);\n    return (\n        <div className=\"columns\">\n            <div className=\"column is-one-quarter\">\n                <HasText>\n                    <h3 style={{ textAlign: \"center\" }}>Season Overview</h3>\n                </HasText>\n                <hr />\n                <Noselect>\n                    <SeasonEditorList castSize={castLength} />\n                </Noselect>\n            </div>\n            <div className=\"column\" style={{ padding: 20 }}>\n                <Subheader>Add Twists</Subheader>\n                <div className=\"columns is-multiline is-centered\">\n                    {twists.map((type) => (\n                        <TwistAdder type={type} key={type.name} />\n                    ))}\n                    <div\n                        className=\"column is-4\"\n                        style={{\n                            border: \"1px solid #808080\",\n                            borderRadius: \"4px\",\n                            backgroundColor: \"#444346\",\n                            margin: \"10px\",\n                        }}\n                    >\n                        <HasText className=\"field is-horizontal centered\">\n                            <div className=\"field-label is-normal\">\n                                <Label className=\"label\" style={validJurySize ? {} : { color: \"#fb8a8a\" }}>\n                                    Jury Size:\n                                </Label>\n                            </div>\n                            <div className=\"field-body\">\n                                <div className=\"field\">\n                                    <div className=\"control\">\n                                        <NumericInput\n                                            className={validJurySize ? undefined : \"is-danger\"}\n                                            value={jurySize}\n                                            onChange={setJurySize}\n                                            placeholder={`${defaultJurySize(castLength)}`}\n                                        />\n                                    </div>\n                                    <p className=\"help\" style={validJurySize ? {} : { color: \"#fb8a8a\" }}>\n                                        {validJurySize\n                                            ? `(Jury starts at F${parseInt(jurySize) + 2})`\n                                            : `Jury must be an odd number < ${castLength - 2}`}\n                                    </p>\n                                </div>\n                            </div>\n                        </HasText>\n                    </div>\n                </div>\n            </div>\n            <div className=\"column is-narrow\" style={{ padding: 40 }}>\n                <button\n                    className=\"button is-success\"\n                    style={{ float: \"right\" }}\n                    onClick={() => {\n                        submit(parseInt(jurySize));\n                    }}\n                    disabled={!validJurySize}\n                >\n                    Submit\n                </button>\n            </div>\n        </div>\n    );\n}\n","import React from \"react\";\nimport FileDrop from \"react-file-drop\";\nimport { PlayerProfile } from \"../../model\";\nimport { SetupPortrait } from \"../playerPortrait/setupPortrait\";\nimport { shuffle } from \"lodash\";\nimport { RandomButton } from \"./randomXButton\";\nimport { selectCastPlayer } from \"../playerPortrait/selectedPortrait\";\nimport { pushToMainContentStream, selectedCastPlayer$, updateCast } from \"../../subjects/subjects\";\nimport { HasText, Input } from \"../layout/text\";\nimport { Centered } from \"../layout/centered\";\nimport { Subscription } from \"rxjs\";\nimport _ from \"lodash\";\nimport { HelpLink } from \"../episode/allianceList\";\nimport { SeasonEditorPage } from \"../seasonEditor/seasonEditorPage\";\nimport { Screens } from \"../topbar/topBar\";\n\ninterface CastingScreenProps {\n    cast?: PlayerProfile[];\n}\n\ninterface CastingScreenState {\n    players: PlayerProfile[];\n    selectedPlayers: Set<number>;\n}\n\nlet id = 1;\n\nexport class CastingScreen extends React.Component<CastingScreenProps, CastingScreenState> {\n    private sub: Subscription | null = null;\n\n    constructor(props: CastingScreenProps) {\n        super(props);\n        if (props.cast) {\n            selectCastPlayer(null);\n            props.cast.forEach((player) => (player.castingScreenId = id++));\n        }\n        this.state = { players: props.cast || [], selectedPlayers: new Set<number>() };\n    }\n\n    public componentDidMount() {\n        this.sub = selectedCastPlayer$.subscribe((selectedPlayers) => {\n            this.setState({ selectedPlayers });\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    private deleteMethod(i: number, castingScreenId: number) {\n        return () => {\n            const newState = { ...this.state };\n            newState.players.splice(i, 1);\n            if (newState.selectedPlayers.has(castingScreenId)) {\n                selectCastPlayer(castingScreenId);\n            }\n            this.setState(newState);\n        };\n    }\n\n    private rename(i: number) {\n        return () => {\n            const newState = { ...this.state };\n            const newName: string | null = prompt(`Enter a new name for ${newState.players[i].name}`);\n            if (!newName) return;\n            newState.players[i].name = newName;\n            this.setState(newState);\n        };\n    }\n\n    private getFiles() {\n        const players = this.state.players;\n        if (!players) {\n            return;\n        }\n        const rows: JSX.Element[] = [];\n        let i = 0;\n        players.forEach((player) =>\n            rows.push(\n                <SetupPortrait\n                    name={player.name}\n                    imageUrl={player.imageURL}\n                    onDelete={this.deleteMethod(i, player.castingScreenId || -1)}\n                    onClick={() => {\n                        selectCastPlayer(player.castingScreenId || -1);\n                    }}\n                    onRename={this.rename(i)}\n                    selected={this.state.selectedPlayers.has(player.castingScreenId || -1)}\n                    key={(++i).toString()}\n                />\n            )\n        );\n        return <div className=\"columns is-gapless is-mobile is-multiline is-centered\">{rows}</div>;\n    }\n\n    private submit = () => {\n        updateCast(this.state.players);\n        pushToMainContentStream(<SeasonEditorPage />, Screens.Season);\n    };\n\n    private random = (_amount: number) => {\n        // get all the selected players first\n        let result: PlayerProfile[] = [];\n        let amount = _amount;\n\n        const allPlayers = this.state.players;\n        let unselectedPlayers: PlayerProfile[] = [];\n\n        allPlayers.forEach((player) => {\n            if (this.state.selectedPlayers.has(player.castingScreenId || -1)) {\n                result.push(player);\n                amount--;\n            } else {\n                unselectedPlayers.push(player);\n            }\n        });\n\n        if (amount > 0) {\n            unselectedPlayers = shuffle(unselectedPlayers);\n            unselectedPlayers = unselectedPlayers.slice(0, amount);\n        }\n        let players = amount > 0 ? result.concat(unselectedPlayers) : result;\n        players = shuffle(players);\n        this.setState({ players });\n    };\n\n    public render() {\n        return (\n            <FileDrop onDrop={this.handleDrop}>\n                <HasText className=\"level\">\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-danger\"\n                            onClick={() => {\n                                this.setState({ players: [] });\n                                selectCastPlayer(null);\n                            }}\n                        >\n                            Delete all\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-danger\"\n                            disabled={this.state.selectedPlayers.size === 0}\n                            onClick={() => {\n                                const players = this.state.players.filter(\n                                    (player) => !this.state.selectedPlayers.has(player.castingScreenId || -1)\n                                );\n                                this.setState({ players });\n                                selectCastPlayer(null);\n                            }}\n                        >\n                            Delete selected\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-warning\"\n                            onClick={() => selectCastPlayer(null)}\n                            disabled={this.state.selectedPlayers.size === 0}\n                        >\n                            Unselect {this.state.selectedPlayers.size || \"all\"}\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <RandomButton random={this.random} />\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-success\"\n                            disabled={this.state.players.length < 3}\n                            onClick={this.submit}\n                        >\n                            Next\n                        </button>\n                    </div>\n                </HasText>\n                <Input type=\"file\" multiple onChange={this.handleUpload} />\n                {this.state.players.length === 0 && (\n                    <Centered>\n                        ~ Drop images here ~\n                        <br />\n                        <br />\n                        <HelpLink\n                            href=\"https://github.com/spaulmark/bb-bots/blob/master/README.md#choose-a-cast-of-characters\"\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            Need help setting up a game?\n                        </HelpLink>\n                    </Centered>\n                )}\n                {this.getFiles()}\n            </FileDrop>\n        );\n    }\n\n    private handleUpload = (event: any) => {\n        this.handleFiles(event.target.files);\n    };\n\n    private handleDrop = (files: FileList | null) => {\n        if (!files) return;\n        this.handleFiles(files);\n    };\n\n    private handleFiles(files: FileList) {\n        const newState = { ...this.state };\n        for (let i = 0; i < files.length; i++) {\n            const file = files[i];\n            if (file.type.match(/image\\/*/)) {\n                newState.players.push({\n                    name: file.name.substr(0, file.name.lastIndexOf(\".\")) || file.name,\n                    imageURL: URL.createObjectURL(file),\n                    castingScreenId: id++,\n                });\n            }\n        }\n        this.setState(newState);\n    }\n}\n","import React from \"react\";\nimport ReactPaginate from \"react-paginate\";\nimport { HasText } from \"../layout/text\";\nimport { shuffle, ceil, debounce } from \"lodash\";\nimport { pushToMainContentStream, selectDeckSubject, selectedDecks$ } from \"../../subjects/subjects\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport _ from \"lodash\";\nimport styled from \"styled-components\";\nimport { Subscription } from \"rxjs\";\nimport { selectedColor } from \"../playerPortrait/houseguestPortraitController\";\nimport { PlayerProfile } from \"../../model\";\nimport { Screens } from \"../topbar/topBar\";\n\ninterface DeckScreenProps {}\n\ninterface DeckScreenState {\n    loading: boolean;\n    decks: string[];\n    i: number;\n    debouncedSearchText: string;\n    searchText: string;\n    selectedDecks: Set<string>;\n}\n\nconst decksPerPage = 26;\nconst baseUrl = \"https://spaulmark.github.io/img/\";\n\nconst imageCache: { [id: string]: string } = {};\n\nconst DeckStyle = styled(HasText)`\n    display: flex;\n    cursor: pointer;\n    align-items: center;\n    :hover {\n        color: red;\n        background-color: #ffe1ea;\n    }\n`;\n\nconst Centered = styled.div`\n    display: flex;\n    justify-content: center;\n    align-items: center;\n`;\n\nconst DeckText = styled.p`\n    margin-left: 1rem;\n`;\n\nasync function randomImageFromFolder(folder: string) {\n    if (imageCache[folder]) return imageCache[folder];\n    const links = await (await fetch(`${baseUrl}${folder}/dir.json`)).json();\n    const image = _.sample(links[\"files\"]);\n    imageCache[folder] = `${baseUrl}${folder}/${image}`;\n    return `${baseUrl}${folder}/${image}`;\n}\n\nasync function submitCasts(casts: Set<string>) {\n    const playerProfiles: PlayerProfile[] = [];\n\n    for (const cast of casts) {\n        const links = await (await fetch(`${baseUrl}${cast}/dir.json`)).json();\n        const imageLinks = links[\"files\"].map((file: string) => {\n            return { name: file, url: `${baseUrl}${cast}/${file}` };\n        });\n        const folderProfiles = imageLinks.map((image: { name: string; url: string }) => {\n            return {\n                name: image.name.substr(0, image.name.lastIndexOf(\".\")) || image.name,\n                imageURL: image.url,\n            };\n        });\n        playerProfiles.push(...folderProfiles);\n    }\n\n    pushToMainContentStream(<CastingScreen cast={playerProfiles} />, Screens.Casting);\n}\n\nfunction Deck(props: { deck: string; selected: boolean }): JSX.Element {\n    const [img, setImage] = React.useState(\"\");\n    const [loading, setLoading] = React.useState(true);\n    const deck = props.deck;\n\n    if (loading)\n        randomImageFromFolder(deck).then((img) => {\n            setLoading(false);\n            setImage(img);\n        });\n    const style = props.selected ? { backgroundColor: selectedColor.toHex(), color: \"black\" } : {};\n    return (\n        <DeckStyle className=\"column is-6\" onClick={() => selectDeckSubject(props.deck)} style={style}>\n            <img src={img} style={{ width: 50, height: 50 }} />\n            <DeckText>{deck}</DeckText>\n        </DeckStyle>\n    );\n}\n\nfunction DeckList(props: { data: string[]; i: number; selected: Set<string> }): JSX.Element {\n    let decks: JSX.Element[] = [];\n    const i = props.i;\n    const data = props.data;\n    const min = i * decksPerPage;\n    for (let j = min; j < min + decksPerPage; j++) {\n        const deck = data[j];\n        if (!deck) continue;\n        decks.push(<Deck selected={props.selected.has(deck)} key={`${deck}__${i}__${j}`} deck={deck} />);\n    }\n    return (\n        <div key={\"__ul__\"} className={\"columns is-multiline\"}>\n            {decks}\n        </div>\n    );\n}\n\nexport class DeckScreen extends React.Component<DeckScreenProps, DeckScreenState> {\n    private subs: Subscription[] = [];\n\n    constructor(props: DeckScreenProps) {\n        super(props);\n        this.state = {\n            loading: true,\n            decks: [],\n            selectedDecks: new Set<string>(),\n            i: 0,\n            debouncedSearchText: \"\",\n            searchText: \"\",\n        };\n    }\n    async componentDidMount() {\n        selectDeckSubject(null);\n        this.subs.push(selectedDecks$.subscribe((selectedDecks) => this.setState({ selectedDecks })));\n        const data = await (await fetch(\"https://spaulmark.github.io/img/dir.json\")).json();\n        this.setState({ decks: shuffle(data.decks), selectedDecks: new Set<string>(), loading: false });\n    }\n    componentWillUnmount() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    private handlePageClick = (page: { selected: number }) => {\n        this.setState({ i: page.selected });\n    };\n\n    private debounceSearch = debounce((nextValue: string) => {\n        this.setState({ debouncedSearchText: nextValue, i: 0 });\n    }, 250);\n\n    private handleSearch = (event: { target: { value: string } }) => {\n        this.setState({ searchText: event.target.value });\n        this.debounceSearch(event.target.value);\n    };\n\n    render() {\n        if (this.state.loading) return <div />;\n        const decks = this.state.decks.filter((deck) =>\n            deck.toLowerCase().match(this.state.debouncedSearchText.toLowerCase())\n        );\n        return (\n            <div>\n                <div className=\"level\">\n                    <div className=\"level-item\">\n                        <input\n                            style={{ minWidth: \"50%\" }}\n                            className=\"input\"\n                            type=\"text\"\n                            placeholder=\"Search...\"\n                            onChange={this.handleSearch}\n                            value={this.state.searchText}\n                        ></input>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-warning\"\n                            onClick={() => selectDeckSubject(null)}\n                            disabled={this.state.selectedDecks.size === 0}\n                        >\n                            Unselect All\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <HasText>{`${this.state.selectedDecks.size} casts selected`}</HasText>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-success\"\n                            disabled={this.state.selectedDecks.size === 0}\n                            onClick={() => submitCasts(this.state.selectedDecks)}\n                        >\n                            Next\n                        </button>\n                    </div>\n                </div>\n                <DeckList\n                    key={\"comments\"}\n                    selected={this.state.selectedDecks}\n                    data={decks}\n                    i={this.state.i}\n                />\n                <Centered>\n                    <ReactPaginate\n                        key={\"__list__\"}\n                        previousLabel={\"previous\"}\n                        nextLabel={\"next\"}\n                        breakLabel={\"...\"}\n                        breakClassName={\"break-me\"}\n                        pageCount={ceil(decks.length / decksPerPage)}\n                        marginPagesDisplayed={2}\n                        pageRangeDisplayed={3}\n                        onPageChange={this.handlePageClick}\n                        containerClassName={\"pagination\"}\n                        activeClassName={\"active\"}\n                    />\n                </Centered>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport { getCast, pushToMainContentStream } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\nimport { Box } from \"../layout/box\";\nimport { DeckScreen } from \"../deckScreen/deckScreen\";\nimport { SeasonEditorPage } from \"../seasonEditor/seasonEditorPage\";\nimport { BehaviorSubject, Subscription } from \"rxjs\";\n\nexport enum Screens {\n    Deck = \"choosecast\",\n    Casting = \"editcast\",\n    Season = \"editseason\",\n    Other = \"other\",\n}\n\n// for topbar minty colors\nexport const activeScreen$ = new BehaviorSubject<Screens>(Screens.Other);\n\nexport const TopbarLink = styled.a`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.link};\n    cursor: pointer;\n`;\n\nexport const ActiveTopbarLink = styled.mark`\n    cursor: pointer;\n    font-weight: bold;\n`;\n\nexport function CastingScreenLink(): JSX.Element {\n    const LinkStyle = activeScreen$.value === Screens.Casting ? ActiveTopbarLink : TopbarLink;\n    return (\n        <LinkStyle\n            onClick={() => {\n                pushToMainContentStream(\n                    <CastingScreen cast={JSON.parse(JSON.stringify(getCast()))} />,\n                    Screens.Casting\n                );\n            }}\n        >\n            Edit / Upload Cast\n        </LinkStyle>\n    );\n}\n\nexport function EditSeasonLink(): JSX.Element {\n    const LinkStyle = activeScreen$.value === Screens.Season ? ActiveTopbarLink : TopbarLink;\n    return (\n        <LinkStyle\n            onClick={() => {\n                pushToMainContentStream(<SeasonEditorPage />, Screens.Season);\n            }}\n        >\n            Edit Season/Twists\n        </LinkStyle>\n    );\n}\n\nexport function ChooseCastLink(): JSX.Element {\n    const LinkStyle = activeScreen$.value === Screens.Deck ? ActiveTopbarLink : TopbarLink;\n    return (\n        <LinkStyle\n            onClick={() => {\n                pushToMainContentStream(<DeckScreen />, Screens.Deck);\n            }}\n        >\n            Choose Cast\n        </LinkStyle>\n    );\n}\n\nexport class Topbar extends React.Component<{ style?: any }, { tab: Screens }> {\n    private subs: Subscription[] = [];\n    constructor(props: Readonly<{ style?: any }>) {\n        super(props);\n        this.state = { tab: Screens.Other };\n    }\n    componentDidMount() {\n        this.subs.push(activeScreen$.subscribe((tab) => this.setState({ tab })));\n    }\n    componentWillUnmount() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    public render(): JSX.Element {\n        const style = { ...(this.props.style || {}) };\n        return (\n            <Box className=\"level is-mobile\" style={style}>\n                <div className=\"level-item\">\n                    <ChooseCastLink />\n                </div>\n                <div className=\"level-item\">\n                    <CastingScreenLink />\n                </div>\n                <div className=\"level-item\">\n                    <EditSeasonLink />\n                </div>\n            </Box>\n        );\n    }\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { HasText } from \"../layout/text\";\nimport { popularityMode } from \"../../model/portraitDisplayMode\";\nimport {\n    displayMode$,\n    mainContentStream$,\n    pushToMainContentStream,\n    switchSceneRelative,\n} from \"../../subjects/subjects\";\nimport { selectedColor } from \"../playerPortrait/houseguestPortraitController\";\nimport { Screens, TopbarLink } from \"../topbar/topBar\";\nimport { SeasonEditorPage } from \"../seasonEditor/seasonEditorPage\";\nimport { Centered, CenteredBold } from \"../layout/centered\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport { DeckScreen } from \"../deckScreen/deckScreen\";\n\ninterface PregameScreenProps {\n    cast: PlayerProfile[];\n}\n\nexport class PregameScreen extends React.Component<PregameScreenProps, {}> {\n    public componentDidMount() {\n        displayMode$.next(popularityMode);\n    }\n\n    public render() {\n        const props = this.props;\n        return (\n            <HasText>\n                <h2\n                    style={{\n                        color: selectedColor.toHex(),\n                        textShadow: \"rgb(114, 46, 123) 2px 2px 0px\",\n                        textAlign: \"center\",\n                    }}\n                >\n                    Big Brother Bots\n                </h2>\n                <CenteredBold>Big Brother Bots is a simulator for the reality show Big Brother.</CenteredBold>\n                <Centered>\n                    <TopbarLink\n                        onClick={() => {\n                            pushToMainContentStream(<DeckScreen />, Screens.Deck);\n                        }}\n                    >\n                        Choose characters\n                    </TopbarLink>{\" \"}\n                    from 300+ collections, or{\" \"}\n                    <TopbarLink\n                        onClick={() => {\n                            pushToMainContentStream(<CastingScreen cast={[]} />, Screens.Casting);\n                        }}\n                    >\n                        upload your own\n                    </TopbarLink>\n                    , then{\" \"}\n                    <TopbarLink\n                        onClick={() => {\n                            pushToMainContentStream(<SeasonEditorPage />, Screens.Season);\n                        }}\n                    >\n                        add twists\n                    </TopbarLink>{\" \"}\n                    and watch as everyone votes each other out until one winner remains!{\" \"}\n                </Centered>\n                {props.cast.length === 0 ? \"\" : <MemoryWall houseguests={props.cast} />}\n                {props.cast.length === 0 ? (\n                    \"\"\n                ) : (\n                    <p>\n                        <b> {\"You can use the ⬅️ and ➡️ arrow keys to move forwards and backwards.\"}</b>\n                    </p>\n                )}\n                {props.cast.length === 0 ? (\n                    \"\"\n                ) : (\n                    <button className=\"button is-success\" onClick={() => switchSceneRelative(1)}>\n                        Start Game\n                    </button>\n                )}\n            </HasText>\n        );\n    }\n}\n","import prand from \"pure-rand\";\nimport { BehaviorSubject } from \"rxjs\";\nimport { hashcode } from \"./utilities\";\nimport { cast$ } from \"../subjects/subjects\";\n\nexport class BbRandomGenerator {\n    private rng: prand.RandomGenerator;\n\n    // returns a random number between 0 and 1.\n    public randomFloat(): number {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result / 2147483647.0;\n    }\n\n    public randomInt(a: number, b: number): number {\n        let result: number;\n        [result, this.rng] = prand.uniformIntDistribution(a, b, this.rng);\n        return result;\n    }\n\n    public flipCoin(): boolean {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result % 2 === 0;\n    }\n\n    public seed(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n\n    public constructor(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n}\n\nexport function rng() {\n    return rng$.value;\n}\n\nconst rng$ = new BehaviorSubject(new BbRandomGenerator(0));\n\nconst castSub = cast$.subscribe({\n    next: (cast) => {\n        let castNames = \"\";\n        cast.forEach((houseguest) => (castNames += houseguest.name));\n        rng$.next(new BbRandomGenerator(hashcode(castNames)));\n    },\n});\n","import { VoteType } from \"./voteType\";\n\nexport class EpisodeLog {\n    public nominationsPreVeto: string[] = [];\n    public vetoWinner?: string;\n    public winner?: number;\n    public runnerUp?: number;\n    public nominationsPostVeto: string[] = [];\n    public evicted: number[] = [];\n    public votes: { [id: string]: VoteType } = {};\n    public votesInMajority: number = -1;\n    public outOf: number = -1;\n    public soleVoter?: string;\n    public votingTo?: string;\n}\n","import { Houseguest, GameState, nonEvictedHouseguests, getById } from \"../model\";\n\nimport { classifyRelationship, RelationshipType } from \"./ai/classifyRelationship\";\n\nimport _ from \"lodash\";\nimport { Graph } from \"./generateCliques\";\n\nclass EdgeMap {\n    public data: { [id: number]: Set<number> } = {};\n    public add(key: number, value: number) {\n        if (!this.data[key]) {\n            this.data[key] = new Set<number>([value]);\n        } else {\n            this.data[key].add(value);\n        }\n    }\n}\n\nfunction generateEdge(\n    hero: Houseguest,\n    villain: Houseguest,\n    relationship: number\n): [number[] | null, number] {\n    const relationshipType = classifyRelationship(hero.popularity, villain.popularity, relationship);\n    if (relationshipType === RelationshipType.Friend) {\n        return [[hero.id, villain.id], 1];\n    }\n    // no edge for non-mutual friends\n    return [null, 0];\n}\n\nexport default function generateGraph(gameState: GameState): Graph {\n    // this algorithm assumes every relationship is mutual,\n    // and will need a face lift if we get non-mutual relationships.\n    const players = nonEvictedHouseguests(gameState);\n    const nodes: number[] = [];\n    const edges: EdgeMap = new EdgeMap();\n    players.forEach((player) => {\n        let friendCount = 0;\n        _.forEach(player.relationships, (relationship, stringId) => {\n            const villainId = parseInt(stringId);\n            const [edge, friends] = generateEdge(player, getById(gameState, villainId), relationship);\n            friendCount += friends;\n            if (villainId > player.id) {\n                if (edge) {\n                    edges.add(player.id, villainId);\n                    edges.add(villainId, player.id);\n                }\n            }\n        });\n        // nodes[player.id] = friendCount; // for pivot later on, thats why friendcount is there unused\n        nodes.push(player.id);\n    });\n    return { nodes, neighbors: (v: number) => edges.data[v] || new Set([]) };\n}\n","import { intersection } from \".\";\nimport { GameState, getById } from \"../model\";\nimport generateGraph from \"./generateGraph\";\nimport { difference } from \"./utilities\";\n\nlet cliques: number[][] = [];\nexport interface Graph {\n    nodes: number[];\n    neighbors: (v: number) => Set<number>;\n}\n\nexport function newCliquesLength(a: Cliques): number {\n    return a.core.length + (a.affiliates ? a.affiliates[0].length + a.affiliates[1].length : 0);\n}\n\nexport interface Cliques {\n    core: number[];\n    affiliates?: [number[], number[]];\n}\n\nexport function generateCliques(gameState: GameState): Cliques[] {\n    const g = generateGraph(gameState);\n    cliques = [];\n    bronKerbosch(new Set<number>([]), new Set(g.nodes), new Set<number>([]), g);\n    cliques.forEach((clique) => clique.map((id) => getById(gameState, id)));\n    cliques = cliques.sort((a, b) => b.length - a.length);\n    const result: Cliques[] = [];\n    // ids of clique i, clique j, & overlap size\n    const mergeCandidates: [number, number, Cliques][] = [];\n    // generate overlap numbers for each clique (n^2)\n    cliques.forEach((clq, i) => {\n        const cliqueI = new Set(clq);\n        for (let j = i + 1; j < cliques.length; j++) {\n            const cliqueJ = new Set(cliques[j]);\n            const core = intersection(cliqueI, cliqueJ);\n            const affiliatesI: Set<number> = difference(cliqueI, core);\n            const affiliatesJ: Set<number> = difference(cliqueJ, core);\n            if (core.size > 0) {\n                mergeCandidates.push([\n                    i,\n                    j,\n                    {\n                        core: Array.from(core),\n                        affiliates: [Array.from(affiliatesI), Array.from(affiliatesJ)],\n                    },\n                ]);\n            }\n        }\n    });\n    // cliques that already have been merged get blacklisted\n    const blacklist: Set<number> = new Set<number>();\n\n    // merge cliques with highest overlap numbers until only unnacceptable overlap remains\n    // for example maybe if the size of both left and right affiliates is greater than the core\n    mergeCandidates.sort(\n        (a: [number, number, Cliques], b: [number, number, Cliques]) => b[2].core.length - a[2].core.length\n    );\n\n    mergeCandidates.forEach((candidate: [number, number, Cliques]) => {\n        const i = candidate[0];\n        const j = candidate[1];\n        if (blacklist.has(i) || blacklist.has(j)) return;\n        blacklist.add(i);\n        blacklist.add(j);\n        result.push(candidate[2]);\n    });\n    // add non merged cliques\n    cliques.forEach((clique, i) => {\n        if (blacklist.has(i)) return;\n        result.push({ core: clique });\n    });\n\n    // then sort and return result\n    result.sort((a: Cliques, b: Cliques) => newCliquesLength(b) - newCliquesLength(a));\n\n    return result;\n}\n\nfunction bronKerbosch(r: Set<number>, p: Set<number>, x: Set<number>, g: Graph) {\n    if (p.size === 0 && x.size === 0) {\n        const values = Array.from(r.values());\n        cliques.push(values);\n        return;\n    }\n    Array.from(p.keys()).forEach((v) => {\n        const rPrime = new Set(r.values()).add(v);\n        const pPrime = new Set([...p].filter((node) => g.neighbors(v).has(node)));\n        const xPrime = new Set([...x].filter((node) => g.neighbors(v).has(node)));\n        bronKerbosch(rPrime, pPrime, xPrime, g);\n        p.delete(v);\n        x.add(v);\n    });\n}\n","import { GameState, MutableGameState, nonEvictedHouseguests } from \"../../model/gameState\";\nimport { Episode, Houseguest } from \"../../model\";\nimport { EpisodeType } from \"./episodes\";\nimport { angleBetween, rng, roundTwoDigits } from \"../../utils\";\nimport { EpisodeLog } from \"../../model/logging/episodelog\";\nimport { generateCliques } from \"../../utils/generateCliques\";\nimport _ from \"lodash\";\nimport { refreshHgStats } from \"./utilities/evictHouseguest\";\n\nexport function canDisplayCliques(newState: GameState): boolean {\n    return newState.remainingPlayers <= 30;\n}\n\nfunction firstImpressions(houseguests: Houseguest[]) {\n    const sin = Math.sin;\n    const cos = Math.cos;\n    houseguests.forEach((hg) => {\n        // generate random spherical co-ordinates on the unit sphere\n        const u = rng().randomFloat();\n        const v = Math.abs(rng().randomFloat());\n        const θ = 2 * Math.PI * u;\n        const φ = Math.acos(2 * v - 1);\n        // convert spherical co-ords to cartesian co-ords\n        hg.compatibility = [sin(θ) * cos(φ), sin(θ) * sin(φ), cos(θ)];\n    });\n    for (let i = 0; i < houseguests.length; i++) {\n        const iMap = houseguests[i].relationships;\n        for (let j = i + 1; j < houseguests.length; j++) {\n            // creates a bunch of mutual relationships based on points on a sphere\n            const jMap = houseguests[j].relationships;\n            const impression =\n                1 - (2 * angleBetween(houseguests[i].compatibility, houseguests[j].compatibility)) / Math.PI;\n            jMap[i] = impression;\n            iMap[j] = impression;\n        }\n    }\n}\n\nexport function nextEpisode(gameState: GameState, episodeType: EpisodeType): Episode {\n    let newState = new MutableGameState(gameState);\n    if (gameState.phase === 0) {\n        firstImpressions(newState.houseguests);\n    }\n    newState.phase++;\n    newState.resetLogIndex();\n    if (gameState.remainingPlayers > 2) {\n        newState.log[newState.phase] = [new EpisodeLog()];\n    }\n    refreshHgStats(newState, true);\n    nonEvictedHouseguests(newState).forEach((hg) => {\n        hg.previousPopularity = hg.popularity;\n    });\n    if (canDisplayCliques(newState)) newState.cliques = generateCliques(newState);\n    const finalState = new GameState(newState);\n    if (!episodeType.canPlayWith(finalState.remainingPlayers))\n        throw new Error(\n            `Episode type ${episodeType.name} not playable with ${finalState.remainingPlayers} players`\n        );\n    return episodeType.generate(finalState);\n}\n","import React from \"react\";\nimport { GameState } from \"../../model\";\nimport { weekStartTab$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { AllianceList, HelpLink } from \"./allianceList\";\n\ninterface WeekStartWrapperProps {\n    gameState: GameState;\n}\n\ninterface WeekStartWrapperState {\n    tab: number;\n}\n\nexport class WeekStartWrapper extends React.Component<WeekStartWrapperProps, WeekStartWrapperState> {\n    private subs: Subscription[] = [];\n    constructor(props: Readonly<WeekStartWrapperProps>) {\n        super(props);\n        this.state = { tab: weekStartTab$.value };\n    }\n    componentDidMount() {\n        this.subs.push(weekStartTab$.subscribe((tab) => this.setState({ tab })));\n    }\n    componentWillUnmount() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    render() {\n        const helpText1 =\n            this.props.gameState.phase === 1 ? (\n                <div key=\"helptext1\" style={{ marginTop: 10 }}>\n                    <b>Try clicking on houseguests to view their relationships.</b> <br />\n                </div>\n            ) : null;\n        const helptext2 =\n            this.props.gameState.phase === 2 ? (\n                <HelpLink\n                    key=\"helptext2\"\n                    href=\"https://github.com/spaulmark/bb-bots/blob/master/README.md#understanding-relationships\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                >\n                    What do the 🛇 ✘ ♥ 💔 🎯 symbols mean?\n                </HelpLink>\n            ) : null;\n        if (this.state.tab === 0) {\n            return [\n                <MemoryWall key=\"memorywall\" houseguests={this.props.gameState.houseguests} />,\n                helpText1,\n                helptext2,\n            ];\n        }\n        return <AllianceList gameState={this.props.gameState} />;\n    }\n}\n","import { GameState, getJurors, nonEvictedHouseguests, MutableGameState, Houseguest } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { castJuryVote } from \"../../../utils/ai/aiApi\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport React from \"react\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport { NormalVote } from \"../../../model/logging/voteType\";\n\nexport function juryVoteScene(initialGameState: GameState): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const jurors: Houseguest[] = getJurors(newGameState);\n    const finalists = nonEvictedHouseguests(newGameState);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    jurors.forEach((juror) => {\n        const decision = castJuryVote(juror, finalists);\n        const result: ProfileHouseguest = { ...juror };\n        votes[decision].push(result);\n        newGameState.currentLog.votes[juror.id] = new NormalVote(finalists[decision].id);\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const winner = votesFor0 > votesFor1 ? finalists[0] : finalists[1];\n    const runnerUp = votesFor0 < votesFor1 ? finalists[0] : finalists[1];\n    newGameState.currentLog.winner = winner.id;\n    newGameState.currentLog.runnerUp = runnerUp.id;\n    const scene = new Scene({\n        title: \"Jury Votes\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </DividerBox>\n                </div>\n                <Portraits houseguests={finalists} centered={true} />\n                <CenteredBold>{`Congratulations, ${winner.name}... you are the winner of Big Brother!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [newGameState, scene];\n}\n","import React from \"react\";\nimport { EpisodeType, Episode, InitEpisode } from \"./episodes\";\nimport { Scene } from \"./scenes/scene\";\nimport { GameState } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { finalHohCompScene } from \"./scenes/finalHohCompScene\";\nimport { finalEvictionScene } from \"./scenes/finalEvictionScene\";\nimport { juryVoteScene } from \"./scenes/juryVoteScene\";\nimport { HasText } from \"../layout/text\";\n\nexport const BigBrotherFinale: EpisodeType = {\n    canPlayWith: (n: number) => n === 3,\n    eliminates: 2,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n    name: \"Big Brother Finale\",\n    generate: generateBbFinale,\n};\n\nexport function generateBbFinale(initialGameState: GameState): Episode {\n    const title = \"Finale\";\n    const content = (\n        <HasText>\n            <MemoryWall houseguests={initialGameState.houseguests} /> <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n    let currentGameState;\n    let hohCompScene;\n    let finalHoH;\n    const scenes = [];\n    [currentGameState, hohCompScene, finalHoH] = finalHohCompScene(initialGameState);\n    scenes.push(hohCompScene);\n    let finalEviction;\n    [currentGameState, finalEviction] = finalEvictionScene(currentGameState, finalHoH);\n    scenes.push(finalEviction);\n    const [gameState, juryScene] = juryVoteScene(currentGameState);\n    scenes.push(juryScene);\n    return new Episode({ gameState, content, title, scenes, type: BigBrotherFinale });\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById,\n} from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { Portraits, Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\n\nexport function finalHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n    const final3 = nonEvictedHouseguests(initialGameState);\n    const enduranceWinner = randomPlayer(final3);\n    const enduranceLosers = final3.filter((hg) => hg.id !== enduranceWinner.id);\n    const skillWinner = randomPlayer(final3, [enduranceWinner]);\n    const finalHoH = getById(newGameState, randomPlayer([enduranceWinner, skillWinner]).id);\n    finalHoH.hohWins++;\n    const scene: Scene = new Scene({\n        title: \"Final HoH Competition\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>The final 3 houseguests compete in the endurance competition.</Centered>\n                <Portraits houseguests={final3} centered={true} />\n                <Portrait houseguest={enduranceWinner} centered={true} />\n                <CenteredBold>{`${enduranceWinner.name} has won the endurance competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceLosers[0].name} and ${enduranceLosers[1].name} compete in the skill competition.`}</Centered>\n                <Portraits houseguests={enduranceLosers} centered={true} />\n                <Portrait houseguest={skillWinner} centered={true} />\n                <CenteredBold>{`${skillWinner.name} has won the skill competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceWinner.name} and ${skillWinner.name} compete in the quiz competition.`}</Centered>\n                <Portraits houseguests={[enduranceWinner, skillWinner]} centered={true} />\n                <Portrait houseguest={finalHoH} centered={true} />\n                <CenteredBold>{`Congratulations ${finalHoH.name}, you are the final Head of Household!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, finalHoH];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests } from \"../../../model\";\nimport { Scene } from \"./scene\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { HoHVote, NomineeVote } from \"../../../model/logging/voteType\";\nimport { evictHouseguest } from \"../utilities/evictHouseguest\";\n\nexport function finalEvictionScene(initialGameState: GameState, HoH: Houseguest): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const nominees = nonEvictedHouseguests(newGameState).filter((hg) => hg.id !== HoH.id);\n    newGameState.currentLog.nominationsPostVeto = nominees.map((hg) => hg.name);\n    const { decision: vote, reason } = castEvictionVote(HoH, nominees, newGameState);\n    const evictee = nominees[vote];\n    const survivor = nominees[vote == 1 ? 0 : 1];\n    newGameState.currentLog.soleVoter = HoH.name;\n    newGameState.currentLog.votes[survivor.id] = new NomineeVote(false);\n    newGameState.currentLog.votes[HoH.id] = new HoHVote(evictee.id);\n    newGameState.currentLog.votesInMajority = 1;\n    newGameState.currentLog.outOf = 1;\n    const hoh: ProfileHouseguest = { ...HoH };\n    hoh.tooltip = reason;\n    evictHouseguest(newGameState, evictee.id);\n    const scene: Scene = new Scene({\n        title: \"Final Eviction\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    {`As the final HoH of the season, ${HoH.name}, you may now cast the sole vote to evict.`}\n                </Centered>\n                <Portrait houseguest={hoh} centered={true} />\n                <CenteredBold>{`I vote to evict ${evictee.name}.`}</CenteredBold>\n                <Portraits houseguests={nominees} centered={true} />\n                <Centered>\n                    It's official... {evictee.name}, you will be the final person leaving the Big Brother\n                    House.\n                </Centered>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene];\n}\n","import { Episode, EpisodeType } from \"./episodes\";\nimport { Scene } from \"./scenes/scene\";\nimport { GameState } from \"../../model\";\nimport { generateVotingTable } from \"./scenes/votingTable\";\nimport { evictHouseguest } from \"./utilities/evictHouseguest\";\n\nexport const GameOver: EpisodeType = {\n    canPlayWith: (_: number) => true,\n    eliminates: 1,\n    arrowsEnabled: false,\n    hasViewsbar: false,\n    name: \"Game Over\",\n    generate: generateGameOver,\n};\n\nexport function generateGameOver(gameState: GameState): Episode {\n    const title = \"Game Over\";\n    const scenes: Scene[] = [];\n    const content = generateVotingTable(gameState);\n    gameState.houseguests.forEach((hg) => {\n        evictHouseguest(gameState, hg.id);\n    });\n    return new Episode({ gameState, content, title, scenes, type: GameOver });\n}\n","import { Subscription } from \"rxjs\";\nimport { Sidebar } from \"./sidebar\";\nimport { EpisodeLibrary, Season } from \"../../model/season\";\nimport { Episode, nonEvictedHouseguests, getById } from \"../../model\";\nimport { Scene } from \"../episode/scenes/scene\";\nimport {\n    mainContentStream$,\n    episodes$,\n    switchEpisode$,\n    newEpisode,\n    switchSceneRelative,\n    getSelectedPlayer,\n    selectedPlayer$,\n    displayMode$,\n    season$,\n    pushToMainContentStream,\n} from \"../../subjects/subjects\";\nimport { popularityMode } from \"../../model/portraitDisplayMode\";\nimport { activeScreen$, Screens } from \"../topbar/topBar\";\n\ninterface IndexedScene {\n    scene: Scene;\n    index: number;\n}\n\nconst LEFT = 37;\nconst RIGHT = 39;\n\nexport class SidebarController {\n    private view: Sidebar;\n    private subscriptions: Subscription[] = [];\n    private season: Season = new Season();\n    private scenes: IndexedScene[] = [];\n    private selectedEpisode: number = 0;\n\n    public constructor(view: Sidebar) {\n        this.view = view;\n        this.subscriptions.push(\n            activeScreen$.subscribe((screen) => {\n                this.view.setState({ selectionsActive: screen === Screens.Other });\n            })\n        );\n        this.subscriptions.push(\n            episodes$.subscribe({\n                next: (episode) => this.onNewEpisode(episode),\n            })\n        );\n        this.subscriptions.push(\n            switchEpisode$.subscribe({\n                next: (value: number) => {\n                    this.switchSceneRelative(value);\n                },\n            })\n        );\n        this.subscriptions.push(\n            season$.subscribe({\n                next: (library: EpisodeLibrary) => {\n                    this.season = new Season(library);\n                    this.selectedEpisode = 0;\n                    displayMode$.next(popularityMode);\n                },\n            })\n        );\n    }\n\n    public getSelectedEpisode() {\n        return this.selectedEpisode;\n    }\n\n    public async switchToScene(id: number) {\n        pushToMainContentStream(this.scenes[id].scene.render, Screens.Other);\n        this.selectedEpisode = this.scenes[id].index;\n        await this.view.setState({ selectedScene: id });\n        if (getSelectedPlayer() !== null) {\n            selectedPlayer$.next(\n                getById(this.scenes[this.view.state.selectedScene].scene.gameState, getSelectedPlayer()!.id)\n            );\n        }\n    }\n\n    private switchSceneRelative = (delta: number) => {\n        const selectedScene = this.view.state.selectedScene;\n        const renderedScenes = this.scenes.length;\n        const targetScene = selectedScene + delta;\n        if (targetScene < 0) {\n            return;\n        }\n        const lastEpisode = this.view.state.episodes[this.view.state.episodes.length - 1];\n        if (targetScene < renderedScenes) {\n            // Go back to an earlier scene\n            this.switchToScene(targetScene);\n        } else if (targetScene === renderedScenes) {\n            // Generate a new scene, then jump to it\n            const currentGameState = lastEpisode.gameState;\n            const newPlayerCount = nonEvictedHouseguests(lastEpisode.gameState).length;\n            if (newPlayerCount > 0) {\n                newEpisode(this.season.renderEpisode(currentGameState));\n                this.switchSceneRelative(1);\n            }\n        }\n    };\n\n    get handleKeyDown(): (e: any) => void {\n        return this._handleKeyDown.bind(this);\n    }\n\n    private _handleKeyDown(event: any) {\n        const state = this.view.state;\n        if (\n            state.episodes[this.selectedEpisode] === undefined ||\n            !state.episodes[this.selectedEpisode].type.arrowsEnabled ||\n            activeScreen$.value !== Screens.Other\n        ) {\n            return;\n        }\n        if (event.keyCode === LEFT) {\n            switchSceneRelative(-1);\n        } else if (event.keyCode === RIGHT) {\n            switchSceneRelative(1);\n        }\n    }\n\n    private onNewEpisode(episode: Episode | null) {\n        if (!episode) {\n            this.view.setState({ episodes: [], selectedScene: 0 });\n            this.scenes = [];\n        } else {\n            const newState = { ...this.view.state };\n            // starts at -1: prevent OBOE\n            const latestIndex = this.scenes.length === 0 ? -1 : this.scenes[this.scenes.length - 1].index;\n            const index = latestIndex + 1;\n            this.scenes.push({ scene: episode, index });\n            episode.scenes.forEach((scene) => this.scenes.push({ scene, index }));\n            newState.episodes.push(episode);\n            this.view.setState(newState);\n        }\n    }\n\n    public destroy() {\n        this.subscriptions.forEach((sub) => sub.unsubscribe());\n    }\n}\n","import React from \"react\";\nimport { SidebarController } from \"./sidebarController\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { defaultJurySize, Episode, GameState, PlayerProfile } from \"../../model\";\nimport { Scene } from \"../episode/scenes/scene\";\nimport { cast$, newEpisode, pushToMainContentStream } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\nimport { HasText } from \"../layout/text\";\nimport { shuffle } from \"lodash\";\nimport { activeScreen$, Screens } from \"../topbar/topBar\";\ninterface SidebarState {\n    episodes: Episode[];\n    selectedScene: number;\n    selectionsActive: boolean;\n}\nconst baseUrl = \"https://spaulmark.github.io/img/\";\n\nlet firstLoad = true;\n\nexport class Sidebar extends React.Component<{}, SidebarState> {\n    private controller: SidebarController;\n    public constructor(props: {}) {\n        super(props);\n        this.controller = new SidebarController(this);\n        this.state = { episodes: [], selectedScene: 0, selectionsActive: true };\n    }\n    public async componentDidMount() {\n        // TODO: this gonna get totally rewritten into a precomputed whitelist.json, first thing next update\n        document.addEventListener(\"keydown\", this.controller.handleKeyDown);\n        if (!firstLoad) {\n            firstLoad = false;\n            return;\n        }\n        const data = await (await fetch(`${baseUrl}dir.json`)).json();\n        const bb = data.decks.filter((file: string) => file.match(\"Big Brother\"));\n        let allBBs: PlayerProfile[] = [];\n        for (const cast of bb) {\n            const bbPlayers = await (await fetch(`${baseUrl}${cast}/dir.json`)).json();\n            bbPlayers.files.forEach((player: string) => {\n                const name = player.substr(0, player.lastIndexOf(\".\")) || player;\n                if (name === \"Julie\") return;\n                allBBs.push({\n                    name,\n                    imageURL: `${baseUrl}${cast}/${player}`,\n                });\n            });\n        }\n        allBBs = shuffle(allBBs);\n        allBBs = allBBs.slice(0, 16);\n        const episode: Episode = new PregameEpisode(\n            new GameState({ players: allBBs, jury: defaultJurySize(allBBs.length) })\n        );\n        newEpisode(episode);\n        cast$.next(allBBs);\n        if (activeScreen$.value === Screens.Other) {\n            pushToMainContentStream(episode.render, Screens.Other);\n        }\n    }\n\n    public componentWillUnmount() {\n        this.controller.destroy();\n    }\n\n    public render() {\n        return (\n            <Box style={{ minWidth: 180 }}>\n                <HasText>{this.getEpisodes()}</HasText>\n            </Box>\n        );\n    }\n\n    private getHighlight(title: string, key: number) {\n        if (key === this.state.selectedScene && this.state.selectionsActive) {\n            return <mark>{title}</mark>;\n        }\n        return title;\n    }\n\n    private getEpisodes() {\n        const result: JSX.Element[] = [];\n        // Weird OBOE to make keys start at 0\n        let episodeKey = -1;\n        let breakKey = 0;\n        this.state.episodes.forEach((episode: Episode) => {\n            const id = ++episodeKey;\n            result.push(\n                <b\n                    key={id}\n                    onClick={() => {\n                        this.controller.switchToScene(id);\n                    }}\n                >\n                    {this.getHighlight(episode.title, id)}\n                </b>\n            );\n            result.push(<br key={--breakKey} />);\n            episode.scenes.forEach((scene: Scene) => {\n                const id = ++episodeKey;\n                if (this.controller.getSelectedEpisode() === episode.gameState.phase) {\n                    result.push(\n                        <a key={id} onClick={() => this.controller.switchToScene(id)}>\n                            {this.getHighlight(scene.title, id)}\n                        </a>\n                    );\n                    result.push(<br key={--breakKey} />);\n                }\n            });\n        });\n        return result;\n    }\n}\n","import styled from \"styled-components\";\nimport React from \"react\";\nimport { mainContentStream$ } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\n\nconst MainContentAreaWrapper = styled(Box)`\n    overflow-x: auto;\n`;\n\nexport class MainContentArea extends React.Component<{}, { content: any }> {\n    // a simple class that displays whatever it gets fed through the main content stream.\n\n    private contentStream: any;\n\n    public constructor(props: any) {\n        super(props);\n        this.state = { content: null };\n    }\n\n    public componentDidMount() {\n        this.contentStream = mainContentStream$.subscribe((content) => {\n            this.setState({ content });\n        });\n    }\n\n    public componentDidUpdate(prevProps: never, prevState: any) {\n        if (prevState.content !== this.state.content) {\n            window.scrollTo(0, 0);\n        }\n    }\n\n    public componentWillUnmount() {\n        this.contentStream.unsubscribe();\n    }\n\n    public render() {\n        return <MainContentAreaWrapper>{this.state.content}</MainContentAreaWrapper>;\n    }\n}\n","import \"./bulma.scss\";\nimport React from \"react\";\nimport { Sidebar } from \"../sidebar/sidebar\";\nimport { Topbar } from \"../topbar/topBar\";\nimport { MainContentArea } from \"./mainContentArea\";\nimport { MainPageController } from \"./mainPageController\";\n\ninterface MainPageProps {\n    controller: MainPageController;\n}\n\ninterface MainPageState {\n    fullscreen: boolean;\n}\n\nexport class MainPage extends React.Component<MainPageProps, MainPageState> {\n    public constructor(props: MainPageProps) {\n        super(props);\n        this.state = { fullscreen: false };\n        props.controller.inject(this);\n    }\n    public componentDidMount() {\n        this.props.controller.subscribe();\n    }\n    public componentWillUnmount() {\n        this.props.controller.unsubscribe();\n    }\n\n    public render() {\n        const fullscreen = this.state.fullscreen;\n        const hideOnFullscreen = { display: fullscreen ? \"none\" : \"\" };\n        const wrapperStyle = fullscreen\n            ? { margin: \"auto\" }\n            : { margin: \"auto\", maxWidth: 1480, overflow: \"hidden\" };\n        return (\n            <div style={wrapperStyle}>\n                <Topbar style={hideOnFullscreen} />\n                <div className=\"columns\">\n                    <div className=\"column is-narrow\" style={hideOnFullscreen}>\n                        <Sidebar />\n                    </div>\n\n                    <div className=\"column\" style={{ overflowX: \"hidden\" }}>\n                        <MainContentArea />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","import { MainPage } from \"./mainPage\";\nimport { Subscription } from \"rxjs\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\n\nexport class MainPageController {\n    private view: MainPage = new MainPage({ controller: this });\n    private subscriptions: Subscription[] = [];\n    public inject(page: MainPage) {\n        this.view = page;\n    }\n\n    public subscribe(): void {\n        this.unsubscribe();\n        this.subscriptions.push(\n            isFullscreen$.subscribe((fullscreen: boolean) => {\n                this.view.setState({ fullscreen });\n            })\n        );\n    }\n\n    public unsubscribe(): void {\n        this.subscriptions.forEach(sub => sub.unsubscribe());\n    }\n}\n","export interface ColorTheme {\n    name: string;\n    bg: string;\n    text: string;\n    toggleBorder: string;\n    bodyArea: string;\n    link: string;\n    mark: string;\n    overlay: string;\n    evictedCell: string;\n    grayCell: string;\n    winnerCell: string;\n    lightGrayCell: string;\n    runnerUpCell: string;\n    saveCell: string;\n    nomineeCell: string;\n    hohCell: string;\n    portraitBorder: string;\n    tableCellBorder: string;\n}\n\n// export const lightTheme: ColorTheme = {\n//     name: \"light\",\n//     bg: \"#fff\",\n//     text: \"#363537\",\n//     toggleBorder: \"#FFF\",\n//     bodyArea: \"#fff\",\n//     link: \"blue\",\n//     mark: \"yellow\",\n//     overlay: \"fff\",\n//     evictedCell: \"#fa8072\",\n//     grayCell: \"#eaecf0\",\n//     lightGrayCell: \"#f8f9fa\",\n//     winnerCell: \"#73fb76\",\n//     runnerUpCell: \"#d1e8ef\",\n//     nomineeCell: \"#959ffd\",\n//     hohCell: \"#CCFFCC\",\n//     portraitBorder: \"gray\",\n//     tableCellBorder: \"#a2a9b1\",\n// };\n\nexport const darkTheme: ColorTheme = {\n    name: \"dark\",\n    bg: \"#121212\",\n    saveCell: \"#334d5e\",\n    text: \"#FAFAFA\",\n    bodyArea: \"#363537\",\n    toggleBorder: \"#6B8096\",\n    link: \"lightblue\",\n    mark: \"#7e006d\",\n    overlay: \"#444346\",\n    evictedCell: \"#9d4c43\",\n    grayCell: \"#5e5e5e\",\n    lightGrayCell: \"#404040\",\n    runnerUpCell: \"#9fbec882\",\n    nomineeCell: \"#6c75d0\",\n    winnerCell: \"#00ac04\",\n    hohCell: \"#3f783f\",\n    portraitBorder: \"#484848\",\n    tableCellBorder: \"#53575b\",\n};\n","import { createGlobalStyle } from \"styled-components\";\nimport { ColorTheme } from \"./theme\";\n\nexport const GlobalStyles = createGlobalStyle`\n  *,\n  *::after,\n  *::before {\n    box-sizing: border-box;\n  }\n\n  body {\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bg};\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n       transition: all 0.25s linear;\n  }`;\n","import React from \"react\";\nimport { MainPage } from \"./components/mainPage/mainPage\";\nimport { MainPageController } from \"./components/mainPage/mainPageController\";\nimport { ThemeProvider } from \"styled-components\";\nimport { ColorTheme, darkTheme } from \"./theme/theme\";\nimport { GlobalStyles } from \"./theme/globalTheme\";\nimport { theme$ } from \"./subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nclass App extends React.Component<{}, { theme: ColorTheme }> {\n    private sub: Subscription | null = null;\n    public constructor(props: any) {\n        super(props);\n        this.state = {\n            theme: darkTheme,\n        };\n    }\n\n    public componentDidMount() {\n        this.sub = theme$.subscribe((theme) => {\n            this.setState({ theme });\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    render() {\n        return (\n            <ThemeProvider theme={this.state.theme}>\n                <>\n                    <GlobalStyles />\n                    <MainPage controller={new MainPageController()} />\n                </>\n            </ThemeProvider>\n        );\n    }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}