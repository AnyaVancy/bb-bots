{"version":3,"sources":["model/playerProfile.ts","model/powerRanking.ts","model/houseguest.ts","utils/utilities.ts","utils/relationshipMap.ts","components/playerPortrait/selectedPortrait.ts","model/color.ts","components/playerPortrait/houseguestPortraitController.ts","components/playerPortrait/houseguestPortrait.tsx","components/playerPortrait/houseguestToPortrait.tsx","components/tooltip/tooltip.tsx","components/playerPortrait/portraits.tsx","components/memoryWall/memoryWall.tsx","components/nextEpisodeButton/nextEpisodeButton.tsx","utils/ai/classifyRelationship.ts","components/playerPortrait/setupPortrait.tsx","components/castingScreen/importLinks.tsx","components/playerPortrait/subtitle.tsx","model/portraitDisplayMode.ts","components/viewsBar/viewBarTag.tsx","components/viewsBar/viewBar.tsx","components/episode/episodes.tsx","components/episode/pregameEpisode.tsx","components/castingScreen/randomXButton.tsx","components/castingScreen/castingScreen.tsx","subjects/subjects.tsx","components/topbar/topBar.tsx","components/pregameScreen/pregameScreen.tsx","utils/BbRandomGenerator.ts","model/gameState.ts","model/season.ts","components/episode/scene.tsx","utils/ai/aiUtils.ts","utils/ai/aiApi.ts","components/episode/scenes/juryVoteScene.tsx","components/episode/bigBrotherFinale.tsx","components/episode/scenes/finalHohCompScene.tsx","components/episode/scenes/finalEvictionScene.tsx","components/episode/episodeFactory.ts","components/episode/bigBrotherEpisode.tsx","components/episode/scenes/hohCompScene.tsx","components/episode/scenes/nomCeremonyScene.tsx","components/episode/scenes/vetoCompScene.tsx","components/episode/scenes/vetoCeremonyScene.tsx","components/episode/scenes/evictionScene.tsx","components/sidebar/sidebarController.ts","components/sidebar/sidebar.tsx","components/mainPage/mainContentArea.tsx","components/mainPage/mainPage.tsx","components/mainPage/mainPageController.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["PlayerProfile","init","Object","classCallCheck","this","name","imageURL","assign","PowerRanking","beats","outOf","Error","createClass","key","get","Houseguest","_PlayerProfile","_this","possibleConstructorReturn","getPrototypeOf","call","isEvicted","isJury","id","nominations","hohWins","povWins","popularity","deltaPopularity","relationships","powerRanking","superiors","Set","getFriendEnemyCount","friends","enemies","assertThisInitialized","inherits","value","villain","roundTwoDigits","number","Math","round","newRelationshipMap","size","exclude","result","i","selectPlayer","player","getSelectedPlayer","selectedPlayer$","next","componentToHex","c","hex","toString","length","Rgb","r","g","b","concat","interpolateColor","min","max","percent","toHex","selectedColor","HouseguestPortraitController","view","subs","refreshData","data","props","setState","comparePowerRankings","defaultState","selectedPlayer","undefined","state","displayMode","backgroundColor","_this2","push","subscribe","displayMode$","forEach","sub","unsubscribe","has","HouseguestPortrait","_React$Component","controller","isNullOrUndefined","subtitle","imageClass","getImageClass","generateSubtitle","detailed","className","react_default","a","createElement","onClick","style","src","width","height","React","Component","houseguestToPortrait","houseguest","houseguestPortrait_HouseguestPortrait","Text","styled","p","_templateObject","Tooltip","visible","Popover_default","isOpen","content","text","onMouseEnter","onMouseLeave","children","Portrait","centered","tooltip","tooltip_Tooltip","Portraits","rows","houseguests","memoryWallPortrait","MemoryWall","margin","maxWidth","getPlayers","NextEpisodeButton","switchSceneRelative","RelationshipType","SetupPortrait","textAlign","onDoubleClick","onDelete","imageUrl","contentEditable","onChange","spellCheck","ImportLinks","lines","split","profiles","line","temp","pop","replace","substr","indexOf","onSubmit","event","target","RelationshipTypeToSymbol","FRIEND","ENEMY","PAWN","QUEEN","classifyRelationship","heroPopularity","villainPopularity","relationship","benefitsHero","benefitsVillain","Friend","Pawn","Queen","Enemy","generatePopularitySubtitle","hero","_addFriendshipCountTi","lineHeight","titles","friendOrEnemyTitle","map","txt","count","Relationship","friendEnemyCountTitle","addFriendshipCountTitles","addCompsLine","addPopularityLine","arguments","popularitySubtitle","deltaPop","statePopularity","getDeltaPopularity","compWins","popularityMinColor","popularityMaxColor","popularityMode","minColor","maxColor","extremePopularity","x","xSquared","extremeValues","powerMaxColor","powerMinColor","powerMode","toFloat","_","ViewBarTag","selected","mode","_this3","disabled","background","toRgba","cursor","ViewsBar","apply","viewBarTag_ViewBarTag","Episode","scenes","title","gameState","type","viewBar_ViewsBar","PregameEpisodeType","eliminates","canPlayWith","n","PregameEpisode","_Episode","PregameScreen","cast","RandomButton","_useState","useState","_useState2","slicedToArray","setNumber","random","parseInt","NumericInput","marginLeft","test","CastingScreen","appendProfiles","newState","objectSpread","profile","players","submit","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","newCast","cast$","mainContentStream$","newEpisode","GameState","stop","amount","shuffle","slice","handleUpload","handleFiles","files","handleDrop","newName","splice","_this4","setupPortrait_SetupPortrait","deleteMethod","handleChange","_this5","FileDrop","onDrop","importLinks_ImportLinks","multiple","getFiles","file","match","lastIndexOf","URL","createObjectURL","EditCastLink","castingScreen_CastingScreen","getCast","EditSeasonLink","Topbar","marginTop","BehaviorSubject","episodes$","switchEpisode$","Subject","episode","BbRandomGenerator","seed","rng","prand","xorshift128plus","_this$rng$next","_this$rng$next2","_prand$uniformIntDist","uniformIntDistribution","_prand$uniformIntDist2","_this$rng$next3","_this$rng$next4","rng$","castNames","string","hash","charCodeAt","hashcode","getById","find","hg","inclusions","exclusions","excludedIds","filter","includes","randomPlayer","options","randomInt","nonEvictedHouseguests","getJurors","inJury","remainingPlayers","finalJurySize","phase","previousHOH","Array","MutableGameState","copy","cloneDeep","Scene","render","favouriteIndex","callback","highestIndex","highestScore","Infinity","currentScore","lowestScore","lowestIndex","doesHeroWinTheFinale","hgs","jury","heroVotes","villainVotes","juror","heroShouldTargetSuperiors","castEvictionVote","nominees","nom0","nom1","zeroIsInferior","oneIsInferior","cutthroatVote","nonVote","vote","reason","nonTarget","excuse","targetIsFriend","nonTargetIsNonFriend","nonTargetIsFriend","targetIsNonFriend","cutthroatVoteJury","r0","r1","nominatePlayer","hitlist","hitList","trueOptions","useGoldenVetoPreJury","save","rel0","relationshipWith","rel1","juryVoteScene","initialGameState","jurors","finalists","voteCount","votes","castJuryVote","voteBlocks","winner","BigBrotherFinale","generateBbFinaleInit","currentGameState","hohCompScene","finalHoH","finalEviction","_finalHohCompScene","newGameState","final3","enduranceWinner","enduranceLosers","skillWinner","scene","finalHohCompScene","_finalHohCompScene2","_finalEvictionScene","HoH","_castEvictionVote","evictee","hoh","evictHouseguest","finalEvictionScene","_finalEvictionScene2","BigBrotherFinaleEpisode","EpisodeFactory","episodeType","iMap","j","jMap","impression","randomFloat","firstImpressions","heroWinsTheFinale","add","populateSuperiors","house","sum","targetId","calculatePopularity","updatePopularity","rel","updateFriendCounts","finalState","BigBrotherVanilla","nomCeremonyScene","_generateHohCompScene","previousHoh","newHoH","generateHohCompScene","_generateHohCompScene2","vetoCompScene","povWinner","_generateNomCeremonyS","nom2","noms","generateNomCeremonyScene","_generateNomCeremonyS2","vetoCeremonyScene","_generateVetoCompScen","choices","povPlayers","everyoneWillPlay","introText","extras","generateVetoCompScene","_generateVetoCompScen2","evictionScene","_generateVetoCeremony","initialNominees","povTarget","descisionText","useGoldenVeto","replacementSpeech","nameAReplacement","finalNominees","replacementNom","generateVetoCeremonyScene","_generateVetoCeremony2","_generateEvictionScen","logic","votesFor0","votesFor1","tieVote","tieBreaker","voteCountText","displayHoH","generateEvictionScene","_generateEvictionScen2","BigBrotherVanillaEpisode","generateBbVanilla","delete","Season","factory","nextEpisode","SidebarController","subscriptions","season","selectedEpisode","delta","selectedScene","renderedScenes","targetScene","lastEpisode","episodes","switchToScene","newPlayerCount","nextEpisodeType","whichEpisodeType","renderEpisode","onNewEpisode","_switchToScene","index","_x","keyCode","Sidebar","document","addEventListener","handleKeyDown","destroy","minWidth","getEpisodes","episodeKey","breakKey","getHighlight","getSelectedEpisode","MainContentArea","contentStream","prevProps","prevState","window","scrollTo","MainPage","inject","sidebar_Sidebar","mainContentArea_MainContentArea","MainPageController","page","App","mainPage_MainPage","Boolean","location","hostname","ReactDOM","src_App","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.37343fc3.chunk.js","sourcesContent":["export class PlayerProfile {\n    readonly name: string = \"\";\n    readonly imageURL: string = \"\";\n    constructor(init: PlayerProfile) {\n        if (!init) {\n            return;\n        }\n        Object.assign(this, init);\n    }\n}\n","export class PowerRanking {\n    readonly beats: number;\n    readonly outOf: number;\n    get toFloat(): number {\n        return this.beats / this.outOf;\n    }\n\n    constructor(beats: number, outOf: number) {\n        if (outOf === 0) throw new Error(\"Power ranking attempted to divide by zero\");\n        this.beats = beats;\n        this.outOf = outOf;\n    }\n}\n","import { PlayerProfile } from \"./playerProfile\";\nimport { RelationshipMap } from \"../utils\";\nimport { PowerRanking } from \"./powerRanking\";\n\ninterface HouseguestInit extends PlayerProfile {\n    id: number;\n    relationships: RelationshipMap;\n}\n\nexport class Houseguest extends PlayerProfile {\n    public isEvicted: boolean = false;\n    public isJury: boolean = false;\n\n    readonly id: number = 0;\n\n    public nominations: number = 0;\n    public hohWins: number = 0;\n    public povWins: number = 0;\n\n    // Popularity ranges from -1 to 1\n    public popularity: number = 0;\n    public deltaPopularity: number = 0;\n    readonly relationships: RelationshipMap = {};\n\n    // power rankings range from 0 to 1\n    public powerRanking: PowerRanking = new PowerRanking(0, 1);\n    readonly superiors: Set<number> = new Set<number>();\n\n    public relationshipWith(villain: Houseguest): number {\n        return this.relationships[villain.id];\n    }\n\n    public getFriendEnemyCount: () => { friends: number; enemies: number } = () => {\n        return { friends: 0, enemies: 0 };\n    };\n\n    constructor(init: HouseguestInit) {\n        super(init);\n        Object.assign(this, init);\n    }\n}\n","// spits out the next episode given a gamestate, in addition to the new gamestate.\n// allows for re-use, because you can give it the initial gamestate, and then just keep asking for the next season.\nexport function hashcode(string: string): number {\n    var hash = 0,\n        i,\n        chr;\n    if (string.length === 0) return hash;\n    for (i = 0; i < string.length; i++) {\n        chr = string.charCodeAt(i);\n        hash = (hash << 5) - hash + chr;\n        hash |= 0;\n    }\n    return hash;\n}\n\nexport function roundTwoDigits(number: number | undefined) {\n    if (!number) {\n        return 0;\n    }\n    return Math.round(number * 100);\n}\n\nexport function extremeValues(x: number | undefined): number {\n    if (!x) {\n        return 0;\n    }\n    const xSquared = x * x;\n    if (x >= 0) {\n        return -xSquared + 2 * x;\n    } else {\n        return xSquared + 2 * x;\n    }\n}\n","export interface RelationshipMap {\n    [id: number]: number;\n}\n\nexport function newRelationshipMap(size: number, exclude: number): RelationshipMap {\n    const result: RelationshipMap = {};\n    for (let i = 0; i < size; i++) {\n        if (i !== exclude) result[i] = 0;\n    }\n    return result;\n}\n","import { Houseguest } from \"../../model\";\nimport { RelationshipMap } from \"../../utils\";\nimport { getSelectedPlayer, selectedPlayer$ } from \"../../subjects/subjects\";\n\nexport interface SelectedPlayerData {\n    id: number;\n    popularity: number;\n    relationships: RelationshipMap;\n    isEvicted: boolean;\n    superiors?: Set<number>;\n}\n\nexport function selectPlayer(player: SelectedPlayerData | null) {\n    if (!player || (getSelectedPlayer() && (getSelectedPlayer() as Houseguest).id === player.id)) {\n        selectedPlayer$.next(null);\n    } else {\n        selectedPlayer$.next(player);\n    }\n}\n","function componentToHex(c: any) {\n    var hex = Math.round(c).toString(16);\n    return hex.length == 1 ? \"0\" + hex : hex;\n}\n\nexport class Rgb {\n    public r: number;\n    public g: number;\n    public b: number;\n    public toHex() {\n        return \"#\" + componentToHex(this.r) + componentToHex(this.g) + componentToHex(this.b);\n    }\n    public toRgba(): string {\n        return `rgba(${this.r}, ${this.g}, ${this.b}, 1)`;\n    }\n    constructor(r: number, g: number, b: number) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n    }\n}\n\nexport function interpolateColor(min: Rgb, max: Rgb, percent: number): string {\n    return new Rgb(\n        min.r + percent * (max.r - min.r),\n        min.g + percent * (max.g - min.g),\n        min.b + percent * (max.b - min.b)\n    ).toHex();\n}\n","import { PortraitProps, HouseguestPortrait, PortraitState } from \"../memoryWall\";\nimport { Subscription } from \"rxjs\";\nimport { selectedPlayer$, displayMode$, getSelectedPlayer } from \"../../subjects/subjects\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport { Rgb } from \"../../model/color\";\nimport { PowerRanking } from \"../../model/powerRanking\";\n\nconst selectedColor = new Rgb(51, 255, 249);\n\nexport class HouseguestPortraitController {\n    private subs: Subscription[] = [];\n    private view: HouseguestPortrait;\n    constructor(view: HouseguestPortrait) {\n        this.view = view;\n    }\n\n    get defaultState() {\n        return {\n            popularity: this.view.props.popularity,\n            displayMode: displayMode$.value,\n            powerRanking: this.view.props.powerRanking\n        };\n    }\n\n    public backgroundColor(props: PortraitProps): undefined | string {\n        const selectedPlayer = getSelectedPlayer();\n        if (selectedPlayer !== null && selectedPlayer.id === props.id) {\n            return selectedColor.toHex();\n        }\n        return props.isEvicted ? undefined : this.view.state.displayMode.backgroundColor(this.view.state);\n    }\n\n    public subscribe() {\n        const subs: Subscription[] = [];\n        subs.push(\n            selectedPlayer$.subscribe({\n                next: this.refreshData\n            })\n        );\n        subs.push(\n            displayMode$.subscribe({\n                next: displayMode => this.view.setState({ displayMode })\n            })\n        );\n        this.subs = subs;\n    }\n\n    public unsubscribe() {\n        this.subs.forEach(sub => sub.unsubscribe());\n    }\n\n    private comparePowerRankings(data: SelectedPlayerData): PowerRanking {\n        // 0 is blue. 1 is orange\n        if (!data.superiors) return new PowerRanking(0, 1);\n        const id = this.view.props.id === undefined ? -1 : this.view.props.id;\n        return data.superiors.has(id) ? new PowerRanking(1, 1) : new PowerRanking(0, 1);\n    }\n\n    private refreshData = (data: SelectedPlayerData | null) => {\n        if (!data) {\n            this.view.setState(this.defaultState);\n        } else {\n            if (data.id !== this.view.props.id) {\n                this.view.setState({\n                    popularity: data.relationships[this.view.props.id!],\n                    powerRanking: this.comparePowerRankings(data)\n                });\n            } else {\n                this.view.setState({ popularity: 2, powerRanking: new PowerRanking(2, 1) });\n            }\n        }\n    };\n}\n","import React from \"react\";\nimport { selectPlayer } from \"./selectedPortrait\";\nimport { isNullOrUndefined } from \"util\";\nimport { RelationshipMap } from \"../../utils\";\nimport _ from \"lodash\";\nimport { HouseguestPortraitController } from \"./houseguestPortraitController\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport { PowerRanking } from \"../../model/powerRanking\";\n\nexport interface PortraitProps {\n    imageURL: string;\n    name: string;\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    powerRanking?: PowerRanking;\n    deltaPopularity?: number;\n    detailed?: boolean;\n    superiors?: Set<number>;\n    getFriendEnemyCount?: () => { friends: number; enemies: number };\n}\n\nexport interface PortraitState {\n    popularity?: number;\n    powerRanking?: PowerRanking;\n    displayMode: PortraitDisplayMode;\n}\nexport class HouseguestPortrait extends React.Component<PortraitProps, PortraitState> {\n    private controller: HouseguestPortraitController;\n\n    public constructor(props: PortraitProps) {\n        super(props);\n        this.controller = new HouseguestPortraitController(this);\n        this.state = this.controller.defaultState;\n    }\n\n    public componentDidMount() {\n        if (isNullOrUndefined(this.props.id)) {\n            return;\n        }\n        this.controller.subscribe();\n    }\n\n    public componentWillUnmount() {\n        this.controller.unsubscribe();\n    }\n\n    private onClick(): void {\n        if (isNullOrUndefined(this.props.id) || !this.props.relationships) {\n            return;\n        }\n        const data = {\n            id: this.props.id,\n            relationships: this.props.relationships,\n            isEvicted: !!this.props.isEvicted,\n            popularity: this.props.popularity || 0,\n            superiors: this.props.superiors\n        };\n        selectPlayer(data);\n    }\n\n    public render() {\n        const props = this.props;\n        const imageClass = getImageClass(props);\n        let subtitle: any[] = [];\n        subtitle = this.state.displayMode.generateSubtitle(this.props, this.state, !!props.detailed);\n\n        let className = \"\";\n        if (props.isJury) {\n            className = \"jury\";\n        } else if (props.isEvicted) {\n            className = \"evicted\";\n        }\n        return (\n            <div\n                onClick={() => this.onClick()}\n                style={{\n                    backgroundColor: this.controller.backgroundColor(props)\n                }}\n                className={`memory-wall-portrait ${className}`}\n            >\n                <img className={imageClass} src={props.imageURL} style={{ width: 100, height: 100 }} />\n                <br />\n                {props.name}\n                <br />\n                {<small className=\"portrait-history\">{subtitle}</small>}\n            </div>\n        );\n    }\n}\n\nfunction getImageClass(props: PortraitProps) {\n    let imageClass = props.isEvicted ? \"grayscale\" : \"\";\n    imageClass = props.isJury ? \"sepia\" : imageClass;\n    return imageClass;\n}\n","import { ProfileHouseguest, HouseguestPortrait } from \"../memoryWall\";\nimport React from \"react\";\n\nexport function houseguestToPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={false} />;\n}\n\nexport function memoryWallPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={true} />;\n}\n","import React from \"react\";\nimport Popover from \"react-tiny-popover\";\nimport styled from \"styled-components\";\n\nconst Text = styled.p`\n    max-width: 200px;\n    padding: 3px 8px;\n    color: #fff;\n    text-align: center;\n    background-color: #000;\n    border-radius: 4px;\n`;\n\ninterface TooltipProps {\n    text: string;\n    children: any;\n}\n\ninterface ToolTipState {\n    visible: boolean;\n}\n\nexport class Tooltip extends React.Component<TooltipProps, ToolTipState> {\n    constructor(props: TooltipProps) {\n        super(props);\n        this.state = { visible: false };\n    }\n\n    public render() {\n        return (\n            <Popover isOpen={this.state.visible} content={<Text>{this.props.text}</Text>}>\n                <div\n                    onMouseEnter={() => this.setState({ visible: true })}\n                    onMouseLeave={() => this.setState({ visible: false })}\n                >\n                    {this.props.children}\n                </div>\n            </Popover>\n        );\n    }\n}\n","import React from \"react\";\nimport { ProfileHouseguest } from \"../memoryWall\";\nimport { houseguestToPortrait, memoryWallPortrait } from \"./houseguestToPortrait\";\nimport { Tooltip } from \"../tooltip/tooltip\";\n\nlet key = -1;\n\nexport function Portrait(props: { houseguest: ProfileHouseguest; centered?: boolean }): JSX.Element {\n    const result = (\n        <div\n            key={key++}\n            className={`columns is-gapless is-mobile is-multiline ${props.centered && \"is-centered\"}`}\n        >\n            {houseguestToPortrait(props.houseguest)}\n        </div>\n    );\n    if (props.houseguest.tooltip) {\n        return <Tooltip text={props.houseguest.tooltip}>{result}</Tooltip>;\n    }\n    return result;\n}\n\nexport function Portraits(props: {\n    houseguests: ProfileHouseguest[];\n    centered?: boolean;\n    detailed?: boolean;\n}): JSX.Element {\n    const rows: JSX.Element[] = [];\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    props.houseguests.forEach((houseguest: ProfileHouseguest) => {\n        let result;\n        if (props.detailed) {\n            result = memoryWallPortrait(houseguest, key++);\n        } else {\n            result = houseguestToPortrait(houseguest, key++);\n        }\n        if (houseguest.tooltip) {\n            result = <Tooltip text={houseguest.tooltip}>{result}</Tooltip>;\n        }\n        rows.push(result);\n    });\n    return (\n        <div className={`columns is-gapless is-mobile is-multiline ${props.centered && \"is-centered\"}`}>\n            {rows}\n        </div>\n    );\n}\n","import React from \"react\";\nimport \"./memoryWall.scss\";\nimport { PlayerProfile } from \"../../model\";\nimport { Portraits } from \"../playerPortrait/portraits\";\nimport { RelationshipMap } from \"../../utils\";\nexport interface IMemoryWallProps {\n    readonly houseguests: ProfileHouseguest[];\n}\n\nexport interface ProfileHouseguest extends PlayerProfile {\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    deltaPopularity?: number;\n    hohWins?: number;\n    povWins?: number;\n    nominations?: number;\n    tooltip?: string;\n    getFriendEnemyCount?: () => { friends: number; enemies: number };\n}\n\nexport function MemoryWall(props: IMemoryWallProps): JSX.Element {\n    return <div className=\"memory-wall\">{getPlayers(props)}</div>;\n}\n\nfunction getPlayers(props: IMemoryWallProps): any {\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return null;\n    }\n    return (\n        <div\n            style={{\n                margin: \"auto\",\n                maxWidth: props.houseguests.length < 26 ? 700 : -1\n            }}\n        >\n            <Portraits houseguests={props.houseguests} centered={true} detailed={true} />\n        </div>\n    );\n}\n","import React from \"react\";\nimport { switchSceneRelative } from \"../../subjects/subjects\";\n\nexport function NextEpisodeButton(): JSX.Element {\n    return (\n        <button className=\"button is-primary\" onClick={() => switchSceneRelative(1)}>\n            Continue\n        </button>\n    );\n}\n","export enum RelationshipType {\n    Friend = \"FRIEND\",\n    Queen = \"QUEEN\",\n    Pawn = \"PAWN\",\n    Enemy = \"ENEMY\"\n}\n\nexport const RelationshipTypeToSymbol = { FRIEND: \"♥\", ENEMY: \"💔\", PAWN: \"PAWN\", QUEEN: \"QUEEN\" };\n\nexport function classifyRelationship(\n    heroPopularity: number,\n    villainPopularity: number,\n    relationship: number\n): RelationshipType {\n    const benefitsHero = relationship > heroPopularity;\n    const benefitsVillain = relationship > villainPopularity;\n    if (benefitsHero && benefitsVillain) {\n        return RelationshipType.Friend;\n    } else if (benefitsHero && !benefitsVillain) {\n        return RelationshipType.Pawn;\n    } else if (!benefitsHero && benefitsVillain) {\n        return RelationshipType.Queen;\n    }\n    return RelationshipType.Enemy;\n}\n","import React from \"react\";\n\ninterface SetupPortraitProps {\n    name: string;\n    imageUrl: string;\n    onDelete: () => void;\n    onChange: (arg0: Event) => void;\n}\n\ninterface SetupPortraitState {\n    name: string;\n}\n\nexport class SetupPortrait extends React.Component<SetupPortraitProps, SetupPortraitState> {\n    // TODO: When you click on the text, you can edit the text.\n\n    public constructor(props: SetupPortraitProps) {\n        super(props);\n        this.state = { name: props.name };\n    }\n\n    public UNSAFE_componentWillReceiveProps(props: SetupPortraitProps) {\n        this.setState({ name: props.name });\n    }\n\n    public render() {\n        return (\n            <div className={`edit-portrait`}>\n                <div style={{ textAlign: \"center\" }}>\n                    <div className=\"x-button noselect\" onDoubleClick={() => this.props.onDelete()}>\n                        ✘\n                    </div>\n                    <img src={this.props.imageUrl} style={{ width: 100, height: 100 }} />\n                    <br />\n                    <input\n                        className=\"memory-wall-portrait\"\n                        contentEditable={true}\n                        onChange={() => this.props.onChange}\n                        spellCheck={false}\n                        value={this.state.name}\n                    />\n                </div>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\n\ninterface ImportLinksProps {\n    onSubmit: (profiles: PlayerProfile[]) => void;\n    className?: string;\n}\n\nexport class ImportLinks extends React.Component<ImportLinksProps, any> {\n    public constructor(props: ImportLinksProps) {\n        super(props);\n        this.state = { text: \"\" };\n    }\n\n    private onSubmit() {\n        const lines = this.state.text.split(/\\r?\\n/);\n        // ugly, but it works.\n        const profiles: PlayerProfile[] = [];\n        lines.forEach((line: string) => {\n            const temp = line.split(\"/\").pop();\n            let name = temp\n                ? temp\n                      .split(\"#\")[0]\n                      .split(\"?\")[0]\n                      .replace(/\\.[^/.]+$/, \"\")\n                      .replace(/[-_]/g, \" \")\n                : null;\n\n            if (line.substr(0, line.indexOf(\" \"))) {\n                name = line.substr(line.indexOf(\" \") + 1);\n            }\n            if (name) {\n                profiles.push({\n                    name,\n                    imageURL: line\n                });\n            }\n        });\n        this.props.onSubmit(profiles);\n        this.setState({ text: \"\" });\n    }\n\n    public render() {\n        return (\n            <div className={this.props.className}>\n                <textarea\n                    className=\"textarea\"\n                    onChange={event => {\n                        this.setState({ text: event.target.value });\n                    }}\n                    value={this.state.text}\n                />\n                <button onClick={() => this.onSubmit()}>Import links</button>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { roundTwoDigits } from \"../../utils\";\nimport { ProfileHouseguest, PortraitProps, PortraitState } from \"../memoryWall\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport {\n    RelationshipTypeToSymbol,\n    RelationshipType as Relationship,\n    classifyRelationship\n} from \"../../utils/ai/classifyRelationship\";\nimport { getSelectedPlayer } from \"../../subjects/subjects\";\n\nexport function generatePowerSubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    _: boolean | undefined\n): any[] {\n    if (state.powerRanking && state.powerRanking.beats === 0 && state.powerRanking.outOf === 1) {\n        return generatePopularitySubtitle(hero, state, _);\n    }\n\n    let key = 0;\n    let subtitle: any[] = [];\n    key = addPopularityLine(state, hero, !!_, subtitle, key);\n    key = addCompsLine(hero, subtitle, key);\n    if (!hero.isEvicted && state.powerRanking) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            subtitle.push(<div key={key++}>{`${state.powerRanking!.beats > 0 ? \"LOSE\" : \"WIN\"}`}</div>);\n        } else if (data && data.id === hero.id) {\n            subtitle.push(<div key={key++}>I WOULD</div>);\n        } else {\n            subtitle.push(\n                <div key={key++}>{`WINS ${state.powerRanking.beats}/${state.powerRanking.outOf}`}</div>\n            );\n        }\n    }\n    return subtitle;\n}\n\nexport function generatePopularitySubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    detailed: boolean = false\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    // popularity\n    key = addPopularityLine(state, hero, detailed, subtitle, key);\n    // competition wins\n    key = addCompsLine(hero, subtitle, key);\n    // friendship count / relationship classification titles\n    ({ subtitle, key } = addFriendshipCountTitles(hero, subtitle, key));\n    return subtitle;\n}\n\nfunction addFriendshipCountTitles(hero: PortraitProps, subtitle: any[], key: number) {\n    if (!hero.isEvicted) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            const titles = friendOrEnemyTitle(hero, data);\n            subtitle = subtitle.concat(titles.map(txt => <div key={key++}>{txt}</div>));\n        } else {\n            const titles = friendEnemyCountTitle(hero);\n            subtitle = subtitle.concat(titles.map(txt => <div key={key++}>{txt}</div>));\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return { subtitle, key };\n}\n\nfunction addPopularityLine(\n    state: { popularity?: number },\n    hero: PortraitProps,\n    detailed: boolean,\n    subtitle: any[],\n    key: number\n) {\n    let popularity = state.popularity;\n    if (popularity && (popularity > 1 || popularity < -1)) {\n        popularity = hero.popularity;\n    }\n    if (popularity && !hero.isEvicted) {\n        let popularitySubtitle = `${roundTwoDigits(popularity)}%`;\n        const deltaPop = getDeltaPopularity(hero, popularity);\n        if (detailed && deltaPop !== 0) {\n            const arrow = deltaPop > 0 ? \" | ↑\" : \" | ↓\";\n            popularitySubtitle += `${arrow} ${deltaPop}%`;\n        }\n        subtitle.push(<div key={key++}>{popularitySubtitle}</div>);\n    }\n    return key;\n}\n\nfunction addCompsLine(hero: PortraitProps, subtitle: any[], key: number) {\n    if (compWins(hero)) {\n        subtitle.push(<div key={key++}>{`${compWins(hero)}`}</div>);\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return key;\n}\n\nfunction getDeltaPopularity(houseguest: PortraitProps, statePopularity: number) {\n    if (roundTwoDigits(houseguest.popularity) !== roundTwoDigits(statePopularity)) {\n        return 0;\n    }\n    return houseguest.deltaPopularity ? roundTwoDigits(houseguest.deltaPopularity) : 0;\n}\n\nfunction compWins(houseguest: ProfileHouseguest): string {\n    return `${houseguest.hohWins ? `♔ ${houseguest.hohWins}` : \"\"}${\n        houseguest.povWins && houseguest.hohWins\n            ? `|🛇 ${houseguest.povWins}`\n            : houseguest.povWins\n            ? `🛇 ${houseguest.povWins}`\n            : \"\"\n    }${(houseguest.hohWins || houseguest.povWins) && houseguest.nominations ? \"|\" : \"\"}${\n        houseguest.nominations ? `✘ ${houseguest.nominations}` : \"\"\n    }`;\n}\n\nfunction friendOrEnemyTitle(hero: PortraitProps, villain: SelectedPlayerData): string[] {\n    const titles: string[] = [];\n    titles.push(\n        RelationshipTypeToSymbol[\n            classifyRelationship(hero.popularity || 0, villain.popularity, hero.relationships![villain.id])\n        ]\n    );\n    return titles;\n}\n\nfunction friendEnemyCountTitle(hero: PortraitProps): string[] {\n    const titles: string[] = [];\n    const count = hero.getFriendEnemyCount ? hero.getFriendEnemyCount() : { friends: 0, enemies: 0 };\n    titles.push(\n        `${count.friends} ${RelationshipTypeToSymbol[Relationship.Friend]} | ${count.enemies} ${\n            RelationshipTypeToSymbol[Relationship.Enemy]\n        }`\n    );\n    return titles;\n}\n","import { Rgb, interpolateColor } from \"./color\";\nimport { PortraitState, PortraitProps } from \"../components/memoryWall\";\nimport { extremeValues } from \"../utils\";\nimport { generatePopularitySubtitle, generatePowerSubtitle } from \"../components/playerPortrait/subtitle\";\n\nexport interface PortraitDisplayMode {\n    minColor: Rgb;\n    maxColor: Rgb;\n    backgroundColor: (state: PortraitState) => string;\n    generateSubtitle: (props: PortraitProps, state: PortraitState, detailed?: boolean) => any[];\n}\n\nconst popularityMinColor = new Rgb(252, 137, 137);\nconst popularityMaxColor = new Rgb(137, 252, 137);\n\nexport const popularityMode: PortraitDisplayMode = {\n    minColor: popularityMinColor,\n    maxColor: popularityMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const popularity = state.popularity;\n\n        const extremePopularity = extremeValues(popularity);\n        const percent = (extremePopularity + 1) / 2;\n        return interpolateColor(popularityMinColor, popularityMaxColor, percent);\n    },\n    generateSubtitle: generatePopularitySubtitle\n};\n\nconst powerMaxColor = new Rgb(255, 204, 94);\nconst powerMinColor = new Rgb(192, 181, 255);\nexport const powerMode: PortraitDisplayMode = {\n    minColor: powerMinColor,\n    maxColor: powerMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const powerRanking = state.powerRanking;\n        if (powerRanking === undefined) return \"\";\n        if (powerRanking.beats === 0 && powerRanking.outOf === 1) {\n            return popularityMode.backgroundColor(state);\n        }\n\n        return interpolateColor(powerMinColor, powerMaxColor, powerRanking.toFloat);\n    },\n    generateSubtitle: generatePowerSubtitle\n};\n","import React, { useState } from \"react\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nfunction setDisplayMode(p: PortraitDisplayMode) {\n    displayMode$.next(p);\n}\n\ninterface ViewBarTagProps {\n    mode: PortraitDisplayMode;\n    text: string;\n    disabled?: boolean;\n}\n\nexport class ViewBarTag extends React.Component<ViewBarTagProps, { selected: boolean }> {\n    private sub: Subscription | null = null;\n\n    public constructor(props: ViewBarTagProps) {\n        super(props);\n        this.state = { selected: props.mode === displayMode$.value };\n    }\n\n    public componentDidMount() {\n        this.sub = displayMode$.subscribe({\n            next: mode => {\n                if (mode !== this.props.mode) {\n                    this.setState({ selected: false });\n                }\n            }\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    public render() {\n        const name = \"level-item tag is-medium is-light\";\n        const style = getStyle(this.props);\n        return (\n            <span\n                className={name}\n                style={style}\n                onClick={() => {\n                    !this.props.disabled && setDisplayMode(this.props.mode);\n                    !this.props.disabled && this.setState({ selected: true });\n                }}\n            >\n                {styleText(this.props.text, this.state.selected)}\n            </span>\n        );\n    }\n}\n\nfunction styleText(text: string, selected: boolean): JSX.Element {\n    return selected ? <b>{text}</b> : <i>{text}</i>;\n}\n\nfunction getStyle(props: ViewBarTagProps) {\n    return props.disabled\n        ? {}\n        : {\n              background: `linear-gradient(90deg, ${props.mode.minColor.toRgba()} 0%, ${props.mode.maxColor.toRgba()} 100%)`,\n              cursor: \"pointer\"\n          };\n}\n","import React from \"react\";\nimport { popularityMode, powerMode } from \"../../model/portraitDisplayMode\";\nimport { ViewBarTag } from \"./viewBarTag\";\n\nexport class ViewsBar extends React.Component {\n    public render() {\n        return (\n            <div className=\"level box is-mobile\" key=\"viewsbar\">\n                <ViewBarTag mode={popularityMode} text={\"Relationships\"}></ViewBarTag>\n                <ViewBarTag mode={powerMode} text={\"Power Rankings\"}></ViewBarTag>\n                <ViewBarTag mode={powerMode} disabled={true} text={\"Cliques [Coming Soon™]\"}></ViewBarTag>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { Scene } from \"./scene\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\n\nexport interface InitEpisode {\n    scenes: Scene[];\n    title: string;\n    content: JSX.Element;\n    gameState: GameState;\n    type: EpisodeType;\n}\n\nexport class Episode {\n    readonly scenes: Scene[];\n    readonly title: string;\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type: EpisodeType;\n    get render(): JSX.Element {\n        return (\n            <div>\n                <ViewsBar />\n                {this.content}\n            </div>\n        );\n    }\n\n    constructor(init: InitEpisode) {\n        this.scenes = init.scenes;\n        this.title = init.title;\n        this.content = init.content;\n        this.gameState = init.gameState;\n        this.type = init.type;\n    }\n}\n\nexport interface EpisodeType {\n    readonly canPlayWith: (n: number) => boolean;\n    readonly eliminates: number;\n}\n","import React from \"react\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { GameState } from \"../../model/gameState\";\n\nconst PregameEpisodeType: EpisodeType = {\n    eliminates: 0,\n    canPlayWith: (n: number) => {\n        return n > 2;\n    }\n};\n\nexport class PregameEpisode extends Episode {\n    readonly title = \"Pregame\";\n    readonly scenes = [];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = PregameEpisodeType;\n\n    public constructor(gameState: GameState) {\n        super({\n            title: \"Pregame\",\n            scenes: [],\n            content: <PregameScreen cast={gameState.houseguests} />,\n            gameState,\n            type: PregameEpisodeType\n        });\n        this.gameState = gameState;\n        this.content = <PregameScreen cast={gameState.houseguests} />;\n    }\n}\n","import React, { useState } from \"react\";\n\ninterface RandomButtonProps {\n    random: (n: number) => void;\n}\n\nexport function RandomButton(props: RandomButtonProps): JSX.Element {\n    const [number, setNumber] = useState(\"16\");\n    return (\n        <div>\n            <button\n                disabled={number === \"\"}\n                className=\"button is-primary\"\n                onClick={() => props.random(parseInt(number))}\n            >\n                Random\n            </button>\n            <NumericInput value={number} onChange={setNumber} />\n        </div>\n    );\n}\n\ninterface NumericInputProps {\n    value: string;\n    onChange: (newValue: string) => void;\n}\n\nfunction NumericInput(props: NumericInputProps) {\n    return (\n        <input\n            className=\"input\"\n            type=\"text\"\n            style={{ width: \"3em\", marginLeft: 5 }}\n            value={props.value}\n            onChange={event => {\n                const value = event.target.value;\n                if (/^\\d*$/g.test(value)) {\n                    props.onChange(value);\n                }\n            }}\n        />\n    );\n}\n","import React from \"react\";\nimport FileDrop from \"react-file-drop\";\nimport { PlayerProfile, GameState } from \"../../model\";\nimport { SetupPortrait } from \"../playerPortrait/setupPortrait\";\nimport { ImportLinks } from \"./importLinks\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { shuffle } from \"lodash\";\nimport { RandomButton } from \"./randomXButton\";\nimport { selectPlayer } from \"../playerPortrait/selectedPortrait\";\nimport { mainContentStream$, newEpisode, updateCast } from \"../../subjects/subjects\";\n\ninterface CastingScreenState {\n    players: PlayerProfile[];\n}\n\ninterface CastingScreenProps {\n    cast?: PlayerProfile[];\n}\n\nexport class CastingScreen extends React.Component<CastingScreenProps, CastingScreenState> {\n    constructor(props: CastingScreenProps) {\n        super(props);\n        this.state = { players: props.cast || [] };\n    }\n\n    private handleChange(i: number) {\n        return (event: any) => {\n            const newName = event.target.value.replace(/\\r?\\n|\\r/g, \"\");\n            const newState = { ...this.state };\n            newState.players[i] = new PlayerProfile({\n                imageURL: newState.players[i].imageURL,\n                name: newName\n            });\n            this.setState(newState);\n        };\n    }\n\n    private deleteMethod(i: number) {\n        return () => {\n            const newState = { ...this.state };\n            newState.players.splice(i, 1);\n            this.setState(newState);\n        };\n    }\n\n    private getFiles() {\n        const players = this.state.players;\n        if (!players) {\n            return;\n        }\n        const rows: JSX.Element[] = [];\n        let i = 0;\n        players.forEach(player =>\n            rows.push(\n                <SetupPortrait\n                    name={player.name}\n                    imageUrl={player.imageURL}\n                    onDelete={this.deleteMethod(i)}\n                    onChange={this.handleChange(i)}\n                    key={(++i).toString()}\n                />\n            )\n        );\n        return <div className=\"columns is-gapless is-mobile is-multiline is-centered\">{rows}</div>;\n    }\n\n    private appendProfiles = (profiles: PlayerProfile[]) => {\n        const newState = { ...this.state };\n        profiles.forEach(profile => newState.players.push(profile));\n        this.setState(newState);\n    };\n\n    private submit = async () => {\n        updateCast(this.state.players);\n        mainContentStream$.next(<PregameScreen cast={this.state.players} />);\n        selectPlayer(null);\n        await newEpisode(null);\n        await newEpisode(new PregameEpisode(new GameState(this.state.players)));\n    };\n\n    private random = (amount: number) => {\n        let players = this.state.players;\n        players = shuffle(players);\n        players = players.slice(0, amount);\n        this.setState({ players });\n    };\n\n    public render() {\n        return (\n            <FileDrop onDrop={this.handleDrop}>\n                <div className=\"level\">\n                    <ImportLinks onSubmit={this.appendProfiles} />\n                    <div className=\"level-item\">\n                        <button className=\"button is-danger\" onClick={() => this.setState({ players: [] })}>\n                            Delete all\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <RandomButton random={this.random} />\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-primary\"\n                            disabled={this.state.players.length < 3}\n                            onClick={this.submit}\n                        >\n                            Submit\n                        </button>\n                    </div>\n                </div>\n                ~ Drop images ~<input type=\"file\" multiple onChange={this.handleUpload} />\n                {this.getFiles()}\n            </FileDrop>\n        );\n    }\n\n    private handleUpload = (event: any) => {\n        this.handleFiles(event.target.files);\n    };\n\n    private handleDrop = (files: FileList | null, event: React.DragEvent) => {\n        if (!files) return;\n        this.handleFiles(files);\n    };\n\n    private handleFiles(files: FileList) {\n        const newState = { ...this.state };\n        for (let i = 0; i < files.length; i++) {\n            const file = files[i];\n            if (file.type.match(/image\\/*/)) {\n                newState.players.push(\n                    new PlayerProfile({\n                        name: file.name.substr(0, file.name.lastIndexOf(\".\")) || file.name,\n                        imageURL: URL.createObjectURL(file)\n                    })\n                );\n            }\n        }\n        this.setState(newState);\n    }\n}\n","import { BehaviorSubject, Subject } from \"rxjs\";\nimport { PregameScreen } from \"../components/pregameScreen/pregameScreen\";\nimport { Episode, PlayerProfile } from \"../model\";\nimport { SelectedPlayerData } from \"../components/playerPortrait/selectedPortrait\";\nimport React from \"react\";\nimport { PortraitDisplayMode, popularityMode } from \"../model/portraitDisplayMode\";\n\n// What is currently being displayed.\nexport const mainContentStream$ = new BehaviorSubject(<PregameScreen cast={[]} />);\n// Push episodes to this subject to add them to the sidebar. Null resets everything.\nexport const episodes$ = new BehaviorSubject<Episode | null>(null);\n// Forcibly switches to an episode. Used when adding a new episode.\nexport const switchEpisode$ = new Subject<number>();\nexport function newEpisode(episode: Episode | null) {\n    episodes$.next(episode);\n}\nexport function switchSceneRelative(n: number) {\n    switchEpisode$.next(n);\n}\n// the list of players in the game\nexport const cast$ = new BehaviorSubject<PlayerProfile[]>([]);\nexport function updateCast(newCast: PlayerProfile[]) {\n    cast$.next(newCast);\n}\nexport function getCast(): PlayerProfile[] {\n    return cast$.value;\n}\n// The player that the user has clicked on.\nexport const selectedPlayer$ = new BehaviorSubject<SelectedPlayerData | null>(null);\nexport function getSelectedPlayer() {\n    return selectedPlayer$.value;\n}\n\n// The display mode selected by the viewsbar.\nexport const displayMode$ = new BehaviorSubject<PortraitDisplayMode>(popularityMode);\n","import React from \"react\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport \"./topBar.scss\";\nimport { mainContentStream$, getCast } from \"../../subjects/subjects\";\n\nexport function EditCastLink(): JSX.Element {\n    return (\n        <div\n            className=\"topbar-link\"\n            onClick={() => {\n                mainContentStream$.next(<CastingScreen cast={getCast()} />);\n            }}\n        >\n            Edit Cast\n        </div>\n    );\n}\n\nexport function EditSeasonLink(): JSX.Element {\n    return (\n        <div\n            className=\"topbar-link\"\n            onClick={() => {\n                mainContentStream$.next(<CastingScreen cast={getCast()} />);\n            }}\n        >\n            Edit Season\n        </div>\n    );\n}\n\nexport function Topbar(): JSX.Element {\n    return (\n        <div className=\"level box is-mobile\" style={{ marginTop: 30 }}>\n            <div className=\"level-item\">\n                <EditCastLink />\n            </div>\n            <div className=\"level-item\">\n                <EditSeasonLink />\n            </div>\n        </div>\n    );\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { EditCastLink } from \"../topbar/topBar\";\n\ninterface PregameScreenProps {\n    cast: PlayerProfile[];\n}\n\nexport function PregameScreen(props: PregameScreenProps): JSX.Element {\n    if (props.cast.length === 0) {\n        return (\n            <div>\n                Cast is empty. <EditCastLink />\n            </div>\n        );\n    }\n    return (\n        <div>\n            Welcome to Big Brother!\n            <MemoryWall houseguests={props.cast} />\n            <NextEpisodeButton />\n        </div>\n    );\n}\n","import prand from \"pure-rand\";\nimport { BehaviorSubject } from \"rxjs\";\nimport { hashcode } from \"./utilities\";\nimport { cast$ } from \"../subjects/subjects\";\n\nexport class BbRandomGenerator {\n    private rng: prand.RandomGenerator;\n\n    public randomFloat(): number {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result / 2147483647.0;\n    }\n\n    public randomInt(a: number, b: number): number {\n        let result: number;\n        [result, this.rng] = prand.uniformIntDistribution(a, b, this.rng);\n        return result;\n    }\n\n    public flipCoin(): boolean {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result % 2 === 0;\n    }\n\n    public seed(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n\n    public constructor(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n}\n\nexport function rng() {\n    return rng$.value;\n}\n\nconst rng$ = new BehaviorSubject(new BbRandomGenerator(0));\n\nconst castSub = cast$.subscribe({\n    next: cast => {\n        let castNames = \"\";\n        cast.forEach(houseguest => (castNames += houseguest.name));\n        rng$.next(new BbRandomGenerator(hashcode(castNames)));\n    }\n});\n","import { Houseguest } from \"./houseguest\";\nimport { PlayerProfile } from \"./playerProfile\";\nimport _ from \"lodash\";\nimport { newRelationshipMap, rng } from \"../utils\";\nimport { finalJurySize, getFinalists } from \"./season\";\n\n// TODO: might want to make houseguests a dictionary. {id: houseguest}\nexport function getById(gameState: GameState, id: number): Houseguest {\n    const result = gameState.houseguests.find(hg => hg.id === id);\n    if (!result) {\n        throw new Error(`Failed to find houseguest with id ${id}`);\n    }\n    return result;\n}\n\nexport function exclude(inclusions: Houseguest[], exclusions: Houseguest[]) {\n    const excludedIds = exclusions.map(hg => hg.id);\n    return inclusions.filter(hg => !excludedIds.includes(hg.id) && !hg.isEvicted);\n}\n\nexport function randomPlayer(inclusions: Houseguest[], exclusions: Houseguest[] = []): Houseguest {\n    if (inclusions.length === 0) {\n        throw new Error(\"Tried to get a random player from a list of 0 players.\");\n    }\n    const options = exclude(inclusions, exclusions);\n    const choice = rng().randomInt(0, options.length - 1);\n\n    return options[choice];\n}\n\nexport function nonEvictedHouseguests(gameState: GameState) {\n    return gameState.houseguests.filter(hg => !hg.isEvicted);\n}\nexport function getJurors(gameState: GameState) {\n    return gameState.houseguests.filter(hg => hg.isJury);\n}\n\nexport function inJury(gameState: GameState): Boolean {\n    return gameState.remainingPlayers - getFinalists() <= finalJurySize();\n}\n\nexport function calculatePopularity(hero: Houseguest, house: Houseguest[]) {\n    let sum = 0;\n    let count = 0;\n    const targetId = hero.id;\n    house.forEach(houseguest => {\n        if (houseguest.id !== targetId) {\n            count++;\n            sum += houseguest.relationships[targetId];\n        }\n    });\n    return count === 0 ? 0 : sum / count;\n}\n\nexport class GameState {\n    // Current state of the game after a phase.\n\n    readonly houseguests: Houseguest[] = [];\n    readonly remainingPlayers: number = 0;\n    readonly phase: number = 0;\n    readonly previousHOH?: Houseguest;\n\n    public constructor(init: PlayerProfile[] | GameState) {\n        if (!(init instanceof Array)) {\n            Object.assign(this, init);\n        } else {\n            const profiles = init as PlayerProfile[];\n            this.remainingPlayers = profiles.length;\n            let id = -1;\n            profiles.forEach(profile => {\n                this.houseguests.push(\n                    new Houseguest({\n                        ...profile,\n                        id: ++id,\n                        // popularity: 0,\n                        // deltaPopularity: 0,\n                        relationships: newRelationshipMap(profiles.length, id)\n                    })\n                );\n            });\n        }\n    }\n}\n\nexport class MutableGameState {\n    public houseguests: Houseguest[] = [];\n    public remainingPlayers: number = 0;\n    public phase: number = 0;\n    public previousHOH?: Houseguest;\n\n    public constructor(init: GameState | MutableGameState) {\n        const copy = _.cloneDeep(init);\n        Object.assign(this, copy);\n    }\n}\n","import { BigBrotherVanilla } from \"../components/episode/bigBrotherEpisode\";\nimport { EpisodeFactory } from \"../components/episode/episodeFactory\";\nimport { GameState } from \"./gameState\";\nimport { EpisodeType, Episode } from \".\";\nimport { BigBrotherFinale } from \"../components/episode/bigBrotherFinale\";\nimport { cast$ } from \"../subjects/subjects\";\n\nexport function finalJurySize() {\n    return jurors;\n}\n\nlet jurors = 7;\nconst sub = cast$.subscribe({\n    next: newCast => {\n        let players = newCast.length;\n        players = Math.round(players * 0.55);\n        if (players % 2 === 0) {\n            players--;\n        }\n        jurors = players;\n    }\n});\n\nexport function getFinalists() {\n    return 2;\n}\n\nexport class Season {\n    private factory: EpisodeFactory;\n\n    public constructor() {\n        this.factory = new EpisodeFactory();\n    }\n\n    // In the future, this would all be customizable,\n    // and not just all big brother episodes by default.\n\n    public renderEpisode(gameState: GameState, type: EpisodeType): Episode {\n        return this.factory.nextEpisode(gameState, type);\n    }\n\n    public whichEpisodeType(players: number) {\n        if (players === 3) {\n            return BigBrotherFinale;\n        }\n        return BigBrotherVanilla;\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\ninterface InitScene {\n    readonly title: string;\n    readonly gameState: GameState;\n    readonly content: JSX.Element;\n}\nexport class Scene {\n    readonly title: string = \"\";\n    readonly gameState: GameState = new GameState([]);\n    readonly content: JSX.Element = <div>{`Error while rendering ${this.title}`}</div>;\n    public render: JSX.Element;\n    public constructor(init: Partial<InitScene>) {\n        Object.assign(this, init);\n        this.render = (\n            <div>\n                <ViewsBar />\n                {this.content}\n            </div>\n        );\n    }\n}\n","import { Houseguest, inJury, GameState } from \"../../model\";\n\nexport const relationship = (hero: Houseguest, villain: Houseguest) => hero.relationships[villain.id];\n\nexport function favouriteIndex(hero: Houseguest, options: Houseguest[]) {\n    // Return the index of the houseguest that hero has the worst relationship with.\n    return highestScore(hero, options, relationship);\n}\n\nexport function highestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let highestIndex = 0;\n    let highestScore = -Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore > highestScore) {\n            highestIndex = i;\n            highestScore = currentScore;\n        }\n    });\n    return highestIndex;\n}\nexport function lowestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let lowestIndex = 0;\n    let lowestScore = Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore < lowestScore) {\n            lowestIndex = i;\n            lowestScore = currentScore;\n        }\n    });\n    return lowestIndex;\n}\n\nexport function doesHeroWinTheFinale(\n    hgs: { hero: Houseguest; villain: Houseguest },\n    jury: Houseguest[]\n): boolean {\n    const hero = hgs.hero;\n    const villain = hgs.villain;\n    let heroVotes = 0;\n    let villainVotes = 0;\n    jury.forEach(juror => {\n        if (juror.id === hero.id || juror.id === villain.id) {\n            return;\n        }\n        if (relationship(hero, juror) > relationship(villain, juror)) {\n            heroVotes++;\n        } else {\n            villainVotes++;\n        }\n    });\n    return heroVotes > villainVotes;\n}\n\nexport function heroShouldTargetSuperiors(hero: Houseguest, gameState: GameState): boolean {\n    const superiors = hero.superiors.size;\n    const inferiors = gameState.remainingPlayers - 1 - hero.superiors.size;\n    // Target the larger group. If they are equal, target superiors.\n    return superiors >= inferiors;\n}\n\n// TODO: this function can just honestly die. it's only used in nomination logic (which sucks anyways)\n// when I do the new logic, I think people who are dead center should target their superiors. works in F5.\n\nexport function hitList(hero: Houseguest, options: Houseguest[], gameState: GameState): Set<number> {\n    let result = options;\n    // jury logic is not affected by someone who is dead center in power rankings\n    if (inJury(gameState) && heroShouldTargetSuperiors(hero, gameState)) {\n        // TODO: logic to take into account that i never want to eliminate the last guy i can actually beat\n        if (hero.superiors.size * 2 < gameState.remainingPlayers - 1) {\n            result = options.filter(hg => !hero.superiors.has(hg.id));\n        } else {\n            result = options.filter(hg => hero.superiors.has(hg.id));\n        }\n    } else {\n    }\n    return new Set(result.map(hg => hg.id));\n}\n","import { Houseguest, GameState, nonEvictedHouseguests, inJury } from \"../../model\";\nimport { favouriteIndex, relationship, lowestScore, hitList, heroShouldTargetSuperiors } from \"./aiUtils\";\nimport { classifyRelationship, RelationshipType as Relationship } from \"./classifyRelationship\";\n\ninterface VoteWithLogic {\n    vote: number;\n    reason: string;\n}\n\n// Return the index of the eviction target.\nexport function castEvictionVote(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): VoteWithLogic {\n    if (inJury(gameState)) {\n        return cutthroatVoteJury(hero, nominees, gameState);\n    } else {\n        return cutthroatVote(hero, nominees);\n    }\n}\n\nfunction cutthroatVoteJury(hero: Houseguest, nominees: Houseguest[], gameState: GameState): VoteWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    const zeroIsInferior = !hero.superiors.has(nom0.id);\n    const oneIsInferior = !hero.superiors.has(nom1.id);\n    // if there is no sup/inf difference, no point in doing special logic for it\n    if (zeroIsInferior === oneIsInferior) {\n        return cutthroatVote(hero, nominees);\n    }\n    // Don't evict the last person in the game you can beat\n    if (gameState.remainingPlayers - hero.superiors.size - 1 === 1 && (zeroIsInferior || oneIsInferior)) {\n        const nonVote = zeroIsInferior ? 0 : 1;\n        return {\n            vote: zeroIsInferior ? 1 : 0,\n            reason: `I can't evict ${nominees[nonVote].name}, because they are the last person I can beat.`\n        };\n    }\n    const target = heroShouldTargetSuperiors(hero, gameState) === oneIsInferior ? 0 : 1;\n    const nonTarget = target ? 0 : 1;\n    const excuse = heroShouldTargetSuperiors(hero, gameState)\n        ? `I can't beat ${nominees[target].name} in the end.`\n        : `I need to keep ${nominees[nonTarget].name} around as a shield.`;\n    const targetIsFriend =\n        classifyRelationship(\n            hero.popularity,\n            nominees[target].popularity,\n            hero.relationships[nominees[target].id]\n        ) === Relationship.Friend;\n    const nonTargetIsNonFriend =\n        classifyRelationship(\n            hero.popularity,\n            nominees[nonTarget].popularity,\n            hero.relationships[nominees[nonTarget].id]\n        ) !== Relationship.Friend;\n    const nonTargetIsFriend = !nonTargetIsNonFriend;\n    const targetIsNonFriend = !targetIsFriend;\n    // the only reason to not evict your target is if he is your only friend on the block\n    if (targetIsFriend && nonTargetIsNonFriend) {\n        return { vote: nonTarget, reason: `${nominees[nonTarget].name} is my enemy.` };\n    } else if (targetIsFriend && nonTargetIsFriend) {\n        return { vote: target, reason: `Both noms are my friends, but ${excuse}` };\n    } else if (targetIsNonFriend && nonTargetIsNonFriend) {\n        return { vote: target, reason: `Neither of the noms are my friends, but ${excuse}` };\n    } else {\n        return { vote: target, reason: `${excuse}` };\n    }\n}\n\n// TODO: only works for 2 nominees\nfunction cutthroatVote(hero: Houseguest, nominees: Houseguest[]): VoteWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    const r0 = classifyRelationship(hero.popularity, nom0.popularity, hero.relationships[nom0.id]);\n    const r1 = classifyRelationship(hero.popularity, nom1.popularity, hero.relationships[nom1.id]);\n    if (r0 === Relationship.Enemy && r1 === Relationship.Enemy) {\n        return {\n            vote: nom0.popularity > nom1.popularity ? 0 : 1,\n            reason: \"Both noms are my enemies, so I voted for the more popular one.\"\n        };\n    } else if (\n        (r0 === Relationship.Enemy && r1 !== Relationship.Enemy) ||\n        (r1 === Relationship.Enemy && r0 !== Relationship.Enemy)\n    ) {\n        const vote = r0 === Relationship.Enemy ? 0 : 1;\n        return { vote, reason: `${nominees[vote].name} is my enemy.` };\n    } else if (\n        (r0 !== Relationship.Friend && r1 === Relationship.Friend) ||\n        (r1 !== Relationship.Friend && r0 === Relationship.Friend)\n    ) {\n        const vote = r0 !== Relationship.Friend ? 0 : 1;\n        const nonVote = vote === 0 ? 1 : 0;\n        return { vote, reason: `${nominees[nonVote].name} is my friend.` };\n    }\n    const vote = lowestScore(hero, nominees, relationship);\n    return {\n        vote,\n        reason: `Both noms are my friends. but I like ${nominees[vote === 0 ? 1 : 0].name} more.`\n    };\n}\n\nexport function nominatePlayer(hero: Houseguest, options: Houseguest[], gameState: GameState): number {\n    // TODO: target and pawn based nominations, different pre and post jury. requires refactoring (nominate N players)\n    const hitlist = hitList(hero, options, gameState);\n    let trueOptions = options.filter(hg => hitlist.has(hg.id));\n    if (trueOptions.length === 0) {\n        // if there are no options, we must sadly deviate from the hit list\n        trueOptions = options;\n    }\n    return trueOptions[lowestScore(hero, trueOptions, relationship)].id;\n}\nexport function useGoldenVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): Houseguest | null {\n    let povTarget: Houseguest | null = null;\n    if (hero.id == nominees[0].id || hero.id == nominees[1].id) {\n        povTarget = hero;\n    } else {\n        if (inJury(gameState)) {\n            // TODO: jury logic goes right here once we're ready\n            povTarget = useGoldenVetoPreJury(hero, nominees);\n        } else {\n            povTarget = useGoldenVetoPreJury(hero, nominees);\n        }\n        if (nonEvictedHouseguests(gameState).length === 4) {\n            povTarget = null;\n        }\n    }\n    return povTarget || null;\n}\n\nfunction useGoldenVetoPreJury(hero: Houseguest, nominees: Houseguest[]) {\n    let save = -1;\n    const rel0 = classifyRelationship(\n        hero.popularity,\n        nominees[0].popularity,\n        hero.relationshipWith(nominees[0])\n    );\n    const rel1 = classifyRelationship(\n        hero.popularity,\n        nominees[1].popularity,\n        hero.relationshipWith(nominees[1])\n    );\n    // basic logic that only saves friends. Doesn't take into account jury stuff.\n    if (rel0 === Relationship.Friend && rel1 !== Relationship.Friend) {\n        save = 0;\n    } else if (rel1 === Relationship.Friend && rel0 !== Relationship.Friend) {\n        save = 1;\n    } else if (rel0 === Relationship.Friend && rel1 === Relationship.Friend) {\n        save = Math.max(nominees[0].popularity, nominees[1].popularity) === nominees[0].popularity ? 0 : 1;\n    }\n\n    return nominees[save];\n}\n\nexport function castJuryVote(juror: Houseguest, finalists: Houseguest[]): number {\n    return favouriteIndex(juror, finalists);\n}\n","import { GameState, getJurors, nonEvictedHouseguests } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { castJuryVote } from \"../../../utils/ai/aiApi\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport React from \"react\";\n\nexport function juryVoteScene(initialGameState: GameState): Scene {\n    const jurors = getJurors(initialGameState);\n    const finalists = nonEvictedHouseguests(initialGameState);\n    let voteCount = [0, 0];\n    const votes = jurors.map(juror => {\n        const result = castJuryVote(juror, finalists);\n        voteCount[result]++;\n        return result;\n    });\n    const voteBlocks = [];\n\n    // TODO: the formatting on this episode sucks...\n    for (let i = 0; i < votes.length; i++) {\n        voteBlocks.push(\n            <div className=\"columns\" key={`jury-vote${i}`}>\n                <Portrait houseguest={jurors[i]} />\n                <p>\n                    <b>{`${jurors[i].name} has voted for...`}</b>\n                </p>\n                <Portrait houseguest={finalists[votes[i]]} />\n            </div>\n        );\n    }\n    const winner = voteCount[0] > voteCount[1] ? finalists[0] : finalists[1];\n\n    const scene: Scene = new Scene({\n        title: \"Jury Votes\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                {voteBlocks}\n                <Portrait houseguest={winner} />\n                {`Congratulations, ${winner.name}, you are the winner of Big Brother!!!`}\n            </div>\n        )\n    });\n    return scene;\n}\n","import React from \"react\";\nimport { EpisodeType, Episode, InitEpisode } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { GameState } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { finalHohCompScene } from \"./scenes/finalHohCompScene\";\nimport { finalEvictionScene } from \"./scenes/finalEvictionScene\";\nimport { juryVoteScene } from \"./scenes/juryVoteScene\";\n\nexport const BigBrotherFinale: EpisodeType = {\n    canPlayWith: (n: number) => n === 3,\n    eliminates: 2\n};\n\nexport function generateBbFinaleInit(initialGameState: GameState): BigBrotherFinaleEpisode {\n    const title = \"Finale\";\n    const content = (\n        <div>\n            {/* TODO: custom title here*/}\n            Finale Night\n            <MemoryWall houseguests={initialGameState.houseguests} /> <br />\n            <NextEpisodeButton />\n        </div>\n    );\n    let currentGameState;\n    let hohCompScene;\n    let finalHoH;\n    const scenes = [];\n    [currentGameState, hohCompScene, finalHoH] = finalHohCompScene(initialGameState);\n    scenes.push(hohCompScene);\n    let finalEviction;\n    [currentGameState, finalEviction] = finalEvictionScene(currentGameState, finalHoH);\n    scenes.push(finalEviction);\n    scenes.push(juryVoteScene(currentGameState));\n    const gameState = currentGameState;\n    return new BigBrotherFinaleEpisode({ gameState, content, title, scenes, type: BigBrotherFinale });\n}\n\nexport class BigBrotherFinaleEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = BigBrotherFinale;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portraits, Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\n\nexport function finalHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n    const final3 = nonEvictedHouseguests(initialGameState);\n    const enduranceWinner = randomPlayer(final3);\n    const enduranceLosers = final3.filter(hg => hg.id !== enduranceWinner.id);\n    const skillWinner = randomPlayer(final3, [enduranceWinner]);\n    const finalHoH = getById(newGameState, randomPlayer([enduranceWinner, skillWinner]).id);\n    finalHoH.hohWins++;\n    const scene: Scene = new Scene({\n        title: \"Final HoH Competition\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <p>The final 3 houseguests compete in the endurance competition.</p>\n                <Portraits houseguests={final3} />\n                <Portrait houseguest={enduranceWinner} />\n                <p>\n                    <b>{`${enduranceWinner.name} has won the endurance competition!`}</b>\n                </p>\n                <hr />\n                <p>{`${enduranceLosers[0].name} and ${\n                    enduranceLosers[1].name\n                } compete in the skill competition.`}</p>\n                <Portraits houseguests={enduranceLosers} />\n                <Portrait houseguest={skillWinner} />\n                <p>\n                    <b>{`${skillWinner.name} has won the skill competition!`}</b>\n                </p>\n                <hr />\n                <p>{`${enduranceWinner.name} and ${skillWinner.name} compete in the quiz competition.`}</p>\n                <Portraits houseguests={[enduranceWinner, skillWinner]} />\n                <Portrait houseguest={finalHoH} />\n                <p>\n                    <b>{`Congratulations ${finalHoH.name}, you are the final Head of Household!`}</b>\n                </p>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    newGameState.phase++;\n    return [new GameState(newGameState), scene, finalHoH];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { evictHouseguest } from \"../bigBrotherEpisode\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\n\nexport function finalEvictionScene(initialGameState: GameState, HoH: Houseguest): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const nominees = nonEvictedHouseguests(newGameState).filter(hg => hg.id !== HoH.id);\n    const { vote, reason } = castEvictionVote(HoH, nominees, newGameState);\n    const evictee = nominees[vote];\n    const hoh: ProfileHouseguest = { ...HoH };\n    hoh.tooltip = reason;\n    evictHouseguest(newGameState, evictee.id);\n    const scene: Scene = new Scene({\n        title: \"Final Eviction\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <div style={{ textAlign: \"center\" }}>\n                    {`As the final HoH of the season, ${HoH.name}, you may now cast the sole vote to evict.`}\n                    <Portrait houseguest={hoh} centered={true} />\n                    <b>\n                        <p>{`I vote to evict ${evictee.name}.`}</p>\n                    </b>\n                    <Portraits houseguests={nominees} centered={true} />\n                    <p>\n                        It's official... {evictee.name}, you will be the final person leaving the Big Brother\n                        House.\n                    </p>\n                </div>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene];\n}\n","import {\n    GameState,\n    MutableGameState,\n    calculatePopularity,\n    nonEvictedHouseguests,\n    inJury,\n    getJurors\n} from \"../../model/gameState\";\nimport { Episode, Houseguest } from \"../../model\";\nimport { EpisodeType } from \"./episodes\";\nimport { BigBrotherVanilla, generateBbVanilla } from \"./bigBrotherEpisode\";\nimport { BigBrotherFinale, generateBbFinaleInit } from \"./bigBrotherFinale\";\nimport { rng, roundTwoDigits } from \"../../utils\";\nimport { doesHeroWinTheFinale as heroWinsTheFinale } from \"../../utils/ai/aiUtils\";\nimport { classifyRelationship, RelationshipType as Relationship } from \"../../utils/ai/classifyRelationship\";\nimport { PowerRanking } from \"../../model/powerRanking\";\n\nfunction firstImpressions(houseguests: Houseguest[]) {\n    for (let i = 0; i < houseguests.length; i++) {\n        const iMap = houseguests[i].relationships;\n        for (let j = i + 1; j < houseguests.length; j++) {\n            // creates a bunch of 100% random mutual relationships\n            const jMap = houseguests[j].relationships;\n            const impression = rng().randomFloat();\n            jMap[i] = impression;\n            iMap[j] = impression;\n        }\n    }\n}\n\nfunction populateSuperiors(houseguests: Houseguest[]) {\n    for (let i = 0; i < houseguests.length; i++) {\n        const hero = houseguests[i];\n        for (let j = i + 1; j < houseguests.length; j++) {\n            const villain = houseguests[j];\n            if (heroWinsTheFinale({ hero, villain }, houseguests)) {\n                villain.superiors.add(hero.id);\n            } else {\n                hero.superiors.add(villain.id);\n            }\n        }\n    }\n}\n\nfunction updatePowerRankings(houseguests: Houseguest[]) {\n    houseguests.forEach(hg => {\n        hg.powerRanking = new PowerRanking(\n            houseguests.length - 1 - hg.superiors.size,\n            houseguests.length - 1\n        );\n    });\n}\n\nfunction updatePopularity(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach(hg => {\n        const result = calculatePopularity(hg, nonEvictedHouseguests(gameState));\n        hg.deltaPopularity = (roundTwoDigits(result) - roundTwoDigits(hg.popularity)) / 100;\n        hg.popularity = result;\n    });\n}\n\nfunction updateFriendCounts(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach(hero => {\n        hero.getFriendEnemyCount = () => {\n            let friends = 0;\n            let enemies = 0;\n            houseguests.forEach(villain => {\n                const rel = classifyRelationship(\n                    hero.popularity,\n                    villain.popularity,\n                    hero.relationshipWith(villain)\n                );\n                if (hero.id === villain.id) {\n                    return;\n                } else if (rel === Relationship.Friend) {\n                    friends++;\n                } else if (rel === Relationship.Enemy) {\n                    enemies++;\n                }\n            });\n            return { friends, enemies };\n        };\n    });\n}\n\nexport class EpisodeFactory {\n    public nextEpisode(gameState: GameState, episodeType: EpisodeType): Episode {\n        let newState = new MutableGameState(gameState);\n        if (gameState.phase === 0) {\n            firstImpressions(newState.houseguests);\n        }\n        // If jury starts this episode, populate superior/inferior data. In the future, every jury ep. (dynamic rels)\n        if (inJury(gameState) && getJurors(gameState).length === 0) {\n            populateSuperiors(nonEvictedHouseguests(newState));\n        }\n        if (inJury(gameState)) {\n            updatePowerRankings(nonEvictedHouseguests(newState));\n        }\n        updatePopularity(newState);\n        updateFriendCounts(newState);\n        const finalState = new GameState(newState);\n        switch (episodeType) {\n            case BigBrotherVanilla:\n                return generateBbVanilla(finalState);\n            case BigBrotherFinale:\n                return generateBbFinaleInit(finalState);\n            default:\n                throw new Error(\"Unsupported Episode Type\");\n        }\n    }\n}\n","import {\n    MutableGameState,\n    getById,\n    inJury,\n    nonEvictedHouseguests,\n    GameState,\n    Houseguest,\n    EpisodeType,\n    Episode,\n    InitEpisode\n} from \"../../model\";\nimport { getFinalists, finalJurySize } from \"../../model/season\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateNomCeremonyScene } from \"./scenes/nomCeremonyScene\";\nimport { generateVetoCompScene } from \"./scenes/vetoCompScene\";\nimport { generateVetoCeremonyScene } from \"./scenes/vetoCeremonyScene\";\nimport { generateEvictionScene } from \"./scenes/evictionScene\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Scene } from \"./scene\";\n\nexport const BigBrotherVanilla: EpisodeType = {\n    canPlayWith: (n: number) => {\n        return n > 1;\n    },\n    eliminates: 1\n};\n\n// TODO: Refactoring ideas\n/**\n * Might be best to start passing ids instead of houseguests for HoH/nominees/veto winner\n */\n\nexport function evictHouseguest(gameState: MutableGameState, id: number) {\n    const evictee = getById(gameState, id);\n    evictee.isEvicted = true;\n    if (gameState.remainingPlayers - getFinalists() <= finalJurySize()) {\n        evictee.isJury = true;\n    }\n    if (inJury(gameState)) {\n        nonEvictedHouseguests(gameState).forEach(hg => {\n            hg.superiors.delete(evictee.id);\n        });\n    }\n    gameState.remainingPlayers--;\n}\n\nexport function generateBbVanilla(initialGameState: GameState): BigBrotherVanillaEpisode {\n    let currentGameState;\n    let hohCompScene;\n    let hoh: Houseguest;\n    const scenes = [];\n\n    [currentGameState, hohCompScene, hoh] = generateHohCompScene(initialGameState);\n    scenes.push(hohCompScene);\n\n    let nomCeremonyScene;\n    let nominees: Houseguest[];\n    [currentGameState, nomCeremonyScene, nominees] = generateNomCeremonyScene(currentGameState, hoh);\n    scenes.push(nomCeremonyScene);\n\n    let vetoCompScene;\n    let povWinner: Houseguest;\n    [currentGameState, vetoCompScene, povWinner] = generateVetoCompScene(\n        currentGameState,\n        hoh,\n        nominees[0],\n        nominees[1]\n    );\n    scenes.push(vetoCompScene);\n    let vetoCeremonyScene;\n\n    [vetoCeremonyScene, nominees] = generateVetoCeremonyScene(currentGameState, hoh, nominees, povWinner);\n    scenes.push(vetoCeremonyScene);\n\n    let evictionScene;\n    [currentGameState, evictionScene] = generateEvictionScene(currentGameState, hoh, nominees);\n    scenes.push(evictionScene);\n\n    const title = `Week ${currentGameState.phase}`;\n    const content = (\n        <div>\n            {/* TODO: custom title here*/}\n            {`Week ${currentGameState.phase}`}\n            <MemoryWall houseguests={initialGameState.houseguests} /> <br />\n            <NextEpisodeButton />\n        </div>\n    );\n    const gameState = new GameState(currentGameState);\n    return new BigBrotherVanillaEpisode({ title, scenes, content, gameState, type: BigBrotherVanilla });\n}\nexport class BigBrotherVanillaEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = BigBrotherVanilla;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import { GameState, Houseguest, MutableGameState, randomPlayer } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\n\nexport function generateHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    const previousHoh = initialGameState.previousHOH ? [initialGameState.previousHOH] : [];\n    const newHoH: Houseguest = randomPlayer(newGameState.houseguests, previousHoh);\n    newGameState.previousHOH = newHoH;\n    newGameState.phase++;\n    newHoH.hohWins += 1;\n\n    const scene = new Scene({\n        title: \"HoH Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                {previousHoh.length > 0 &&\n                    `Houseguests, it's time to find a new Head of Household. As outgoing HoH, ${\n                        previousHoh[0].name\n                    } will not compete. `}\n                <Portrait houseguest={newHoH} />\n                {newHoH.name} has won Head of Household!\n                <br />\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n\n    return [new GameState(newGameState), scene, newHoH];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    exclude,\n    nonEvictedHouseguests,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { nominatePlayer } from \"../../../utils/ai/aiApi\";\nimport { shuffle } from \"lodash\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\n\nexport function generateNomCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest\n): [GameState, Scene, Houseguest[]] {\n    const newGameState = new MutableGameState(initialGameState);\n    const options = exclude(nonEvictedHouseguests(newGameState), [HoH]);\n    const nom1 = getById(newGameState, nominatePlayer(HoH, options, newGameState));\n    const nom2 = getById(newGameState, nominatePlayer(HoH, exclude(options, [nom1]), newGameState));\n    nom1.nominations++;\n    nom2.nominations++;\n    const noms = shuffle([nom1, nom2]);\n    const scene = new Scene({\n        title: \"Nomination Ceremony\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Portrait houseguest={HoH} />\n                <br />\n                This is the nomination ceremony. It is my responsibility as the Head of Household to nominate\n                two houseguests for eviction.\n                <br />\n                <b>\n                    My first nominee is...\n                    <br />\n                    <Portrait houseguest={noms[0]} />\n                    <br />\n                    My second nominee is...\n                    <br />\n                    <Portrait houseguest={noms[1]} />\n                    {`I have nominated you, ${noms[0].name} and you, ${noms[1].name} for eviction.`}\n                    <br />\n                </b>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene, [nom1, nom2]];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\n\nexport function generateVetoCompScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nom1: Houseguest,\n    nom2: Houseguest\n): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    // pick players\n    const choices = nonEvictedHouseguests(newGameState);\n    let povPlayers: any[] = [];\n    const everyoneWillPlay = choices.length <= 6;\n\n    if (everyoneWillPlay) {\n        povPlayers.push({ ...HoH });\n        povPlayers.push({ ...nom1 });\n        povPlayers.push({ ...nom2 });\n        while (povPlayers.length < choices.length) {\n            povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        }\n    } else {\n        // TODO: houseguests choice picks\n        povPlayers.push({ ...HoH });\n        povPlayers.push({ ...nom1 });\n        povPlayers.push({ ...nom2 });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n    }\n    let povWinner = randomPlayer(povPlayers);\n    povWinner = getById(newGameState, povWinner.id);\n    povWinner.povWins++;\n    let introText: string;\n    if (everyoneWillPlay) {\n        introText = \"Everyone left in the house will compete in this challenge.\";\n    } else {\n        introText = `${HoH.name}, as Head of Household, and ${nom1.name} and ${\n            nom2.name\n        } as nominees, will compete, as well as 3 others chosen by random draw.`;\n    }\n    const extras = [povPlayers[3]];\n    povPlayers[4] && extras.push(povPlayers[4]);\n    povPlayers[5] && extras.push(povPlayers[5]);\n    const scene = new Scene({\n        title: \"Veto Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                It's time to pick players for the veto competition.\n                <br />\n                <Portraits houseguests={[HoH, nom1, nom2]} />\n                <br />\n                {introText}\n                <br />\n                <Portraits houseguests={extras} />\n                ...\n                <Portraits houseguests={[povWinner]} />\n                {`${povWinner.name} has won the Golden Power of Veto!`}\n                <br />\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene, povWinner];\n}\n","import { GameState, Houseguest, getById, exclude } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { useGoldenVeto, nominatePlayer } from \"../../../utils/ai/aiApi\";\nimport { Portraits, Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\n\nexport function generateVetoCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    initialNominees: Houseguest[],\n    povWinner: Houseguest\n): [Scene, Houseguest[]] {\n    let povTarget: Houseguest | null = null;\n    let descisionText = \"\";\n    initialNominees[0] = getById(initialGameState, initialNominees[0].id);\n    initialNominees[1] = getById(initialGameState, initialNominees[1].id);\n    HoH = getById(initialGameState, HoH.id);\n\n    povTarget = useGoldenVeto(povWinner, initialNominees, initialGameState);\n\n    if (!povTarget) {\n        descisionText += \"... not to use the power of veto.\";\n    } else if (povWinner.id == initialNominees[0].id || povWinner.id == initialNominees[1].id) {\n        descisionText += \"...to use the power of veto on myself.\";\n    } else {\n        descisionText += `...to use the power of veto on ${povTarget.name}.`;\n    }\n\n    let replacementSpeech = \"\";\n    let nameAReplacement = \"\";\n    let finalNominees: any[] = initialNominees;\n    if (povTarget) {\n        finalNominees = initialNominees.filter(hg => hg.id != povTarget!.id);\n        nameAReplacement += ` ${\n            HoH.name\n        }, since I have just vetoed one of your nominations, you must name a replacement nominee.`;\n        const replacementNom = {\n            ...getById(\n                initialGameState,\n                nominatePlayer(\n                    HoH,\n                    exclude(initialGameState.houseguests, [\n                        HoH,\n                        initialNominees[0],\n                        initialNominees[1],\n                        povWinner\n                    ]),\n                    initialGameState\n                )\n            )\n        };\n        replacementNom.nominations++;\n        finalNominees.push(replacementNom);\n        getById(initialGameState, replacementNom.id).nominations++;\n        replacementSpeech = `My replacement nominee is ${replacementNom.name}.`;\n    }\n\n    const scene = new Scene({\n        title: \"Veto Ceremony\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                This is the Veto Ceremony.\n                <br />\n                {`${initialNominees[0].name} and ${\n                    initialNominees[1].name\n                } have been nominated for eviction.`}\n                <Portraits houseguests={initialNominees} />\n                But I have the power to veto one of these nominations.\n                <br />\n                <b>\n                    I have decided...\n                    <Portrait houseguest={povWinner} />\n                    {descisionText}\n                </b>\n                {nameAReplacement}\n                {replacementSpeech && <Portrait houseguest={HoH} />}\n                <b>{replacementSpeech}</b>\n                <Portraits houseguests={finalNominees} />\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [scene, finalNominees];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests, getById } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { shuffle } from \"lodash\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { evictHouseguest } from \"../bigBrotherEpisode\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\n\nexport function generateEvictionScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nominees: Houseguest[]\n): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    nominees = shuffle(nominees);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    nonEvictedHouseguests(newGameState).forEach(hg => {\n        if (hg.id !== nominees[0].id && hg.id !== nominees[1].id && hg.id !== HoH.id) {\n            const logic = castEvictionVote(hg, nominees, newGameState);\n            const result: ProfileHouseguest = { ...hg };\n            result.tooltip = logic.reason;\n            votes[logic.vote].push(result);\n        }\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n\n    let tieVote = votesFor0 === votesFor1;\n    let tieBreaker = { vote: 0, reason: \"Error you should not be seeing this\" };\n    if (tieVote) {\n        tieBreaker = castEvictionVote(HoH, nominees, newGameState);\n    }\n    let evictee: Houseguest;\n    if (votesFor0 > votesFor1) {\n        evictee = nominees[0];\n    } else if (votesFor1 > votesFor0) {\n        evictee = nominees[1];\n    } else {\n        evictee = nominees[tieBreaker.vote];\n    }\n    evictHouseguest(newGameState, evictee.id);\n\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const displayHoH: ProfileHouseguest = { ...HoH };\n    displayHoH.tooltip = tieBreaker.reason;\n    const scene = new Scene({\n        title: \"Live Eviction\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <p style={{ textAlign: \"center\" }}>\n                    <b>{voteCountText} </b>\n                </p>\n                <div className=\"columns is-centered\">\n                    <div className=\"column box\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </div>\n                    <div className=\"column box\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </div>\n                </div>\n                {tieVote && (\n                    <div>\n                        <p style={{ textAlign: \"center\" }}>\n                            <b> We have a tie.</b> <br />\n                            {`${\n                                HoH.name\n                            }, as current Head of Household, you must cast the sole vote to evict.`}\n                        </p>\n                        <Portraits houseguests={[displayHoH]} centered={true} />\n                        <p style={{ textAlign: \"center\" }}>\n                            <b>I vote to evict {`${evictee.name}.`}</b>\n                        </p>\n                    </div>\n                )}\n\n                <Portraits\n                    houseguests={[\n                        getById(newGameState, nominees[0].id),\n                        getById(newGameState, nominees[1].id)\n                    ]}\n                    centered={true}\n                />\n                <p style={{ textAlign: \"center\" }}>\n                    <b>{`${evictee.name}... you have been evicted from the Big Brother House.`}</b>\n                </p>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [newGameState, scene];\n}\n","import { Subscription } from \"rxjs\";\nimport { Sidebar } from \"./sidebar\";\nimport { Season } from \"../../model/season\";\nimport { Episode, nonEvictedHouseguests, getById } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport {\n    mainContentStream$,\n    episodes$,\n    switchEpisode$,\n    newEpisode,\n    switchSceneRelative,\n    cast$,\n    getSelectedPlayer,\n    selectedPlayer$\n} from \"../../subjects/subjects\";\n\ninterface IndexedScene {\n    scene: Scene;\n    index: number;\n}\n\nconst LEFT = 37;\nconst RIGHT = 39;\n\nexport class SidebarController {\n    private view: Sidebar;\n    private subscriptions: Subscription[] = [];\n    private season: Season = new Season();\n    private scenes: IndexedScene[] = [];\n    private selectedEpisode: number = 0;\n\n    public constructor(view: Sidebar) {\n        this.view = view;\n        this.subscriptions.push(\n            episodes$.subscribe({\n                next: episode => this.onNewEpisode(episode)\n            })\n        );\n        this.subscriptions.push(\n            switchEpisode$.subscribe({\n                next: (value: number) => {\n                    this.switchSceneRelative(value);\n                }\n            })\n        );\n        this.subscriptions.push(\n            cast$.subscribe({\n                next: () => (this.season = new Season())\n            })\n        );\n    }\n\n    public getSelectedEpisode() {\n        return this.selectedEpisode;\n    }\n\n    public async switchToScene(id: number) {\n        mainContentStream$.next(this.scenes[id].scene.render);\n        this.selectedEpisode = this.scenes[id].index;\n        await this.view.setState({ selectedScene: id });\n        if (getSelectedPlayer() !== null) {\n            selectedPlayer$.next(\n                getById(this.scenes[this.view.state.selectedScene].scene.gameState, getSelectedPlayer()!.id)\n            );\n        }\n    }\n\n    private switchSceneRelative = (delta: number) => {\n        const selectedScene = this.view.state.selectedScene;\n        const renderedScenes = this.scenes.length;\n        const targetScene = selectedScene + delta;\n        if (targetScene < 0) {\n            return;\n        }\n        const lastEpisode = this.view.state.episodes[this.view.state.episodes.length - 1];\n        if (targetScene < renderedScenes) {\n            // Go back to an earlier scene\n            this.switchToScene(targetScene);\n        } else if (targetScene === renderedScenes) {\n            // Generate a new scene, then jump to it\n            const currentGameState = lastEpisode.gameState;\n            const newPlayerCount = nonEvictedHouseguests(lastEpisode.gameState).length;\n            const nextEpisodeType = this.season.whichEpisodeType(newPlayerCount);\n            if (newPlayerCount > 2) {\n                newEpisode(this.season.renderEpisode(currentGameState, nextEpisodeType));\n                this.switchSceneRelative(1);\n            }\n        }\n    };\n\n    public handleKeyDown(event: any) {\n        if (event.keyCode === LEFT) {\n            switchSceneRelative(-1);\n        } else if (event.keyCode === RIGHT) {\n            switchSceneRelative(1);\n        }\n    }\n\n    private onNewEpisode(episode: Episode | null) {\n        if (!episode) {\n            this.view.setState({ episodes: [], selectedScene: 0 });\n            this.scenes = [];\n        } else {\n            const newState = { ...this.view.state };\n            // starts at -1: prevent OBOE\n            const latestIndex = this.scenes.length === 0 ? -1 : this.scenes[this.scenes.length - 1].index;\n            const index = latestIndex + 1;\n            this.scenes.push({ scene: episode, index });\n            episode.scenes.forEach(scene => this.scenes.push({ scene, index }));\n            newState.episodes.push(episode);\n            this.view.setState(newState);\n        }\n    }\n\n    public destroy() {\n        this.subscriptions.forEach(sub => sub.unsubscribe());\n    }\n}\n","import React from \"react\";\nimport { SidebarController } from \"./sidebarController\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { Episode, GameState } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport { newEpisode } from \"../../subjects/subjects\";\ninterface SidebarState {\n    episodes: Episode[];\n    selectedScene: number;\n}\n\nexport class Sidebar extends React.Component<{}, SidebarState> {\n    private controller: SidebarController;\n    public constructor(props: {}) {\n        super(props);\n        this.controller = new SidebarController(this);\n        this.state = { episodes: [], selectedScene: 0 };\n        newEpisode(new PregameEpisode(new GameState([])));\n    }\n\n    public componentDidMount() {\n        document.addEventListener(\"keydown\", this.controller.handleKeyDown);\n    }\n\n    public componentWillUnmount() {\n        this.controller.destroy();\n    }\n\n    public render() {\n        return (\n            <div className=\"box\" style={{ minWidth: 140 }}>\n                {this.getEpisodes()}\n            </div>\n        );\n    }\n\n    private getHighlight(title: string, key: number) {\n        if (key === this.state.selectedScene) {\n            return <mark>{title}</mark>;\n        }\n        return title;\n    }\n\n    private getEpisodes() {\n        const result: JSX.Element[] = [];\n        // Weird OBOE to make keys start at 0\n        let episodeKey = -1;\n        let breakKey = 0;\n        this.state.episodes.forEach((episode: Episode) => {\n            const id = ++episodeKey;\n            result.push(\n                <b\n                    key={id}\n                    onClick={() => {\n                        this.controller.switchToScene(id);\n                    }}\n                >\n                    {this.getHighlight(episode.title, id)}\n                </b>\n            );\n            result.push(<br key={--breakKey} />);\n            episode.scenes.forEach((scene: Scene) => {\n                const id = ++episodeKey;\n                if (this.controller.getSelectedEpisode() === episode.gameState.phase) {\n                    result.push(\n                        <a key={id} onClick={() => this.controller.switchToScene(id)}>\n                            {this.getHighlight(scene.title, id)}\n                        </a>\n                    );\n                    result.push(<br key={--breakKey} />);\n                }\n            });\n        });\n        return result;\n    }\n}\n","import React from \"react\";\nimport { mainContentStream$ } from \"../../subjects/subjects\";\n\nexport class MainContentArea extends React.Component<{}, { content: any }> {\n    // a simple class that displays whatever it gets fed through the main content stream.\n\n    private contentStream: any;\n\n    public constructor(props: any) {\n        super(props);\n        this.state = { content: null };\n    }\n\n    public componentDidMount() {\n        this.contentStream = mainContentStream$.subscribe(content => {\n            this.setState({ content });\n        });\n    }\n\n    public componentDidUpdate(prevProps: never, prevState: any) {\n        if (prevState.content !== this.state.content) {\n            window.scrollTo(0, 0);\n        }\n    }\n\n    public componentWillUnmount() {\n        this.contentStream.unsubscribe();\n    }\n\n    public render() {\n        return <div className=\"box\">{this.state.content}</div>;\n    }\n}\n","import \"./mainPage.scss\";\nimport React from \"react\";\nimport { Sidebar } from \"../sidebar/sidebar\";\nimport { Topbar } from \"../topbar/topBar\";\nimport { MainContentArea } from \"./mainContentArea\";\nimport { MainPageController } from \"./mainPageController\";\n\ninterface MainPageProps {\n    controller: MainPageController;\n}\n\nexport class MainPage extends React.Component<MainPageProps, any> {\n    public constructor(props: MainPageProps) {\n        super(props);\n        props.controller.inject(this);\n    }\n\n    public render() {\n        return (\n            <div className=\"main-page\">\n                <Topbar />\n                <div className=\"columns\">\n                    <div className=\"column is-narrow\">\n                        <Sidebar />\n                    </div>\n                    <div className=\"column\">\n                        <MainContentArea />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","import { MainPage } from \"./mainPage\";\n\nexport class MainPageController {\n    private view: MainPage = new MainPage({ controller: this });\n\n    public inject(page: MainPage) {\n        this.view = page;\n    }\n}\n","import React, { Component } from \"react\";\nimport { MainPage } from \"./components/mainPage/mainPage\";\nimport { MainPageController } from \"./components/mainPage/mainPageController\";\n\nclass App extends Component {\n    render() {\n        return <MainPage controller={new MainPageController()} />;\n    }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {});\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {});\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {});\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}