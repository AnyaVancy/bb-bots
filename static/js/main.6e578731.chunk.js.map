{"version":3,"sources":["model/houseguest.ts","model/playerProfile.ts","utils/utilities.ts","utils/relationshipMap.ts","components/playerPortrait/selectedPortrait.ts","subjects/subjects.tsx","model/color.ts","components/playerPortrait/houseguestPortraitController.ts","components/playerPortrait/houseguestPortrait.tsx","components/playerPortrait/houseguestToPortrait.tsx","components/tooltip/tooltip.tsx","components/playerPortrait/portraits.tsx","components/memoryWall/memoryWall.tsx","components/nextEpisodeButton/nextEpisodeButton.tsx","components/playerPortrait/setupPortrait.tsx","utils/ai/classifyRelationship.ts","components/castingScreen/importLinks.tsx","components/playerPortrait/subtitle.tsx","model/portraitDisplayMode.ts","components/viewsBar/viewBarTag.tsx","components/viewsBar/viewBar.tsx","components/episode/episodes.tsx","components/episode/pregameEpisode.tsx","components/castingScreen/randomXButton.tsx","components/layout/text.ts","components/layout/centered.tsx","components/episode/allianceList.tsx","components/castingScreen/castingScreen.tsx","theme/theme.ts","components/topbar/themeSwitch.tsx","components/layout/box.tsx","components/deckScreen/deckScreen.tsx","components/topbar/topBar.tsx","components/pregameScreen/pregameScreen.tsx","utils/BbRandomGenerator.ts","model/gameState.ts","model/season.ts","components/episode/scene.tsx","utils/fft.ts","utils/poissonbinomial.ts","utils/ai/aiUtils.ts","utils/ai/targets.ts","utils/ai/aiApi.ts","components/mainPage/fullscreenButton.tsx","components/episode/scenes/votingTable.tsx","model/logging/voteType.tsx","components/episode/scenes/juryVoteScene.tsx","components/episode/bigBrotherFinale.tsx","components/episode/scenes/finalHohCompScene.tsx","components/episode/scenes/finalEvictionScene.tsx","components/episode/gameOver.tsx","model/logging/episodelog.ts","utils/generateGraph.ts","utils/generateCliques.ts","components/episode/bigBrotherWeekstartWrapper.tsx","components/episode/safetyChain.tsx","components/episode/scenes/safetyChainScene.tsx","components/episode/episodeFactory.ts","components/episode/bigBrotherEpisode.tsx","components/episode/scenes/hohCompScene.tsx","components/episode/scenes/nomCeremonyScene.tsx","components/episode/scenes/vetoCompScene.tsx","components/episode/scenes/vetoCeremonyScene.tsx","components/episode/scenes/evictionScene.tsx","components/sidebar/sidebarController.ts","components/sidebar/sidebar.tsx","components/mainPage/mainContentArea.tsx","components/mainPage/mainPage.tsx","components/mainPage/mainPageController.ts","theme/globalTheme.ts","App.tsx","index.tsx"],"names":["Houseguest","_PlayerProfile","init","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","isEvicted","isJury","id","nominations","hohWins","povWins","compatibility","popularity","deltaPopularity","relationships","targets","powerRanking","superiors","friends","enemies","targetingMe","assign","assertThisInitialized","inherits","createClass","key","value","villain","PlayerProfile","name","imageURL","castingScreenId","roundTwoDigits","number","Math","round","intersection","setA","setB","_intersection","Set","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","elem","has","add","err","return","difference","_difference","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","delete","isWellDefined","x","isNotWellDefined","magnitude","result","forEach","pow","angleBetween","y","length","Error","concat","acos","_","i","dot","newRelationshipMap","size","exclude","selectPlayer","player","getSelectedPlayer","selectedPlayer$","selectCastPlayer","selectedCastPlayers","selectedCastPlayer$","componentToHex","c","hex","toString","Rgb","r","g","b","interpolateColor","min","max","percent","toHex","selectedColor","HouseguestPortraitController","view","subs","refreshData","data","props","setState","comparePowerRankings","defaultState","selectedPlayer","state","displayMode","backgroundColor","_this2","push","subscribe","displayMode$","sub","unsubscribe","get","Subtitle","styled","small","_templateObject","MemoryWallPortrait","div","_templateObject2","_ref","theme","portraitBorder","Evicted","_templateObject3","Jury","_templateObject4","Normal","img","_templateObject5","Grayscale","_templateObject6","Sepia","_templateObject7","HouseguestPortrait","_React$Component","controller","subtitle","Img","imageClass","getImageClass","generateSubtitle","detailed","Portrait","react_default","a","createElement","onClick","style","src","height","width","React","Component","houseguestToPortrait","houseguest","houseguestPortrait_HouseguestPortrait","Text","p","tooltip_templateObject","Tooltip","visible","Popover_default","position","isOpen","content","text","onMouseEnter","onMouseLeave","children","PortraitWrapper","className","centered","tooltip","tooltip_Tooltip","Portraits","rows","houseguests","display","justifyContent","alignItems","memoryWallPortrait","MemoryWall","margin","maxWidth","NextEpisodeButton","switchSceneRelative","RelationshipType","TwoWayRelationshipType","EditPortrait","setupPortrait_templateObject","Noselect","setupPortrait_templateObject2","XButton","setupPortrait_templateObject3","EditButton","setupPortrait_templateObject4","SetupPortrait","selected","textAlign","maxHeight","onDoubleClick","onDelete","event","stopPropagation","onRename","imageUrl","ImportLinks","lines","split","profiles","line","temp","pop","replace","substr","indexOf","onSubmit","onChange","target","RelationshipTypeToSymbol","FRIEND","ENEMY","PAWN","QUEEN","classifyRelationship","heroPopularity","villainPopularity","relationship","benefitsHero","benefitsVillain","Friend","Pawn","Queen","Enemy","classifyTwoWayRelationship","PawnQueen","addPopularityLine","hero","popularitySubtitle","deltaPop","statePopularity","getDeltaPopularity","addCompsLine","compWins","lineHeight","popularityMinColor","popularityMaxColor","popularityMode","minColor","maxColor","extremePopularity","xSquared","extremeValues","_addFriendshipCountTi","titles","friendOrEnemyTitle","map","txt","count","Relationship","friendEnemyCountTitle","addFriendshipCountTitles","arguments","powerMaxColor","powerMinColor","powerMode","ViewBarTag","mode","_this3","disabled","background","toRgba","cursor","ViewsBar","inJury","gameState","marginBottom","viewBarTag_ViewBarTag","Episode","scenes","title","initialGameState","type","arrowsEnabled","initialGamestate","viewsBar","hasViewsbar","viewBar_ViewsBar","PregameEpisodeType","eliminates","canPlayWith","n","PregameEpisode","_Episode","pregameScreen_PregameScreen","cast","RandomButton","_useState","useState","_useState2","slicedToArray","setNumber","random","parseInt","NumericInput","marginLeft","test","HasText","text_templateObject","Input","input","text_templateObject2","_ref2","NoMargin","centered_templateObject","Center","centered_templateObject2","Centered","noMargin","CenteredBold","CenteredItallic","HelpLink","allianceList_templateObject","link","AllianceList","canDisplayCliques","elements","cliques","clique","affiliates","phase","core","getById","entries","toConsumableArray","href","rel","CastingScreen","appendProfiles","newState","objectSpread","profile","players","submit","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","newCast","cast$","mainContentStream$","newEpisode","GameState","stop","_amount","amount","allPlayers","unselectedPlayers","selectedPlayers","shuffle","slice","handleUpload","handleFiles","files","handleDrop","splice","_this4","newName","prompt","_this5","setupPortrait_SetupPortrait","deleteMethod","rename","_this6","FileDrop","onDrop","importLinks_ImportLinks","filter","multiple","getFiles","file","match","lastIndexOf","URL","createObjectURL","lightTheme","bg","toggleBorder","gradient","bodyArea","overlay","evictedCell","grayCell","lightGrayCell","winnerCell","runnerUpCell","nomineeCell","hohCell","tableCellBorder","darkTheme","ThemeSwitcher","window","matchMedia","matches","setTheme","theme$","ShadowBox","box_templateObject","StyledBox","box_templateObject2","_ref3","DividerBox","Box","decksPerPage","baseUrl","imageCache","DeckStyle","deckScreen_templateObject","deckScreen_templateObject2","DeckText","deckScreen_templateObject3","_callee2","folder","links","image","_context2","abrupt","fetch","sent","json","sample","_callee3","casts","playerProfiles","_loop","_context4","imageLinks","folderProfiles","_context3","url","apply","delegateYield","t1","finish","castingScreen_CastingScreen","Deck","_React$useState","_React$useState2","setImage","_React$useState3","_React$useState4","loading","setLoading","deck","randomImageFromFolder","then","color","selectDeckSubject","DeckList","decks","j","DeckScreen","handlePageClick","page","debounceSearch","debounce","nextValue","debouncedSearchText","handleSearch","searchText","selectedDecks","_componentDidMount","selectedDecks$","toLowerCase","minWidth","placeholder","submitCasts","deckScreen_Centered","dist_default","previousLabel","nextLabel","breakLabel","breakClassName","pageCount","ceil","marginPagesDisplayed","pageRangeDisplayed","onPageChange","containerClassName","activeClassName","TopbarLink","topBar_templateObject","AdvancedEditLink","ChooseCastLink","deckScreen_DeckScreen","Topbar","PregameScreen","BehaviorSubject","episodes$","switchEpisode$","Subject","episode","weekStartTab$","isFullscreen$","BbRandomGenerator","seed","rng","prand","xorshift128plus","_this$rng$next","_this$rng$next2","_prand$uniformIntDist","uniformIntDistribution","_prand$uniformIntDist2","_this$rng$next3","_this$rng$next4","rng$","castNames","string","hash","charCodeAt","hashcode","houseguestCache","inclusions","exclusions","excludedIds","hg","includes","randomPlayer","options","randomInt","nonEvictedHouseguests","getJurors","remainingPlayers","finalJurySize","previousHOH","log","Array","MutableGameState","copy","cloneDeep","Scene","render","fft","real","imag","levels","cosTable","sinTable","cos","PI","sin","reverseBits","halfsize","tablestep","k","l","tpre","tpim","val","transformRadix2","m","areal","newArrayOfZeros","aimag","breal","bimag","creal","cimag","convolveComplex","transformBluestein","xreal","ximag","yreal","yimag","outreal","outimag","pbincdf","pp","zeros","ones","num","cdf","nPlusOne","ω","sigmaLogModulusZ","sum","p_j","e1","e2","sigmaPrincipalArgz","atan2","d","exp","sigmaArgZ","ξ","_pbincdf","RelationshipTypeToNumber","friendship","relationshipWith","getBestFriend","highestScore","callback","highestIndex","Infinity","currentScore","pHeroWinsTheFinale","hgs","jury","juror","pJurorVotesForHero","deadValue","pHeroWins","winrate","getRelationshipSummary","doIWin","TargetStrategy","Targets","firstTarget","secondTarget","newTarget","isBetterTarget","old","neww","strategy","MoR","StatusQuo","Underdog","determineStrategy","newRank","rankRelationshipSummaryStatusQuo","oldRank","isBetterTargetStatusQuo","_computeLocalPopulari","computeLocalPopularity","oldPop","newPop","isBetterTargetMoR","_computeLocalPopulari2","isBetterTargetUnderdog","condition","nonFriends","from","oldHg","newHg","castEvictionVote","nominees","nom0","nom1","castF3Vote","HoH","evictNom0","winningOddsF3","evictNom1","decision","reason","castF4vote","values","cutthroatVote","voteBasedOnWinrate","r0","r1","heroBeatsnom0","heroBeatsnom1","cutthroatVoteJury","villain1","villain2","heroVs1","heroVs2","v1Vs2","nom0isTarget","nom1isTarget","vote","lowestIndex","lowestScore","useGoldenVeto","potentialSave","nominee","useGoldenVetoPreJury","FullscreenIcon","fullscreenButton_templateObject","FullscreenButton","getValue","EndgameTableCell","td","votingTable_templateObject","EndgameTable","table","votingTable_templateObject2","Gray","votingTable_templateObject3","White","votingTable_templateObject4","_ref4","votingTable_templateObject5","_ref5","WinnerCell","votingTable_templateObject6","_ref6","RunnerUpCell","votingTable_templateObject7","_ref7","NomineeCell","_templateObject8","_ref8","HohCell","_templateObject9","_ref9","BlackRow","tr","_templateObject10","generateVotingTable","masterLog","houseguestCells","evictionOrder","topRowCells","preVetoCells","vetoCells","postVetoCells","evictedCells","winnerCells","cells","colSpan","generateTopRow","nominationsPreVeto","rowSpan","generatePreVetoRow","vetoWinner","generateVetoRow","nominationsPostVeto","generatePostVetoRow","voteTextLine1","soleVoter","votesInMajority","outOf","votingTable_Evicted","evicted","generateEvictedRow","runnerUp","winner","_arr","votes","_i","_ref12","_ref11","WinnerVote","RunnerUpVote","winnerRow","topRow","preVetoRow","vetoRow","postVetoRow","blackRow","houseguestRows","evictedRow","evictionColSpan","weeks","reverse","weekText","tempList","voteKey","getKey","NormalVote","NomineeVote","HoHVote","hohText","hohVote","juryVoteScene","newGameState","jurors","finalists","abs","randomFloat","castJuryVote","currentLog","votesFor0","votesFor1","voteCountText","scene","BigBrotherFinale","generateBbFinale","currentGameState","hohCompScene","finalHoH","finalEviction","_finalHohCompScene","final3","enduranceWinner","enduranceLosers","skillWinner","portraits_Portrait","finalHohCompScene","_finalHohCompScene2","_finalEvictionScene","_castEvictionVote","evictee","survivor","hoh","evictHouseguest","finalEvictionScene","_finalEvictionScene2","_juryVoteScene","_juryVoteScene2","juryScene","BigBrotherFinaleEpisode","GameOver","GameOverEpisode","EpisodeLog","EdgeMap","generateGraph","nodes","edges","stringId","villainId","_generateEdge","generateEdge","_generateEdge2","edge","neighbors","v","newCliquesLength","generateCliques","bronKerbosch","keys","rPrime","pPrime","node","xPrime","sort","mergeCandidates","clq","cliqueI","cliqueJ","affiliatesI","affiliatesJ","blacklist","candidate","WeekStartWrapper","tab","helpText1","marginTop","helptext2","SafetyChain","generateSafetyChain","safetyChainScene","Tabs","bigBrotherWeekstartWrapper_WeekStartWrapper","_generateSafetyChainS","chainOrder","chainStarter","safeSpots","currentChooser","sceneContent","first","newSafeIndex","generateSafetyChainScene","_generateSafetyChainS2","SafetyChainEpisode","EpisodeFactory","episodeType","u","θ","φ","iMap","jMap","impression","firstImpressions","populateSuperiors","h","xi","average","house","targetId","calculatePopularity","updatePopularity","addTarget","getTargets","updateFriendCounts","finalState","BigBrotherVanilla","nomCeremonyScene","_generateHohCompScene","previousHoh","newHoH","generateHohCompScene","_generateHohCompScene2","vetoCompScene","povWinner","_generateNomCeremonyS","nom2","noms","generateNomCeremonyScene","_generateNomCeremonyS2","vetoCeremonyScene","_generateVetoCompScen","choices","povPlayers","everyoneWillPlay","introText","extras","generateVetoCompScene","_generateVetoCompScen2","evictionScene","_generateVetoCeremony","initialNominees","povTarget","descisionText","vetoChoice","replacementSpeech","nameAReplacement","finalNominees","HoHwonPoV","replacementNom","sortedOptions","hg1","hg2","backdoorNPlayers","replacementIndex","findIndex","generateVetoCeremonyScene","_generateVetoCeremony2","_generateEvictionScen","lastVoter","logic","tieVote","tieBreaker","displayHoH","generateEvictionScene","_generateEvictionScen2","BigBrotherVanillaEpisode","generateBbVanilla","generateGameOver","TabItem","li","bigBrotherEpisode_templateObject","Tab","active","setActive","paddingLeft","Season","factory","nextEpisode","whichEpisodeType","SidebarController","subscriptions","season","selectedEpisode","delta","selectedScene","renderedScenes","targetScene","lastEpisode","episodes","switchToScene","renderEpisode","onNewEpisode","_switchToScene","index","_x","keyCode","_handleKeyDown","bind","Sidebar","document","addEventListener","handleKeyDown","destroy","getEpisodes","episodeKey","breakKey","getHighlight","getSelectedEpisode","MainContentAreaWrapper","mainContentArea_templateObject","MainContentArea","contentStream","prevProps","prevState","scrollTo","MainPage","fullscreen","inject","hideOnFullscreen","wrapperStyle","overflow","sidebar_Sidebar","overflowX","mainContentArea_MainContentArea","MainPageController","GlobalStyles","createGlobalStyle","globalTheme_templateObject","App","styled_components_browser_esm","Fragment","mainPage_MainPage","ReactDOM","src_App","getElementById"],"mappings":"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","file":"static/js/main.6e578731.chunk.js","sourcesContent":["import { PlayerProfile } from \"./playerProfile\";\nimport { RelationshipMap } from \"../utils\";\n\ninterface HouseguestInit extends PlayerProfile {\n    id: number;\n    relationships: RelationshipMap;\n}\n\nexport class Houseguest extends PlayerProfile {\n    public isEvicted: boolean = false;\n    public isJury: boolean = false;\n\n    readonly id: number = 0;\n\n    public nominations: number = 0;\n    public hohWins: number = 0;\n    public povWins: number = 0;\n\n    // Popularity ranges from -1 to 1\n    public compatibility: [number, number, number] = [0, 0, 0];\n    public popularity: number = 0;\n    public deltaPopularity: number = 0;\n    readonly relationships: RelationshipMap = {};\n\n    public targets: [number, number] = [this.id, this.id];\n\n    // power rankings range from 0 to 1\n    public powerRanking: number = 0;\n    readonly superiors: { [id: number]: number } = {}; // { id : pHeroWins }\n\n    public relationshipWith(villain: Houseguest): number {\n        return this.relationships[villain.id];\n    }\n    public friends = 0;\n    public enemies = 0;\n    public targetingMe = 0;\n\n    constructor(init: HouseguestInit) {\n        super(init);\n        Object.assign(this, init);\n    }\n}\n","interface InitPlayerProfile {\n    readonly name: string;\n    readonly imageURL: string;\n}\n\nexport class PlayerProfile {\n    public name: string = \"\";\n    readonly imageURL: string = \"\";\n    public castingScreenId?: number | undefined = 0;\n    constructor(init: InitPlayerProfile) {\n        if (!init) {\n            return;\n        }\n        Object.assign(this, init);\n    }\n}\n","export function hashcode(string: string): number {\n    let hash = 0,\n        i,\n        chr;\n    if (string.length === 0) return hash;\n    for (i = 0; i < string.length; i++) {\n        chr = string.charCodeAt(i);\n        hash = (hash << 5) - hash + chr;\n        hash |= 0;\n    }\n    return hash;\n}\n\nexport function roundTwoDigits(number: number | undefined) {\n    if (!number) {\n        return 0;\n    }\n    return Math.round(number * 100);\n}\n\nexport function max(a: number, b: number) {\n    return a > b ? a : b;\n}\n\nexport function intersection<T>(setA: Set<T>, setB: Set<T>): Set<T> {\n    let _intersection = new Set<T>();\n    for (let elem of setB) {\n        if (setA.has(elem)) {\n            _intersection.add(elem);\n        }\n    }\n    return _intersection;\n}\nexport function difference<T>(setA: Set<T>, setB: Set<T>): Set<T> {\n    let _difference = new Set<T>(setA);\n    for (let elem of setB) {\n        _difference.delete(elem);\n    }\n    return _difference;\n}\n\nexport function extremeValues(x: number | undefined): number {\n    if (!x) {\n        return 0;\n    }\n    const xSquared = x * x;\n    if (x >= 0) {\n        return -xSquared + 2 * x;\n    } else {\n        return xSquared + 2 * x;\n    }\n}\n\nexport function average(x: number[]): number {\n    let sum = 0;\n    x.forEach((xi) => (sum += xi));\n    return sum / x.length;\n}\n\nexport function isWellDefined(x: any) {\n    return x !== null && x !== undefined;\n}\n\nexport function isNotWellDefined(x: any): x is null | undefined {\n    return x === null || x === undefined;\n}\n\nexport function dot(x: number[], y: number[]) {\n    if (x.length !== y.length)\n        throw new Error(\n            `Tried to get the dot product between two vectors of non-equal length: ${x.length} !== ${y.length}`\n        );\n    let result = 0;\n    x.forEach((_, i) => {\n        result += x[i] * y[i];\n    });\n    return result;\n}\n\nexport function magnitude(x: number[]): number {\n    let result = 0;\n    x.forEach((x) => (result += x ** 2));\n    return result;\n}\n\n// returns a value between 0 and pi\n\nexport function angleBetween(x: number[], y: number[]): number {\n    if (x.length !== y.length)\n        throw new Error(\n            `Tried to get the angle between two vectors of non-equal length: ${x.length} !== ${y.length}`\n        );\n    return Math.acos((dot(x, y) / magnitude(x)) * magnitude(y));\n}\n","export interface RelationshipMap {\n    [id: number]: number;\n}\n\nexport function newRelationshipMap(size: number, exclude: number): RelationshipMap {\n    const result: RelationshipMap = {};\n    for (let i = 0; i < size; i++) {\n        if (i !== exclude) result[i] = 0;\n    }\n    return result;\n}\n","import { Houseguest } from \"../../model\";\nimport { RelationshipMap } from \"../../utils\";\nimport {\n    getSelectedCastPlayers,\n    getSelectedPlayer,\n    selectedCastPlayer$,\n    selectedPlayer$,\n} from \"../../subjects/subjects\";\n\nexport interface SelectedPlayerData {\n    id: number;\n    popularity: number;\n    relationships: RelationshipMap;\n    isEvicted: boolean;\n    superiors?: { [id: number]: number };\n}\n\nexport function selectPlayer(player: SelectedPlayerData | null) {\n    if (!player || (getSelectedPlayer() && (getSelectedPlayer() as Houseguest).id === player.id)) {\n        selectedPlayer$.next(null);\n    } else {\n        selectedPlayer$.next(player);\n    }\n}\n\nexport function selectCastPlayer(id: number | null) {\n    if (id === null) {\n        selectedCastPlayer$.next(new Set());\n        return;\n    }\n    const selectedCastPlayers = getSelectedCastPlayers();\n    if (selectedCastPlayers.has(id)) {\n        // remove if exists\n        selectedCastPlayers.delete(id);\n    } else {\n        // else add\n        selectedCastPlayers.add(id);\n    }\n    selectedCastPlayer$.next(selectedCastPlayers);\n}\n","import { BehaviorSubject, Subject } from \"rxjs\";\nimport { PregameScreen } from \"../components/pregameScreen/pregameScreen\";\nimport { Episode, PlayerProfile } from \"../model\";\nimport { SelectedPlayerData } from \"../components/playerPortrait/selectedPortrait\";\nimport React from \"react\";\nimport { PortraitDisplayMode, popularityMode } from \"../model/portraitDisplayMode\";\nimport { ColorTheme } from \"../theme/theme\";\n\n// What is currently being displayed.\nexport const mainContentStream$ = new BehaviorSubject(<PregameScreen cast={[]} />);\n// Push episodes to this subject to add them to the sidebar. Null resets everything.\nexport const episodes$ = new BehaviorSubject<Episode | null>(null);\n// Forcibly switches to an episode. Used when adding a new episode.\nexport const switchEpisode$ = new Subject<number>();\nexport function newEpisode(episode: Episode | null) {\n    episodes$.next(episode);\n}\nexport function switchSceneRelative(n: number) {\n    switchEpisode$.next(n);\n}\n// the list of players in the game\nexport const cast$ = new BehaviorSubject<PlayerProfile[]>([]);\nexport function updateCast(newCast: PlayerProfile[]) {\n    cast$.next(newCast);\n}\nexport function getCast(): PlayerProfile[] {\n    return cast$.value;\n}\n// The player that the user has clicked on.\nexport const selectedPlayer$ = new BehaviorSubject<SelectedPlayerData | null>(null);\nexport function getSelectedPlayer() {\n    return selectedPlayer$.value;\n}\n\n// The cast member(s) that the user has clicked on.\n// Used for the casting screen.\nexport const selectedCastPlayer$ = new BehaviorSubject<Set<number>>(new Set<number>());\n\nexport function getSelectedCastPlayers() {\n    return selectedCastPlayer$.value;\n}\n\n// The decks that have been selected on the casting screen.\nexport const selectedDecks$ = new BehaviorSubject<Set<string>>(new Set<string>());\n\nexport function selectDeckSubject(deck: string | null) {\n    if (deck === null) {\n        selectedDecks$.next(new Set());\n        return;\n    }\n    const selectedDecks = selectedDecks$.value;\n    if (selectedDecks.has(deck)) {\n        // remove if exists\n        selectedDecks.delete(deck);\n    } else {\n        // else add\n        selectedDecks.add(deck);\n    }\n    selectedDecks$.next(selectedDecks);\n}\n\n// The tab selected on the start of each week.\nexport const weekStartTab$ = new BehaviorSubject<number>(0);\n\n// The display mode selected by the viewsbar.\nexport const displayMode$ = new BehaviorSubject<PortraitDisplayMode>(popularityMode);\n\n// If the screen is fullscreen or not.\nexport const isFullscreen$ = new BehaviorSubject<boolean>(false);\n\n// dark or light mode.\nexport const theme$ = new Subject<ColorTheme>();\n","function componentToHex(c: any) {\n    var hex = Math.round(c).toString(16);\n    return hex.length == 1 ? \"0\" + hex : hex;\n}\n\nexport class Rgb {\n    public r: number;\n    public g: number;\n    public b: number;\n    public toHex() {\n        return \"#\" + componentToHex(this.r) + componentToHex(this.g) + componentToHex(this.b);\n    }\n    public toRgba(): string {\n        return `rgba(${this.r}, ${this.g}, ${this.b}, 1)`;\n    }\n    constructor(r: number, g: number, b: number) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n    }\n}\n\nexport function interpolateColor(min: Rgb, max: Rgb, percent: number): string {\n    return new Rgb(\n        min.r + percent * (max.r - min.r),\n        min.g + percent * (max.g - min.g),\n        min.b + percent * (max.b - min.b)\n    ).toHex();\n}\n","import { PortraitProps, HouseguestPortrait, PortraitState } from \"../memoryWall\";\nimport { Subscription } from \"rxjs\";\nimport { selectedPlayer$, displayMode$, getSelectedPlayer } from \"../../subjects/subjects\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport { Rgb } from \"../../model/color\";\n\nexport const selectedColor = new Rgb(51, 255, 249);\n\nexport class HouseguestPortraitController {\n    private subs: Subscription[] = [];\n    private view: HouseguestPortrait;\n    constructor(view: HouseguestPortrait) {\n        this.view = view;\n    }\n\n    get defaultState() {\n        return {\n            popularity: this.view.props.popularity,\n            displayMode: displayMode$.value,\n            powerRanking: this.view.props.powerRanking,\n        };\n    }\n\n    public backgroundColor(props: PortraitProps): undefined | string {\n        const selectedPlayer = getSelectedPlayer();\n        if (selectedPlayer !== null && selectedPlayer.id === props.id) {\n            return selectedColor.toHex();\n        }\n        return props.isEvicted ? undefined : this.view.state.displayMode.backgroundColor(this.view.state);\n    }\n\n    public subscribe() {\n        const subs: Subscription[] = [];\n        subs.push(\n            selectedPlayer$.subscribe({\n                next: this.refreshData,\n            })\n        );\n        subs.push(\n            displayMode$.subscribe({\n                next: (displayMode) => this.view.setState({ displayMode }),\n            })\n        );\n        this.subs = subs;\n    }\n\n    public unsubscribe() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    private comparePowerRankings(data: SelectedPlayerData): number {\n        // 0 is blue. 1 is orange\n        if (!data.superiors) return 0;\n        const id = this.view.props.id === undefined ? -1 : this.view.props.id;\n        return data.superiors[id];\n    }\n\n    private refreshData = (data: SelectedPlayerData | null) => {\n        if (!data) {\n            this.view.setState(this.defaultState);\n        } else {\n            if (data.id !== this.view.props.id) {\n                this.view.setState({\n                    popularity: data.relationships[this.view.props.id!],\n                    powerRanking: this.comparePowerRankings(data),\n                });\n            } else {\n                this.view.setState({ popularity: 2, powerRanking: 2 });\n            }\n        }\n    };\n}\n","import React from \"react\";\nimport { selectPlayer } from \"./selectedPortrait\";\nimport { isNotWellDefined, RelationshipMap } from \"../../utils\";\nimport _ from \"lodash\";\nimport { HouseguestPortraitController } from \"./houseguestPortraitController\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst Subtitle = styled.small`\n    font-weight: 100;\n    font-size: small;\n`;\n\nconst MemoryWallPortrait = styled.div`\n    margin: 5px;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.portraitBorder};\n    color: black;\n    border-radius: 5px;\n    text-align: center;\n    font-weight: 600;\n    width: 7rem;\n    word-wrap: break-word;\n    -webkit-transition-property: none;\n    -moz-transition-property: none;\n    -o-transition-property: none;\n    transition-property: none;\n`;\n\nconst Evicted = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: grey;\n    background-color: #111111;\n`;\n\nconst Jury = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: #c3ae88;\n    background-color: #5d5340;\n    filter: brightness(0.6);\n`;\n\nconst Normal = styled.img`\n    min-width: 100px;\n    width: 100%;\n    width: -moz-available; /* For Mozzila */\n    width: -webkit-fill-available; /* For Chrome */\n    width: stretch; /* Unprefixed */\n    -webkit-transition-property: none;\n    -moz-transition-property: none;\n    -o-transition-property: none;\n    transition-property: none;\n`;\n\nconst Grayscale = styled(Normal)`\n    filter: grayscale(100%);\n`;\n\nconst Sepia = styled(Normal)`\n    filter: sepia(100%);\n`;\n\nexport interface PortraitProps {\n    imageURL: string;\n    name: string;\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    powerRanking?: number;\n    deltaPopularity?: number;\n    detailed?: boolean;\n    superiors?: { [id: number]: number };\n    friends?: number;\n    enemies?: number;\n    targetingMe?: number;\n}\n\nexport interface PortraitState {\n    popularity?: number;\n    powerRanking?: number;\n    displayMode: PortraitDisplayMode;\n}\nexport class HouseguestPortrait extends React.Component<PortraitProps, PortraitState> {\n    private controller: HouseguestPortraitController;\n\n    public constructor(props: PortraitProps) {\n        super(props);\n        this.controller = new HouseguestPortraitController(this);\n        this.state = this.controller.defaultState;\n    }\n\n    public componentDidMount() {\n        if (isNotWellDefined(this.props.id)) {\n            return;\n        }\n        this.controller.subscribe();\n    }\n\n    public componentWillUnmount() {\n        this.controller.unsubscribe();\n    }\n\n    private onClick(): void {\n        if (isNotWellDefined(this.props.id) || !this.props.relationships) {\n            return;\n        }\n        const data = {\n            id: this.props.id,\n            relationships: this.props.relationships,\n            isEvicted: !!this.props.isEvicted,\n            popularity: this.props.popularity || 0,\n            superiors: this.props.superiors,\n        };\n        selectPlayer(data);\n    }\n\n    public render() {\n        const props = this.props;\n        const Img = getImageClass(props);\n        let subtitle: any[] = [];\n        subtitle = this.state.displayMode.generateSubtitle(this.props, this.state, !!props.detailed);\n\n        let Portrait = MemoryWallPortrait;\n        if (props.isJury) {\n            Portrait = Jury;\n        } else if (props.isEvicted) {\n            Portrait = Evicted;\n        }\n        return (\n            <Portrait\n                onClick={() => this.onClick()}\n                style={{\n                    backgroundColor: this.controller.backgroundColor(props),\n                }}\n            >\n                <Img src={props.imageURL} style={{ height: 100, width: \"-moz-available\" }} />\n                <br />\n                {props.name}\n                <br />\n                {<Subtitle>{subtitle}</Subtitle>}\n            </Portrait>\n        );\n    }\n}\n\nfunction getImageClass(props: PortraitProps) {\n    let imageClass = props.isEvicted ? Grayscale : Normal;\n    imageClass = props.isJury ? Sepia : imageClass;\n    return imageClass;\n}\n","import { ProfileHouseguest, HouseguestPortrait } from \"../memoryWall\";\nimport React from \"react\";\n\nexport function houseguestToPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={false} />;\n}\n\nexport function memoryWallPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={true} />;\n}\n","import React from \"react\";\nimport Popover from \"react-tiny-popover\";\nimport styled from \"styled-components\";\n\nconst Text = styled.p`\n    max-width: 200px;\n    padding: 3px 8px;\n    color: #fff;\n    text-align: center;\n    background-color: #000;\n    border-radius: 4px;\n`;\n\ninterface TooltipProps {\n    text: string;\n    children: any;\n}\n\ninterface ToolTipState {\n    visible: boolean;\n}\n\nexport class Tooltip extends React.Component<TooltipProps, ToolTipState> {\n    constructor(props: TooltipProps) {\n        super(props);\n        this.state = { visible: false };\n    }\n\n    public render() {\n        return (\n            <Popover\n                position={[\"top\", \"bottom\"]}\n                isOpen={this.state.visible}\n                content={<Text>{this.props.text}</Text>}\n            >\n                <div\n                    onMouseEnter={() => this.setState({ visible: true })}\n                    onMouseLeave={() => this.setState({ visible: false })}\n                >\n                    {this.props.children}\n                </div>\n            </Popover>\n        );\n    }\n}\n","import React from \"react\";\nimport { ProfileHouseguest } from \"../memoryWall\";\nimport { houseguestToPortrait, memoryWallPortrait } from \"./houseguestToPortrait\";\nimport { Tooltip } from \"../tooltip/tooltip\";\n\nlet key = -1;\n\nfunction PortraitWrapper(props: { centered?: boolean; children: any }): JSX.Element {\n    return (\n        <div\n            key={key++}\n            className={`columns is-gapless is-mobile is-multiline ${props.centered ? \"is-centered\" : \"\"}`}\n        >\n            {props.children}\n        </div>\n    );\n}\n\nexport function Portrait(props: { houseguest: ProfileHouseguest; centered?: boolean }): JSX.Element {\n    const result = (\n        <PortraitWrapper centered={props.centered}>{houseguestToPortrait(props.houseguest)}</PortraitWrapper>\n    );\n    if (props.houseguest.tooltip) {\n        return (\n            <PortraitWrapper centered={props.centered}>\n                <Tooltip text={props.houseguest.tooltip}>{houseguestToPortrait(props.houseguest)}</Tooltip>\n            </PortraitWrapper>\n        );\n    }\n    return result;\n}\n\nexport function Portraits(props: {\n    houseguests: (ProfileHouseguest | \"⬅️\" | \"➡️\")[];\n    centered?: boolean;\n    detailed?: boolean;\n}): JSX.Element {\n    const rows: JSX.Element[] = [];\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    props.houseguests.forEach((houseguest: ProfileHouseguest | \"⬅️\" | \"➡️\") => {\n        let result;\n        if (houseguest === \"⬅️\" || houseguest === \"➡️\") {\n            result = (\n                <div\n                    key={`plus-${key++}`}\n                    style={{ display: \"flex\", justifyContent: \"center\", alignItems: \"center\" }}\n                    className=\"column is-narrow\"\n                >\n                    <p>{houseguest}</p>\n                </div>\n            );\n        } else if (props.detailed) {\n            result = memoryWallPortrait(houseguest, key++);\n        } else {\n            result = houseguestToPortrait(houseguest, key++);\n        }\n        if (houseguest !== \"⬅️\" && houseguest !== \"➡️\" && houseguest.tooltip) {\n            result = (\n                <Tooltip key={key++} text={houseguest.tooltip}>\n                    {result}\n                </Tooltip>\n            );\n        }\n        rows.push(result);\n    });\n    return (\n        <div className={`columns is-gapless is-mobile is-multiline ${props.centered && \"is-centered\"}`}>\n            {rows}\n        </div>\n    );\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { Portraits } from \"../playerPortrait/portraits\";\nimport { RelationshipMap } from \"../../utils\";\nexport interface IMemoryWallProps {\n    readonly houseguests: ProfileHouseguest[];\n}\n\nexport interface ProfileHouseguest extends PlayerProfile {\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    deltaPopularity?: number;\n    hohWins?: number;\n    povWins?: number;\n    nominations?: number;\n    tooltip?: string;\n    friends?: number;\n    enemies?: number;\n    targetingMe?: number;\n}\n\nexport function MemoryWall(props: IMemoryWallProps): JSX.Element {\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    return (\n        <div\n            style={{\n                margin: \"auto\",\n                maxWidth: props.houseguests.length < 26 ? 800 : -1,\n            }}\n        >\n            <Portraits houseguests={props.houseguests} centered={true} detailed={true} />\n        </div>\n    );\n}\n","import React from \"react\";\nimport { switchSceneRelative } from \"../../subjects/subjects\";\n\nexport function NextEpisodeButton(): JSX.Element {\n    return (\n        <button className=\"button is-primary\" onClick={() => switchSceneRelative(1)}>\n            Continue\n        </button>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { selectedColor } from \"./houseguestPortraitController\";\n\nconst EditPortrait = styled.div`\n    padding: 5px;\n    margin: 5px;\n    border: 1px solid grey;\n    background-color: grey;\n    color: black;\n    border-radius: 5px;\n    font-weight: 600;\n    width: 7rem;\n    word-wrap: break-word;\n`;\n\nconst Noselect = styled.div`\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -khtml-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n`;\n\nconst XButton = styled(Noselect)`\n    color: #300808;\n    width: 50%;\n\n    :active {\n        color: #ff7133;\n        background-color: #ffd8c7;\n    }\n    :hover {\n        color: red;\n        background-color: #ffe1ea;\n    }\n`;\n\nconst EditButton = styled(Noselect)`\n    color: #300808;\n    width: 50%;\n\n    :active {\n        color: #ff7133;\n        background-color: #ffd8c7;\n    }\n    :hover {\n        color: orange;\n        background-color: #fff6e1;\n    }\n`;\n\ninterface SetupPortraitProps {\n    name: string;\n    imageUrl: string;\n    onDelete: () => void;\n    onRename: () => void;\n    onClick: () => void;\n    selected: boolean;\n}\n\ninterface SetupPortraitState {\n    name: string;\n}\n\nexport class SetupPortrait extends React.Component<SetupPortraitProps, SetupPortraitState> {\n    public constructor(props: SetupPortraitProps) {\n        super(props);\n        this.state = { name: props.name };\n    }\n\n    public UNSAFE_componentWillReceiveProps(props: SetupPortraitProps) {\n        this.setState({ name: props.name });\n    }\n\n    public render() {\n        const style = this.props.selected ? { backgroundColor: selectedColor.toHex() } : {};\n        return (\n            <EditPortrait onClick={() => this.props.onClick()} style={style}>\n                <div style={{ textAlign: \"center\" }}>\n                    <div style={{ maxHeight: 20, display: \"flex\" }}>\n                        <XButton\n                            onDoubleClick={() => this.props.onDelete()}\n                            onClick={(event) => event.stopPropagation()}\n                        >\n                            ✘\n                        </XButton>\n                        <EditButton\n                            onClick={(event) => {\n                                event.stopPropagation();\n                                this.props.onRename();\n                            }}\n                        >\n                            ✎\n                        </EditButton>\n                    </div>\n                    <img src={this.props.imageUrl} style={{ width: 100, height: 100 }} />\n                    <br />\n                    <p>{this.state.name}</p>\n                </div>\n            </EditPortrait>\n        );\n    }\n}\n","export enum RelationshipType {\n    Friend = \"FRIEND\",\n    Queen = \"QUEEN\",\n    Pawn = \"PAWN\",\n    Enemy = \"ENEMY\",\n}\nexport enum TwoWayRelationshipType {\n    Friend = \"FRIEND\",\n    PawnQueen = \"PAWN/QUEEN\",\n    Enemy = \"ENEMY\",\n}\n\nexport const RelationshipTypeToSymbol = { FRIEND: \"♥\", ENEMY: \"💔\", PAWN: \"PAWN\", QUEEN: \"QUEEN\" };\n\nexport function classifyRelationship(\n    heroPopularity: number,\n    villainPopularity: number,\n    relationship: number\n): RelationshipType {\n    const benefitsHero = relationship > heroPopularity;\n    const benefitsVillain = relationship > villainPopularity;\n    if (benefitsHero && benefitsVillain) {\n        return RelationshipType.Friend;\n    } else if (benefitsHero && !benefitsVillain) {\n        return RelationshipType.Pawn;\n    } else if (!benefitsHero && benefitsVillain) {\n        return RelationshipType.Queen;\n    }\n    return RelationshipType.Enemy;\n}\n\nexport function classifyTwoWayRelationship(\n    heroPopularity: number,\n    villainPopularity: number,\n    relationship: number\n): TwoWayRelationshipType {\n    const benefitsHero = relationship > heroPopularity;\n    const benefitsVillain = relationship > villainPopularity;\n    if (benefitsHero && benefitsVillain) {\n        return TwoWayRelationshipType.Friend;\n    } else if (!benefitsHero && !benefitsVillain) {\n        return TwoWayRelationshipType.Enemy;\n    }\n    return TwoWayRelationshipType.PawnQueen;\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\n\ninterface ImportLinksProps {\n    onSubmit: (profiles: PlayerProfile[]) => void;\n    className?: string;\n}\n\nexport class ImportLinks extends React.Component<ImportLinksProps, any> {\n    public constructor(props: ImportLinksProps) {\n        super(props);\n        this.state = { text: \"\" };\n    }\n\n    private onSubmit() {\n        const lines = this.state.text.split(/\\r?\\n/);\n        // ugly, but it works.\n        const profiles: PlayerProfile[] = [];\n        lines.forEach((line: string) => {\n            const temp = line.split(\"/\").pop();\n            let name = temp\n                ? temp\n                      .split(\"#\")[0]\n                      .split(\"?\")[0]\n                      .replace(/\\.[^/.]+$/, \"\")\n                      .replace(/[-_]/g, \" \")\n                : null;\n\n            if (line.substr(0, line.indexOf(\" \"))) {\n                name = line.substr(line.indexOf(\" \") + 1);\n            }\n            if (name) {\n                profiles.push({\n                    name,\n                    imageURL: line\n                });\n            }\n        });\n        this.props.onSubmit(profiles);\n        this.setState({ text: \"\" });\n    }\n\n    public render() {\n        return (\n            <div className={this.props.className}>\n                <textarea\n                    className=\"textarea\"\n                    onChange={event => {\n                        this.setState({ text: event.target.value });\n                    }}\n                    value={this.state.text}\n                />\n                <button onClick={() => this.onSubmit()}>Import links</button>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { isWellDefined, roundTwoDigits } from \"../../utils\";\nimport { ProfileHouseguest, PortraitProps, PortraitState } from \"../memoryWall\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport {\n    RelationshipTypeToSymbol,\n    RelationshipType as Relationship,\n    classifyRelationship,\n} from \"../../utils/ai/classifyRelationship\";\nimport { getSelectedPlayer } from \"../../subjects/subjects\";\n\nexport function generatePowerSubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    _: boolean | undefined\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    key = addPopularityLine(state, hero, !!_, subtitle, key);\n    key = addCompsLine(hero, subtitle, key);\n    if (!hero.isEvicted && state.powerRanking) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            subtitle.push(<div key={key++}>{`WIN ${roundTwoDigits(state.powerRanking!)}%`}</div>);\n        } else if (data && data.id === hero.id) {\n            subtitle.push(<div key={key++}>I WOULD</div>);\n        } else {\n            subtitle.push(\n                <div key={key++}>{`WIN ${roundTwoDigits(state.powerRanking)}%${\n                    hero.targetingMe ? ` | 🎯 ${hero.targetingMe}` : \"\"\n                }`}</div>\n            );\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return subtitle;\n}\n\nexport function generatePopularitySubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    detailed: boolean = false\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    // popularity\n    key = addPopularityLine(state, hero, detailed, subtitle, key);\n    // competition wins\n    key = addCompsLine(hero, subtitle, key);\n    // friendship count / relationship classification titles\n    ({ subtitle, key } = addFriendshipCountTitles(hero, subtitle, key));\n    return subtitle;\n}\n\nfunction addFriendshipCountTitles(hero: PortraitProps, subtitle: any[], key: number) {\n    if (!hero.isEvicted) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            const titles = friendOrEnemyTitle(hero, data);\n            subtitle = subtitle.concat(titles.map((txt) => <div key={key++}>{txt}</div>));\n        } else {\n            const titles = friendEnemyCountTitle(hero);\n            subtitle = subtitle.concat(titles.map((txt) => <div key={key++}>{txt}</div>));\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return { subtitle, key };\n}\n\nfunction addPopularityLine(\n    state: { popularity?: number },\n    hero: PortraitProps,\n    detailed: boolean,\n    subtitle: any[],\n    key: number\n) {\n    let popularity = state.popularity;\n    if (popularity && (popularity > 1 || popularity < -1)) {\n        popularity = hero.popularity;\n    }\n    if (popularity && !hero.isEvicted) {\n        let popularitySubtitle = `${roundTwoDigits(popularity)}%`;\n        const deltaPop = getDeltaPopularity(hero, popularity);\n        if (detailed && deltaPop !== 0) {\n            const arrow = deltaPop > 0 ? \" | ↑\" : \" | ↓\";\n            popularitySubtitle += `${arrow} ${deltaPop}%`;\n        }\n        subtitle.push(<div key={key++}>{popularitySubtitle}</div>);\n    }\n    return key;\n}\n\nfunction addCompsLine(hero: PortraitProps, subtitle: any[], key: number) {\n    if (compWins(hero)) {\n        subtitle.push(<div key={key++}>{`${compWins(hero)}`}</div>);\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return key;\n}\n\nfunction getDeltaPopularity(houseguest: PortraitProps, statePopularity: number) {\n    if (roundTwoDigits(houseguest.popularity) !== roundTwoDigits(statePopularity)) {\n        return 0;\n    }\n    return houseguest.deltaPopularity ? roundTwoDigits(houseguest.deltaPopularity) : 0;\n}\n\nfunction compWins(houseguest: ProfileHouseguest): string {\n    return `${houseguest.hohWins ? `♔ ${houseguest.hohWins}` : \"\"}${\n        houseguest.povWins && houseguest.hohWins\n            ? `|🛇 ${houseguest.povWins}`\n            : houseguest.povWins\n            ? `🛇 ${houseguest.povWins}`\n            : \"\"\n    }${(houseguest.hohWins || houseguest.povWins) && houseguest.nominations ? \"|\" : \"\"}${\n        houseguest.nominations ? `✘ ${houseguest.nominations}` : \"\"\n    }`;\n}\n\nfunction friendOrEnemyTitle(hero: PortraitProps, villain: SelectedPlayerData): string[] {\n    const titles: string[] = [];\n    titles.push(\n        RelationshipTypeToSymbol[\n            classifyRelationship(hero.popularity || 0, villain.popularity, hero.relationships![villain.id])\n        ]\n    );\n    return titles;\n}\n\nfunction friendEnemyCountTitle(hero: PortraitProps): string[] {\n    const titles: string[] = [];\n    const count =\n        isWellDefined(hero.friends) && isWellDefined(hero.enemies)\n            ? { friends: hero.friends, enemies: hero.enemies }\n            : { friends: 0, enemies: 0 };\n    titles.push(\n        `${count.friends} ${RelationshipTypeToSymbol[Relationship.Friend]}| ${count.enemies} ${\n            RelationshipTypeToSymbol[Relationship.Enemy]\n        }${hero.targetingMe ? `| 🎯 ${hero.targetingMe}` : \"\"}`\n    );\n    return titles;\n}\n","import { Rgb, interpolateColor } from \"./color\";\nimport { PortraitState, PortraitProps } from \"../components/memoryWall\";\nimport { extremeValues } from \"../utils\";\nimport { generatePopularitySubtitle, generatePowerSubtitle } from \"../components/playerPortrait/subtitle\";\n\nexport interface PortraitDisplayMode {\n    minColor: Rgb;\n    maxColor: Rgb;\n    backgroundColor: (state: PortraitState) => string;\n    generateSubtitle: (props: PortraitProps, state: PortraitState, detailed?: boolean) => any[];\n}\n\nconst popularityMinColor = new Rgb(252, 137, 137);\nconst popularityMaxColor = new Rgb(137, 252, 137);\n\nexport const popularityMode: PortraitDisplayMode = {\n    minColor: popularityMinColor,\n    maxColor: popularityMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const popularity = state.popularity;\n\n        const extremePopularity = extremeValues(popularity);\n        const percent = (extremePopularity + 1) / 2;\n        return interpolateColor(popularityMinColor, popularityMaxColor, percent);\n    },\n    generateSubtitle: generatePopularitySubtitle,\n};\n\nconst powerMaxColor = new Rgb(255, 204, 94);\nconst powerMinColor = new Rgb(192, 181, 255);\nexport const powerMode: PortraitDisplayMode = {\n    minColor: powerMinColor,\n    maxColor: powerMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const powerRanking = state.powerRanking;\n        if (powerRanking === undefined) return \"\";\n\n        return interpolateColor(powerMinColor, powerMaxColor, powerRanking);\n    },\n    generateSubtitle: generatePowerSubtitle,\n};\n","import React from \"react\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nfunction setDisplayMode(p: PortraitDisplayMode) {\n    displayMode$.next(p);\n}\n\ninterface ViewBarTagProps {\n    mode: PortraitDisplayMode;\n    text: string;\n    disabled?: boolean;\n}\n\nexport class ViewBarTag extends React.Component<ViewBarTagProps, { selected: boolean }> {\n    private sub: Subscription | null = null;\n\n    public constructor(props: ViewBarTagProps) {\n        super(props);\n        this.state = { selected: props.mode === displayMode$.value };\n    }\n\n    public componentDidMount() {\n        this.sub = displayMode$.subscribe({\n            next: (mode) => {\n                if (mode !== this.props.mode) {\n                    this.setState({ selected: false });\n                } else {\n                    this.setState({ selected: true });\n                }\n            },\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    public render() {\n        const name = \"level-item tag is-medium is-light\";\n        const style = getStyle(this.props);\n        return (\n            <span\n                className={name}\n                style={style}\n                onClick={() => {\n                    !this.props.disabled && setDisplayMode(this.props.mode);\n                    !this.props.disabled && this.setState({ selected: true });\n                }}\n            >\n                {styleText(this.props.text, this.state.selected)}\n            </span>\n        );\n    }\n}\n\nfunction styleText(text: string, selected: boolean): JSX.Element {\n    return selected ? <b>{text}</b> : <i>{text}</i>;\n}\n\nfunction getStyle(props: ViewBarTagProps) {\n    return props.disabled\n        ? {}\n        : {\n              background: `linear-gradient(90deg, ${props.mode.minColor.toRgba()} 0%, ${props.mode.maxColor.toRgba()} 100%)`,\n              cursor: \"pointer\",\n          };\n}\n","import React from \"react\";\nimport { popularityMode, powerMode } from \"../../model/portraitDisplayMode\";\nimport { ViewBarTag } from \"./viewBarTag\";\nimport { GameState, inJury } from \"../../model\";\nimport { displayMode$ } from \"../../subjects/subjects\";\n\nexport class ViewsBar extends React.Component<{ gameState: GameState }, {}> {\n    public constructor(props: { gameState: GameState }) {\n        super(props);\n        if (!inJury(this.props.gameState) && displayMode$.value === powerMode) {\n            displayMode$.next(popularityMode);\n        }\n    }\n\n    componentDidUpdate() {\n        if (!inJury(this.props.gameState) && displayMode$.value === powerMode) {\n            displayMode$.next(popularityMode);\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"level is-mobile\" key=\"viewsbar\" style={{ marginBottom: 0 }}>\n                <ViewBarTag mode={popularityMode} text={\"Relationships\"}></ViewBarTag>\n                {inJury(this.props.gameState) && (\n                    <ViewBarTag mode={powerMode} text={\"Endgame Winrate\"}></ViewBarTag>\n                )}\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { Scene } from \"./scene\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\n\nexport interface InitEpisode {\n    scenes: Scene[];\n    title: string;\n    content: JSX.Element;\n    gameState: GameState;\n    initialGamestate?: GameState;\n    type: EpisodeType;\n}\n\nexport class Episode {\n    readonly scenes: Scene[];\n    readonly title: string;\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly initialGameState: GameState;\n    readonly type: EpisodeType;\n    readonly arrowsEnabled: boolean = true;\n    get render(): JSX.Element {\n        const viewsBar = this.type.hasViewsbar ? <ViewsBar gameState={this.initialGameState} /> : null;\n        return (\n            <div>\n                {viewsBar}\n                {this.content}\n            </div>\n        );\n    }\n\n    constructor(init: InitEpisode) {\n        this.scenes = init.scenes;\n        this.title = init.title;\n        this.content = init.content;\n        this.gameState = init.gameState;\n        this.initialGameState = init.initialGamestate || init.gameState;\n        this.type = init.type;\n    }\n}\n\nexport interface EpisodeType {\n    readonly canPlayWith: (n: number) => boolean;\n    readonly eliminates: number;\n    readonly arrowsEnabled: boolean;\n    readonly hasViewsbar: boolean;\n}\n","import React from \"react\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { GameState } from \"../../model/gameState\";\n\nconst PregameEpisodeType: EpisodeType = {\n    eliminates: 0,\n    canPlayWith: (n: number) => {\n        return n > 2;\n    },\n    arrowsEnabled: true,\n    hasViewsbar: false,\n};\n\nexport class PregameEpisode extends Episode {\n    readonly title = \"Pregame\";\n    readonly scenes = [];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = PregameEpisodeType;\n\n    public constructor(gameState: GameState) {\n        super({\n            title: \"Pregame\",\n            scenes: [],\n            content: <PregameScreen cast={gameState.houseguests} />,\n            gameState,\n            type: PregameEpisodeType,\n        });\n        this.gameState = gameState;\n        this.content = <PregameScreen cast={gameState.houseguests} />;\n    }\n}\n","import React, { useState } from \"react\";\n\ninterface RandomButtonProps {\n    random: (n: number) => void;\n}\n\nexport function RandomButton(props: RandomButtonProps): JSX.Element {\n    const [number, setNumber] = useState(\"16\");\n    return (\n        <div>\n            <button\n                disabled={number === \"\"}\n                className=\"button is-primary\"\n                onClick={() => props.random(parseInt(number))}\n            >\n                Random\n            </button>\n            <NumericInput value={number} onChange={setNumber} />\n        </div>\n    );\n}\n\ninterface NumericInputProps {\n    value: string;\n    onChange: (newValue: string) => void;\n}\n\nfunction NumericInput(props: NumericInputProps) {\n    return (\n        <input\n            className=\"input\"\n            type=\"text\"\n            style={{ width: \"3em\", marginLeft: 5 }}\n            value={props.value}\n            onChange={event => {\n                const value = event.target.value;\n                if (/^\\d*$/g.test(value)) {\n                    props.onChange(value);\n                }\n            }}\n        />\n    );\n}\n","import styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nexport const HasText = styled.div`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport const Input = styled.input`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\ninterface TextProps {\n    noMargin?: boolean;\n    children?: any;\n}\n\nconst NoMargin = styled.div`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\nconst Center = styled.p`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport function Centered(props: TextProps): JSX.Element {\n    if (props.noMargin) return <NoMargin>{props.children}</NoMargin>;\n    return <Center>{props.children} </Center>;\n}\n\nexport function CenteredBold(props: TextProps): JSX.Element {\n    return (\n        <Centered noMargin={props.noMargin}>\n            <b>{props.children} </b>\n        </Centered>\n    );\n}\n\nexport function CenteredItallic(props: TextProps): JSX.Element {\n    return (\n        <Centered noMargin={props.noMargin}>\n            <i>{props.children} </i>\n        </Centered>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { canDisplayCliques, GameState, getById } from \"../../model\";\nimport { ColorTheme } from \"../../theme/theme\";\nimport { isNotWellDefined } from \"../../utils\";\nimport { Centered } from \"../layout/centered\";\nimport { HasText } from \"../layout/text\";\nimport { Portraits } from \"../playerPortrait/portraits\";\n\nexport const HelpLink = styled.a`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.link};\n    cursor: pointer;\n    font-weight: bold;\n    margin-top: 10px;\n    margin-bottom: 10px;\n`;\n\ninterface AllianceListProps {\n    gameState: GameState;\n}\n\nexport function AllianceList(props: AllianceListProps) {\n    if (!canDisplayCliques(props.gameState))\n        return (\n            <HasText>\n                <Centered>\n                    ⚠️ There are too many players left in the game to display the alliances! Try again when\n                    there are 30 or less! ⚠️\n                </Centered>\n            </HasText>\n        );\n    const cliques = props.gameState.cliques;\n    const elements: JSX.Element[] = cliques.map((clique, i) => {\n        if (isNotWellDefined(clique.affiliates)) {\n            return (\n                <Portraits\n                    centered={true}\n                    detailed={true}\n                    key={`${clique}, ${i}, ${props.gameState.phase}`}\n                    houseguests={clique.core.map((id) => getById(props.gameState, id))}\n                />\n            );\n        }\n        const entries: (number | \"⬅️\" | \"➡️\")[] = [\n            ...clique.affiliates[0],\n            \"➡️\",\n            ...clique.core,\n            \"⬅️\",\n            ...clique.affiliates[1],\n        ];\n        return (\n            <Portraits\n                centered={true}\n                detailed={true}\n                key={`${clique}, ${i}, ${props.gameState.phase}`}\n                houseguests={entries.map((id) => {\n                    if (id === \"⬅️\") return \"⬅️\";\n                    if (id === \"➡️\") return \"➡️\";\n                    return getById(props.gameState, id);\n                })}\n            />\n        );\n    });\n    return (\n        <div>\n            {elements}\n            {props.gameState.phase < 3 && (\n                <HelpLink\n                    href=\"https://github.com/spaulmark/bb-bots/blob/master/README.md#understanding-alliances-or-what-do-the-arrows-mean\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                >\n                    What do the arrows mean?\n                </HelpLink>\n            )}\n        </div>\n    );\n}\n","import React from \"react\";\nimport FileDrop from \"react-file-drop\";\nimport { PlayerProfile, GameState } from \"../../model\";\nimport { SetupPortrait } from \"../playerPortrait/setupPortrait\";\nimport { ImportLinks } from \"./importLinks\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { shuffle } from \"lodash\";\nimport { RandomButton } from \"./randomXButton\";\nimport { selectCastPlayer, selectPlayer } from \"../playerPortrait/selectedPortrait\";\nimport { mainContentStream$, newEpisode, selectedCastPlayer$, updateCast } from \"../../subjects/subjects\";\nimport { HasText, Input } from \"../layout/text\";\nimport { Centered } from \"../layout/centered\";\nimport { Subscription } from \"rxjs\";\nimport _ from \"lodash\";\nimport { HelpLink } from \"../episode/allianceList\";\n\ninterface CastingScreenProps {\n    cast?: PlayerProfile[];\n}\n\ninterface CastingScreenState {\n    players: PlayerProfile[];\n    selectedPlayers: Set<number>;\n}\n\nlet id = 1;\n\nexport class CastingScreen extends React.Component<CastingScreenProps, CastingScreenState> {\n    private sub: Subscription | null = null;\n\n    constructor(props: CastingScreenProps) {\n        super(props);\n        if (props.cast) {\n            selectCastPlayer(null);\n            props.cast.forEach((player) => (player.castingScreenId = id++));\n        }\n        this.state = { players: props.cast || [], selectedPlayers: new Set<number>() };\n    }\n\n    public componentDidMount() {\n        this.sub = selectedCastPlayer$.subscribe((selectedPlayers) => {\n            this.setState({ selectedPlayers });\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    private deleteMethod(i: number, castingScreenId: number) {\n        return () => {\n            const newState = { ...this.state };\n            newState.players.splice(i, 1);\n            if (newState.selectedPlayers.has(castingScreenId)) {\n                selectCastPlayer(castingScreenId);\n            }\n            this.setState(newState);\n        };\n    }\n\n    private rename(i: number) {\n        return () => {\n            const newState = { ...this.state };\n            const newName: string | null = prompt(`Enter a new name for ${newState.players[i].name}`);\n            if (!newName) return;\n            newState.players[i].name = newName;\n            this.setState(newState);\n        };\n    }\n\n    private getFiles() {\n        const players = this.state.players;\n        if (!players) {\n            return;\n        }\n        const rows: JSX.Element[] = [];\n        let i = 0;\n        players.forEach((player) =>\n            rows.push(\n                <SetupPortrait\n                    name={player.name}\n                    imageUrl={player.imageURL}\n                    onDelete={this.deleteMethod(i, player.castingScreenId || -1)}\n                    onClick={() => {\n                        selectCastPlayer(player.castingScreenId || -1);\n                    }}\n                    onRename={this.rename(i)}\n                    selected={this.state.selectedPlayers.has(player.castingScreenId || -1)}\n                    key={(++i).toString()}\n                />\n            )\n        );\n        return <div className=\"columns is-gapless is-mobile is-multiline is-centered\">{rows}</div>;\n    }\n\n    private appendProfiles = (profiles: PlayerProfile[]) => {\n        const newState = { ...this.state };\n        profiles.forEach((profile) => newState.players.push(profile));\n        this.setState(newState);\n    };\n\n    private submit = async () => {\n        updateCast(this.state.players);\n        mainContentStream$.next(<PregameScreen cast={this.state.players} />);\n        selectPlayer(null);\n        // vscode says the awaits are unnessecary here,\n        await newEpisode(null);\n        // but if you remove them then bad things happen\n        await newEpisode(new PregameEpisode(new GameState(this.state.players)));\n    };\n\n    private random = (_amount: number) => {\n        // get all the selected players first\n        let result: PlayerProfile[] = [];\n        let amount = _amount;\n\n        const allPlayers = this.state.players;\n        let unselectedPlayers: PlayerProfile[] = [];\n\n        allPlayers.forEach((player) => {\n            if (this.state.selectedPlayers.has(player.castingScreenId || -1)) {\n                result.push(player);\n                amount--;\n            } else {\n                unselectedPlayers.push(player);\n            }\n        });\n\n        if (amount > 0) {\n            unselectedPlayers = shuffle(unselectedPlayers);\n            unselectedPlayers = unselectedPlayers.slice(0, amount);\n        }\n        let players = amount > 0 ? result.concat(unselectedPlayers) : result;\n        players = shuffle(players);\n        this.setState({ players });\n    };\n\n    public render() {\n        return (\n            <FileDrop onDrop={this.handleDrop}>\n                <HasText className=\"level\">\n                    <ImportLinks onSubmit={this.appendProfiles} />\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-danger\"\n                            onClick={() => {\n                                this.setState({ players: [] });\n                                selectCastPlayer(null);\n                            }}\n                        >\n                            Delete all\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-danger\"\n                            disabled={this.state.selectedPlayers.size === 0}\n                            onClick={() => {\n                                const players = this.state.players.filter(\n                                    (player) => !this.state.selectedPlayers.has(player.castingScreenId || -1)\n                                );\n                                this.setState({ players });\n                                selectCastPlayer(null);\n                            }}\n                        >\n                            Delete selected\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-warning\"\n                            onClick={() => selectCastPlayer(null)}\n                            disabled={this.state.selectedPlayers.size === 0}\n                        >\n                            Unselect {this.state.selectedPlayers.size || \"all\"}\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <RandomButton random={this.random} />\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-success\"\n                            disabled={this.state.players.length < 3}\n                            onClick={this.submit}\n                        >\n                            Submit\n                        </button>\n                    </div>\n                </HasText>\n                <Input type=\"file\" multiple onChange={this.handleUpload} />\n                {this.state.players.length === 0 && (\n                    <Centered>\n                        ~ Drop images here ~\n                        <br />\n                        <br />\n                        <HelpLink\n                            href=\"https://github.com/spaulmark/bb-bots/blob/master/README.md#choose-a-cast-of-characters\"\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            Need help setting up a game?\n                        </HelpLink>\n                    </Centered>\n                )}\n                {this.getFiles()}\n            </FileDrop>\n        );\n    }\n\n    private handleUpload = (event: any) => {\n        this.handleFiles(event.target.files);\n    };\n\n    private handleDrop = (files: FileList | null, event: React.DragEvent) => {\n        if (!files) return;\n        this.handleFiles(files);\n    };\n\n    private handleFiles(files: FileList) {\n        const newState = { ...this.state };\n        for (let i = 0; i < files.length; i++) {\n            const file = files[i];\n            if (file.type.match(/image\\/*/)) {\n                newState.players.push({\n                    name: file.name.substr(0, file.name.lastIndexOf(\".\")) || file.name,\n                    imageURL: URL.createObjectURL(file),\n                    castingScreenId: id++,\n                });\n            }\n        }\n        this.setState(newState);\n    }\n}\n","export interface ColorTheme {\n    name: string;\n    bg: string;\n    text: string;\n    toggleBorder: string;\n    gradient: string;\n    bodyArea: string;\n    link: string;\n    mark: string;\n    overlay: string;\n    evictedCell: string;\n    grayCell: string;\n    winnerCell: string;\n    lightGrayCell: string;\n    runnerUpCell: string;\n    nomineeCell: string;\n    hohCell: string;\n    portraitBorder: string;\n    tableCellBorder: string;\n}\n\nexport const lightTheme: ColorTheme = {\n    name: \"light\",\n    bg: \"#fff\",\n    text: \"#363537\",\n    toggleBorder: \"#FFF\",\n    gradient: \"linear-gradient(#39598A, #79D7ED)\",\n    bodyArea: \"#fff\",\n    link: \"blue\",\n    mark: \"yellow\",\n    overlay: \"fff\",\n    evictedCell: \"#fa8072\",\n    grayCell: \"#eaecf0\",\n    lightGrayCell: \"#f8f9fa\",\n    winnerCell: \"#73fb76\",\n    runnerUpCell: \"#d1e8ef\",\n    nomineeCell: \"#959ffd\",\n    hohCell: \"#CCFFCC\",\n    portraitBorder: \"gray\",\n    tableCellBorder: \"#a2a9b1\",\n};\n\nexport const darkTheme: ColorTheme = {\n    name: \"dark\",\n    bg: \"#121212\",\n    text: \"#FAFAFA\",\n    bodyArea: \"#363537\",\n    toggleBorder: \"#6B8096\",\n    gradient: \"linear-gradient(#091236, #1E215D)\",\n    link: \"lightblue\",\n    mark: \"#7e006d\",\n    overlay: \"#444346\",\n    evictedCell: \"#9d4c43\",\n    grayCell: \"#5e5e5e\",\n    lightGrayCell: \"#404040\",\n    runnerUpCell: \"#9fbec882\",\n    nomineeCell: \"#6c75d0\",\n    winnerCell: \"#00ac04\",\n    hohCell: \"#3f783f\",\n    portraitBorder: \"#484848\",\n    tableCellBorder: \"#53575b\",\n};\n","import React, { useState } from \"react\";\nimport { theme$ } from \"../../subjects/subjects\";\nimport { darkTheme, lightTheme } from \"../../theme/theme\";\n\nexport function ThemeSwitcher() {\n    const [theme, setTheme] = useState(\n        window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches ? \"dark\" : \"light\"\n    );\n    const toggleTheme = () => {\n        if (theme === \"light\") {\n            setTheme(\"dark\");\n            theme$.next(darkTheme);\n        } else {\n            setTheme(\"light\");\n            theme$.next(lightTheme);\n        }\n    };\n\n    const className = `button ${theme === \"dark\" ? `is-dark` : \"is-light\"}`;\n    return (\n        <div className={className} onClick={toggleTheme}>\n            {theme === \"light\" ? \"Dark mode\" : \"Light mode\"}\n        </div>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst ShadowBox = styled.div`\n    box-shadow: ${({ theme }: { theme: ColorTheme }) =>\n        theme.name === \"light\" ? \"0 2px 3px rgba(10, 10, 10, 0.1), 0 0 0 1px rgba(10, 10, 10, 0.1)\" : \"\"};\n    border-radius: 6px;\n    margin-left: 3px;\n    margin-top: 3px;\n    margin-right: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.overlay};\n`;\n\nconst StyledBox = styled.div`\n    margin-left: 3px;\n    margin-right: 3px;\n    margin-bottom: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bodyArea};\n`;\n\nexport function DividerBox(props: any): JSX.Element {\n    return <ShadowBox className={props.className || \"\"}>{props.children}</ShadowBox>;\n}\n\nexport function Box(props: any): JSX.Element {\n    return (\n        <StyledBox style={props.style} className={`box ${props.className || \"\"}`}>\n            {props.children}\n        </StyledBox>\n    );\n}\n","import React from \"react\";\nimport ReactPaginate from \"react-paginate\";\nimport { HasText } from \"../layout/text\";\nimport { shuffle, ceil, debounce } from \"lodash\";\nimport { mainContentStream$, selectDeckSubject, selectedDecks$ } from \"../../subjects/subjects\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport _ from \"lodash\";\nimport styled from \"styled-components\";\nimport { Subscription } from \"rxjs\";\nimport { selectedColor } from \"../playerPortrait/houseguestPortraitController\";\nimport { PlayerProfile } from \"../../model\";\n\ninterface DeckScreenProps {}\n\ninterface DeckScreenState {\n    loading: boolean;\n    decks: string[];\n    i: number;\n    debouncedSearchText: string;\n    searchText: string;\n    selectedDecks: Set<string>;\n}\n\nconst decksPerPage = 26;\nconst baseUrl = \"https://spaulmark.github.io/img/\";\n\nconst imageCache: { [id: string]: string } = {};\n\nconst DeckStyle = styled(HasText)`\n    display: flex;\n    cursor: pointer;\n    align-items: center;\n    :hover {\n        color: red;\n        background-color: #ffe1ea;\n    }\n`;\n\nconst Centered = styled.div`\n    display: flex;\n    justify-content: center;\n    align-items: center;\n`;\n\nconst DeckText = styled.p`\n    margin-left: 1rem;\n`;\n\nasync function randomImageFromFolder(folder: string) {\n    if (imageCache[folder]) return imageCache[folder];\n    const links = await (await fetch(`${baseUrl}${folder}/dir.json`)).json();\n    const image = _.sample(links[\"files\"]);\n    imageCache[folder] = `${baseUrl}${folder}/${image}`;\n    return `${baseUrl}${folder}/${image}`;\n}\n\nasync function submitCasts(casts: Set<string>) {\n    const playerProfiles: PlayerProfile[] = [];\n\n    for (const cast of casts) {\n        const links = await (await fetch(`${baseUrl}${cast}/dir.json`)).json();\n        const imageLinks = links[\"files\"].map((file: string) => {\n            return { name: file, url: `${baseUrl}${cast}/${file}` };\n        });\n        const folderProfiles = imageLinks.map((image: { name: string; url: string }) => {\n            return {\n                name: image.name.substr(0, image.name.lastIndexOf(\".\")) || image.name,\n                imageURL: image.url,\n            };\n        });\n        playerProfiles.push(...folderProfiles);\n    }\n\n    mainContentStream$.next(<CastingScreen cast={playerProfiles} />);\n}\n\nfunction Deck(props: { deck: string; selected: boolean }): JSX.Element {\n    const [img, setImage] = React.useState(\"\");\n    const [loading, setLoading] = React.useState(true);\n    const deck = props.deck;\n\n    if (loading)\n        randomImageFromFolder(deck).then((img) => {\n            setLoading(false);\n            setImage(img);\n        });\n    const style = props.selected ? { backgroundColor: selectedColor.toHex(), color: \"black\" } : {};\n    return (\n        <DeckStyle className=\"column is-6\" onClick={() => selectDeckSubject(props.deck)} style={style}>\n            <img src={img} style={{ width: 50, height: 50 }} />\n            <DeckText>{deck}</DeckText>\n        </DeckStyle>\n    );\n}\n\nfunction DeckList(props: { data: string[]; i: number; selected: Set<string> }): JSX.Element {\n    let decks: JSX.Element[] = [];\n    const i = props.i;\n    const data = props.data;\n    const min = i * decksPerPage;\n    for (let j = min; j < min + decksPerPage; j++) {\n        const deck = data[j];\n        if (!deck) continue;\n        decks.push(<Deck selected={props.selected.has(deck)} key={`${deck}__${i}__${j}`} deck={deck} />);\n    }\n    return (\n        <div key={\"__ul__\"} className={\"columns is-multiline\"}>\n            {decks}\n        </div>\n    );\n}\n\nexport class DeckScreen extends React.Component<DeckScreenProps, DeckScreenState> {\n    private subs: Subscription[] = [];\n\n    constructor(props: DeckScreenProps) {\n        super(props);\n        this.state = {\n            loading: true,\n            decks: [],\n            selectedDecks: new Set<string>(),\n            i: 0,\n            debouncedSearchText: \"\",\n            searchText: \"\",\n        };\n    }\n    async componentDidMount() {\n        selectDeckSubject(null);\n        this.subs.push(selectedDecks$.subscribe((selectedDecks) => this.setState({ selectedDecks })));\n        const data = await (await fetch(\"https://spaulmark.github.io/img/dir.json\")).json();\n        this.setState({ decks: shuffle(data.decks), selectedDecks: new Set<string>(), loading: false });\n    }\n    componentWillUnmount() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    private handlePageClick = (page: { selected: number }) => {\n        this.setState({ i: page.selected });\n    };\n\n    private debounceSearch = debounce((nextValue: string) => {\n        this.setState({ debouncedSearchText: nextValue, i: 0 });\n    }, 250);\n\n    private handleSearch = (event: { target: { value: string } }) => {\n        this.setState({ searchText: event.target.value });\n        this.debounceSearch(event.target.value);\n    };\n\n    render() {\n        if (this.state.loading) return <div />;\n        const decks = this.state.decks.filter((deck) =>\n            deck.toLowerCase().match(this.state.debouncedSearchText.toLowerCase())\n        );\n        return (\n            <div>\n                <div className=\"level\">\n                    <div className=\"level-item\">\n                        <input\n                            style={{ marginBottom: \"1.5rem\", minWidth: \"50%\" }}\n                            className=\"input\"\n                            type=\"text\"\n                            placeholder=\"Search...\"\n                            onChange={this.handleSearch}\n                            value={this.state.searchText}\n                        ></input>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-warning\"\n                            onClick={() => selectDeckSubject(null)}\n                            disabled={this.state.selectedDecks.size === 0}\n                        >\n                            Unselect All\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <HasText>{`${this.state.selectedDecks.size} casts selected`}</HasText>\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-success\"\n                            disabled={this.state.selectedDecks.size === 0}\n                            onClick={() => submitCasts(this.state.selectedDecks)}\n                        >\n                            Submit\n                        </button>\n                    </div>\n                </div>\n                <DeckList\n                    key={\"comments\"}\n                    selected={this.state.selectedDecks}\n                    data={decks}\n                    i={this.state.i}\n                />\n                <Centered>\n                    <ReactPaginate\n                        key={\"__list__\"}\n                        previousLabel={\"previous\"}\n                        nextLabel={\"next\"}\n                        breakLabel={\"...\"}\n                        breakClassName={\"break-me\"}\n                        pageCount={ceil(decks.length / decksPerPage)}\n                        marginPagesDisplayed={2}\n                        pageRangeDisplayed={3}\n                        onPageChange={this.handlePageClick}\n                        containerClassName={\"pagination\"}\n                        activeClassName={\"active\"}\n                    />\n                </Centered>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport { mainContentStream$, getCast } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\nimport { ThemeSwitcher } from \"./themeSwitch\";\nimport { ColorTheme } from \"../../theme/theme\";\nimport { Box } from \"../layout/box\";\nimport { DeckScreen } from \"../deckScreen/deckScreen\";\n\nconst TopbarLink = styled.div`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.link};\n    cursor: pointer;\n`;\n\nexport function AdvancedEditLink(): JSX.Element {\n    return (\n        <TopbarLink\n            onClick={() => {\n                mainContentStream$.next(<CastingScreen cast={getCast()} />);\n            }}\n        >\n            Edit / Upload Cast\n        </TopbarLink>\n    );\n}\n\nexport function ChooseCastLink(): JSX.Element {\n    return (\n        <TopbarLink\n            onClick={() => {\n                mainContentStream$.next(<DeckScreen />);\n            }}\n        >\n            Choose Cast\n        </TopbarLink>\n    );\n}\n\nexport function Topbar(props: { style?: any }): JSX.Element {\n    const style = { ...(props.style || {}) };\n    return (\n        <Box className=\"level is-mobile\" style={style}>\n            <div className=\"level-item\">\n                <ChooseCastLink />\n            </div>\n            <div className=\"level-item\">\n                <AdvancedEditLink />\n            </div>\n            <div className=\"level-item\">\n                <ThemeSwitcher />\n            </div>\n        </Box>\n    );\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { ChooseCastLink } from \"../topbar/topBar\";\nimport { HasText } from \"../layout/text\";\nimport { popularityMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$ } from \"../../subjects/subjects\";\n\ninterface PregameScreenProps {\n    cast: PlayerProfile[];\n}\n\nexport class PregameScreen extends React.Component<PregameScreenProps, {}> {\n    public componentDidMount() {\n        displayMode$.next(popularityMode);\n    }\n\n    public render() {\n        const props = this.props;\n        if (props.cast.length === 0) {\n            return (\n                <HasText>\n                    Cast is empty. <ChooseCastLink />\n                </HasText>\n            );\n        }\n        return (\n            <HasText>\n                <MemoryWall houseguests={props.cast} />\n                <p>\n                    <b> {\"You can use the <- and -> arrow keys to move forwards and backwards.\"}</b>\n                </p>\n                <NextEpisodeButton />\n            </HasText>\n        );\n    }\n}\n","import prand from \"pure-rand\";\nimport { BehaviorSubject } from \"rxjs\";\nimport { hashcode } from \"./utilities\";\nimport { cast$ } from \"../subjects/subjects\";\n\nexport class BbRandomGenerator {\n    private rng: prand.RandomGenerator;\n\n    // returns a random number between 0 and 1.\n    public randomFloat(): number {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result / 2147483647.0;\n    }\n\n    public randomInt(a: number, b: number): number {\n        let result: number;\n        [result, this.rng] = prand.uniformIntDistribution(a, b, this.rng);\n        return result;\n    }\n\n    public flipCoin(): boolean {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result % 2 === 0;\n    }\n\n    public seed(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n\n    public constructor(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n}\n\nexport function rng() {\n    return rng$.value;\n}\n\nconst rng$ = new BehaviorSubject(new BbRandomGenerator(0));\n\nconst castSub = cast$.subscribe({\n    next: (cast) => {\n        let castNames = \"\";\n        cast.forEach((houseguest) => (castNames += houseguest.name));\n        rng$.next(new BbRandomGenerator(hashcode(castNames)));\n    },\n});\n","import { Houseguest } from \"./houseguest\";\nimport { PlayerProfile } from \"./playerProfile\";\nimport _ from \"lodash\";\nimport { newRelationshipMap, rng } from \"../utils\";\nimport { finalJurySize, getFinalists } from \"./season\";\nimport { EpisodeLog } from \"./logging/episodelog\";\nimport { Cliques } from \"../utils/generateCliques\";\n\nexport function getById(gameState: GameState, id: number): Houseguest {\n    return gameState.houseguestCache[id];\n}\n\nexport function exclude(inclusions: Houseguest[], exclusions: Houseguest[]) {\n    const excludedIds = exclusions.map((hg) => hg.id);\n    return inclusions.filter((hg) => !excludedIds.includes(hg.id) && !hg.isEvicted);\n}\n\nexport function randomPlayer(inclusions: Houseguest[], exclusions: Houseguest[] = []): Houseguest {\n    if (inclusions.length === 0) {\n        throw new Error(\"Tried to get a random player from a list of 0 players.\");\n    }\n    const options = exclude(inclusions, exclusions);\n    const choice = rng().randomInt(0, options.length - 1);\n\n    return options[choice];\n}\n\nexport function nonEvictedHouseguests(gameState: GameState): Houseguest[] {\n    return [...gameState.nonEvictedHouseguests.entries()].map(([_, id]) => getById(gameState, id));\n}\nexport function getJurors(gameState: GameState): Houseguest[] {\n    return gameState.houseguests.filter((hg) => hg.isJury);\n}\n\nexport function inJury(gameState: GameState): Boolean {\n    return gameState.remainingPlayers - getFinalists() <= finalJurySize();\n}\n\nexport function calculatePopularity(hero: Houseguest, house: Houseguest[]) {\n    let sum = 0;\n    let count = 0;\n    const targetId = hero.id;\n    house.forEach((houseguest) => {\n        if (houseguest.id !== targetId) {\n            count++;\n            sum += houseguest.relationships[targetId];\n        }\n    });\n    return count === 0 ? 0 : sum / count;\n}\n\nexport class GameState {\n    // Current state of the game after a phase.\n\n    readonly houseguestCache: { [id: number]: Houseguest } = {};\n    readonly nonEvictedHouseguests: Set<number> = new Set<number>();\n    readonly houseguests: Houseguest[] = [];\n    readonly remainingPlayers: number = 0;\n    readonly phase: number = 0;\n    readonly previousHOH?: Houseguest;\n    readonly log: EpisodeLog[] = [];\n    readonly cliques: Cliques[] = [];\n    get currentLog() {\n        return this.log[this.phase];\n    }\n\n    public constructor(init: PlayerProfile[] | GameState) {\n        if (!(init instanceof Array)) {\n            Object.assign(this, init);\n        } else {\n            const profiles = init as PlayerProfile[];\n            this.remainingPlayers = profiles.length;\n            profiles.forEach((profile, i) => {\n                const hg: Houseguest = new Houseguest({\n                    ...profile,\n                    id: i,\n                    relationships: newRelationshipMap(profiles.length, i),\n                });\n                this.nonEvictedHouseguests.add(i);\n                this.houseguestCache[i] = hg;\n                this.houseguests.push(hg);\n            });\n        }\n    }\n}\n\nexport class MutableGameState {\n    public houseguests: Houseguest[] = [];\n    public houseguestCache: { [id: number]: Houseguest } = {};\n    readonly nonEvictedHouseguests: Set<number> = new Set<number>();\n    public remainingPlayers: number = 0;\n    public phase: number = 0;\n    public previousHOH?: Houseguest;\n    public cliques: Cliques[] = [];\n    public log: EpisodeLog[] = [];\n    get currentLog() {\n        return this.log[this.phase];\n    }\n\n    public constructor(init: GameState | MutableGameState) {\n        const copy = _.cloneDeep(init);\n        Object.assign(this, copy);\n    }\n}\n","import { BigBrotherVanilla } from \"../components/episode/bigBrotherEpisode\";\nimport { EpisodeFactory } from \"../components/episode/episodeFactory\";\nimport { GameState } from \"./gameState\";\nimport { Episode } from \".\";\nimport { BigBrotherFinale } from \"../components/episode/bigBrotherFinale\";\nimport { cast$ } from \"../subjects/subjects\";\nimport { GameOver } from \"../components/episode/gameOver\";\nimport { SafetyChain } from \"../components/episode/safetyChain\";\n\nexport function finalJurySize() {\n    return jurors;\n}\n\n// 7 is not a magic number: it is just an arbitrary value which is always overwritten by cast$ before it is read.\nlet jurors = 7;\n\nconst sub = cast$.subscribe({\n    next: (newCast) => {\n        let players = newCast.length;\n        players = Math.round(players * 0.55);\n        if (players % 2 === 0) {\n            players--;\n        }\n        jurors = players;\n    },\n});\n\nexport function getFinalists() {\n    return 2;\n}\n\nexport class Season {\n    private factory: EpisodeFactory;\n\n    public constructor() {\n        this.factory = new EpisodeFactory();\n    }\n\n    // In the future, this would all be customizable,\n    // and not just all big brother episodes by default.\n\n    public renderEpisode(gameState: GameState): Episode {\n        return this.factory.nextEpisode(gameState, this.whichEpisodeType(gameState.remainingPlayers));\n    }\n\n    public whichEpisodeType(players: number) {\n        if (players === 3) {\n            return BigBrotherFinale;\n        }\n        if (players === 2) {\n            return GameOver;\n        }\n        ///// commented out lines make every 4th episode a safety chain\n\n        // if (players % 4 !== 1) {\n        return BigBrotherVanilla;\n        // }\n        // return SafetyChain;\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\ninterface InitScene {\n    readonly title: string;\n    readonly gameState: GameState;\n    readonly content: JSX.Element;\n}\nexport class Scene {\n    readonly title: string = \"\";\n    readonly gameState: GameState = new GameState([]);\n    readonly content: JSX.Element = (<div>{`Error while rendering ${this.title}`}</div>);\n    public render: JSX.Element;\n    public constructor(init: Partial<InitScene>) {\n        Object.assign(this, init);\n        this.render = (\n            <div>\n                <ViewsBar gameState={this.gameState} />\n                {this.content}\n            </div>\n        );\n    }\n}\n","/*\n * Free FFT and convolution (TypeScript)\n *\n * Copyright (c) 2020 Project Nayuki. (MIT License)\n * https://www.nayuki.io/page/free-small-fft-in-multiple-languages\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\n * this software and associated documentation files (the \"Software\"), to deal in\n * the Software without restriction, including without limitation the rights to\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\n * the Software, and to permit persons to whom the Software is furnished to do so,\n * subject to the following conditions:\n * - The above copyright notice and this permission notice shall be included in\n *   all copies or substantial portions of the Software.\n * - The Software is provided \"as is\", without warranty of any kind, express or\n *   implied, including but not limited to the warranties of merchantability,\n *   fitness for a particular purpose and noninfringement. In no event shall the\n *   authors or copyright holders be liable for any claim, damages or other\n *   liability, whether in an action of contract, tort or otherwise, arising from,\n *   out of or in connection with the Software or the use or other dealings in the\n *   Software.\n */\n\n/*\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\n * The vector can have any length. This is a wrapper function.\n */\nexport function fft(real: number[] | Float64Array, imag: number[] | Float64Array): void {\n    const n: number = real.length;\n    if (n != imag.length) throw \"Mismatched lengths\";\n    if (n == 0) return;\n    else if ((n & (n - 1)) == 0)\n        // Is power of 2\n        transformRadix2(real, imag);\n    // More complicated algorithm for arbitrary sizes\n    else transformBluestein(real, imag);\n}\n\n/*\n * Computes the inverse discrete Fourier transform (IDFT) of the given complex vector, storing the result back into the vector.\n * The vector can have any length. This is a wrapper function. This transform does not perform scaling, so the inverse is not a true inverse.\n */\nexport function inverseFFT(real: Array<number> | Float64Array, imag: Array<number> | Float64Array): void {\n    fft(imag, real);\n}\n\n/*\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\n * The vector's length must be a power of 2. Uses the Cooley-Tukey decimation-in-time radix-2 algorithm.\n */\nfunction transformRadix2(real: Array<number> | Float64Array, imag: Array<number> | Float64Array): void {\n    // Length variables\n    const n: number = real.length;\n    if (n != imag.length) throw \"Mismatched lengths\";\n    if (n == 1)\n        // Trivial transform\n        return;\n    let levels: number = -1;\n    for (let i = 0; i < 32; i++) {\n        if (1 << i == n) levels = i; // Equal to log2(n)\n    }\n    if (levels == -1) throw \"Length is not a power of 2\";\n\n    // Trigonometric tables\n    let cosTable = new Array<number>(n / 2);\n    let sinTable = new Array<number>(n / 2);\n    for (let i = 0; i < n / 2; i++) {\n        cosTable[i] = Math.cos((2 * Math.PI * i) / n);\n        sinTable[i] = Math.sin((2 * Math.PI * i) / n);\n    }\n\n    // Bit-reversed addressing permutation\n    for (let i = 0; i < n; i++) {\n        const j: number = reverseBits(i, levels);\n        if (j > i) {\n            let temp: number = real[i];\n            real[i] = real[j];\n            real[j] = temp;\n            temp = imag[i];\n            imag[i] = imag[j];\n            imag[j] = temp;\n        }\n    }\n\n    // Cooley-Tukey decimation-in-time radix-2 FFT\n    for (let size = 2; size <= n; size *= 2) {\n        const halfsize: number = size / 2;\n        const tablestep: number = n / size;\n        for (let i = 0; i < n; i += size) {\n            for (let j = i, k = 0; j < i + halfsize; j++, k += tablestep) {\n                const l: number = j + halfsize;\n                const tpre: number = real[l] * cosTable[k] + imag[l] * sinTable[k];\n                const tpim: number = -real[l] * sinTable[k] + imag[l] * cosTable[k];\n                real[l] = real[j] - tpre;\n                imag[l] = imag[j] - tpim;\n                real[j] += tpre;\n                imag[j] += tpim;\n            }\n        }\n    }\n\n    // Returns the integer whose value is the reverse of the lowest 'width' bits of the integer 'val'.\n    function reverseBits(val: number, width: number): number {\n        let result: number = 0;\n        for (let i = 0; i < width; i++) {\n            result = (result << 1) | (val & 1);\n            val >>>= 1;\n        }\n        return result;\n    }\n}\n\n/*\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\n * The vector can have any length. This requires the convolution function, which in turn requires the radix-2 FFT function.\n * Uses Bluestein's chirp z-transform algorithm.\n */\nfunction transformBluestein(real: Array<number> | Float64Array, imag: Array<number> | Float64Array): void {\n    // Find a power-of-2 convolution length m such that m >= n * 2 + 1\n    const n: number = real.length;\n    if (n != imag.length) throw \"Mismatched lengths\";\n    let m: number = 1;\n    while (m < n * 2 + 1) m *= 2;\n\n    // Trigonometric tables\n    let cosTable = new Array<number>(n);\n    let sinTable = new Array<number>(n);\n    for (let i = 0; i < n; i++) {\n        const j: number = (i * i) % (n * 2); // This is more accurate than j = i * i\n        cosTable[i] = Math.cos((Math.PI * j) / n);\n        sinTable[i] = Math.sin((Math.PI * j) / n);\n    }\n\n    // Temporary vectors and preprocessing\n    let areal: Array<number> = newArrayOfZeros(m);\n    let aimag: Array<number> = newArrayOfZeros(m);\n    for (let i = 0; i < n; i++) {\n        areal[i] = real[i] * cosTable[i] + imag[i] * sinTable[i];\n        aimag[i] = -real[i] * sinTable[i] + imag[i] * cosTable[i];\n    }\n    let breal: Array<number> = newArrayOfZeros(m);\n    let bimag: Array<number> = newArrayOfZeros(m);\n    breal[0] = cosTable[0];\n    bimag[0] = sinTable[0];\n    for (let i = 1; i < n; i++) {\n        breal[i] = breal[m - i] = cosTable[i];\n        bimag[i] = bimag[m - i] = sinTable[i];\n    }\n\n    // Convolution\n    let creal = new Array<number>(m);\n    let cimag = new Array<number>(m);\n    convolveComplex(areal, aimag, breal, bimag, creal, cimag);\n\n    // Postprocessing\n    for (let i = 0; i < n; i++) {\n        real[i] = creal[i] * cosTable[i] + cimag[i] * sinTable[i];\n        imag[i] = -creal[i] * sinTable[i] + cimag[i] * cosTable[i];\n    }\n}\n\n/*\n * Computes the circular convolution of the given real vectors. Each vector's length must be the same.\n */\nfunction convolveReal(\n    xvec: Array<number> | Float64Array,\n    yvec: Array<number> | Float64Array,\n    outvec: Array<number> | Float64Array\n): void {\n    const n: number = xvec.length;\n    if (n != yvec.length || n != outvec.length) throw \"Mismatched lengths\";\n    convolveComplex(xvec, newArrayOfZeros(n), yvec, newArrayOfZeros(n), outvec, newArrayOfZeros(n));\n}\n\n/*\n * Computes the circular convolution of the given complex vectors. Each vector's length must be the same.\n */\nfunction convolveComplex(\n    xreal: Array<number> | Float64Array,\n    ximag: Array<number> | Float64Array,\n    yreal: Array<number> | Float64Array,\n    yimag: Array<number> | Float64Array,\n    outreal: Array<number> | Float64Array,\n    outimag: Array<number> | Float64Array\n): void {\n    const n: number = xreal.length;\n    if (\n        n != ximag.length ||\n        n != yreal.length ||\n        n != yimag.length ||\n        n != outreal.length ||\n        n != outimag.length\n    )\n        throw \"Mismatched lengths\";\n\n    xreal = xreal.slice();\n    ximag = ximag.slice();\n    yreal = yreal.slice();\n    yimag = yimag.slice();\n    fft(xreal, ximag);\n    fft(yreal, yimag);\n\n    for (let i = 0; i < n; i++) {\n        const temp: number = xreal[i] * yreal[i] - ximag[i] * yimag[i];\n        ximag[i] = ximag[i] * yreal[i] + xreal[i] * yimag[i];\n        xreal[i] = temp;\n    }\n    inverseFFT(xreal, ximag);\n\n    for (let i = 0; i < n; i++) {\n        // Scaling (because this FFT implementation omits it)\n        outreal[i] = xreal[i] / n;\n        outimag[i] = ximag[i] / n;\n    }\n}\n\nfunction newArrayOfZeros(n: number): Array<number> {\n    let result: Array<number> = [];\n    for (let i = 0; i < n; i++) result.push(0);\n    return result;\n}\n","// Homebrew typescript implementation of this:\n// https://www.researchgate.net/publication/257017356_On_computing_the_distribution_function_for_the_Poisson_binomial_distribution?enrichId=rgreq-6ff78e1a69dcaf49a733e2dd0e9f2db6-XXX&enrichSource=Y292ZXJQYWdlOzI1NzAxNzM1NjtBUzo1NTg0MDU5OTE1MzA0OTZAMTUxMDE0NTc3MTQ0Mw%3D%3D&el=1_x_3&_esc=publicationCoverPdf\n\nimport _ from \"lodash\";\nimport { fft } from \"./fft\";\n\n// Due to the high complexity of this function, it has been optimized for readability.\n// And even then, it's still pretty spooky.\n\nexport function pbincdf(pp: number[]): number[] {\n    const p: number[] = [];\n    const zeros: number[] = [];\n    const ones: number[] = [];\n    pp.forEach((num) => {\n        num === 0 && zeros.push(0);\n        num === 1 && ones.push(1);\n        num !== 0 && num !== 1 && p.push(num);\n    });\n    const cdf = _pbincdf(p);\n    cdf.forEach((number, i) => (cdf[i] = 1 - number));\n    const result = ones.concat(cdf, zeros);\n    return result;\n}\n\nfunction _pbincdf(p: number[]): number[] {\n    const n = p.length;\n    const nPlusOne = n + 1;\n    const ω = (2 * Math.PI) / nPlusOne;\n    const a = [1];\n    const b = [0];\n    // STEP 1 OF THE ALGORITHM\n    const sigmaLogModulusZ = (l: number): number => {\n        let sum = 0;\n        p.forEach((p_j) => {\n            const e1 = (1 - p_j + p_j * Math.cos(ω * l)) ** 2;\n            const e2 = (p_j * Math.sin(ω * l)) ** 2;\n            sum += 0.5 * Math.log(e1 + e2);\n        });\n        return sum;\n    };\n    const sigmaPrincipalArgz = (l: number): number => {\n        let sum = 0;\n        p.forEach((p_j) => {\n            const y = p_j * Math.sin(ω * l);\n            const x = 1 - p_j + p_j * Math.cos(ω * l);\n            sum += Math.atan2(y, x);\n        });\n        return sum;\n    };\n    for (let l = 1; l <= Math.ceil(n / 2); l++) {\n        const d = Math.exp(sigmaLogModulusZ(l));\n        const sigmaArgZ = sigmaPrincipalArgz(l);\n        a[l] = d * Math.cos(sigmaArgZ);\n        b[l] = d * Math.sin(sigmaArgZ);\n    }\n    // STEP 2 OF THE ALGORITHM\n    for (let l = Math.ceil(n / 2) + 1; l <= n; l++) {\n        a[l] = a[nPlusOne - l];\n        b[l] = -b[nPlusOne - l];\n    }\n    // STEP 3 OF THE ALGORITHM\n    fft(a, b);\n    const ξ = a;\n    // STEP 4 OF THE ALGORITHM\n    const result: number[] = [];\n    ξ.forEach((a, i) => (ξ[i] = a / nPlusOne));\n    result[0] = ξ[0];\n    ξ.forEach((_, m) => {\n        if (m === 0) return;\n        result[m] = result[m - 1] + ξ[m];\n    });\n    return result;\n}\n","import { Houseguest, GameState } from \"../../model\";\nimport { pbincdf } from \"../poissonbinomial\";\nimport { pJurorVotesForHero } from \"./aiApi\";\nimport { classifyRelationship } from \"./classifyRelationship\";\n\nexport const relationship = (hero: Houseguest, villain: Houseguest) => hero.relationships[villain.id];\n\nexport const RelationshipTypeToNumber = { FRIEND: 10, ENEMY: -10, PAWN: 0, QUEEN: +5 };\n\nexport const friendship = (hero: Houseguest, villain: Houseguest) =>\n    hero.relationshipWith(villain) +\n    RelationshipTypeToNumber[\n        classifyRelationship(hero.popularity, villain.popularity, hero.relationshipWith(villain))\n    ];\n\nexport function getBestFriend(hero: Houseguest, options: Houseguest[]) {\n    // take in the players and return the favourite, taking friend/enemy/nonmutual into account.\n    return highestScore(hero, options, friendship);\n}\n\nexport function favouriteIndex(hero: Houseguest, options: Houseguest[]) {\n    // Return the index of the houseguest that hero has the highest relationship % with.\n    return highestScore(hero, options, relationship);\n}\n\nfunction highestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let highestIndex = 0;\n    let highestScore = -Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore > highestScore) {\n            highestIndex = i;\n            highestScore = currentScore;\n        }\n    });\n    return highestIndex;\n}\nexport function lowestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let lowestIndex = 0;\n    let lowestScore = Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore < lowestScore) {\n            lowestIndex = i;\n            lowestScore = currentScore;\n        }\n    });\n    return lowestIndex;\n}\n\n// returns the probability that the hero wins the f2 between hero and villian\nexport function pHeroWinsTheFinale(\n    hgs: { hero: Houseguest; villain: Houseguest },\n    jury: Houseguest[]\n): number {\n    const hero = hgs.hero;\n    const villain = hgs.villain;\n    const p: number[] = [];\n    jury.forEach((juror) => {\n        if (juror.id === hero.id || juror.id === villain.id) return;\n        p.push(pJurorVotesForHero(juror, hero, villain));\n    });\n    const cdf = pbincdf(p);\n    return cdf[Math.ceil((jury.length - 2) / 2) - 1];\n}\n","import _ from \"lodash\";\nimport { GameState, getById, Houseguest } from \"../../model\";\nimport { classifyRelationship, RelationshipType } from \"./classifyRelationship\";\n\ninterface RelationshipSummary {\n    type: RelationshipType;\n    relationship: number;\n    winrate: number;\n    id: number;\n    pHeroWins: number;\n    villainPopularity: number;\n}\n\nconst deadValue: RelationshipSummary = {\n    type: RelationshipType.Friend,\n    id: -1,\n    pHeroWins: -1,\n    winrate: -1,\n    relationship: 2,\n    villainPopularity: 2,\n};\n\nexport function getRelationshipSummary(hero: Houseguest, villain: Houseguest): RelationshipSummary {\n    const doIWin = hero.superiors[villain.id];\n    const type = classifyRelationship(hero.popularity, villain.popularity, hero.relationshipWith(villain));\n    return {\n        id: villain.id,\n        relationship: villain.relationshipWith(hero),\n        type,\n        winrate: hero.powerRanking,\n        pHeroWins: doIWin,\n        villainPopularity: villain.popularity,\n    };\n}\n\nexport class Targets {\n    private firstTarget: RelationshipSummary = deadValue;\n    private secondTarget: RelationshipSummary = deadValue;\n    private hg: Houseguest;\n\n    constructor(hg: Houseguest) {\n        this.hg = hg;\n    }\n\n    public getTargets(): [number, number] {\n        return [this.firstTarget.id, this.secondTarget.id];\n    }\n    public addTarget(newTarget: RelationshipSummary, gameState: GameState) {\n        if (\n            !(\n                isBetterTarget(this.firstTarget, newTarget, this.hg, gameState) ||\n                isBetterTarget(this.secondTarget, newTarget, this.hg, gameState)\n            )\n        )\n            return;\n        isBetterTarget(this.firstTarget, this.secondTarget, this.hg, gameState)\n            ? (this.firstTarget = newTarget)\n            : (this.secondTarget = newTarget);\n    }\n}\n\n// TODO: target strategies that account for jury winrate?\n\n// Statusquo goes with the status quo, underdog tries to disrupt & go after big targets, MoR goes after his personal targets\nexport enum TargetStrategy {\n    StatusQuo,\n    Underdog,\n    MoR,\n}\n\nfunction determineStrategy(hero: Houseguest): TargetStrategy {\n    if (hero.friends === hero.enemies) return TargetStrategy.MoR;\n    return hero.friends > hero.enemies ? TargetStrategy.StatusQuo : TargetStrategy.Underdog;\n}\n\nexport function isBetterTarget(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    hero: Houseguest,\n    gameState: GameState\n): boolean {\n    if (old.relationship === 2) return true;\n    const strategy = determineStrategy(hero);\n    if (strategy === TargetStrategy.StatusQuo) return isBetterTargetStatusQuo(old, neww);\n    else if (strategy === TargetStrategy.MoR) {\n        return isBetterTargetMoR(old, neww, gameState, hero);\n    } else {\n        return isBetterTargetUnderdog(old, neww, gameState, hero);\n    }\n}\n\nfunction isBetterTargetMoR(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    gameState: GameState,\n    hero: Houseguest\n): boolean {\n    // Is the old target a non-enemy? Then neww is a better target if he is an enemy, or if he's a worse non-enemy.\n    if (old.type !== RelationshipType.Enemy) {\n        return neww.type === RelationshipType.Enemy ? true : neww.relationship < old.relationship;\n    }\n    // So, the old target is an enemy? Then neww must be an enemy to be a better target.\n    // If they are both enemies, the more popular enemy is a better target.\n    if (neww.type !== RelationshipType.Enemy) return false;\n\n    let { oldPop, newPop }: { oldPop: number; newPop: number } = computeLocalPopularity(\n        gameState,\n        hero,\n        old,\n        neww,\n        (x: RelationshipType) => x === RelationshipType.Enemy\n    );\n    return oldPop < newPop;\n}\n\nfunction isBetterTargetUnderdog(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    gameState: GameState,\n    hero: Houseguest\n): boolean {\n    // Is the old target a friend? Then neww is a better target if he is NOT a friend, or if he's a worse friend.\n    if (old.type === RelationshipType.Friend) {\n        return neww.type !== RelationshipType.Friend ? true : neww.relationship < old.relationship;\n    }\n    // So, the old target isn't a friend? Then neww will never be a better target if he is a friend.\n    if (neww.type === RelationshipType.Friend) return false;\n    // But if neww isn't a friend, then the best target is the more central of the two non-friends.\n    let { oldPop, newPop }: { oldPop: number; newPop: number } = computeLocalPopularity(\n        gameState,\n        hero,\n        old,\n        neww,\n        (x: RelationshipType) => x !== RelationshipType.Friend\n    );\n    return oldPop < newPop;\n}\n// computes the popularity of houseguests old and neww,\n// only taking into account houseguests that have relationship type x with hero\n// satisfying the boolean condition you pass in\nfunction computeLocalPopularity(\n    gameState: GameState,\n    hero: Houseguest,\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    condition: (x: RelationshipType) => boolean\n) {\n    const nonFriends: Houseguest[] = Array.from(gameState.nonEvictedHouseguests)\n        .map((hg) => getById(gameState, hg))\n        .filter(\n            (villain) =>\n                condition(\n                    classifyRelationship(hero.popularity, villain.popularity, hero.relationshipWith(villain))\n                ) && hero.id !== villain.id\n        );\n    let oldPop: number = 0;\n    const oldHg: Houseguest = getById(gameState, old.id);\n    let newPop: number = 0;\n    const newHg: Houseguest = getById(gameState, neww.id);\n    nonFriends.forEach((hg) => {\n        if (hg.id !== oldHg.id) {\n            oldPop += oldHg.relationshipWith(hg);\n        }\n        if (hg.id !== newHg.id) {\n            newPop += newHg.relationshipWith(hg);\n        }\n    });\n    return { oldPop, newPop };\n}\n\nfunction isBetterTargetStatusQuo(old: RelationshipSummary, neww: RelationshipSummary) {\n    const newRank = rankRelationshipSummaryStatusQuo(neww);\n    const oldRank = rankRelationshipSummaryStatusQuo(old);\n    if (newRank > oldRank) return false;\n    if (newRank < oldRank) return true;\n    return neww.relationship < old.relationship;\n}\n\nfunction rankRelationshipSummaryStatusQuo(r: RelationshipSummary): number {\n    if (r.type === RelationshipType.Enemy) return 1;\n    if (r.type === RelationshipType.Friend) return 3;\n    return 2;\n}\n","import { Houseguest, GameState, inJury, exclude } from \"../../model\";\nimport { rng } from \"../BbRandomGenerator\";\nimport { relationship, lowestScore } from \"./aiUtils\";\nimport {\n    classifyRelationship,\n    classifyTwoWayRelationship,\n    RelationshipType as Relationship,\n} from \"./classifyRelationship\";\nimport { getRelationshipSummary, isBetterTarget } from \"./targets\";\n\ninterface NumberWithLogic {\n    decision: number;\n    reason: string;\n}\n\ninterface HouseguestWithLogic {\n    decision: Houseguest | null;\n    reason: string;\n}\n\n// Return the index of the eviction target.\nexport function castEvictionVote(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): NumberWithLogic {\n    if (inJury(gameState)) {\n        return cutthroatVoteJury(hero, nominees, gameState);\n    } else {\n        return cutthroatVote(hero, nominees);\n    }\n}\n\nfunction winningOddsF3(hero: Houseguest, villain1: Houseguest, villain2: Houseguest): number {\n    // chance that hero wins final HoH\n    const heroVs1: number = hero.superiors[villain1.id];\n    const heroVs2: number = hero.superiors[villain2.id];\n    const v1Vs2: number = villain1.superiors[villain2.id];\n\n    if (heroVs1 === undefined)\n        throw new Error(\n            `Tried to get a power comparison that does not exist between ${hero.name} and ${villain1.name} [1]`\n        );\n    if (heroVs2 === undefined)\n        throw new Error(\n            `Tried to get a power comparison that does not exist between ${hero.name} and ${villain2.name} [2]`\n        );\n    if (v1Vs2 === undefined)\n        throw new Error(\n            `Tried to get a power comparison that does not exist between ${villain1.name} and ${villain2.name} [3]`\n        );\n    const heroWins: number = Math.max(heroVs1, heroVs2); // evict the person who beats you more often\n    const v1wins: number = castF3Vote(villain1, hero, villain2).decision === 0 ? 0 : heroVs1;\n    const v2wins: number = castF3Vote(villain2, hero, villain1).decision === 0 ? 0 : heroVs2;\n    return (1 / 3) * heroWins + (1 / 3) * v1wins + (1 / 3) * v2wins;\n}\n\nfunction castF3Vote(hero: Houseguest, nom0: Houseguest, nom1: Houseguest): NumberWithLogic {\n    const decision = hero.superiors[nom0.id] < hero.superiors[nom1.id] ? 0 : 1;\n    return {\n        decision,\n        reason: `I have better odds of beating ${decision ? nom0.name : nom1.name} in the final 2.`,\n    };\n}\n\nfunction castF4vote(hero: Houseguest, nom0: Houseguest, nom1: Houseguest, HoH: Houseguest): NumberWithLogic {\n    const evictNom0 = winningOddsF3(hero, nom1, HoH);\n    const evictNom1 = winningOddsF3(hero, nom0, HoH);\n    const decision = evictNom0 > evictNom1 ? 0 : 1;\n    return {\n        decision,\n        reason: `Evicting ${\n            [nom0, nom1][decision].name\n        } gives me better odds of making it to the end and winning.`,\n    };\n}\n\nfunction cutthroatVoteJury(hero: Houseguest, nominees: Houseguest[], gameState: GameState): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    // In the F3 vote, take the person who you have better odds against to F2\n    if (gameState.remainingPlayers === 3) {\n        return castF3Vote(hero, nom0, nom1);\n    }\n    // In the F4 vote, do some genius level mathematics to predict what gives you the best odds of winning given that the\n    // person who wins the F3 HoH will evict the person they have the worst odds against\n    if (gameState.remainingPlayers === 4) {\n        return castF4vote(\n            hero,\n            nom0,\n            nom1,\n            // all this work just to get the HoH...\n            exclude(\n                Array.from(gameState.nonEvictedHouseguests.values()).map(\n                    (id) => gameState.houseguestCache[id]\n                ),\n                [nom0, nom1, hero]\n            )[0]\n        );\n    }\n    if (hero.powerRanking >= 0.45) {\n        // with a high enough winrate, vote normally\n        return cutthroatVote(hero, nominees);\n    } else if (hero.powerRanking <= 1 / 3) {\n        // with a very low winrate, vote based on winrate\n        return voteBasedOnWinrate();\n    } else {\n        // with a sort of low winrate, break ties with winrate\n        const r0 = classifyTwoWayRelationship(hero.popularity, nom0.popularity, hero.relationships[nom0.id]);\n        const r1 = classifyTwoWayRelationship(hero.popularity, nom1.popularity, hero.relationships[nom1.id]);\n        return r0 === r1 ? voteBasedOnWinrate() : cutthroatVote(hero, nominees);\n    }\n\n    function voteBasedOnWinrate() {\n        const heroBeatsnom0 = hero.powerRanking < hero.superiors[nom0.id];\n        const heroBeatsnom1 = hero.powerRanking < hero.superiors[nom1.id];\n\n        // if i am voting between 2 people who i can't beat, vote based on relationship\n        if (!heroBeatsnom0 && !heroBeatsnom1) {\n            return cutthroatVote(hero, nominees);\n        }\n        // otherwise, vote based on relationship\n\n        const decision = hero.superiors[nom0.id] < hero.superiors[nom1.id] ? 0 : 1;\n        return {\n            decision,\n            reason: `I can't beat ${nominees[decision].name} in the end.`,\n        };\n    }\n}\n\n// only works for 2 nominees\nfunction cutthroatVote(hero: Houseguest, nominees: Houseguest[]): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    const r0 = classifyRelationship(hero.popularity, nom0.popularity, hero.relationships[nom0.id]);\n    const r1 = classifyRelationship(hero.popularity, nom1.popularity, hero.relationships[nom1.id]);\n\n    const nom0isTarget = hero.targets[0] === nom0.id || hero.targets[1] === nom0.id;\n    const nom1isTarget = hero.targets[0] === nom1.id || hero.targets[1] === nom1.id;\n    // KILL TARGETS FIRST\n    if ((nom0isTarget && !nom1isTarget) || (nom1isTarget && !nom0isTarget)) {\n        const decision = nom0isTarget ? 0 : 1;\n        return {\n            decision,\n            reason: `I am targeting ${nominees[decision].name}.`,\n        };\n    }\n\n    if (r0 === Relationship.Enemy && r1 === Relationship.Enemy) {\n        const decision = hero.relationships[nom0.id] < hero.relationships[nom1.id] ? 0 : 1;\n        return {\n            decision,\n            reason: `Both noms are my enemies, but I dislike ${nominees[decision].name} more.`,\n        };\n    } else if (\n        (r0 === Relationship.Enemy && r1 !== Relationship.Enemy) ||\n        (r1 === Relationship.Enemy && r0 !== Relationship.Enemy)\n    ) {\n        const vote = r0 === Relationship.Enemy ? 0 : 1;\n        return { decision: vote, reason: `${nominees[vote].name} is my enemy.` };\n    } else if (\n        (r0 !== Relationship.Friend && r1 === Relationship.Friend) ||\n        (r1 !== Relationship.Friend && r0 === Relationship.Friend)\n    ) {\n        const vote = r0 !== Relationship.Friend ? 0 : 1;\n        const nonVote = vote === 0 ? 1 : 0;\n        return { decision: vote, reason: `${nominees[nonVote].name} is my friend.` };\n    }\n    const vote = lowestScore(hero, nominees, relationship);\n    return {\n        decision: vote,\n        reason: `Both noms are my friends, but I like ${nominees[vote === 0 ? 1 : 0].name} more.`,\n    };\n}\n\nexport function backdoorNPlayers(\n    hero: Houseguest,\n    options: Houseguest[],\n    gameState: GameState,\n    n: number\n): NumberWithLogic[] {\n    const result: NumberWithLogic[] = [];\n    const sortedOptions = [...options];\n    // negative value if first is less than second\n    sortedOptions.sort((hg1, hg2) => {\n        return isBetterTarget(\n            getRelationshipSummary(hero, hg1),\n            getRelationshipSummary(hero, hg2),\n            hero,\n            gameState\n        )\n            ? 1\n            : -1;\n    });\n\n    while (result.length < n) {\n        const decision = sortedOptions[result.length];\n        const reason = \"I think you are ugly\";\n        result.push({ decision: decision.id, reason });\n    }\n    return result;\n}\n\nexport function useGoldenVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState,\n    HoH: number\n): HouseguestWithLogic {\n    let result: HouseguestWithLogic;\n    if (hero.id === HoH) {\n        return { decision: null, reason: \"I support my original nominations.\" };\n    }\n    if (hero.id == nominees[0].id || hero.id == nominees[1].id) {\n        result = { decision: hero, reason: \"I am going to save myself.\" };\n    } else {\n        result = useGoldenVetoPreJury(hero, nominees, gameState);\n        if (gameState.remainingPlayers === 4) {\n            result = {\n                decision: null,\n                reason: \"It doesn't make sense to use the veto here.\",\n            };\n        }\n    }\n    return result || null;\n}\n\nfunction useGoldenVetoPreJury(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): HouseguestWithLogic {\n    let reason = \"Neither of these nominees are my friends.\";\n    let potentialSave: Houseguest | null = null;\n    let alwaysSave: Houseguest | null = null;\n    nominees.forEach((nominee) => {\n        // TODO: Save people who you can beat in the end if you are low winrate\n        const relationship = classifyRelationship(\n            hero.popularity,\n            nominee.popularity,\n            hero.relationshipWith(nominee)\n        );\n        if (relationship === Relationship.Friend) {\n            if (potentialSave) {\n                potentialSave =\n                    hero.relationshipWith(nominee) > hero.relationshipWith(potentialSave)\n                        ? nominee\n                        : potentialSave;\n                reason = `Of these noms, I like ${potentialSave.name} the most.`;\n            } else {\n                reason = `${nominee.name} is my friend.`;\n                potentialSave = nominee;\n            }\n        }\n    });\n    if (alwaysSave) {\n        return { decision: alwaysSave, reason };\n    } else if (potentialSave) {\n        return { decision: potentialSave, reason };\n    } else {\n        return { decision: null, reason };\n    }\n}\n\nexport function pJurorVotesForHero(juror: Houseguest, hero: Houseguest, villain: Houseguest): number {\n    const r1 = juror.relationshipWith(hero);\n    const r2 = juror.relationshipWith(villain);\n    const delta = (r1 - r2) / 2;\n    let result = 0.5 + delta;\n    if (result > 1) result = 1;\n    if (result < 0) result = 0;\n    return result;\n}\n\n// Returns the index of the finalist with the highest relationship with juror\n// only works with 2 finalists\nexport function castJuryVote(juror: Houseguest, finalists: Houseguest[]): number {\n    const choice = Math.abs(rng().randomFloat());\n    return choice > pJurorVotesForHero(juror, finalists[0], finalists[1]) ? 1 : 0;\n}\n","import React from \"react\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\n\nconst FullscreenIcon = styled.img`\n    position: -webkit-sticky;\n    position: sticky;\n    top: 20px;\n    right: 20px;\n`;\n\nexport function FullscreenButton(): JSX.Element {\n    return (\n        <FullscreenIcon\n            src={\n                \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAASElEQVRIiWNgGAUEACMa/z+R6ohWz0Sqi0gFLIRcQAAQDAGa+2DoWzAKRgH1wX8G3OULWfqHfkYbsNIUPR5IrQ/gYLQsGngAAEPgCRZjAdYSAAAAAElFTkSuQmCC\"\n            }\n            className=\"button is-rounded\"\n            onClick={() => {\n                isFullscreen$.next(!isFullscreen$.getValue());\n            }}\n        />\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { EpisodeLog } from \"../../../model/logging/episodelog\";\nimport { CenteredBold, Centered, CenteredItallic } from \"../../layout/centered\";\nimport { GameState, getById } from \"../../../model\";\nimport { VoteType, WinnerVote, RunnerUpVote } from \"../../../model/logging/voteType\";\nimport { FullscreenButton } from \"../../mainPage/fullscreenButton\";\nimport { ColorTheme } from \"../../../theme/theme\";\n\nexport const EndgameTableCell = styled.td`\n    padding: 0.1em 0.4em;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n`;\n\nconst EndgameTable = styled.table`\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n    border-collapse: collapse;\n`;\n\nconst Gray = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.grayCell};\n`;\n\nconst White = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.lightGrayCell};\n`;\n\nconst Evicted = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.evictedCell};\n`;\n\nexport const WinnerCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.winnerCell};\n`;\n\nexport const RunnerUpCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.runnerUpCell};\n`;\n\nexport const NomineeCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.nomineeCell};\n`;\n\nexport const HohCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.hohCell};\n`;\n\nconst BlackRow = styled.tr`\n    height: 0.4em;\n    background-color: #000000;\n`;\n\nexport function generateVotingTable(gameState: GameState): JSX.Element {\n    const masterLog: EpisodeLog[] = gameState.log;\n    const houseguestCells: JSX.Element[][] = [];\n    gameState.houseguests.forEach((hg, i) => {\n        houseguestCells[hg.id] = [\n            <Gray key={`hg-name---${i}`}>\n                <CenteredBold noMargin={true}>{hg.name}</CenteredBold>\n            </Gray>,\n        ];\n    });\n    const evictionOrder: number[] = [];\n    const topRowCells: JSX.Element[] = [];\n    const preVetoCells: JSX.Element[] = [];\n    const vetoCells: JSX.Element[] = [];\n    const postVetoCells: JSX.Element[] = [];\n    const evictedCells: JSX.Element[] = [];\n    const winnerCells: JSX.Element[] = [];\n    masterLog.forEach((log, i) => {\n        generateTopRow(log, i, topRowCells, masterLog.length - 1);\n        generatePreVetoRow(log, i, preVetoCells);\n        generateVetoRow(log, i, vetoCells);\n        generatePostVetoRow(log, i, postVetoCells);\n        generateEvictedRow(log, i, evictedCells, gameState);\n        if (!log) return;\n        evictionOrder.push(log.evicted);\n        if (log.runnerUp !== undefined) evictionOrder.push(log.runnerUp);\n        if (log.winner !== undefined) evictionOrder.push(log.winner);\n        // add each of the votes to the houseguest cells\n        for (const [key, value] of Object.entries(log.votes)) {\n            // typescript for .. in loops kinda suck so i need to do a sketchy type conversion\n            const id: number = (key as unknown) as number;\n            const vote: VoteType = value;\n            houseguestCells[id].push(vote.render(gameState));\n        }\n        if (log.winner !== undefined && log.runnerUp !== undefined) {\n            houseguestCells[log.winner].push(new WinnerVote().render(gameState));\n            houseguestCells[log.runnerUp].push(new RunnerUpVote().render(gameState));\n            evictedCells.push(\n                <RunnerUpCell key={\"runnerUp\"}>\n                    <CenteredBold noMargin={true}>{getById(gameState, log.runnerUp).name}</CenteredBold>\n                    <Centered noMargin={true}>\n                        <small>Finalist</small> {/** TODO: put \"X votes\" here instead. */}\n                    </Centered>\n                </RunnerUpCell>\n            );\n            winnerCells.push(\n                <WinnerCell key={\"winner\"}>\n                    <CenteredBold noMargin={true}>{getById(gameState, log.winner).name}</CenteredBold>\n                    <Centered noMargin={true}>\n                        <small>Winner</small>\n                    </Centered>\n                </WinnerCell>\n            );\n        }\n    });\n    preVetoCells.push(\n        <White key={`preveto--finale`} rowSpan={3}>\n            <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n        </White>\n    );\n    const winnerRow = <tr>{winnerCells}</tr>;\n    const topRow = <tr>{topRowCells}</tr>;\n    const preVetoRow = <tr>{preVetoCells}</tr>;\n    const vetoRow = <tr>{vetoCells}</tr>;\n    const postVetoRow = <tr>{postVetoCells}</tr>;\n    const blackRow = (\n        <BlackRow>\n            <td colSpan={gameState.houseguests.length} />\n        </BlackRow>\n    );\n    const houseguestRows: JSX.Element[] = [];\n    const evictedRow = <tr>{evictedCells}</tr>;\n    let evictionColSpan = -1;\n    const weeks = evictionOrder.length;\n    evictionOrder.reverse().forEach((id, i) => {\n        if (evictionColSpan > 0) {\n            const weekText = i === 2 ? \"(Finale)\" : `(Week ${weeks - i})`;\n            const isJury = getById(gameState, id).isJury;\n            const colSpan = isJury ? evictionColSpan - 1 : evictionColSpan;\n            const evicted = (\n                <Evicted colSpan={colSpan} key={`evicted-week-${weeks - i}`}>\n                    <CenteredItallic noMargin={true}>Evicted</CenteredItallic>\n                    <CenteredItallic noMargin={true}>\n                        <small>{weekText}</small>\n                    </CenteredItallic>\n                </Evicted>\n            );\n            if (!isJury) {\n                houseguestCells[id].push(evicted); // not jury, they dead\n            } else {\n                const tempList = houseguestCells[id].slice(0, -1);\n                tempList.push(evicted);\n                tempList.push(houseguestCells[id][houseguestCells[id].length - 1]);\n                houseguestCells[id] = tempList;\n            }\n        }\n        houseguestRows.push(<tr key={`hgrow--${id}`}>{houseguestCells[id]}</tr>);\n        evictionColSpan++;\n    });\n\n    return (\n        <div>\n            <FullscreenButton />\n            <EndgameTable>\n                <tbody>\n                    {topRow}\n                    {preVetoRow}\n                    {vetoRow}\n                    {postVetoRow}\n                    {blackRow}\n                    {houseguestRows}\n                    {blackRow}\n                    {evictedRow}\n                    {winnerRow}\n                </tbody>\n            </EndgameTable>\n        </div>\n    );\n}\n\nfunction generateEvictedRow(\n    log: EpisodeLog | undefined,\n    i: number,\n    cells: JSX.Element[],\n    gameState: GameState\n) {\n    if (!log) {\n        cells.push(\n            <Gray key={i} rowSpan={2}>\n                <CenteredBold noMargin={true}>Evicted</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n\n    const voteTextLine1 =\n        log.soleVoter !== undefined\n            ? `${log.soleVoter}'s choice`\n            : `${log.votesInMajority} of ${log.outOf} votes`;\n\n    cells.push(\n        <Evicted key={i} rowSpan={2}>\n            <Centered noMargin={true}>\n                <b>{getById(gameState, log.evicted).name}</b>\n                <br />\n                <small>\n                    {voteTextLine1} <br />\n                    to evict\n                </small>\n            </Centered>\n        </Evicted>\n    );\n}\n\nfunction generatePostVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`postVeto--${i}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(post-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`postVeto--${i}`}>\n            <Centered noMargin={true}>\n                {log.nominationsPostVeto[0]}\n                <br /> {log.nominationsPostVeto[1]}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`veto--${i}`}>\n                <CenteredBold noMargin={true}>Veto Winner</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.vetoWinner === undefined) return;\n\n    cells.push(\n        <White key={`veto--${i}`}>\n            <Centered noMargin={true}>{log.vetoWinner}</Centered>\n        </White>\n    );\n}\n\nfunction generatePreVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`preveto--${i}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(pre-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.nominationsPreVeto.length === 0) {\n        cells.push(\n            <White key={`preveto--${i}`} rowSpan={2}>\n                <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n            </White>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`preveto--${i}`}>\n            <Centered noMargin={true}>\n                {log.nominationsPreVeto[0]}\n                <br /> {log.nominationsPreVeto[1]}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateTopRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[], max: number) {\n    if (!log) {\n        cells.push(<Gray key={`toprow--${i}`} />);\n        return;\n    }\n    if (i === max) {\n        cells.push(\n            <Gray key={`toprow--${i}`} colSpan={2}>\n                <CenteredBold noMargin={true}>Finale</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <Gray key={`toprow--${i}`}>\n            <CenteredBold noMargin={true}>Week {i}</CenteredBold>\n        </Gray>\n    );\n}\n","import React from \"react\";\nimport { GameState, getById } from \"../gameState\";\nimport { CenteredItallic, Centered } from \"../../components/layout/centered\";\nimport {\n    EndgameTableCell,\n    WinnerCell,\n    RunnerUpCell,\n    NomineeCell,\n    HohCell,\n} from \"../../components/episode/scenes/votingTable\";\n\nlet voteKey = 0;\n\nfunction getKey(): string {\n    return `${voteKey++}-- vote key`;\n}\n\nexport interface VoteType {\n    id: number;\n    render: (state: GameState) => JSX.Element;\n}\n\nexport class NormalVote implements VoteType {\n    id: number;\n    render = (state: GameState) => (\n        <EndgameTableCell key={getKey()}>\n            <Centered noMargin={true}>{getById(state, this.id).name}</Centered>\n        </EndgameTableCell>\n    );\n    constructor(id: number) {\n        this.id = id;\n    }\n}\n\nexport class WinnerVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <WinnerCell key={\"winner---\"}>\n            <Centered noMargin={true}>Winner</Centered>\n        </WinnerCell>\n    );\n}\n\nexport class RunnerUpVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <RunnerUpCell key={\"runnerUp---\"}>\n            <Centered noMargin={true}>Finalist</Centered>\n        </RunnerUpCell>\n    );\n}\n\nexport class NomineeVote implements VoteType {\n    id: number = -1;\n    evicted: boolean;\n    render = (state: GameState) => (\n        <NomineeCell key={getKey()}>\n            <CenteredItallic noMargin={true}>Nominated</CenteredItallic>\n        </NomineeCell>\n    );\n    constructor(evicted: boolean) {\n        this.evicted = evicted;\n    }\n}\n\nexport class HoHVote implements VoteType {\n    id: number;\n\n    get hohText(): JSX.Element {\n        return (\n            <CenteredItallic noMargin={true}>\n                Head of\n                <br />\n                Household\n            </CenteredItallic>\n        );\n    }\n\n    private hohVote(state: GameState): JSX.Element {\n        return <CenteredItallic noMargin={true}>{getById(state, this.id).name}</CenteredItallic>;\n    }\n\n    render = (state: GameState) => {\n        return <HohCell key={getKey()}>{this.id == -1 ? this.hohText : this.hohVote(state)}</HohCell>;\n    };\n    constructor(id?: number) {\n        this.id = id === undefined ? -1 : id;\n    }\n}\n","import { GameState, getJurors, nonEvictedHouseguests, MutableGameState, Houseguest } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { castJuryVote } from \"../../../utils/ai/aiApi\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport React from \"react\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport { NormalVote } from \"../../../model/logging/voteType\";\n\nexport function juryVoteScene(initialGameState: GameState): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const jurors: Houseguest[] = getJurors(newGameState);\n    const finalists = nonEvictedHouseguests(newGameState);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    jurors.forEach(juror => {\n        const decision = castJuryVote(juror, finalists);\n        const result: ProfileHouseguest = { ...juror };\n        votes[decision].push(result);\n        newGameState.currentLog.votes[juror.id] = new NormalVote(finalists[decision].id);\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const winner = votesFor0 > votesFor1 ? finalists[0] : finalists[1];\n    const runnerUp = votesFor0 < votesFor1 ? finalists[0] : finalists[1];\n    newGameState.currentLog.winner = winner.id;\n    newGameState.currentLog.runnerUp = runnerUp.id;\n    const scene = new Scene({\n        title: \"Jury Votes\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </DividerBox>\n                </div>\n                <Portraits houseguests={finalists} centered={true} />\n                <CenteredBold>{`Congratulations, ${winner.name}... you are the winner of Big Brother!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [newGameState, scene];\n}\n","import React from \"react\";\nimport { EpisodeType, Episode, InitEpisode } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { GameState } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { finalHohCompScene } from \"./scenes/finalHohCompScene\";\nimport { finalEvictionScene } from \"./scenes/finalEvictionScene\";\nimport { juryVoteScene } from \"./scenes/juryVoteScene\";\nimport { HasText } from \"../layout/text\";\n\nexport const BigBrotherFinale: EpisodeType = {\n    canPlayWith: (n: number) => n === 3,\n    eliminates: 2,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n};\n\nexport function generateBbFinale(initialGameState: GameState): BigBrotherFinaleEpisode {\n    const title = \"Finale\";\n    const content = (\n        <HasText>\n            <MemoryWall houseguests={initialGameState.houseguests} /> <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n    let currentGameState;\n    let hohCompScene;\n    let finalHoH;\n    const scenes = [];\n    [currentGameState, hohCompScene, finalHoH] = finalHohCompScene(initialGameState);\n    scenes.push(hohCompScene);\n    let finalEviction;\n    [currentGameState, finalEviction] = finalEvictionScene(currentGameState, finalHoH);\n    scenes.push(finalEviction);\n    const [gameState, juryScene] = juryVoteScene(currentGameState);\n    scenes.push(juryScene);\n    return new BigBrotherFinaleEpisode({ gameState, content, title, scenes, type: BigBrotherFinale });\n}\n\nexport class BigBrotherFinaleEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = BigBrotherFinale;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portraits, Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\n\nexport function finalHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n    const final3 = nonEvictedHouseguests(initialGameState);\n    const enduranceWinner = randomPlayer(final3);\n    const enduranceLosers = final3.filter(hg => hg.id !== enduranceWinner.id);\n    const skillWinner = randomPlayer(final3, [enduranceWinner]);\n    const finalHoH = getById(newGameState, randomPlayer([enduranceWinner, skillWinner]).id);\n    finalHoH.hohWins++;\n    const scene: Scene = new Scene({\n        title: \"Final HoH Competition\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>The final 3 houseguests compete in the endurance competition.</Centered>\n                <Portraits houseguests={final3} centered={true} />\n                <Portrait houseguest={enduranceWinner} centered={true} />\n                <CenteredBold>{`${enduranceWinner.name} has won the endurance competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceLosers[0].name} and ${enduranceLosers[1].name} compete in the skill competition.`}</Centered>\n                <Portraits houseguests={enduranceLosers} centered={true} />\n                <Portrait houseguest={skillWinner} centered={true} />\n                <CenteredBold>{`${skillWinner.name} has won the skill competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceWinner.name} and ${skillWinner.name} compete in the quiz competition.`}</Centered>\n                <Portraits houseguests={[enduranceWinner, skillWinner]} centered={true} />\n                <Portrait houseguest={finalHoH} centered={true} />\n                <CenteredBold>{`Congratulations ${finalHoH.name}, you are the final Head of Household!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene, finalHoH];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { evictHouseguest } from \"../bigBrotherEpisode\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { HoHVote, NomineeVote } from \"../../../model/logging/voteType\";\n\nexport function finalEvictionScene(initialGameState: GameState, HoH: Houseguest): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const nominees = nonEvictedHouseguests(newGameState).filter((hg) => hg.id !== HoH.id);\n    newGameState.currentLog.nominationsPostVeto = nominees.map((hg) => hg.name);\n    const { decision: vote, reason } = castEvictionVote(HoH, nominees, newGameState);\n    const evictee = nominees[vote];\n    const survivor = nominees[vote == 1 ? 0 : 1];\n    newGameState.currentLog.soleVoter = HoH.name;\n    newGameState.currentLog.votes[survivor.id] = new NomineeVote(false);\n    newGameState.currentLog.votes[HoH.id] = new HoHVote(evictee.id);\n    newGameState.currentLog.votesInMajority = 1;\n    newGameState.currentLog.outOf = 1;\n    const hoh: ProfileHouseguest = { ...HoH };\n    hoh.tooltip = reason;\n    evictHouseguest(newGameState, evictee.id);\n    const scene: Scene = new Scene({\n        title: \"Final Eviction\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    {`As the final HoH of the season, ${HoH.name}, you may now cast the sole vote to evict.`}\n                </Centered>\n                <Portrait houseguest={hoh} centered={true} />\n                <CenteredBold>{`I vote to evict ${evictee.name}.`}</CenteredBold>\n                <Portraits houseguests={nominees} centered={true} />\n                <Centered>\n                    It's official... {evictee.name}, you will be the final person leaving the Big Brother\n                    House.\n                </Centered>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene];\n}\n","import { Episode, InitEpisode, EpisodeType } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { GameState } from \"../../model\";\nimport { evictHouseguest } from \"./bigBrotherEpisode\";\nimport { generateVotingTable } from \"./scenes/votingTable\";\n\nexport const GameOver: EpisodeType = {\n    canPlayWith: (n: number) => n === 1,\n    eliminates: 1,\n    arrowsEnabled: false,\n    hasViewsbar: false\n};\n\nexport function generateGameOver(gameState: GameState): GameOverEpisode {\n    const title = \"Game Over\";\n    const scenes: Scene[] = [];\n    const content = generateVotingTable(gameState);\n    gameState.houseguests.forEach(hg => {\n        evictHouseguest(gameState, hg.id);\n    });\n    return new GameOverEpisode({ gameState, content, title, scenes, type: GameOver });\n}\n\nexport class GameOverEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import { VoteType } from \"./voteType\";\n\nexport class EpisodeLog {\n    public nominationsPreVeto: string[] = [];\n    public vetoWinner?: string;\n    public winner?: number;\n    public runnerUp?: number;\n    public nominationsPostVeto: string[] = [];\n    public evicted: number = -1;\n    public votes: { [id: string]: VoteType } = {};\n    public votesInMajority: number = -1;\n    public outOf: number = -1;\n    public soleVoter?: string;\n}\n","import { Houseguest, GameState, nonEvictedHouseguests, getById } from \"../model\";\n\nimport { classifyRelationship, RelationshipType } from \"./ai/classifyRelationship\";\n\nimport _ from \"lodash\";\nimport { Graph } from \"./generateCliques\";\n\nclass EdgeMap {\n    public data: { [id: number]: Set<number> } = {};\n    public add(key: number, value: number) {\n        if (!this.data[key]) {\n            this.data[key] = new Set<number>([value]);\n        } else {\n            this.data[key].add(value);\n        }\n    }\n}\n\nfunction generateEdge(\n    hero: Houseguest,\n    villain: Houseguest,\n    relationship: number\n): [number[] | null, number] {\n    const relationshipType = classifyRelationship(hero.popularity, villain.popularity, relationship);\n    if (relationshipType === RelationshipType.Friend) {\n        return [[hero.id, villain.id], 1];\n    }\n    // no edge for non-mutual friends\n    return [null, 0];\n}\n\nexport default function generateGraph(gameState: GameState): Graph {\n    // this algorithm assumes every relationship is mutual,\n    // and will need a face lift if we get non-mutual relationships.\n    const players = nonEvictedHouseguests(gameState);\n    const nodes: number[] = [];\n    const edges: EdgeMap = new EdgeMap();\n    players.forEach((player) => {\n        let friendCount = 0;\n        _.forEach(player.relationships, (relationship, stringId) => {\n            const villainId = parseInt(stringId);\n            const [edge, friends] = generateEdge(player, getById(gameState, villainId), relationship);\n            friendCount += friends;\n            if (villainId > player.id) {\n                if (edge) {\n                    edges.add(player.id, villainId);\n                    edges.add(villainId, player.id);\n                }\n            }\n        });\n        // nodes[player.id] = friendCount; // for pivot later on, thats why friendcount is there unused\n        nodes.push(player.id);\n    });\n    return { nodes, neighbors: (v: number) => edges.data[v] || new Set([]) };\n}\n","import { intersection } from \".\";\nimport { GameState, getById } from \"../model\";\nimport generateGraph from \"./generateGraph\";\nimport { difference } from \"./utilities\";\n\nlet cliques: number[][] = [];\nexport interface Graph {\n    nodes: number[];\n    neighbors: (v: number) => Set<number>;\n}\n\nexport function newCliquesLength(a: Cliques): number {\n    return a.core.length + (a.affiliates ? a.affiliates[0].length + a.affiliates[1].length : 0);\n}\n\nexport interface Cliques {\n    core: number[];\n    affiliates?: [number[], number[]];\n}\n\nexport function generateCliques(gameState: GameState): Cliques[] {\n    const g = generateGraph(gameState);\n    cliques = [];\n    bronKerbosch(new Set<number>([]), new Set(g.nodes), new Set<number>([]), g);\n    cliques.forEach((clique) => clique.map((id) => getById(gameState, id)));\n    cliques = cliques.sort((a, b) => b.length - a.length);\n    const result: Cliques[] = [];\n    // ids of clique i, clique j, & overlap size\n    const mergeCandidates: [number, number, Cliques][] = [];\n    // generate overlap numbers for each clique (n^2)\n    cliques.forEach((clq, i) => {\n        const cliqueI = new Set(clq);\n        for (let j = i + 1; j < cliques.length; j++) {\n            const cliqueJ = new Set(cliques[j]);\n            const core = intersection(cliqueI, cliqueJ);\n            const affiliatesI: Set<number> = difference(cliqueI, core);\n            const affiliatesJ: Set<number> = difference(cliqueJ, core);\n            if (core.size > 0) {\n                mergeCandidates.push([\n                    i,\n                    j,\n                    {\n                        core: Array.from(core),\n                        affiliates: [Array.from(affiliatesI), Array.from(affiliatesJ)],\n                    },\n                ]);\n            }\n        }\n    });\n    // cliques that already have been merged get blacklisted\n    const blacklist: Set<number> = new Set<number>();\n\n    // merge cliques with highest overlap numbers until only unnacceptable overlap remains\n    // for example maybe if the size of both left and right affiliates is greater than the core\n    mergeCandidates.sort(\n        (a: [number, number, Cliques], b: [number, number, Cliques]) => b[2].core.length - a[2].core.length\n    );\n\n    mergeCandidates.forEach((candidate: [number, number, Cliques]) => {\n        const i = candidate[0];\n        const j = candidate[1];\n        if (blacklist.has(i) || blacklist.has(j)) return;\n        blacklist.add(i);\n        blacklist.add(j);\n        result.push(candidate[2]);\n    });\n    // add non merged cliques\n    cliques.forEach((clique, i) => {\n        if (blacklist.has(i)) return;\n        result.push({ core: clique });\n    });\n\n    // then sort and return result\n    result.sort((a: Cliques, b: Cliques) => newCliquesLength(b) - newCliquesLength(a));\n\n    return result;\n}\n\nfunction bronKerbosch(r: Set<number>, p: Set<number>, x: Set<number>, g: Graph) {\n    if (p.size === 0 && x.size === 0) {\n        const values = Array.from(r.values());\n        cliques.push(values);\n        return;\n    }\n    Array.from(p.keys()).forEach((v) => {\n        const rPrime = new Set(r.values()).add(v);\n        const pPrime = new Set([...p].filter((node) => g.neighbors(v).has(node)));\n        const xPrime = new Set([...x].filter((node) => g.neighbors(v).has(node)));\n        bronKerbosch(rPrime, pPrime, xPrime, g);\n        p.delete(v);\n        x.add(v);\n    });\n}\n","import React from \"react\";\nimport { GameState } from \"../../model\";\nimport { weekStartTab$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { AllianceList, HelpLink } from \"./allianceList\";\n\ninterface WeekStartWrapperProps {\n    gameState: GameState;\n}\n\ninterface WeekStartWrapperState {\n    tab: number;\n}\n\nexport class WeekStartWrapper extends React.Component<WeekStartWrapperProps, WeekStartWrapperState> {\n    private subs: Subscription[] = [];\n    constructor(props: Readonly<WeekStartWrapperProps>) {\n        super(props);\n        this.state = { tab: weekStartTab$.value };\n    }\n    componentDidMount() {\n        this.subs.push(weekStartTab$.subscribe((tab) => this.setState({ tab })));\n    }\n    componentWillUnmount() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    render() {\n        const helpText1 =\n            this.props.gameState.phase === 1 ? (\n                <div key=\"helptext1\" style={{ marginTop: 10 }}>\n                    <b>Try clicking on houseguests to view their relationships.</b> <br />\n                </div>\n            ) : null;\n        const helptext2 =\n            this.props.gameState.phase === 2 ? (\n                <HelpLink\n                    key=\"helptext2\"\n                    href=\"https://github.com/spaulmark/bb-bots/blob/master/README.md#understanding-relationships\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                >\n                    What do the 🛇 ✘ ♥ 💔 🎯 symbols mean?\n                </HelpLink>\n            ) : null;\n        if (this.state.tab === 0) {\n            return [\n                <MemoryWall key=\"memorywall\" houseguests={this.props.gameState.houseguests} />,\n                helpText1,\n                helptext2,\n            ];\n        }\n        return <AllianceList gameState={this.props.gameState} />;\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model\";\nimport { HasText } from \"../layout/text\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { Tabs } from \"./bigBrotherEpisode\";\nimport { WeekStartWrapper } from \"./bigBrotherWeekstartWrapper\";\nimport { Episode, EpisodeType, InitEpisode } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { generateSafetyChainScene } from \"./scenes/safetyChainScene\";\n\nexport const SafetyChain: EpisodeType = {\n    canPlayWith: (n: number) => n >= 3,\n    eliminates: 1,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n};\n\nexport function generateSafetyChain(initialGameState: GameState): SafetyChainEpisode {\n    const content = (\n        <HasText>\n            <Tabs />\n            <WeekStartWrapper gameState={initialGameState} />\n            <NextEpisodeButton />\n        </HasText>\n    );\n    let currentGameState: GameState = initialGameState;\n    const title = `Safety Chain ${currentGameState.phase}`;\n    const scenes: Scene[] = [];\n    let safetyChainScene;\n    [currentGameState, safetyChainScene] = generateSafetyChainScene(initialGameState);\n    scenes.push(safetyChainScene);\n    return new SafetyChainEpisode({ gameState: currentGameState, content, title, scenes, type: SafetyChain });\n}\n\nexport class SafetyChainEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = SafetyChain;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import React from \"react\";\nimport { GameState, Houseguest, MutableGameState, nonEvictedHouseguests, randomPlayer } from \"../../../model\";\nimport { HoHVote, NomineeVote, NormalVote } from \"../../../model/logging/voteType\";\nimport { getBestFriend } from \"../../../utils/ai/aiUtils\";\nimport { Centered } from \"../../layout/centered\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { evictHouseguest } from \"../bigBrotherEpisode\";\nimport { Scene } from \"../scene\";\nimport { NomineeCell } from \"./votingTable\";\n\nexport function generateSafetyChainScene(initialGameState: GameState): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const chainOrder: Houseguest[] = [];\n    const chainStarter: Houseguest = randomPlayer(newGameState.houseguests);\n    const options: Houseguest[] = nonEvictedHouseguests(newGameState).filter(\n        (hg) => hg.id !== chainStarter.id\n    );\n\n    chainOrder.push(chainStarter);\n    const safeSpots = newGameState.nonEvictedHouseguests.size - 1;\n    let currentChooser: Houseguest = chainStarter;\n    const sceneContent: JSX.Element[] = [];\n    let first = true;\n    while (chainOrder.length < safeSpots) {\n        const newSafeIndex = getBestFriend(currentChooser, options);\n        chainOrder.push(options[newSafeIndex]);\n        newGameState.currentLog.votes[currentChooser.id] = first\n            ? new HoHVote(options[newSafeIndex].id)\n            : new NormalVote(options[newSafeIndex].id);\n        first = false;\n        options.splice(newSafeIndex, 1);\n        sceneContent.push(\n            <Centered key={`safetychain-${newGameState.phase}-${chainOrder.length}`}>\n                {currentChooser.name} has chosen {chainOrder[chainOrder.length - 1].name}!\n                <Portraits\n                    houseguests={[currentChooser, chainOrder[chainOrder.length - 1]]}\n                    centered={true}\n                />\n            </Centered>\n        );\n        currentChooser = chainOrder[chainOrder.length - 1];\n    }\n    newGameState.currentLog.soleVoter = chainOrder[chainOrder.length - 2].name;\n    newGameState.currentLog.votes[chainOrder[chainOrder.length - 1].id] = new NomineeVote(false);\n    newGameState.currentLog.votes[options[0].id] = new NomineeVote(true);\n    newGameState.currentLog.nominationsPostVeto = [options[0].name, chainOrder[chainOrder.length - 1].name];\n\n    sceneContent.push(\n        <Centered key={`safetychain-final-${newGameState.phase}-${chainOrder.length}`}>\n            {options[0].name} has been left out!\n            <Portrait houseguest={options[0]} centered={true} />\n        </Centered>\n    );\n    evictHouseguest(newGameState, options[0].id);\n    const scene: Scene = new Scene({\n        title: \"Chain Ceremony\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                {sceneContent}\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n\n    return [newGameState, scene];\n}\n","import {\n    GameState,\n    MutableGameState,\n    calculatePopularity,\n    nonEvictedHouseguests,\n    inJury,\n    getJurors,\n    getById,\n} from \"../../model/gameState\";\nimport { Episode, Houseguest } from \"../../model\";\nimport { EpisodeType } from \"./episodes\";\nimport { BigBrotherVanilla, generateBbVanilla } from \"./bigBrotherEpisode\";\nimport { BigBrotherFinale, generateBbFinale } from \"./bigBrotherFinale\";\nimport { angleBetween, average, rng, roundTwoDigits } from \"../../utils\";\nimport { pHeroWinsTheFinale } from \"../../utils/ai/aiUtils\";\nimport { classifyRelationship, RelationshipType as Relationship } from \"../../utils/ai/classifyRelationship\";\nimport { GameOver, generateGameOver } from \"./gameOver\";\nimport { EpisodeLog } from \"../../model/logging/episodelog\";\nimport { generateCliques } from \"../../utils/generateCliques\";\nimport { getRelationshipSummary, Targets } from \"../../utils/ai/targets\";\nimport { generateSafetyChain, SafetyChain } from \"./safetyChain\";\nimport _ from \"lodash\";\n\nexport function canDisplayCliques(newState: GameState): boolean {\n    return newState.remainingPlayers <= 30;\n}\n\nfunction firstImpressions(houseguests: Houseguest[]) {\n    const sin = Math.sin;\n    const cos = Math.cos;\n    houseguests.forEach((hg) => {\n        // generate random spherical co-ordinates on the unit sphere\n        const u = rng().randomFloat();\n        const v = Math.abs(rng().randomFloat());\n        const θ = 2 * Math.PI * u;\n        const φ = Math.acos(2 * v - 1);\n        // convert spherical co-ords to cartesian co-ords\n        hg.compatibility = [sin(θ) * cos(φ), sin(θ) * sin(φ), cos(θ)];\n    });\n    for (let i = 0; i < houseguests.length; i++) {\n        const iMap = houseguests[i].relationships;\n        for (let j = i + 1; j < houseguests.length; j++) {\n            // creates a bunch of mutual relationships based on points on a sphere\n            const jMap = houseguests[j].relationships;\n            const impression =\n                1 - (2 * angleBetween(houseguests[i].compatibility, houseguests[j].compatibility)) / Math.PI;\n            jMap[i] = impression;\n            iMap[j] = impression;\n        }\n    }\n}\n\nfunction populateSuperiors(houseguests: Houseguest[]) {\n    for (let i = 0; i < houseguests.length; i++) {\n        const hero = houseguests[i];\n        for (let j = i + 1; j < houseguests.length; j++) {\n            const villain = houseguests[j];\n            const pHeroWins = pHeroWinsTheFinale({ hero, villain }, houseguests);\n            hero.superiors[villain.id] = pHeroWins;\n            villain.superiors[hero.id] = 1 - pHeroWins;\n        }\n    }\n}\n\nfunction updatePowerRankings(houseguests: Houseguest[]) {\n    houseguests.forEach((hg) => {\n        let superiors: { [id: number]: number } = { ...hg.superiors };\n        const nonEvictedHouseguests: Set<number> = new Set<number>(houseguests.map((h) => h.id));\n        superiors = _.filter(superiors, (_, id) => nonEvictedHouseguests.has(parseInt(id)));\n        hg.powerRanking = average(Object.values(superiors));\n    });\n}\n\nfunction updatePopularity(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach((hg) => {\n        hg.targetingMe = 0;\n        const result = calculatePopularity(hg, nonEvictedHouseguests(gameState));\n        hg.deltaPopularity = (roundTwoDigits(result) - roundTwoDigits(hg.popularity)) / 100;\n        hg.popularity = result;\n    });\n}\n\nfunction updateFriendCounts(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach((hero: Houseguest) => {\n        let targets = new Targets(hero);\n        let friends = 0;\n        let enemies = 0;\n        houseguests.forEach((villain) => {\n            if (hero.id === villain.id) return;\n            const type = classifyRelationship(\n                hero.popularity,\n                villain.popularity,\n                hero.relationshipWith(villain)\n            );\n            if (type === Relationship.Friend) {\n                friends++;\n            } else if (type === Relationship.Enemy) {\n                enemies++;\n            }\n        });\n        hero.friends = friends;\n        hero.enemies = enemies;\n        houseguests.forEach((villain) => {\n            if (hero.id === villain.id) return;\n            targets.addTarget(getRelationshipSummary(hero, villain), gameState);\n        });\n        hero.targets = targets.getTargets();\n        hero.targets.forEach((target) => {\n            getById(gameState, target).targetingMe++;\n        });\n    });\n}\n\nexport class EpisodeFactory {\n    public nextEpisode(gameState: GameState, episodeType: EpisodeType): Episode {\n        let newState = new MutableGameState(gameState);\n        if (gameState.phase === 0) {\n            firstImpressions(newState.houseguests);\n        }\n        newState.phase++;\n        if (gameState.remainingPlayers > 2) {\n            newState.log[newState.phase] = new EpisodeLog();\n        }\n        // If jury starts this episode, populate superior/inferior data. In the future, every jury ep. (dynamic rels)\n        if (inJury(gameState) && getJurors(gameState).length === 0) {\n            populateSuperiors(nonEvictedHouseguests(newState));\n        }\n        if (inJury(gameState)) {\n            updatePowerRankings(nonEvictedHouseguests(newState));\n        }\n        updatePopularity(newState);\n        gameState.remainingPlayers > 2 && updateFriendCounts(newState);\n        if (canDisplayCliques(newState)) newState.cliques = generateCliques(newState);\n        const finalState = new GameState(newState);\n        switch (episodeType) {\n            case BigBrotherVanilla:\n                return generateBbVanilla(finalState);\n            case BigBrotherFinale:\n                return generateBbFinale(finalState);\n            case SafetyChain:\n                return generateSafetyChain(finalState);\n            case GameOver:\n                return generateGameOver(finalState);\n            default:\n                throw new Error(\"Unsupported Episode Type\");\n        }\n    }\n}\n","import {\n    MutableGameState,\n    getById,\n    inJury,\n    nonEvictedHouseguests,\n    GameState,\n    Houseguest,\n    EpisodeType,\n    Episode,\n    InitEpisode,\n} from \"../../model\";\nimport { getFinalists, finalJurySize } from \"../../model/season\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateNomCeremonyScene } from \"./scenes/nomCeremonyScene\";\nimport { generateVetoCompScene } from \"./scenes/vetoCompScene\";\nimport { generateVetoCeremonyScene } from \"./scenes/vetoCeremonyScene\";\nimport { generateEvictionScene } from \"./scenes/evictionScene\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Scene } from \"./scene\";\nimport { HasText } from \"../layout/text\";\nimport styled from \"styled-components\";\nimport { weekStartTab$ } from \"../../subjects/subjects\";\nimport { WeekStartWrapper } from \"./bigBrotherWeekstartWrapper\";\n\nexport const BigBrotherVanilla: EpisodeType = {\n    canPlayWith: (n: number) => {\n        return n > 1;\n    },\n    eliminates: 1,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n};\n\nconst TabItem = styled.li`\n    cursor: pointer;\n`;\n\n// Refactoring ideas\n/**\n * Might be best to start passing ids instead of houseguests for HoH/nominees/veto winner\n */\n\nexport function evictHouseguest(gameState: MutableGameState, id: number) {\n    const evictee = getById(gameState, id);\n    if (gameState.currentLog) gameState.currentLog.evicted = evictee.id;\n    evictee.isEvicted = true;\n    if (gameState.remainingPlayers - getFinalists() <= finalJurySize()) {\n        evictee.isJury = true;\n    }\n    gameState.nonEvictedHouseguests.delete(evictee.id);\n    gameState.remainingPlayers--;\n}\n\nfunction Tab(props: { text: string; active: number; id: number; setActive: any }): JSX.Element {\n    return (\n        <TabItem\n            className={props.active === props.id ? \"is-active\" : \"\"}\n            onClick={() => {\n                props.setActive(props.id);\n                weekStartTab$.next(props.id);\n            }}\n        >\n            <a>{props.text}</a>\n        </TabItem>\n    );\n}\n\nexport function Tabs(): JSX.Element {\n    const [active, setActive] = React.useState(weekStartTab$.value);\n    return (\n        <div className=\"tabs is-centered is-fullwidth is-medium\" style={{ marginBottom: 0 }}>\n            <ul style={{ paddingLeft: 0 }}>\n                <Tab text={\"Memory Wall\"} active={active} setActive={setActive} id={0} />\n                <Tab text={\"Alliances\"} active={active} setActive={setActive} id={1} />\n            </ul>\n        </div>\n    );\n}\n\nexport function generateBbVanilla(initialGamestate: GameState): BigBrotherVanillaEpisode {\n    let currentGameState;\n    let hohCompScene;\n    let hoh: Houseguest;\n    const scenes = [];\n    [currentGameState, hohCompScene, hoh] = generateHohCompScene(initialGamestate);\n    scenes.push(hohCompScene);\n\n    let nomCeremonyScene;\n    let nominees: Houseguest[];\n    [currentGameState, nomCeremonyScene, nominees] = generateNomCeremonyScene(currentGameState, hoh);\n    scenes.push(nomCeremonyScene);\n\n    let vetoCompScene;\n    let povWinner: Houseguest;\n    [currentGameState, vetoCompScene, povWinner] = generateVetoCompScene(\n        currentGameState,\n        hoh,\n        nominees[0],\n        nominees[1]\n    );\n    scenes.push(vetoCompScene);\n    let vetoCeremonyScene;\n\n    [currentGameState, vetoCeremonyScene, nominees] = generateVetoCeremonyScene(\n        currentGameState,\n        hoh,\n        nominees,\n        povWinner\n    );\n    scenes.push(vetoCeremonyScene);\n\n    let evictionScene;\n    [currentGameState, evictionScene] = generateEvictionScene(currentGameState, hoh, nominees);\n    scenes.push(evictionScene);\n\n    const title = `Week ${currentGameState.phase}`;\n    const content = (\n        <HasText>\n            <Tabs />\n            <WeekStartWrapper gameState={initialGamestate} />\n            <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n    const gameState = new GameState(currentGameState);\n    return new BigBrotherVanillaEpisode({\n        title,\n        scenes,\n        content,\n        gameState,\n        initialGamestate,\n        type: BigBrotherVanilla,\n    });\n}\nexport class BigBrotherVanillaEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly initialGamestate: GameState;\n    readonly gameState: GameState;\n    readonly type = BigBrotherVanilla;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n        this.initialGamestate = init.initialGamestate || init.gameState;\n    }\n}\n","import { GameState, Houseguest, MutableGameState, randomPlayer } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { HoHVote } from \"../../../model/logging/voteType\";\n\nexport function generateHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    const previousHoh = initialGameState.previousHOH ? [initialGameState.previousHOH] : [];\n    const newHoH: Houseguest = randomPlayer(newGameState.houseguests, previousHoh);\n    newGameState.previousHOH = newHoH;\n    newGameState.currentLog.votes[newHoH.id] = new HoHVote();\n    newHoH.hohWins += 1;\n    const scene = new Scene({\n        title: \"HoH Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>\n                    {previousHoh.length > 0 &&\n                        `Houseguests, it's time to find a new Head of Household. As outgoing HoH, ${previousHoh[0].name} will not compete. `}\n                </Centered>\n                <Portrait centered={true} houseguest={newHoH} />\n                <CenteredBold>{newHoH.name} has won Head of Household!</CenteredBold>\n                <br />\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n\n    return [new GameState(newGameState), scene, newHoH];\n}\n","import { GameState, Houseguest, MutableGameState, getById } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { shuffle } from \"lodash\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\n\nexport function generateNomCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest\n): [GameState, Scene, Houseguest[]] {\n    const newGameState = new MutableGameState(initialGameState);\n    const [nom1, nom2] = [getById(newGameState, HoH.targets[0]), getById(newGameState, HoH.targets[1])];\n    nom1.nominations++;\n    nom2.nominations++;\n    newGameState.currentLog.nominationsPreVeto = [nom1.name, nom2.name];\n    const noms = shuffle([nom1, nom2]);\n    const scene = new Scene({\n        title: \"Nomination Ceremony\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    This is the nomination ceremony. It is my responsibility as the Head of Household to\n                    nominate two houseguests for eviction.\n                </Centered>\n                <Portrait centered={true} houseguest={HoH} />\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Centered> My first nominee is...</Centered>\n                        <Portrait centered={true} houseguest={noms[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Centered>My second nominee is...</Centered>\n                        <Portrait centered={true} houseguest={noms[1]} />\n                    </DividerBox>\n                </div>\n                <CenteredBold>{`I have nominated you, ${noms[0].name} and you, ${noms[1].name} for eviction.`}</CenteredBold>\n                <br />\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, [nom1, nom2]];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById,\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\n\nexport function generateVetoCompScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nom1: Houseguest,\n    nom2: Houseguest\n): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    // pick players\n    const choices = nonEvictedHouseguests(newGameState);\n    let povPlayers: any[] = [];\n    const everyoneWillPlay = choices.length <= 6;\n\n    if (everyoneWillPlay) {\n        povPlayers.push({ ...HoH });\n        povPlayers.push({ ...nom1 });\n        povPlayers.push({ ...nom2 });\n        while (povPlayers.length < choices.length) {\n            povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        }\n    } else {\n        povPlayers.push({ ...HoH });\n        povPlayers.push({ ...nom1 });\n        povPlayers.push({ ...nom2 });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n    }\n    let povWinner = randomPlayer(povPlayers);\n    povWinner = getById(newGameState, povWinner.id);\n    povWinner.povWins++;\n    newGameState.currentLog.vetoWinner = povWinner.name;\n    let introText: string;\n    if (everyoneWillPlay) {\n        introText = \"Everyone left in the house will compete in this challenge.\";\n    } else {\n        introText = `${HoH.name}, as Head of Household, and ${nom1.name} and ${nom2.name} as nominees, will compete, as well as 3 others chosen by random draw.`;\n    }\n    const extras = [povPlayers[3]];\n    povPlayers[4] && extras.push(povPlayers[4]);\n    povPlayers[5] && extras.push(povPlayers[5]);\n    const scene = new Scene({\n        title: \"Veto Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>It's time to pick players for the veto competition.</Centered>\n                <Portraits centered={true} houseguests={[HoH, nom1, nom2]} />\n                <Centered>{introText}</Centered>\n                <Portraits centered={true} houseguests={extras} />\n                <Centered>...</Centered>\n                <Portraits centered={true} houseguests={[povWinner]} />\n                <CenteredBold>{`${povWinner.name} has won the Golden Power of Veto!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, povWinner];\n}\n","import { GameState, Houseguest, getById, exclude } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { useGoldenVeto, backdoorNPlayers } from \"../../../utils/ai/aiApi\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\n\nexport function generateVetoCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    initialNominees: Houseguest[],\n    povWinner: Houseguest\n): [GameState, Scene, Houseguest[]] {\n    let povTarget: Houseguest | null = null;\n    let descisionText = \"\";\n    initialNominees[0] = getById(initialGameState, initialNominees[0].id);\n    initialNominees[1] = getById(initialGameState, initialNominees[1].id);\n    HoH = getById(initialGameState, HoH.id);\n    const vetoChoice = useGoldenVeto(povWinner, initialNominees, initialGameState, HoH.id);\n    povTarget = vetoChoice.decision;\n    if (!povTarget) {\n        descisionText += \"... not to use the power of veto.\";\n    } else if (povWinner.id == initialNominees[0].id || povWinner.id == initialNominees[1].id) {\n        descisionText += \"...to use the power of veto on myself.\";\n    } else {\n        descisionText += `...to use the power of veto on ${povTarget.name}.`;\n    }\n    let replacementSpeech = \"\";\n    let nameAReplacement = \"\";\n    let finalNominees: any[] = [...initialNominees];\n    if (povTarget) {\n        const HoHwonPoV = HoH.id === povWinner.id;\n        nameAReplacement += HoHwonPoV\n            ? `Since I have just vetoed one of my nominations, I must name a replacement nominee.`\n            : `${HoH.name}, since I have just vetoed one of your nominations, you must name a replacement nominee.`;\n        const replacementNom = {\n            ...getById(\n                initialGameState,\n                backdoorNPlayers(\n                    HoH,\n                    exclude(initialGameState.houseguests, [\n                        HoH,\n                        initialNominees[0],\n                        initialNominees[1],\n                        povWinner,\n                    ]),\n                    initialGameState,\n                    1\n                )[0].decision\n            ),\n        };\n        const replacementIndex = initialNominees.findIndex((hg) => hg.id === vetoChoice.decision!.id);\n        finalNominees[replacementIndex] = replacementNom;\n        replacementNom.nominations++;\n        getById(initialGameState, replacementNom.id).nominations++;\n        replacementSpeech = `My replacement nominee is ${replacementNom.name}.`;\n    }\n    const scene = new Scene({\n        title: \"Veto Ceremony\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>This is the Veto Ceremony.</Centered>\n                <Centered>\n                    {`${initialNominees[0].name} and ${initialNominees[1].name} have been nominated for eviction, \n                    but I have the power to veto one of these nominations.`}\n                </Centered>\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={initialNominees[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={initialNominees[1]} />\n                    </DividerBox>\n                </div>\n                <CenteredBold>\n                    I have decided... <br />\n                </CenteredBold>\n                <Portrait centered={true} houseguest={{ ...povWinner, tooltip: vetoChoice.reason }} />\n                <CenteredBold noMargin={true}>{descisionText}</CenteredBold>\n                <Centered>{nameAReplacement}</Centered>\n                {replacementSpeech && <Portrait centered={true} houseguest={HoH} />}\n                <CenteredBold>{replacementSpeech}</CenteredBold>\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={finalNominees[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={finalNominees[1]} />\n                    </DividerBox>\n                </div>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    initialGameState.currentLog.nominationsPostVeto = [finalNominees[0].name, finalNominees[1].name];\n    return [initialGameState, scene, finalNominees];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests, getById } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { shuffle } from \"lodash\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { evictHouseguest } from \"../bigBrotherEpisode\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NomineeVote, NormalVote, HoHVote } from \"../../../model/logging/voteType\";\n\nexport function generateEvictionScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nominees: Houseguest[]\n): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    nominees = shuffle(nominees);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    let lastVoter: Houseguest;\n    nonEvictedHouseguests(newGameState).forEach(hg => {\n        if (hg.id !== nominees[0].id && hg.id !== nominees[1].id && hg.id !== HoH.id) {\n            const logic = castEvictionVote(hg, nominees, newGameState);\n            const result: ProfileHouseguest = { ...hg };\n            result.tooltip = logic.reason;\n            newGameState.currentLog.votes[hg.id] = new NormalVote(nominees[logic.decision].id);\n            votes[logic.decision].push(result);\n            lastVoter = hg;\n        }\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n    newGameState.currentLog.outOf = votesFor0 + votesFor1;\n    if (votesFor0 + votesFor1 === 1) {\n        newGameState.currentLog.soleVoter = lastVoter!!.name;\n    }\n    let tieVote = votesFor0 === votesFor1;\n    let tieBreaker = { decision: 0, reason: \"Error you should not be seeing this\" };\n    if (tieVote) {\n        newGameState.currentLog.outOf++;\n        tieBreaker = castEvictionVote(HoH, nominees, newGameState);\n        newGameState.currentLog.votes[HoH.id] = new HoHVote(nominees[tieBreaker.decision].id);\n    }\n    let evictee: Houseguest;\n    if (votesFor0 > votesFor1) {\n        evictee = nominees[0];\n        newGameState.currentLog.votesInMajority = votesFor0;\n    } else if (votesFor1 > votesFor0) {\n        evictee = nominees[1];\n        newGameState.currentLog.votesInMajority = votesFor1;\n    } else {\n        evictee = nominees[tieBreaker.decision];\n        newGameState.currentLog.votesInMajority = votesFor1 + 1;\n    }\n    newGameState.currentLog.votes[nominees[0].id] = new NomineeVote(evictee.id === nominees[0].id);\n    newGameState.currentLog.votes[nominees[1].id] = new NomineeVote(evictee.id !== nominees[0].id);\n\n    evictHouseguest(newGameState, evictee.id);\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const displayHoH: ProfileHouseguest = { ...HoH };\n    displayHoH.tooltip = tieBreaker.reason;\n    const scene = new Scene({\n        title: \"Live Eviction\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </DividerBox>\n                </div>\n                {tieVote && (\n                    <div>\n                        <CenteredBold> We have a tie.</CenteredBold>\n                        <Centered>{`${HoH.name}, as current Head of Household, you must cast the sole vote to evict.`}</Centered>\n                        <Portraits houseguests={[displayHoH]} centered={true} />\n                        <CenteredBold>I vote to evict {`${evictee.name}.`}</CenteredBold>\n                    </div>\n                )}\n                <Portraits\n                    houseguests={[\n                        getById(newGameState, nominees[0].id),\n                        getById(newGameState, nominees[1].id)\n                    ]}\n                    centered={true}\n                />\n                <CenteredBold>{`${evictee.name}... you have been evicted from the Big Brother House.`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [newGameState, scene];\n}\n","import { Subscription } from \"rxjs\";\nimport { Sidebar } from \"./sidebar\";\nimport { Season } from \"../../model/season\";\nimport { Episode, nonEvictedHouseguests, getById } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport {\n    mainContentStream$,\n    episodes$,\n    switchEpisode$,\n    newEpisode,\n    switchSceneRelative,\n    cast$,\n    getSelectedPlayer,\n    selectedPlayer$,\n    displayMode$,\n} from \"../../subjects/subjects\";\nimport { popularityMode } from \"../../model/portraitDisplayMode\";\n\ninterface IndexedScene {\n    scene: Scene;\n    index: number;\n}\n\nconst LEFT = 37;\nconst RIGHT = 39;\n\nexport class SidebarController {\n    private view: Sidebar;\n    private subscriptions: Subscription[] = [];\n    private season: Season = new Season();\n    private scenes: IndexedScene[] = [];\n    private selectedEpisode: number = 0;\n\n    public constructor(view: Sidebar) {\n        this.view = view;\n        this.subscriptions.push(\n            episodes$.subscribe({\n                next: (episode) => this.onNewEpisode(episode),\n            })\n        );\n        this.subscriptions.push(\n            switchEpisode$.subscribe({\n                next: (value: number) => {\n                    this.switchSceneRelative(value);\n                },\n            })\n        );\n        this.subscriptions.push(\n            cast$.subscribe({\n                next: () => {\n                    this.season = new Season();\n                    this.selectedEpisode = 0;\n                    displayMode$.next(popularityMode);\n                },\n            })\n        );\n    }\n\n    public getSelectedEpisode() {\n        return this.selectedEpisode;\n    }\n\n    public async switchToScene(id: number) {\n        mainContentStream$.next(this.scenes[id].scene.render);\n        this.selectedEpisode = this.scenes[id].index;\n        await this.view.setState({ selectedScene: id });\n        if (getSelectedPlayer() !== null) {\n            selectedPlayer$.next(\n                getById(this.scenes[this.view.state.selectedScene].scene.gameState, getSelectedPlayer()!.id)\n            );\n        }\n    }\n\n    private switchSceneRelative = (delta: number) => {\n        const selectedScene = this.view.state.selectedScene;\n        const renderedScenes = this.scenes.length;\n        const targetScene = selectedScene + delta;\n        if (targetScene < 0) {\n            return;\n        }\n        const lastEpisode = this.view.state.episodes[this.view.state.episodes.length - 1];\n        if (targetScene < renderedScenes) {\n            // Go back to an earlier scene\n            this.switchToScene(targetScene);\n        } else if (targetScene === renderedScenes) {\n            // Generate a new scene, then jump to it\n            const currentGameState = lastEpisode.gameState;\n            const newPlayerCount = nonEvictedHouseguests(lastEpisode.gameState).length;\n            if (newPlayerCount > 0) {\n                newEpisode(this.season.renderEpisode(currentGameState));\n                this.switchSceneRelative(1);\n            }\n        }\n    };\n\n    get handleKeyDown(): (e: any) => void {\n        return this._handleKeyDown.bind(this);\n    }\n\n    private _handleKeyDown(event: any) {\n        const state = this.view.state;\n        if (\n            state.episodes[this.selectedEpisode] === undefined ||\n            !state.episodes[this.selectedEpisode].type.arrowsEnabled\n        ) {\n            return;\n        }\n        if (event.keyCode === LEFT) {\n            switchSceneRelative(-1);\n        } else if (event.keyCode === RIGHT) {\n            switchSceneRelative(1);\n        }\n    }\n\n    private onNewEpisode(episode: Episode | null) {\n        if (!episode) {\n            this.view.setState({ episodes: [], selectedScene: 0 });\n            this.scenes = [];\n        } else {\n            const newState = { ...this.view.state };\n            // starts at -1: prevent OBOE\n            const latestIndex = this.scenes.length === 0 ? -1 : this.scenes[this.scenes.length - 1].index;\n            const index = latestIndex + 1;\n            this.scenes.push({ scene: episode, index });\n            episode.scenes.forEach((scene) => this.scenes.push({ scene, index }));\n            newState.episodes.push(episode);\n            this.view.setState(newState);\n        }\n    }\n\n    public destroy() {\n        this.subscriptions.forEach((sub) => sub.unsubscribe());\n    }\n}\n","import React from \"react\";\nimport { SidebarController } from \"./sidebarController\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { Episode, GameState } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport { newEpisode } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\nimport { HasText } from \"../layout/text\";\ninterface SidebarState {\n    episodes: Episode[];\n    selectedScene: number;\n}\n\nexport class Sidebar extends React.Component<{}, SidebarState> {\n    private controller: SidebarController;\n    public constructor(props: {}) {\n        super(props);\n        this.controller = new SidebarController(this);\n        this.state = { episodes: [], selectedScene: 0 };\n        newEpisode(new PregameEpisode(new GameState([])));\n    }\n\n    public componentDidMount() {\n        document.addEventListener(\"keydown\", this.controller.handleKeyDown);\n    }\n\n    public componentWillUnmount() {\n        this.controller.destroy();\n    }\n\n    public render() {\n        return (\n            <Box style={{ minWidth: 180 }}>\n                <HasText>{this.getEpisodes()}</HasText>\n            </Box>\n        );\n    }\n\n    private getHighlight(title: string, key: number) {\n        if (key === this.state.selectedScene) {\n            return <mark>{title}</mark>;\n        }\n        return title;\n    }\n\n    private getEpisodes() {\n        const result: JSX.Element[] = [];\n        // Weird OBOE to make keys start at 0\n        let episodeKey = -1;\n        let breakKey = 0;\n        this.state.episodes.forEach((episode: Episode) => {\n            const id = ++episodeKey;\n            result.push(\n                <b\n                    key={id}\n                    onClick={() => {\n                        this.controller.switchToScene(id);\n                    }}\n                >\n                    {this.getHighlight(episode.title, id)}\n                </b>\n            );\n            result.push(<br key={--breakKey} />);\n            episode.scenes.forEach((scene: Scene) => {\n                const id = ++episodeKey;\n                if (this.controller.getSelectedEpisode() === episode.gameState.phase) {\n                    result.push(\n                        <a key={id} onClick={() => this.controller.switchToScene(id)}>\n                            {this.getHighlight(scene.title, id)}\n                        </a>\n                    );\n                    result.push(<br key={--breakKey} />);\n                }\n            });\n        });\n        return result;\n    }\n}\n","import styled from \"styled-components\";\nimport React from \"react\";\nimport { mainContentStream$ } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\n\nconst MainContentAreaWrapper = styled(Box)`\n    overflow-x: auto;\n`;\n\nexport class MainContentArea extends React.Component<{}, { content: any }> {\n    // a simple class that displays whatever it gets fed through the main content stream.\n\n    private contentStream: any;\n\n    public constructor(props: any) {\n        super(props);\n        this.state = { content: null };\n    }\n\n    public componentDidMount() {\n        this.contentStream = mainContentStream$.subscribe((content) => {\n            this.setState({ content });\n        });\n    }\n\n    public componentDidUpdate(prevProps: never, prevState: any) {\n        if (prevState.content !== this.state.content) {\n            window.scrollTo(0, 0);\n        }\n    }\n\n    public componentWillUnmount() {\n        this.contentStream.unsubscribe();\n    }\n\n    public render() {\n        return <MainContentAreaWrapper>{this.state.content}</MainContentAreaWrapper>;\n    }\n}\n","import \"./bulma.scss\";\nimport React from \"react\";\nimport { Sidebar } from \"../sidebar/sidebar\";\nimport { Topbar } from \"../topbar/topBar\";\nimport { MainContentArea } from \"./mainContentArea\";\nimport { MainPageController } from \"./mainPageController\";\n\ninterface MainPageProps {\n    controller: MainPageController;\n}\n\ninterface MainPageState {\n    fullscreen: boolean;\n}\n\nexport class MainPage extends React.Component<MainPageProps, MainPageState> {\n    public constructor(props: MainPageProps) {\n        super(props);\n        this.state = { fullscreen: false };\n        props.controller.inject(this);\n    }\n    public componentDidMount() {\n        this.props.controller.subscribe();\n    }\n    public componentWillUnmount() {\n        this.props.controller.unsubscribe();\n    }\n\n    public render() {\n        const fullscreen = this.state.fullscreen;\n        const hideOnFullscreen = { display: fullscreen ? \"none\" : \"\" };\n        const wrapperStyle = fullscreen\n            ? { margin: \"auto\" }\n            : { margin: \"auto\", maxWidth: 1480, overflow: \"hidden\" };\n        return (\n            <div style={wrapperStyle}>\n                <Topbar style={hideOnFullscreen} />\n                <div className=\"columns\">\n                    <div className=\"column is-narrow\" style={hideOnFullscreen}>\n                        <Sidebar />\n                    </div>\n\n                    <div className=\"column\" style={{ overflowX: \"hidden\" }}>\n                        <MainContentArea />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","import { MainPage } from \"./mainPage\";\nimport { Subscription } from \"rxjs\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\n\nexport class MainPageController {\n    private view: MainPage = new MainPage({ controller: this });\n    private subscriptions: Subscription[] = [];\n    public inject(page: MainPage) {\n        this.view = page;\n    }\n\n    public subscribe(): void {\n        this.unsubscribe();\n        this.subscriptions.push(\n            isFullscreen$.subscribe((fullscreen: boolean) => {\n                this.view.setState({ fullscreen });\n            })\n        );\n    }\n\n    public unsubscribe(): void {\n        this.subscriptions.forEach(sub => sub.unsubscribe());\n    }\n}\n","import { createGlobalStyle } from \"styled-components\";\nimport { ColorTheme } from \"./theme\";\n\nexport const GlobalStyles = createGlobalStyle`\n  *,\n  *::after,\n  *::before {\n    box-sizing: border-box;\n  }\n\n  body {\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bg};\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n       transition: all 0.25s linear;\n  }`;\n","import React from \"react\";\nimport { MainPage } from \"./components/mainPage/mainPage\";\nimport { MainPageController } from \"./components/mainPage/mainPageController\";\nimport { ThemeProvider } from \"styled-components\";\nimport { ColorTheme, darkTheme } from \"./theme/theme\";\nimport { GlobalStyles } from \"./theme/globalTheme\";\nimport { theme$ } from \"./subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nclass App extends React.Component<{}, { theme: ColorTheme }> {\n    private sub: Subscription | null = null;\n    public constructor(props: any) {\n        super(props);\n        this.state = {\n            theme: darkTheme,\n        };\n    }\n\n    public componentDidMount() {\n        this.sub = theme$.subscribe((theme) => {\n            this.setState({ theme });\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    render() {\n        return (\n            <ThemeProvider theme={this.state.theme}>\n                <>\n                    <GlobalStyles />\n                    <MainPage controller={new MainPageController()} />\n                </>\n            </ThemeProvider>\n        );\n    }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}