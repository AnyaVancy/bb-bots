{"version":3,"sources":["model/playerProfile.ts","model/houseguest.ts","utils/utilities.ts","utils/relationshipMap.ts","components/playerPortrait/selectedPortrait.ts","model/color.ts","components/playerPortrait/houseguestPortraitController.ts","components/playerPortrait/houseguestPortrait.tsx","components/playerPortrait/houseguestToPortrait.tsx","components/tooltip/tooltip.tsx","components/playerPortrait/portraits.tsx","components/memoryWall/memoryWall.tsx","components/nextEpisodeButton/nextEpisodeButton.tsx","components/playerPortrait/setupPortrait.tsx","utils/ai/classifyRelationship.ts","components/castingScreen/importLinks.tsx","components/playerPortrait/subtitle.tsx","model/portraitDisplayMode.ts","components/viewsBar/viewBarTag.tsx","components/viewsBar/viewBar.tsx","components/episode/episodes.tsx","components/episode/pregameEpisode.tsx","components/castingScreen/randomXButton.tsx","components/layout/text.ts","components/layout/centered.tsx","components/castingScreen/castingScreen.tsx","subjects/subjects.tsx","theme/theme.ts","components/topbar/themeSwitch.tsx","components/layout/box.tsx","components/deckScreen/deckScreen.tsx","components/topbar/topBar.tsx","components/pregameScreen/pregameScreen.tsx","utils/BbRandomGenerator.ts","model/gameState.ts","model/season.ts","components/episode/scene.tsx","utils/fft.ts","utils/poissonbinomial.ts","utils/ai/aiUtils.ts","utils/ai/targets.ts","utils/ai/aiApi.ts","components/mainPage/fullscreenButton.tsx","components/episode/scenes/votingTable.tsx","model/logging/voteType.tsx","components/episode/scenes/juryVoteScene.tsx","components/episode/bigBrotherFinale.tsx","components/episode/scenes/finalHohCompScene.tsx","components/episode/scenes/finalEvictionScene.tsx","components/episode/gameOver.tsx","model/logging/episodelog.ts","utils/generateGraph.ts","utils/generateCliques.ts","components/episode/episodeFactory.ts","components/episode/bigBrotherEpisode.tsx","components/episode/scenes/hohCompScene.tsx","components/episode/scenes/nomCeremonyScene.tsx","components/episode/scenes/vetoCompScene.tsx","components/episode/scenes/vetoCeremonyScene.tsx","components/episode/scenes/evictionScene.tsx","components/episode/allianceList.tsx","components/episode/bigBrotherWeekstartWrapper.tsx","components/sidebar/sidebarController.ts","components/sidebar/sidebar.tsx","components/mainPage/mainContentArea.tsx","components/mainPage/mainPage.tsx","components/mainPage/mainPageController.ts","theme/globalTheme.ts","App.tsx","index.tsx"],"names":["PlayerProfile","init","Object","classCallCheck","this","name","imageURL","assign","Houseguest","_PlayerProfile","_this","possibleConstructorReturn","getPrototypeOf","call","isEvicted","isJury","id","nominations","hohWins","povWins","compatibility","popularity","deltaPopularity","relationships","targets","powerRanking","superiors","size","friends","enemies","targetingMe","assertThisInitialized","inherits","createClass","key","value","villain","roundTwoDigits","number","Math","round","intersection","setA","setB","_intersection","Set","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","elem","has","add","err","return","difference","_difference","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","delete","isWellDefined","x","isNotWellDefined","magnitude","result","forEach","pow","angleBetween","y","length","Error","concat","acos","_","i","dot","newRelationshipMap","exclude","selectPlayer","player","getSelectedPlayer","selectedPlayer$","componentToHex","c","hex","toString","Rgb","r","g","b","interpolateColor","min","max","percent","toHex","selectedColor","HouseguestPortraitController","view","subs","refreshData","data","props","setState","comparePowerRankings","defaultState","selectedPlayer","state","displayMode","backgroundColor","_this2","push","subscribe","displayMode$","sub","unsubscribe","get","Subtitle","styled","small","_templateObject","MemoryWallPortrait","div","_templateObject2","_ref","theme","portraitBorder","Evicted","_templateObject3","Jury","_templateObject4","Normal","img","_templateObject5","Grayscale","_templateObject6","Sepia","_templateObject7","HouseguestPortrait","_React$Component","controller","subtitle","Img","imageClass","getImageClass","generateSubtitle","detailed","Portrait","react_default","a","createElement","onClick","style","src","height","width","React","Component","houseguestToPortrait","houseguest","houseguestPortrait_HouseguestPortrait","Text","p","tooltip_templateObject","Tooltip","visible","Popover_default","position","isOpen","content","text","onMouseEnter","onMouseLeave","children","PortraitWrapper","className","centered","tooltip","tooltip_Tooltip","Portraits","rows","houseguests","display","justifyContent","alignItems","memoryWallPortrait","MemoryWall","margin","maxWidth","NextEpisodeButton","switchSceneRelative","RelationshipType","EditPortrait","setupPortrait_templateObject","Noselect","setupPortrait_templateObject2","XButton","setupPortrait_templateObject3","SetupPortrait","textAlign","onDoubleClick","onDelete","imageUrl","ImportLinks","lines","split","profiles","line","temp","pop","replace","substr","indexOf","onSubmit","onChange","event","target","RelationshipTypeToSymbol","FRIEND","ENEMY","PAWN","QUEEN","classifyRelationship","heroPopularity","villainPopularity","relationship","benefitsHero","benefitsVillain","Friend","Pawn","Queen","Enemy","addPopularityLine","hero","popularitySubtitle","deltaPop","statePopularity","getDeltaPopularity","addCompsLine","compWins","lineHeight","popularityMinColor","popularityMaxColor","popularityMode","minColor","maxColor","extremePopularity","xSquared","extremeValues","_addFriendshipCountTi","titles","friendOrEnemyTitle","map","txt","count","Relationship","friendEnemyCountTitle","addFriendshipCountTitles","arguments","powerMaxColor","powerMinColor","powerMode","ViewBarTag","selected","mode","_this3","disabled","background","toRgba","cursor","ViewsBar","inJury","gameState","marginBottom","viewBarTag_ViewBarTag","Episode","scenes","title","initialGameState","type","arrowsEnabled","initialGamestate","viewsBar","hasViewsbar","viewBar_ViewsBar","PregameEpisodeType","eliminates","canPlayWith","n","PregameEpisode","_Episode","pregameScreen_PregameScreen","cast","RandomButton","_useState","useState","_useState2","slicedToArray","setNumber","random","parseInt","NumericInput","marginLeft","test","HasText","text_templateObject","Input","input","text_templateObject2","_ref2","NoMargin","centered_templateObject","Center","centered_templateObject2","Centered","noMargin","CenteredBold","CenteredItallic","CastingScreen","appendProfiles","newState","objectSpread","profile","players","submit","asyncToGenerator","regenerator_default","mark","_callee","wrap","_context","prev","newCast","cast$","mainContentStream$","newEpisode","GameState","stop","amount","shuffle","slice","handleUpload","handleFiles","files","handleDrop","newName","splice","_this4","setupPortrait_SetupPortrait","deleteMethod","handleChange","_this5","FileDrop","onDrop","importLinks_ImportLinks","multiple","getFiles","file","match","lastIndexOf","URL","createObjectURL","lightTheme","bg","toggleBorder","gradient","bodyArea","link","overlay","evictedCell","grayCell","lightGrayCell","winnerCell","runnerUpCell","nomineeCell","hohCell","tableCellBorder","darkTheme","ThemeSwitcher","window","matchMedia","matches","setTheme","theme$","ShadowBox","box_templateObject","StyledBox","box_templateObject2","_ref3","DividerBox","Box","decksPerPage","baseUrl","imageCache","DeckStyle","deckScreen_templateObject","deckScreen_templateObject2","DeckText","deckScreen_templateObject3","_callee2","folder","links","image","_context2","abrupt","fetch","sent","json","sample","_callee3","imageLinks","playerProfiles","_context3","url","castingScreen_CastingScreen","Deck","_React$useState","_React$useState2","setImage","_React$useState3","_React$useState4","loading","setLoading","deck","randomImageFromFolder","then","selectCast","DeckList","commentNodes","j","DeckScreen","handlePageClick","page","debounceSearch","debounce","nextValue","debouncedSearchText","handleSearch","searchText","decks","_componentDidMount","apply","filter","toLowerCase","minWidth","placeholder","deckScreen_Centered","dist_default","previousLabel","nextLabel","breakLabel","breakClassName","pageCount","ceil","marginPagesDisplayed","pageRangeDisplayed","onPageChange","containerClassName","activeClassName","TopbarLink","topBar_templateObject","AdvancedEditLink","ChooseCastLink","deckScreen_DeckScreen","Topbar","PregameScreen","BehaviorSubject","episodes$","switchEpisode$","Subject","episode","weekStartTab$","isFullscreen$","BbRandomGenerator","seed","rng","prand","xorshift128plus","_this$rng$next","_this$rng$next2","_prand$uniformIntDist","uniformIntDistribution","_prand$uniformIntDist2","_this$rng$next3","_this$rng$next4","rng$","castNames","string","hash","charCodeAt","hashcode","getById","houseguestCache","inclusions","exclusions","excludedIds","hg","includes","randomPlayer","options","randomInt","nonEvictedHouseguests","toConsumableArray","entries","getJurors","remainingPlayers","finalJurySize","phase","previousHOH","log","cliques","Array","MutableGameState","copy","cloneDeep","Scene","render","fft","real","imag","levels","cosTable","sinTable","cos","PI","sin","reverseBits","halfsize","tablestep","k","l","tpre","tpim","val","transformRadix2","m","areal","newArrayOfZeros","aimag","breal","bimag","creal","cimag","convolveComplex","transformBluestein","xreal","ximag","yreal","yimag","outreal","outimag","pbincdf","pp","zeros","ones","num","cdf","nPlusOne","ω","sigmaLogModulusZ","sum","p_j","e1","e2","sigmaPrincipalArgz","atan2","d","exp","sigmaArgZ","ξ","_pbincdf","pHeroWinsTheFinale","hgs","jury","juror","pJurorVotesForHero","heroShouldTargetSuperiors","opponents","deadValue","doIWin","getRelationshipSummary","MAGIC_SUPERIOR_NUMBER","relationshipWith","TargetStrategy","Targets","firstTarget","secondTarget","newTarget","isBetterTarget","old","neww","strategy","MoR","StatusQuo","Underdog","determineStrategy","newRank","rankRelationshipSummaryStatusQuo","oldRank","isBetterTargetStatusQuo","isBetterTargetMoR","isBetterTargetUnderdog","castEvictionVote","nominees","nom0","nom1","zeroIsInferior","oneIsInferior","castF3Vote","HoH","evictNom0","winningOddsF3","evictNom1","decision","reason","castF4vote","from","values","r0","r1","cutthroatVote","nonVote","cutthroatVoteJury","villain1","villain2","heroVs1","heroVs2","v1Vs2","nom0isTarget","nom1isTarget","vote","callback","lowestIndex","lowestScore","Infinity","currentScore","useGoldenVeto","potentialSave","alwaysSave","nominee","nomineeIsSuperior","useGoldenVetoPreJury","FullscreenIcon","fullscreenButton_templateObject","FullscreenButton","getValue","EndgameTableCell","td","votingTable_templateObject","EndgameTable","table","votingTable_templateObject2","Gray","votingTable_templateObject3","White","votingTable_templateObject4","_ref4","votingTable_templateObject5","_ref5","WinnerCell","votingTable_templateObject6","_ref6","RunnerUpCell","votingTable_templateObject7","_ref7","NomineeCell","_templateObject8","_ref8","HohCell","_templateObject9","_ref9","BlackRow","tr","_templateObject10","generateVotingTable","masterLog","houseguestCells","evictionOrder","topRowCells","preVetoCells","vetoCells","postVetoCells","evictedCells","winnerCells","cells","colSpan","generateTopRow","nominationsPreVeto","rowSpan","generatePreVetoRow","vetoWinner","generateVetoRow","nominationsPostVeto","generatePostVetoRow","voteTextLine1","soleVoter","votesInMajority","outOf","votingTable_Evicted","evicted","generateEvictedRow","runnerUp","winner","_arr","votes","_i","_ref12","_ref11","WinnerVote","RunnerUpVote","winnerRow","topRow","preVetoRow","vetoRow","postVetoRow","blackRow","houseguestRows","evictedRow","evictionColSpan","weeks","reverse","weekText","tempList","voteKey","getKey","NormalVote","NomineeVote","HoHVote","hohText","hohVote","juryVoteScene","newGameState","jurors","finalists","abs","randomFloat","castJuryVote","currentLog","votesFor0","votesFor1","voteCountText","scene","BigBrotherFinale","generateBbFinale","currentGameState","hohCompScene","finalHoH","finalEviction","_finalHohCompScene","final3","enduranceWinner","enduranceLosers","skillWinner","portraits_Portrait","finalHohCompScene","_finalHohCompScene2","_finalEvictionScene","_castEvictionVote","evictee","survivor","hoh","evictHouseguest","finalEvictionScene","_finalEvictionScene2","_juryVoteScene","_juryVoteScene2","juryScene","BigBrotherFinaleEpisode","GameOver","GameOverEpisode","EpisodeLog","EdgeMap","generateGraph","nodes","edges","stringId","villainId","_generateEdge","generateEdge","_generateEdge2","edge","neighbors","v","generateCliques","bronKerbosch","keys","rPrime","pPrime","node","xPrime","clique","sort","blacklist","clq","cliqueI","cliquePushed","cliqueJ","core","affiliates","JSON","stringify","canDisplayCliques","EpisodeFactory","episodeType","u","θ","φ","iMap","jMap","impression","firstImpressions","pHeroWins","populateSuperiors","test2","xi","average","house","targetId","calculatePopularity","updatePopularity","addTarget","getTargets","updateFriendCounts","finalState","BigBrotherVanilla","nomCeremonyScene","_generateHohCompScene","previousHoh","newHoH","generateHohCompScene","_generateHohCompScene2","vetoCompScene","povWinner","_generateNomCeremonyS","nom2","noms","generateNomCeremonyScene","_generateNomCeremonyS2","vetoCeremonyScene","_generateVetoCompScen","choices","povPlayers","everyoneWillPlay","introText","extras","generateVetoCompScene","_generateVetoCompScen2","evictionScene","_generateVetoCeremony","initialNominees","povTarget","descisionText","vetoChoice","replacementSpeech","nameAReplacement","finalNominees","HoHwonPoV","replacementNom","sortedOptions","hg1","hg2","backdoorNPlayers","replacementIndex","findIndex","generateVetoCeremonyScene","_generateVetoCeremony2","_generateEvictionScen","lastVoter","logic","tieVote","tieBreaker","displayHoH","generateEvictionScene","_generateEvictionScen2","Tabs","bigBrotherWeekstartWrapper_WeekStartWrapper","BigBrotherVanillaEpisode","generateBbVanilla","generateGameOver","AllianceList","elements","WeekStartWrapper","tab","TabItem","li","bigBrotherEpisode_templateObject","Tab","active","setActive","paddingLeft","Season","factory","nextEpisode","whichEpisodeType","SidebarController","subscriptions","season","selectedEpisode","delta","selectedScene","renderedScenes","targetScene","lastEpisode","episodes","switchToScene","renderEpisode","onNewEpisode","_switchToScene","index","_x","keyCode","_handleKeyDown","bind","Sidebar","document","addEventListener","handleKeyDown","destroy","getEpisodes","episodeKey","breakKey","getHighlight","getSelectedEpisode","MainContentAreaWrapper","mainContentArea_templateObject","MainContentArea","contentStream","prevProps","prevState","scrollTo","MainPage","fullscreen","inject","hideOnFullscreen","wrapperStyle","overflow","sidebar_Sidebar","overflowX","mainContentArea_MainContentArea","MainPageController","GlobalStyles","createGlobalStyle","globalTheme_templateObject","App","styled_components_browser_esm","Fragment","mainPage_MainPage","ReactDOM","src_App","getElementById"],"mappings":"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","file":"static/js/main.2b96c5c7.chunk.js","sourcesContent":["export class PlayerProfile {\n    readonly name: string = \"\";\n    readonly imageURL: string = \"\";\n    constructor(init: PlayerProfile) {\n        if (!init) {\n            return;\n        }\n        Object.assign(this, init);\n    }\n}\n","import { PlayerProfile } from \"./playerProfile\";\nimport { RelationshipMap } from \"../utils\";\n\ninterface HouseguestInit extends PlayerProfile {\n    id: number;\n    relationships: RelationshipMap;\n}\n\nexport class Houseguest extends PlayerProfile {\n    public isEvicted: boolean = false;\n    public isJury: boolean = false;\n\n    readonly id: number = 0;\n\n    public nominations: number = 0;\n    public hohWins: number = 0;\n    public povWins: number = 0;\n\n    // Popularity ranges from -1 to 1\n    public compatibility: [number, number, number] = [0, 0, 0];\n    public popularity: number = 0;\n    public deltaPopularity: number = 0;\n    readonly relationships: RelationshipMap = {};\n\n    public targets: [number, number] = [this.id, this.id];\n\n    // power rankings range from 0 to 1\n    public powerRanking: number = 0;\n    readonly superiors: { [id: number]: number; size: number } = { size: 0 }; // { id : pHeroWins }\n\n    public relationshipWith(villain: Houseguest): number {\n        return this.relationships[villain.id];\n    }\n    public friends = 0;\n    public enemies = 0;\n    public targetingMe = 0;\n\n    constructor(init: HouseguestInit) {\n        super(init);\n        Object.assign(this, init);\n    }\n}\n","export function hashcode(string: string): number {\n    let hash = 0,\n        i,\n        chr;\n    if (string.length === 0) return hash;\n    for (i = 0; i < string.length; i++) {\n        chr = string.charCodeAt(i);\n        hash = (hash << 5) - hash + chr;\n        hash |= 0;\n    }\n    return hash;\n}\n\nexport function roundTwoDigits(number: number | undefined) {\n    if (!number) {\n        return 0;\n    }\n    return Math.round(number * 100);\n}\n\nexport function max(a: number, b: number) {\n    return a > b ? a : b;\n}\n\nexport function intersection<T>(setA: Set<T>, setB: Set<T>): Set<T> {\n    let _intersection = new Set<T>();\n    for (let elem of setB) {\n        if (setA.has(elem)) {\n            _intersection.add(elem);\n        }\n    }\n    return _intersection;\n}\nexport function difference<T>(setA: Set<T>, setB: Set<T>): Set<T> {\n    let _difference = new Set<T>(setA);\n    for (let elem of setB) {\n        _difference.delete(elem);\n    }\n    return _difference;\n}\n\nexport function extremeValues(x: number | undefined): number {\n    if (!x) {\n        return 0;\n    }\n    const xSquared = x * x;\n    if (x >= 0) {\n        return -xSquared + 2 * x;\n    } else {\n        return xSquared + 2 * x;\n    }\n}\n\nexport function average(x: number[]): number {\n    let sum = 0;\n    x.forEach((xi) => (sum += xi));\n    return sum / x.length;\n}\n\nexport function isWellDefined(x: any) {\n    return x !== null && x !== undefined;\n}\n\nexport function isNotWellDefined(x: any): x is null | undefined {\n    return x === null || x === undefined;\n}\n\nexport function dot(x: number[], y: number[]) {\n    if (x.length !== y.length)\n        throw new Error(\n            `Tried to get the dot product between two vectors of non-equal length: ${x.length} !== ${y.length}`\n        );\n    let result = 0;\n    x.forEach((_, i) => {\n        result += x[i] * y[i];\n    });\n    return result;\n}\n\nexport function magnitude(x: number[]): number {\n    let result = 0;\n    x.forEach((x) => (result += x ** 2));\n    return result;\n}\n\n// returns a value between 0 and pi\n\nexport function angleBetween(x: number[], y: number[]): number {\n    if (x.length !== y.length)\n        throw new Error(\n            `Tried to get the angle between two vectors of non-equal length: ${x.length} !== ${y.length}`\n        );\n    return Math.acos((dot(x, y) / magnitude(x)) * magnitude(y));\n}\n","export interface RelationshipMap {\n    [id: number]: number;\n}\n\nexport function newRelationshipMap(size: number, exclude: number): RelationshipMap {\n    const result: RelationshipMap = {};\n    for (let i = 0; i < size; i++) {\n        if (i !== exclude) result[i] = 0;\n    }\n    return result;\n}\n","import { Houseguest } from \"../../model\";\nimport { RelationshipMap } from \"../../utils\";\nimport { getSelectedPlayer, selectedPlayer$ } from \"../../subjects/subjects\";\n\nexport interface SelectedPlayerData {\n    id: number;\n    popularity: number;\n    relationships: RelationshipMap;\n    isEvicted: boolean;\n    superiors?: { [id: number]: number };\n}\n\nexport function selectPlayer(player: SelectedPlayerData | null) {\n    if (!player || (getSelectedPlayer() && (getSelectedPlayer() as Houseguest).id === player.id)) {\n        selectedPlayer$.next(null);\n    } else {\n        selectedPlayer$.next(player);\n    }\n}\n","function componentToHex(c: any) {\n    var hex = Math.round(c).toString(16);\n    return hex.length == 1 ? \"0\" + hex : hex;\n}\n\nexport class Rgb {\n    public r: number;\n    public g: number;\n    public b: number;\n    public toHex() {\n        return \"#\" + componentToHex(this.r) + componentToHex(this.g) + componentToHex(this.b);\n    }\n    public toRgba(): string {\n        return `rgba(${this.r}, ${this.g}, ${this.b}, 1)`;\n    }\n    constructor(r: number, g: number, b: number) {\n        this.r = r;\n        this.g = g;\n        this.b = b;\n    }\n}\n\nexport function interpolateColor(min: Rgb, max: Rgb, percent: number): string {\n    return new Rgb(\n        min.r + percent * (max.r - min.r),\n        min.g + percent * (max.g - min.g),\n        min.b + percent * (max.b - min.b)\n    ).toHex();\n}\n","import { PortraitProps, HouseguestPortrait, PortraitState } from \"../memoryWall\";\nimport { Subscription } from \"rxjs\";\nimport { selectedPlayer$, displayMode$, getSelectedPlayer } from \"../../subjects/subjects\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport { Rgb } from \"../../model/color\";\n\nconst selectedColor = new Rgb(51, 255, 249);\n\nexport class HouseguestPortraitController {\n    private subs: Subscription[] = [];\n    private view: HouseguestPortrait;\n    constructor(view: HouseguestPortrait) {\n        this.view = view;\n    }\n\n    get defaultState() {\n        return {\n            popularity: this.view.props.popularity,\n            displayMode: displayMode$.value,\n            powerRanking: this.view.props.powerRanking,\n        };\n    }\n\n    public backgroundColor(props: PortraitProps): undefined | string {\n        const selectedPlayer = getSelectedPlayer();\n        if (selectedPlayer !== null && selectedPlayer.id === props.id) {\n            return selectedColor.toHex();\n        }\n        return props.isEvicted ? undefined : this.view.state.displayMode.backgroundColor(this.view.state);\n    }\n\n    public subscribe() {\n        const subs: Subscription[] = [];\n        subs.push(\n            selectedPlayer$.subscribe({\n                next: this.refreshData,\n            })\n        );\n        subs.push(\n            displayMode$.subscribe({\n                next: (displayMode) => this.view.setState({ displayMode }),\n            })\n        );\n        this.subs = subs;\n    }\n\n    public unsubscribe() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    private comparePowerRankings(data: SelectedPlayerData): number {\n        // 0 is blue. 1 is orange\n        if (!data.superiors) return 0;\n        const id = this.view.props.id === undefined ? -1 : this.view.props.id;\n        return data.superiors[id];\n    }\n\n    private refreshData = (data: SelectedPlayerData | null) => {\n        if (!data) {\n            this.view.setState(this.defaultState);\n        } else {\n            if (data.id !== this.view.props.id) {\n                this.view.setState({\n                    popularity: data.relationships[this.view.props.id!],\n                    powerRanking: this.comparePowerRankings(data),\n                });\n            } else {\n                this.view.setState({ popularity: 2, powerRanking: 2 });\n            }\n        }\n    };\n}\n","import React from \"react\";\nimport { selectPlayer } from \"./selectedPortrait\";\nimport { isNotWellDefined, RelationshipMap } from \"../../utils\";\nimport _ from \"lodash\";\nimport { HouseguestPortraitController } from \"./houseguestPortraitController\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst Subtitle = styled.small`\n    font-weight: 100;\n    font-size: small;\n`;\n\nconst MemoryWallPortrait = styled.div`\n    margin: 5px;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.portraitBorder};\n    color: black;\n    border-radius: 5px;\n    text-align: center;\n    font-weight: 600;\n    width: 7rem;\n    word-wrap: break-word;\n    -webkit-transition-property: none;\n    -moz-transition-property: none;\n    -o-transition-property: none;\n    transition-property: none;\n`;\n\nconst Evicted = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: grey;\n    background-color: #111111;\n`;\n\nconst Jury = styled(MemoryWallPortrait)`\n    font-weight: 100;\n    color: #c3ae88;\n    background-color: #5d5340;\n    filter: brightness(0.6);\n`;\n\nconst Normal = styled.img`\n    min-width: 100px;\n    width: 100%;\n    width: -moz-available; /* For Mozzila */\n    width: -webkit-fill-available; /* For Chrome */\n    width: stretch; /* Unprefixed */\n    -webkit-transition-property: none;\n    -moz-transition-property: none;\n    -o-transition-property: none;\n    transition-property: none;\n`;\n\nconst Grayscale = styled(Normal)`\n    filter: grayscale(100%);\n`;\n\nconst Sepia = styled(Normal)`\n    filter: sepia(100%);\n`;\n\nexport interface PortraitProps {\n    imageURL: string;\n    name: string;\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    powerRanking?: number;\n    deltaPopularity?: number;\n    detailed?: boolean;\n    superiors?: { [id: number]: number };\n    friends?: number;\n    enemies?: number;\n    targetingMe?: number;\n}\n\nexport interface PortraitState {\n    popularity?: number;\n    powerRanking?: number;\n    displayMode: PortraitDisplayMode;\n}\nexport class HouseguestPortrait extends React.Component<PortraitProps, PortraitState> {\n    private controller: HouseguestPortraitController;\n\n    public constructor(props: PortraitProps) {\n        super(props);\n        this.controller = new HouseguestPortraitController(this);\n        this.state = this.controller.defaultState;\n    }\n\n    public componentDidMount() {\n        if (isNotWellDefined(this.props.id)) {\n            return;\n        }\n        this.controller.subscribe();\n    }\n\n    public componentWillUnmount() {\n        this.controller.unsubscribe();\n    }\n\n    private onClick(): void {\n        if (isNotWellDefined(this.props.id) || !this.props.relationships) {\n            return;\n        }\n        const data = {\n            id: this.props.id,\n            relationships: this.props.relationships,\n            isEvicted: !!this.props.isEvicted,\n            popularity: this.props.popularity || 0,\n            superiors: this.props.superiors,\n        };\n        selectPlayer(data);\n    }\n\n    public render() {\n        const props = this.props;\n        const Img = getImageClass(props);\n        let subtitle: any[] = [];\n        subtitle = this.state.displayMode.generateSubtitle(this.props, this.state, !!props.detailed);\n\n        let Portrait = MemoryWallPortrait;\n        if (props.isJury) {\n            Portrait = Jury;\n        } else if (props.isEvicted) {\n            Portrait = Evicted;\n        }\n        return (\n            <Portrait\n                onClick={() => this.onClick()}\n                style={{\n                    backgroundColor: this.controller.backgroundColor(props),\n                }}\n            >\n                <Img src={props.imageURL} style={{ height: 100, width: \"-moz-available\" }} />\n                <br />\n                {props.name}\n                <br />\n                {<Subtitle>{subtitle}</Subtitle>}\n            </Portrait>\n        );\n    }\n}\n\nfunction getImageClass(props: PortraitProps) {\n    let imageClass = props.isEvicted ? Grayscale : Normal;\n    imageClass = props.isJury ? Sepia : imageClass;\n    return imageClass;\n}\n","import { ProfileHouseguest, HouseguestPortrait } from \"../memoryWall\";\nimport React from \"react\";\n\nexport function houseguestToPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={false} />;\n}\n\nexport function memoryWallPortrait(houseguest: ProfileHouseguest, key?: any): JSX.Element {\n    return <HouseguestPortrait {...houseguest} key={key} detailed={true} />;\n}\n","import React from \"react\";\nimport Popover from \"react-tiny-popover\";\nimport styled from \"styled-components\";\n\nconst Text = styled.p`\n    max-width: 200px;\n    padding: 3px 8px;\n    color: #fff;\n    text-align: center;\n    background-color: #000;\n    border-radius: 4px;\n`;\n\ninterface TooltipProps {\n    text: string;\n    children: any;\n}\n\ninterface ToolTipState {\n    visible: boolean;\n}\n\nexport class Tooltip extends React.Component<TooltipProps, ToolTipState> {\n    constructor(props: TooltipProps) {\n        super(props);\n        this.state = { visible: false };\n    }\n\n    public render() {\n        return (\n            <Popover\n                position={[\"top\", \"bottom\"]}\n                isOpen={this.state.visible}\n                content={<Text>{this.props.text}</Text>}\n            >\n                <div\n                    onMouseEnter={() => this.setState({ visible: true })}\n                    onMouseLeave={() => this.setState({ visible: false })}\n                >\n                    {this.props.children}\n                </div>\n            </Popover>\n        );\n    }\n}\n","import React from \"react\";\nimport { ProfileHouseguest } from \"../memoryWall\";\nimport { houseguestToPortrait, memoryWallPortrait } from \"./houseguestToPortrait\";\nimport { Tooltip } from \"../tooltip/tooltip\";\n\nlet key = -1;\n\nfunction PortraitWrapper(props: { centered?: boolean; children: any }): JSX.Element {\n    return (\n        <div\n            key={key++}\n            className={`columns is-gapless is-mobile is-multiline ${props.centered ? \"is-centered\" : \"\"}`}\n        >\n            {props.children}\n        </div>\n    );\n}\n\nexport function Portrait(props: { houseguest: ProfileHouseguest; centered?: boolean }): JSX.Element {\n    const result = (\n        <PortraitWrapper centered={props.centered}>{houseguestToPortrait(props.houseguest)}</PortraitWrapper>\n    );\n    if (props.houseguest.tooltip) {\n        return (\n            <PortraitWrapper centered={props.centered}>\n                <Tooltip text={props.houseguest.tooltip}>{houseguestToPortrait(props.houseguest)}</Tooltip>\n            </PortraitWrapper>\n        );\n    }\n    return result;\n}\n\nexport function Portraits(props: {\n    houseguests: (ProfileHouseguest | \"+\")[];\n    centered?: boolean;\n    detailed?: boolean;\n}): JSX.Element {\n    const rows: JSX.Element[] = [];\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    props.houseguests.forEach((houseguest: ProfileHouseguest | \"+\") => {\n        let result;\n        if (houseguest === \"+\") {\n            result = (\n                <div\n                    key={`plus-${key++}`}\n                    style={{ display: \"flex\", justifyContent: \"center\", alignItems: \"center\" }}\n                    className=\"column is-narrow\"\n                >\n                    <p>+</p>\n                </div>\n            );\n        } else if (props.detailed) {\n            result = memoryWallPortrait(houseguest, key++);\n        } else {\n            result = houseguestToPortrait(houseguest, key++);\n        }\n        if (houseguest !== \"+\" && houseguest.tooltip) {\n            result = (\n                <Tooltip key={key++} text={houseguest.tooltip}>\n                    {result}\n                </Tooltip>\n            );\n        }\n        rows.push(result);\n    });\n    return (\n        <div className={`columns is-gapless is-mobile is-multiline ${props.centered && \"is-centered\"}`}>\n            {rows}\n        </div>\n    );\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { Portraits } from \"../playerPortrait/portraits\";\nimport { RelationshipMap } from \"../../utils\";\nexport interface IMemoryWallProps {\n    readonly houseguests: ProfileHouseguest[];\n}\n\nexport interface ProfileHouseguest extends PlayerProfile {\n    id?: number;\n    relationships?: RelationshipMap;\n    isEvicted?: boolean;\n    isJury?: boolean;\n    popularity?: number;\n    deltaPopularity?: number;\n    hohWins?: number;\n    povWins?: number;\n    nominations?: number;\n    tooltip?: string;\n    friends?: number;\n    enemies?: number;\n    targetingMe?: number;\n}\n\nexport function MemoryWall(props: IMemoryWallProps): JSX.Element {\n    if (!props.houseguests || props.houseguests.length === 0) {\n        return <div />;\n    }\n    return (\n        // TODO: modulo magic. i dare you.\n        <div\n            style={{\n                margin: \"auto\",\n                maxWidth: props.houseguests.length < 26 ? 800 : -1,\n            }}\n        >\n            <Portraits houseguests={props.houseguests} centered={true} detailed={true} />\n        </div>\n    );\n}\n","import React from \"react\";\nimport { switchSceneRelative } from \"../../subjects/subjects\";\n\nexport function NextEpisodeButton(): JSX.Element {\n    return (\n        <button className=\"button is-primary\" onClick={() => switchSceneRelative(1)}>\n            Continue\n        </button>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\ninterface SetupPortraitProps {\n    name: string;\n    imageUrl: string;\n    onDelete: () => void;\n    onChange: (arg0: Event) => void;\n}\n\ninterface SetupPortraitState {\n    name: string;\n}\n\nconst EditPortrait = styled.div`\n    padding: 5px;\n    margin: 5px;\n    border: 1px solid grey;\n    background-color: grey;\n    color: black;\n    border-radius: 5px;\n    font-weight: 600;\n    width: 7rem;\n    word-wrap: break-word;\n`;\n\nconst Noselect = styled.div`\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -khtml-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n`;\n\nconst XButton = styled(Noselect)`\n    color: #300808;\n\n    :active {\n        color: #ff7133;\n        background-color: #ffd8c7;\n    }\n    :hover {\n        color: red;\n        background-color: #ffe1ea;\n    }\n`;\n\nexport class SetupPortrait extends React.Component<SetupPortraitProps, SetupPortraitState> {\n    public constructor(props: SetupPortraitProps) {\n        super(props);\n        this.state = { name: props.name };\n    }\n\n    public UNSAFE_componentWillReceiveProps(props: SetupPortraitProps) {\n        this.setState({ name: props.name });\n    }\n\n    public render() {\n        return (\n            <EditPortrait>\n                <div style={{ textAlign: \"center\" }}>\n                    <XButton onDoubleClick={() => this.props.onDelete()}>✘</XButton>\n                    <img src={this.props.imageUrl} style={{ width: 100, height: 100 }} />\n                    <br />\n                    <p>{this.state.name} </p>\n                </div>\n            </EditPortrait>\n        );\n    }\n}\n","export enum RelationshipType {\n    Friend = \"FRIEND\",\n    Queen = \"QUEEN\",\n    Pawn = \"PAWN\",\n    Enemy = \"ENEMY\"\n}\n\nexport const RelationshipTypeToSymbol = { FRIEND: \"♥\", ENEMY: \"💔\", PAWN: \"PAWN\", QUEEN: \"QUEEN\" };\n\nexport function classifyRelationship(\n    heroPopularity: number,\n    villainPopularity: number,\n    relationship: number\n): RelationshipType {\n    const benefitsHero = relationship > heroPopularity;\n    const benefitsVillain = relationship > villainPopularity;\n    if (benefitsHero && benefitsVillain) {\n        return RelationshipType.Friend;\n    } else if (benefitsHero && !benefitsVillain) {\n        return RelationshipType.Pawn;\n    } else if (!benefitsHero && benefitsVillain) {\n        return RelationshipType.Queen;\n    }\n    return RelationshipType.Enemy;\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\n\ninterface ImportLinksProps {\n    onSubmit: (profiles: PlayerProfile[]) => void;\n    className?: string;\n}\n\nexport class ImportLinks extends React.Component<ImportLinksProps, any> {\n    public constructor(props: ImportLinksProps) {\n        super(props);\n        this.state = { text: \"\" };\n    }\n\n    private onSubmit() {\n        const lines = this.state.text.split(/\\r?\\n/);\n        // ugly, but it works.\n        const profiles: PlayerProfile[] = [];\n        lines.forEach((line: string) => {\n            const temp = line.split(\"/\").pop();\n            let name = temp\n                ? temp\n                      .split(\"#\")[0]\n                      .split(\"?\")[0]\n                      .replace(/\\.[^/.]+$/, \"\")\n                      .replace(/[-_]/g, \" \")\n                : null;\n\n            if (line.substr(0, line.indexOf(\" \"))) {\n                name = line.substr(line.indexOf(\" \") + 1);\n            }\n            if (name) {\n                profiles.push({\n                    name,\n                    imageURL: line\n                });\n            }\n        });\n        this.props.onSubmit(profiles);\n        this.setState({ text: \"\" });\n    }\n\n    public render() {\n        return (\n            <div className={this.props.className}>\n                <textarea\n                    className=\"textarea\"\n                    onChange={event => {\n                        this.setState({ text: event.target.value });\n                    }}\n                    value={this.state.text}\n                />\n                <button onClick={() => this.onSubmit()}>Import links</button>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { isWellDefined, roundTwoDigits } from \"../../utils\";\nimport { ProfileHouseguest, PortraitProps, PortraitState } from \"../memoryWall\";\nimport { SelectedPlayerData } from \"./selectedPortrait\";\nimport {\n    RelationshipTypeToSymbol,\n    RelationshipType as Relationship,\n    classifyRelationship,\n} from \"../../utils/ai/classifyRelationship\";\nimport { getSelectedPlayer } from \"../../subjects/subjects\";\n\nexport function generatePowerSubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    _: boolean | undefined\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    key = addPopularityLine(state, hero, !!_, subtitle, key);\n    key = addCompsLine(hero, subtitle, key);\n    if (!hero.isEvicted && state.powerRanking) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            subtitle.push(<div key={key++}>{`WIN ${roundTwoDigits(state.powerRanking!)}%`}</div>);\n        } else if (data && data.id === hero.id) {\n            subtitle.push(<div key={key++}>I WOULD</div>);\n        } else {\n            subtitle.push(\n                <div key={key++}>{`WIN ${roundTwoDigits(state.powerRanking)}%${\n                    hero.targetingMe ? ` | 🎯 ${hero.targetingMe}` : \"\"\n                }`}</div>\n            );\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return subtitle;\n}\n\nexport function generatePopularitySubtitle(\n    hero: PortraitProps,\n    state: PortraitState,\n    detailed: boolean = false\n): any[] {\n    let key = 0;\n    let subtitle: any[] = [];\n    // popularity\n    key = addPopularityLine(state, hero, detailed, subtitle, key);\n    // competition wins\n    key = addCompsLine(hero, subtitle, key);\n    // friendship count / relationship classification titles\n    ({ subtitle, key } = addFriendshipCountTitles(hero, subtitle, key));\n    return subtitle;\n}\n\nfunction addFriendshipCountTitles(hero: PortraitProps, subtitle: any[], key: number) {\n    if (!hero.isEvicted) {\n        const data = getSelectedPlayer() as SelectedPlayerData | null;\n        if (data && data.id !== hero.id) {\n            const titles = friendOrEnemyTitle(hero, data);\n            subtitle = subtitle.concat(titles.map((txt) => <div key={key++}>{txt}</div>));\n        } else {\n            const titles = friendEnemyCountTitle(hero);\n            subtitle = subtitle.concat(titles.map((txt) => <div key={key++}>{txt}</div>));\n        }\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return { subtitle, key };\n}\n\nfunction addPopularityLine(\n    state: { popularity?: number },\n    hero: PortraitProps,\n    detailed: boolean,\n    subtitle: any[],\n    key: number\n) {\n    let popularity = state.popularity;\n    if (popularity && (popularity > 1 || popularity < -1)) {\n        popularity = hero.popularity;\n    }\n    if (popularity && !hero.isEvicted) {\n        let popularitySubtitle = `${roundTwoDigits(popularity)}%`;\n        const deltaPop = getDeltaPopularity(hero, popularity);\n        if (detailed && deltaPop !== 0) {\n            const arrow = deltaPop > 0 ? \" | ↑\" : \" | ↓\";\n            popularitySubtitle += `${arrow} ${deltaPop}%`;\n        }\n        subtitle.push(<div key={key++}>{popularitySubtitle}</div>);\n    }\n    return key;\n}\n\nfunction addCompsLine(hero: PortraitProps, subtitle: any[], key: number) {\n    if (compWins(hero)) {\n        subtitle.push(<div key={key++}>{`${compWins(hero)}`}</div>);\n    } else {\n        subtitle.push(<br key={key++} style={{ lineHeight: 1 }} />);\n    }\n    return key;\n}\n\nfunction getDeltaPopularity(houseguest: PortraitProps, statePopularity: number) {\n    if (roundTwoDigits(houseguest.popularity) !== roundTwoDigits(statePopularity)) {\n        return 0;\n    }\n    return houseguest.deltaPopularity ? roundTwoDigits(houseguest.deltaPopularity) : 0;\n}\n\nfunction compWins(houseguest: ProfileHouseguest): string {\n    return `${houseguest.hohWins ? `♔ ${houseguest.hohWins}` : \"\"}${\n        houseguest.povWins && houseguest.hohWins\n            ? `|🛇 ${houseguest.povWins}`\n            : houseguest.povWins\n            ? `🛇 ${houseguest.povWins}`\n            : \"\"\n    }${(houseguest.hohWins || houseguest.povWins) && houseguest.nominations ? \"|\" : \"\"}${\n        houseguest.nominations ? `✘ ${houseguest.nominations}` : \"\"\n    }`;\n}\n\nfunction friendOrEnemyTitle(hero: PortraitProps, villain: SelectedPlayerData): string[] {\n    const titles: string[] = [];\n    titles.push(\n        RelationshipTypeToSymbol[\n            classifyRelationship(hero.popularity || 0, villain.popularity, hero.relationships![villain.id])\n        ]\n    );\n    return titles;\n}\n\nfunction friendEnemyCountTitle(hero: PortraitProps): string[] {\n    const titles: string[] = [];\n    const count =\n        isWellDefined(hero.friends) && isWellDefined(hero.enemies)\n            ? { friends: hero.friends, enemies: hero.enemies }\n            : { friends: 0, enemies: 0 };\n    titles.push(\n        `${count.friends} ${RelationshipTypeToSymbol[Relationship.Friend]}| ${count.enemies} ${\n            RelationshipTypeToSymbol[Relationship.Enemy]\n        }${hero.targetingMe ? `| 🎯 ${hero.targetingMe}` : \"\"}`\n    );\n    return titles;\n}\n","import { Rgb, interpolateColor } from \"./color\";\nimport { PortraitState, PortraitProps } from \"../components/memoryWall\";\nimport { extremeValues } from \"../utils\";\nimport { generatePopularitySubtitle, generatePowerSubtitle } from \"../components/playerPortrait/subtitle\";\n\nexport interface PortraitDisplayMode {\n    minColor: Rgb;\n    maxColor: Rgb;\n    backgroundColor: (state: PortraitState) => string;\n    generateSubtitle: (props: PortraitProps, state: PortraitState, detailed?: boolean) => any[];\n}\n\nconst popularityMinColor = new Rgb(252, 137, 137);\nconst popularityMaxColor = new Rgb(137, 252, 137);\n\nexport const popularityMode: PortraitDisplayMode = {\n    minColor: popularityMinColor,\n    maxColor: popularityMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const popularity = state.popularity;\n\n        const extremePopularity = extremeValues(popularity);\n        const percent = (extremePopularity + 1) / 2;\n        return interpolateColor(popularityMinColor, popularityMaxColor, percent);\n    },\n    generateSubtitle: generatePopularitySubtitle,\n};\n\nconst powerMaxColor = new Rgb(255, 204, 94);\nconst powerMinColor = new Rgb(192, 181, 255);\nexport const powerMode: PortraitDisplayMode = {\n    minColor: powerMinColor,\n    maxColor: powerMaxColor,\n    backgroundColor: (state: PortraitState) => {\n        const powerRanking = state.powerRanking;\n        if (powerRanking === undefined) return \"\";\n\n        return interpolateColor(powerMinColor, powerMaxColor, powerRanking);\n    },\n    generateSubtitle: generatePowerSubtitle,\n};\n","import React from \"react\";\nimport { PortraitDisplayMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nfunction setDisplayMode(p: PortraitDisplayMode) {\n    displayMode$.next(p);\n}\n\ninterface ViewBarTagProps {\n    mode: PortraitDisplayMode;\n    text: string;\n    disabled?: boolean;\n}\n\nexport class ViewBarTag extends React.Component<ViewBarTagProps, { selected: boolean }> {\n    private sub: Subscription | null = null;\n\n    public constructor(props: ViewBarTagProps) {\n        super(props);\n        this.state = { selected: props.mode === displayMode$.value };\n    }\n\n    public componentDidMount() {\n        this.sub = displayMode$.subscribe({\n            next: (mode) => {\n                if (mode !== this.props.mode) {\n                    this.setState({ selected: false });\n                } else {\n                    this.setState({ selected: true });\n                }\n            },\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    public render() {\n        const name = \"level-item tag is-medium is-light\";\n        const style = getStyle(this.props);\n        return (\n            <span\n                className={name}\n                style={style}\n                onClick={() => {\n                    !this.props.disabled && setDisplayMode(this.props.mode);\n                    !this.props.disabled && this.setState({ selected: true });\n                }}\n            >\n                {styleText(this.props.text, this.state.selected)}\n            </span>\n        );\n    }\n}\n\nfunction styleText(text: string, selected: boolean): JSX.Element {\n    return selected ? <b>{text}</b> : <i>{text}</i>;\n}\n\nfunction getStyle(props: ViewBarTagProps) {\n    return props.disabled\n        ? {}\n        : {\n              background: `linear-gradient(90deg, ${props.mode.minColor.toRgba()} 0%, ${props.mode.maxColor.toRgba()} 100%)`,\n              cursor: \"pointer\",\n          };\n}\n","import React from \"react\";\nimport { popularityMode, powerMode } from \"../../model/portraitDisplayMode\";\nimport { ViewBarTag } from \"./viewBarTag\";\nimport { GameState, inJury } from \"../../model\";\nimport { displayMode$ } from \"../../subjects/subjects\";\n\nexport class ViewsBar extends React.Component<{ gameState: GameState }, {}> {\n    public constructor(props: { gameState: GameState }) {\n        super(props);\n    }\n\n    componentDidUpdate() {\n        if (!inJury(this.props.gameState) && displayMode$.value === powerMode) {\n            displayMode$.next(popularityMode);\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"level is-mobile\" key=\"viewsbar\" style={{ marginBottom: 0 }}>\n                <ViewBarTag mode={popularityMode} text={\"Relationships\"}></ViewBarTag>\n                {inJury(this.props.gameState) && (\n                    <ViewBarTag mode={powerMode} text={\"Power Rankings\"}></ViewBarTag>\n                )}\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { Scene } from \"./scene\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\n\nexport interface InitEpisode {\n    scenes: Scene[];\n    title: string;\n    content: JSX.Element;\n    gameState: GameState;\n    initialGamestate?: GameState;\n    type: EpisodeType;\n}\n\nexport class Episode {\n    readonly scenes: Scene[];\n    readonly title: string;\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly initialGameState: GameState;\n    readonly type: EpisodeType;\n    readonly arrowsEnabled: boolean = true;\n    get render(): JSX.Element {\n        const viewsBar = this.type.hasViewsbar ? <ViewsBar gameState={this.initialGameState} /> : null;\n        return (\n            <div>\n                {viewsBar}\n                {this.content}\n            </div>\n        );\n    }\n\n    constructor(init: InitEpisode) {\n        this.scenes = init.scenes;\n        this.title = init.title;\n        this.content = init.content;\n        this.gameState = init.gameState;\n        this.initialGameState = init.initialGamestate || init.gameState;\n        this.type = init.type;\n    }\n}\n\nexport interface EpisodeType {\n    readonly canPlayWith: (n: number) => boolean;\n    readonly eliminates: number;\n    readonly arrowsEnabled: boolean;\n    readonly hasViewsbar: boolean;\n}\n","import React from \"react\";\nimport { Episode, EpisodeType } from \"./episodes\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { GameState } from \"../../model/gameState\";\n\nconst PregameEpisodeType: EpisodeType = {\n    eliminates: 0,\n    canPlayWith: (n: number) => {\n        return n > 2;\n    },\n    arrowsEnabled: true,\n    hasViewsbar: false,\n};\n\nexport class PregameEpisode extends Episode {\n    readonly title = \"Pregame\";\n    readonly scenes = [];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = PregameEpisodeType;\n\n    public constructor(gameState: GameState) {\n        super({\n            title: \"Pregame\",\n            scenes: [],\n            content: <PregameScreen cast={gameState.houseguests} />,\n            gameState,\n            type: PregameEpisodeType,\n        });\n        this.gameState = gameState;\n        this.content = <PregameScreen cast={gameState.houseguests} />;\n    }\n}\n","import React, { useState } from \"react\";\n\ninterface RandomButtonProps {\n    random: (n: number) => void;\n}\n\nexport function RandomButton(props: RandomButtonProps): JSX.Element {\n    const [number, setNumber] = useState(\"16\");\n    return (\n        <div>\n            <button\n                disabled={number === \"\"}\n                className=\"button is-primary\"\n                onClick={() => props.random(parseInt(number))}\n            >\n                Random\n            </button>\n            <NumericInput value={number} onChange={setNumber} />\n        </div>\n    );\n}\n\ninterface NumericInputProps {\n    value: string;\n    onChange: (newValue: string) => void;\n}\n\nfunction NumericInput(props: NumericInputProps) {\n    return (\n        <input\n            className=\"input\"\n            type=\"text\"\n            style={{ width: \"3em\", marginLeft: 5 }}\n            value={props.value}\n            onChange={event => {\n                const value = event.target.value;\n                if (/^\\d*$/g.test(value)) {\n                    props.onChange(value);\n                }\n            }}\n        />\n    );\n}\n","import styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nexport const HasText = styled.div`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport const Input = styled.input`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\ninterface TextProps {\n    noMargin?: boolean;\n    children?: any;\n}\n\nconst NoMargin = styled.div`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\nconst Center = styled.p`\n    text-align: center;\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n`;\n\nexport function Centered(props: TextProps): JSX.Element {\n    if (props.noMargin) return <NoMargin>{props.children}</NoMargin>;\n    return <Center>{props.children} </Center>;\n}\n\nexport function CenteredBold(props: TextProps): JSX.Element {\n    return (\n        <Centered noMargin={props.noMargin}>\n            <b>{props.children} </b>\n        </Centered>\n    );\n}\n\nexport function CenteredItallic(props: TextProps): JSX.Element {\n    return (\n        <Centered noMargin={props.noMargin}>\n            <i>{props.children} </i>\n        </Centered>\n    );\n}\n","import React from \"react\";\nimport FileDrop from \"react-file-drop\";\nimport { PlayerProfile, GameState } from \"../../model\";\nimport { SetupPortrait } from \"../playerPortrait/setupPortrait\";\nimport { ImportLinks } from \"./importLinks\";\nimport { PregameScreen } from \"../pregameScreen/pregameScreen\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { shuffle } from \"lodash\";\nimport { RandomButton } from \"./randomXButton\";\nimport { selectPlayer } from \"../playerPortrait/selectedPortrait\";\nimport { mainContentStream$, newEpisode, updateCast } from \"../../subjects/subjects\";\nimport { HasText, Input } from \"../layout/text\";\nimport { Centered } from \"../layout/centered\";\n\ninterface CastingScreenState {\n    players: PlayerProfile[];\n}\n\ninterface CastingScreenProps {\n    cast?: PlayerProfile[];\n}\n\nexport class CastingScreen extends React.Component<CastingScreenProps, CastingScreenState> {\n    constructor(props: CastingScreenProps) {\n        super(props);\n        this.state = { players: props.cast || [] };\n    }\n\n    private handleChange(i: number) {\n        return (event: any) => {\n            const newName = event.target.value.replace(/\\r?\\n|\\r/g, \"\");\n            const newState = { ...this.state };\n            newState.players[i] = new PlayerProfile({\n                imageURL: newState.players[i].imageURL,\n                name: newName,\n            });\n            this.setState(newState);\n        };\n    }\n\n    private deleteMethod(i: number) {\n        return () => {\n            const newState = { ...this.state };\n            newState.players.splice(i, 1);\n            this.setState(newState);\n        };\n    }\n\n    private getFiles() {\n        const players = this.state.players;\n        if (!players) {\n            return;\n        }\n        const rows: JSX.Element[] = [];\n        let i = 0;\n        players.forEach((player) =>\n            rows.push(\n                <SetupPortrait\n                    name={player.name}\n                    imageUrl={player.imageURL}\n                    onDelete={this.deleteMethod(i)}\n                    onChange={this.handleChange(i)}\n                    key={(++i).toString()}\n                />\n            )\n        );\n        return <div className=\"columns is-gapless is-mobile is-multiline is-centered\">{rows}</div>;\n    }\n\n    private appendProfiles = (profiles: PlayerProfile[]) => {\n        const newState = { ...this.state };\n        profiles.forEach((profile) => newState.players.push(profile));\n        this.setState(newState);\n    };\n\n    private submit = async () => {\n        updateCast(this.state.players);\n        mainContentStream$.next(<PregameScreen cast={this.state.players} />);\n        selectPlayer(null);\n        await newEpisode(null);\n        await newEpisode(new PregameEpisode(new GameState(this.state.players)));\n    };\n\n    private random = (amount: number) => {\n        let players = this.state.players;\n        players = shuffle(players);\n        players = players.slice(0, amount);\n        this.setState({ players });\n    };\n\n    public render() {\n        return (\n            <FileDrop onDrop={this.handleDrop}>\n                <HasText className=\"level\">\n                    <ImportLinks onSubmit={this.appendProfiles} />\n                    <div className=\"level-item\">\n                        <button className=\"button is-danger\" onClick={() => this.setState({ players: [] })}>\n                            Delete all\n                        </button>\n                    </div>\n                    <div className=\"level-item\">\n                        <RandomButton random={this.random} />\n                    </div>\n                    <div className=\"level-item\">\n                        <button\n                            className=\"button is-primary\"\n                            disabled={this.state.players.length < 3}\n                            onClick={this.submit}\n                        >\n                            Submit\n                        </button>\n                    </div>\n                </HasText>\n                <Input type=\"file\" multiple onChange={this.handleUpload} />\n                {this.state.players.length === 0 && <Centered>~ Drop images ~</Centered>}\n                {this.getFiles()}\n            </FileDrop>\n        );\n    }\n\n    private handleUpload = (event: any) => {\n        this.handleFiles(event.target.files);\n    };\n\n    private handleDrop = (files: FileList | null, event: React.DragEvent) => {\n        if (!files) return;\n        this.handleFiles(files);\n    };\n\n    private handleFiles(files: FileList) {\n        const newState = { ...this.state };\n        for (let i = 0; i < files.length; i++) {\n            const file = files[i];\n            if (file.type.match(/image\\/*/)) {\n                newState.players.push(\n                    new PlayerProfile({\n                        name: file.name.substr(0, file.name.lastIndexOf(\".\")) || file.name,\n                        imageURL: URL.createObjectURL(file),\n                    })\n                );\n            }\n        }\n        this.setState(newState);\n    }\n}\n","import { BehaviorSubject, Subject } from \"rxjs\";\nimport { PregameScreen } from \"../components/pregameScreen/pregameScreen\";\nimport { Episode, PlayerProfile } from \"../model\";\nimport { SelectedPlayerData } from \"../components/playerPortrait/selectedPortrait\";\nimport React from \"react\";\nimport { PortraitDisplayMode, popularityMode } from \"../model/portraitDisplayMode\";\nimport { ColorTheme, lightTheme } from \"../theme/theme\";\n\n// What is currently being displayed.\nexport const mainContentStream$ = new BehaviorSubject(<PregameScreen cast={[]} />);\n// Push episodes to this subject to add them to the sidebar. Null resets everything.\nexport const episodes$ = new BehaviorSubject<Episode | null>(null);\n// Forcibly switches to an episode. Used when adding a new episode.\nexport const switchEpisode$ = new Subject<number>();\nexport function newEpisode(episode: Episode | null) {\n    episodes$.next(episode);\n}\nexport function switchSceneRelative(n: number) {\n    switchEpisode$.next(n);\n}\n// the list of players in the game\nexport const cast$ = new BehaviorSubject<PlayerProfile[]>([]);\nexport function updateCast(newCast: PlayerProfile[]) {\n    cast$.next(newCast);\n}\nexport function getCast(): PlayerProfile[] {\n    return cast$.value;\n}\n// The player that the user has clicked on.\nexport const selectedPlayer$ = new BehaviorSubject<SelectedPlayerData | null>(null);\nexport function getSelectedPlayer() {\n    return selectedPlayer$.value;\n}\n\n// The tab selected on the start of each week.\nexport const weekStartTab$ = new BehaviorSubject<number>(0);\n\n// The display mode selected by the viewsbar.\nexport const displayMode$ = new BehaviorSubject<PortraitDisplayMode>(popularityMode);\n\n// If the screen is fullscreen or not.\nexport const isFullscreen$ = new BehaviorSubject<boolean>(false);\n\n// dark or light mode.\nexport const theme$ = new Subject<ColorTheme>();\n","export interface ColorTheme {\n    name: string;\n    bg: string;\n    text: string;\n    toggleBorder: string;\n    gradient: string;\n    bodyArea: string;\n    link: string;\n    mark: string;\n    overlay: string;\n    evictedCell: string;\n    grayCell: string;\n    winnerCell: string;\n    lightGrayCell: string;\n    runnerUpCell: string;\n    nomineeCell: string;\n    hohCell: string;\n    portraitBorder: string;\n    tableCellBorder: string;\n}\n\nexport const lightTheme: ColorTheme = {\n    name: \"light\",\n    bg: \"#fff\",\n    text: \"#363537\",\n    toggleBorder: \"#FFF\",\n    gradient: \"linear-gradient(#39598A, #79D7ED)\",\n    bodyArea: \"#fff\",\n    link: \"blue\",\n    mark: \"yellow\",\n    overlay: \"fff\",\n    evictedCell: \"#fa8072\",\n    grayCell: \"#eaecf0\",\n    lightGrayCell: \"#f8f9fa\",\n    winnerCell: \"#73fb76\",\n    runnerUpCell: \"#d1e8ef\",\n    nomineeCell: \"#959ffd\",\n    hohCell: \"#CCFFCC\",\n    portraitBorder: \"gray\",\n    tableCellBorder: \"#a2a9b1\",\n};\n\nexport const darkTheme: ColorTheme = {\n    name: \"dark\",\n    bg: \"#121212\",\n    text: \"#FAFAFA\",\n    bodyArea: \"#363537\",\n    toggleBorder: \"#6B8096\",\n    gradient: \"linear-gradient(#091236, #1E215D)\",\n    link: \"lightblue\",\n    mark: \"#7e006d\",\n    overlay: \"#444346\",\n    evictedCell: \"#9d4c43\",\n    grayCell: \"#5e5e5e\",\n    lightGrayCell: \"#404040\",\n    runnerUpCell: \"#9fbec882\",\n    nomineeCell: \"#6c75d0\",\n    winnerCell: \"#00ac04\",\n    hohCell: \"#3f783f\",\n    portraitBorder: \"#484848\",\n    tableCellBorder: \"#53575b\",\n};\n","import React, { useState } from \"react\";\nimport { theme$ } from \"../../subjects/subjects\";\nimport { darkTheme, lightTheme } from \"../../theme/theme\";\n\nexport function ThemeSwitcher() {\n    const [theme, setTheme] = useState(\n        window.matchMedia && window.matchMedia(\"(prefers-color-scheme: dark)\").matches ? \"dark\" : \"light\"\n    );\n    const toggleTheme = () => {\n        if (theme === \"light\") {\n            setTheme(\"dark\");\n            theme$.next(darkTheme);\n        } else {\n            setTheme(\"light\");\n            theme$.next(lightTheme);\n        }\n    };\n\n    const className = `button ${theme === \"dark\" ? `is-dark` : \"is-light\"}`;\n    return (\n        <div className={className} onClick={toggleTheme}>\n            {theme === \"light\" ? \"Dark mode\" : \"Light mode\"}\n        </div>\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { ColorTheme } from \"../../theme/theme\";\n\nconst ShadowBox = styled.div`\n    box-shadow: ${({ theme }: { theme: ColorTheme }) =>\n        theme.name === \"light\" ? \"0 2px 3px rgba(10, 10, 10, 0.1), 0 0 0 1px rgba(10, 10, 10, 0.1)\" : \"\"};\n    border-radius: 6px;\n    margin-left: 3px;\n    margin-right: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.overlay};\n`;\n\nconst StyledBox = styled.div`\n    margin-left: 3px;\n    margin-right: 3px;\n    margin-bottom: 3px;\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bodyArea};\n`;\n\nexport function DividerBox(props: any): JSX.Element {\n    return <ShadowBox className={props.className || \"\"}>{props.children}</ShadowBox>;\n}\n\nexport function Box(props: any): JSX.Element {\n    return (\n        <StyledBox style={props.style} className={`box ${props.className || \"\"}`}>\n            {props.children}\n        </StyledBox>\n    );\n}\n","import React, { useCallback } from \"react\";\nimport ReactPaginate from \"react-paginate\";\nimport { HasText } from \"../layout/text\";\nimport { shuffle, ceil, debounce } from \"lodash\";\nimport { PlayerProfile } from \"../../model\";\nimport { mainContentStream$ } from \"../../subjects/subjects\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport _ from \"lodash\";\nimport styled from \"styled-components\";\n\ninterface DeckScreenProps {}\n\ninterface DeckScreenState {\n    loading: boolean;\n    decks: string[];\n    i: number;\n    debouncedSearchText: string;\n    searchText: string;\n}\n\nconst decksPerPage = 26;\nconst baseUrl = \"https://spaulmark.github.io/img/\";\n\nconst imageCache: { [id: string]: string } = {};\n\nconst DeckStyle = styled(HasText)`\n    display: flex;\n    cursor: pointer;\n    align-items: center;\n    :hover {\n        color: red;\n        background-color: #ffe1ea;\n    }\n`;\n\nconst Centered = styled.div`\n    display: flex;\n    justify-content: center;\n    align-items: center;\n`;\n\nconst DeckText = styled.p`\n    margin-left: 1rem;\n`;\n\n// TODO: add a search bar, add a sort alphebetically function.\n\nasync function randomImageFromFolder(folder: string) {\n    if (imageCache[folder]) return imageCache[folder];\n    const links = await (await fetch(`${baseUrl}${folder}/dir.json`)).json();\n    const image = _.sample(links[\"files\"]);\n    imageCache[folder] = `${baseUrl}${folder}/${image}`;\n    return `${baseUrl}${folder}/${image}`;\n}\n\nasync function selectCast(folder: string) {\n    const links = await (await fetch(`${baseUrl}${folder}/dir.json`)).json();\n    const imageLinks = links[\"files\"].map((file: string) => {\n        return { name: file, url: `${baseUrl}${folder}/${file}` };\n    });\n    const playerProfiles = imageLinks.map((image: { name: string; url: string }) => {\n        return new PlayerProfile({\n            name: image.name.substr(0, image.name.lastIndexOf(\".\")) || image.name,\n            imageURL: image.url,\n        });\n    });\n    mainContentStream$.next(<CastingScreen cast={playerProfiles} />);\n}\n\nfunction Deck(props: { deck: string }): JSX.Element {\n    const [img, setImage] = React.useState(\"\");\n    const [loading, setLoading] = React.useState(true);\n    const deck = props.deck;\n\n    if (loading)\n        randomImageFromFolder(deck).then((img) => {\n            setLoading(false);\n            setImage(img);\n        });\n    return (\n        <DeckStyle className=\"column is-6\" onClick={() => selectCast(deck)}>\n            <img src={img} style={{ width: 50, height: 50 }} />\n            <DeckText>{deck}</DeckText>\n        </DeckStyle>\n    );\n}\n\nfunction DeckList(props: { data: string[]; i: number }): JSX.Element {\n    let commentNodes: JSX.Element[] = [];\n    const i = props.i;\n    const data = props.data;\n    const min = i * decksPerPage;\n    for (let j = min; j < min + decksPerPage; j++) {\n        const deck = data[j];\n        if (!deck) continue;\n        commentNodes.push(<Deck key={`${deck}__${i}__${j}`} deck={deck} />);\n    }\n    return (\n        <div key={\"__ul__\"} className={\"columns is-multiline\"}>\n            {commentNodes}\n        </div>\n    );\n}\n\nexport class DeckScreen extends React.Component<DeckScreenProps, DeckScreenState> {\n    constructor(props: DeckScreenProps) {\n        super(props);\n        this.state = { loading: true, decks: [], i: 0, debouncedSearchText: \"\", searchText: \"\" };\n    }\n    async componentDidMount() {\n        const data = await (await fetch(\"https://spaulmark.github.io/img/dir.json\")).json();\n        this.setState({ decks: shuffle(data.decks), loading: false });\n    }\n\n    private handlePageClick = (page: { selected: number }) => {\n        this.setState({ i: page.selected });\n    };\n\n    private debounceSearch = debounce((nextValue: string) => {\n        this.setState({ debouncedSearchText: nextValue, i: 0 });\n    }, 250);\n\n    private handleSearch = (event: { target: { value: string } }) => {\n        this.setState({ searchText: event.target.value });\n        this.debounceSearch(event.target.value);\n    };\n\n    render() {\n        if (this.state.loading) return <div />;\n        const decks = this.state.decks.filter((deck) =>\n            deck.toLowerCase().match(this.state.debouncedSearchText.toLowerCase())\n        );\n        return (\n            <div>\n                <div>\n                    <input\n                        style={{ marginBottom: \"1.5rem\", minWidth: \"50%\" }}\n                        className=\"input\"\n                        type=\"text\"\n                        placeholder=\"Search...\"\n                        onChange={this.handleSearch}\n                        value={this.state.searchText}\n                    ></input>\n                </div>\n                <DeckList key={\"comments\"} data={decks} i={this.state.i} />\n                <Centered>\n                    <ReactPaginate\n                        key={\"__list__\"}\n                        previousLabel={\"previous\"}\n                        nextLabel={\"next\"}\n                        breakLabel={\"...\"}\n                        breakClassName={\"break-me\"}\n                        pageCount={ceil(decks.length / decksPerPage)}\n                        marginPagesDisplayed={2}\n                        pageRangeDisplayed={3}\n                        onPageChange={this.handlePageClick}\n                        containerClassName={\"pagination\"}\n                        activeClassName={\"active\"}\n                    />\n                </Centered>\n            </div>\n        );\n    }\n}\n","import React from \"react\";\nimport { CastingScreen } from \"../castingScreen/castingScreen\";\nimport { mainContentStream$, getCast } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\nimport { ThemeSwitcher } from \"./themeSwitch\";\nimport { ColorTheme } from \"../../theme/theme\";\nimport { Box } from \"../layout/box\";\nimport { DeckScreen } from \"../deckScreen/deckScreen\";\n\nconst TopbarLink = styled.div`\n    color: ${({ theme }: { theme: ColorTheme }) => theme.link};\n    cursor: pointer;\n`;\n\nexport function AdvancedEditLink(): JSX.Element {\n    return (\n        <TopbarLink\n            onClick={() => {\n                mainContentStream$.next(<CastingScreen cast={getCast()} />);\n            }}\n        >\n            Edit / Upload Cast\n        </TopbarLink>\n    );\n}\n\nexport function ChooseCastLink(): JSX.Element {\n    return (\n        <TopbarLink\n            onClick={() => {\n                mainContentStream$.next(<DeckScreen />);\n            }}\n        >\n            Choose Cast\n        </TopbarLink>\n    );\n}\n\nexport function Topbar(props: { style?: any }): JSX.Element {\n    const style = { ...(props.style || {}) };\n    return (\n        <Box className=\"level is-mobile\" style={style}>\n            <div className=\"level-item\">\n                <ChooseCastLink />\n            </div>\n            <div className=\"level-item\">\n                <AdvancedEditLink />\n            </div>\n            <div className=\"level-item\">\n                <ThemeSwitcher />\n            </div>\n        </Box>\n    );\n}\n","import React from \"react\";\nimport { PlayerProfile } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { ChooseCastLink } from \"../topbar/topBar\";\nimport { HasText } from \"../layout/text\";\nimport { popularityMode } from \"../../model/portraitDisplayMode\";\nimport { displayMode$ } from \"../../subjects/subjects\";\n\ninterface PregameScreenProps {\n    cast: PlayerProfile[];\n}\n\nexport class PregameScreen extends React.Component<PregameScreenProps, {}> {\n    public componentDidMount() {\n        displayMode$.next(popularityMode);\n    }\n\n    public render() {\n        const props = this.props;\n        if (props.cast.length === 0) {\n            return (\n                <HasText>\n                    Cast is empty. <ChooseCastLink />\n                </HasText>\n            );\n        }\n        return (\n            <HasText>\n                <MemoryWall houseguests={props.cast} />\n                <p>\n                    <b> {\"You can use the <- and -> arrow keys to move forwards and backwards.\"}</b>\n                </p>\n                <NextEpisodeButton />\n            </HasText>\n        );\n    }\n}\n","import prand from \"pure-rand\";\nimport { BehaviorSubject } from \"rxjs\";\nimport { hashcode } from \"./utilities\";\nimport { cast$ } from \"../subjects/subjects\";\n\nexport class BbRandomGenerator {\n    private rng: prand.RandomGenerator;\n\n    // returns a random number between 0 and 1.\n    public randomFloat(): number {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result / 2147483647.0;\n    }\n\n    public randomInt(a: number, b: number): number {\n        let result: number;\n        [result, this.rng] = prand.uniformIntDistribution(a, b, this.rng);\n        return result;\n    }\n\n    public flipCoin(): boolean {\n        let result: number;\n        [result, this.rng] = this.rng.next();\n        return result % 2 === 0;\n    }\n\n    public seed(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n\n    public constructor(seed: number) {\n        this.rng = prand.xorshift128plus(seed);\n    }\n}\n\nexport function rng() {\n    return rng$.value;\n}\n\nconst rng$ = new BehaviorSubject(new BbRandomGenerator(0));\n\nconst castSub = cast$.subscribe({\n    next: (cast) => {\n        let castNames = \"\";\n        cast.forEach((houseguest) => (castNames += houseguest.name));\n        rng$.next(new BbRandomGenerator(hashcode(castNames)));\n    },\n});\n","import { Houseguest } from \"./houseguest\";\nimport { PlayerProfile } from \"./playerProfile\";\nimport _ from \"lodash\";\nimport { newRelationshipMap, rng } from \"../utils\";\nimport { finalJurySize, getFinalists } from \"./season\";\nimport { EpisodeLog } from \"./logging/episodelog\";\nimport { Cliques } from \"../utils/generateCliques\";\n\nexport function getById(gameState: GameState, id: number): Houseguest {\n    return gameState.houseguestCache[id];\n}\n\nexport function exclude(inclusions: Houseguest[], exclusions: Houseguest[]) {\n    const excludedIds = exclusions.map((hg) => hg.id);\n    return inclusions.filter((hg) => !excludedIds.includes(hg.id) && !hg.isEvicted);\n}\n\nexport function randomPlayer(inclusions: Houseguest[], exclusions: Houseguest[] = []): Houseguest {\n    if (inclusions.length === 0) {\n        throw new Error(\"Tried to get a random player from a list of 0 players.\");\n    }\n    const options = exclude(inclusions, exclusions);\n    const choice = rng().randomInt(0, options.length - 1);\n\n    return options[choice];\n}\n\nexport function nonEvictedHouseguests(gameState: GameState): Houseguest[] {\n    return [...gameState.nonEvictedHouseguests.entries()].map(([_, id]) => getById(gameState, id));\n}\nexport function getJurors(gameState: GameState): Houseguest[] {\n    return gameState.houseguests.filter((hg) => hg.isJury);\n}\n\nexport function inJury(gameState: GameState): Boolean {\n    return gameState.remainingPlayers - getFinalists() <= finalJurySize();\n}\n\nexport function calculatePopularity(hero: Houseguest, house: Houseguest[]) {\n    let sum = 0;\n    let count = 0;\n    const targetId = hero.id;\n    house.forEach((houseguest) => {\n        if (houseguest.id !== targetId) {\n            count++;\n            sum += houseguest.relationships[targetId];\n        }\n    });\n    return count === 0 ? 0 : sum / count;\n}\n\nexport class GameState {\n    // Current state of the game after a phase.\n\n    readonly houseguestCache: { [id: number]: Houseguest } = {};\n    readonly nonEvictedHouseguests: Set<number> = new Set<number>();\n    readonly houseguests: Houseguest[] = [];\n    readonly remainingPlayers: number = 0;\n    readonly phase: number = 0;\n    readonly previousHOH?: Houseguest;\n    readonly log: EpisodeLog[] = [];\n    readonly cliques: Cliques[] = [];\n    get currentLog() {\n        return this.log[this.phase];\n    }\n\n    public constructor(init: PlayerProfile[] | GameState) {\n        if (!(init instanceof Array)) {\n            Object.assign(this, init);\n        } else {\n            const profiles = init as PlayerProfile[];\n            this.remainingPlayers = profiles.length;\n            profiles.forEach((profile, i) => {\n                const hg: Houseguest = new Houseguest({\n                    ...profile,\n                    id: i,\n                    relationships: newRelationshipMap(profiles.length, i),\n                });\n                this.nonEvictedHouseguests.add(i);\n                this.houseguestCache[i] = hg;\n                this.houseguests.push(hg);\n            });\n        }\n    }\n}\n\nexport class MutableGameState {\n    public houseguests: Houseguest[] = [];\n    public houseguestCache: { [id: number]: Houseguest } = {};\n    readonly nonEvictedHouseguests: Set<number> = new Set<number>();\n    public remainingPlayers: number = 0;\n    public phase: number = 0;\n    public previousHOH?: Houseguest;\n    public cliques: Cliques[] = [];\n    public log: EpisodeLog[] = [];\n    get currentLog() {\n        return this.log[this.phase];\n    }\n\n    public constructor(init: GameState | MutableGameState) {\n        const copy = _.cloneDeep(init);\n        Object.assign(this, copy);\n    }\n}\n","import { BigBrotherVanilla } from \"../components/episode/bigBrotherEpisode\";\nimport { EpisodeFactory } from \"../components/episode/episodeFactory\";\nimport { GameState } from \"./gameState\";\nimport { Episode } from \".\";\nimport { BigBrotherFinale } from \"../components/episode/bigBrotherFinale\";\nimport { cast$ } from \"../subjects/subjects\";\nimport { GameOver } from \"../components/episode/gameOver\";\n\nexport function finalJurySize() {\n    return jurors;\n}\n\n// 7 is not a magic number: it is just an arbitrary value which is always overwritten by cast$ before it is read.\nlet jurors = 7;\n\nconst sub = cast$.subscribe({\n    next: (newCast) => {\n        let players = newCast.length;\n        players = Math.round(players * 0.55);\n        if (players % 2 === 0) {\n            players--;\n        }\n        jurors = players;\n    },\n});\n\nexport function getFinalists() {\n    return 2;\n}\n\nexport class Season {\n    private factory: EpisodeFactory;\n\n    public constructor() {\n        this.factory = new EpisodeFactory();\n    }\n\n    // In the future, this would all be customizable,\n    // and not just all big brother episodes by default.\n\n    // TODO: I think the way to do this would be to have season asnycronously generate all episodes here,\n    // and then store them in an array,\n    // and then when sidebar calls renderEpisode, I can just pluck them from a pre-calculated array.\n    // The problem being that if it's not there, it's just not there.\n\n    // then maybe renderEpisode needs to become async?\n    // wait\n    // maybe as i generate them\n    /// obviously i generate episode 1 first\n    // then i have a hanging async function that is like \"get episode 2\"\n    // and it literally just is an awaiting or something? idk\n\n    // like if its array of async () => episode\n    // then if there is NO episode\n    // and the generator is still generating episode 2, then\n\n    //maybe it uses subjects or something\n\n    public renderEpisode(gameState: GameState): Episode {\n        return this.factory.nextEpisode(gameState, this.whichEpisodeType(gameState.remainingPlayers));\n    }\n\n    public whichEpisodeType(players: number) {\n        if (players === 3) {\n            return BigBrotherFinale;\n        }\n        if (players === 2) {\n            return GameOver;\n        }\n        return BigBrotherVanilla;\n    }\n}\n","import React from \"react\";\nimport { GameState } from \"../../model/gameState\";\nimport { ViewsBar } from \"../viewsBar/viewBar\";\ninterface InitScene {\n    readonly title: string;\n    readonly gameState: GameState;\n    readonly content: JSX.Element;\n}\nexport class Scene {\n    readonly title: string = \"\";\n    readonly gameState: GameState = new GameState([]);\n    readonly content: JSX.Element = (<div>{`Error while rendering ${this.title}`}</div>);\n    public render: JSX.Element;\n    public constructor(init: Partial<InitScene>) {\n        Object.assign(this, init);\n        this.render = (\n            <div>\n                <ViewsBar gameState={this.gameState} />\n                {this.content}\n            </div>\n        );\n    }\n}\n","/*\n * Free FFT and convolution (TypeScript)\n *\n * Copyright (c) 2020 Project Nayuki. (MIT License)\n * https://www.nayuki.io/page/free-small-fft-in-multiple-languages\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\n * this software and associated documentation files (the \"Software\"), to deal in\n * the Software without restriction, including without limitation the rights to\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\n * the Software, and to permit persons to whom the Software is furnished to do so,\n * subject to the following conditions:\n * - The above copyright notice and this permission notice shall be included in\n *   all copies or substantial portions of the Software.\n * - The Software is provided \"as is\", without warranty of any kind, express or\n *   implied, including but not limited to the warranties of merchantability,\n *   fitness for a particular purpose and noninfringement. In no event shall the\n *   authors or copyright holders be liable for any claim, damages or other\n *   liability, whether in an action of contract, tort or otherwise, arising from,\n *   out of or in connection with the Software or the use or other dealings in the\n *   Software.\n */\n\n/*\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\n * The vector can have any length. This is a wrapper function.\n */\nexport function fft(real: number[] | Float64Array, imag: number[] | Float64Array): void {\n    const n: number = real.length;\n    if (n != imag.length) throw \"Mismatched lengths\";\n    if (n == 0) return;\n    else if ((n & (n - 1)) == 0)\n        // Is power of 2\n        transformRadix2(real, imag);\n    // More complicated algorithm for arbitrary sizes\n    else transformBluestein(real, imag);\n}\n\n/*\n * Computes the inverse discrete Fourier transform (IDFT) of the given complex vector, storing the result back into the vector.\n * The vector can have any length. This is a wrapper function. This transform does not perform scaling, so the inverse is not a true inverse.\n */\nexport function inverseFFT(real: Array<number> | Float64Array, imag: Array<number> | Float64Array): void {\n    fft(imag, real);\n}\n\n/*\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\n * The vector's length must be a power of 2. Uses the Cooley-Tukey decimation-in-time radix-2 algorithm.\n */\nfunction transformRadix2(real: Array<number> | Float64Array, imag: Array<number> | Float64Array): void {\n    // Length variables\n    const n: number = real.length;\n    if (n != imag.length) throw \"Mismatched lengths\";\n    if (n == 1)\n        // Trivial transform\n        return;\n    let levels: number = -1;\n    for (let i = 0; i < 32; i++) {\n        if (1 << i == n) levels = i; // Equal to log2(n)\n    }\n    if (levels == -1) throw \"Length is not a power of 2\";\n\n    // Trigonometric tables\n    let cosTable = new Array<number>(n / 2);\n    let sinTable = new Array<number>(n / 2);\n    for (let i = 0; i < n / 2; i++) {\n        cosTable[i] = Math.cos((2 * Math.PI * i) / n);\n        sinTable[i] = Math.sin((2 * Math.PI * i) / n);\n    }\n\n    // Bit-reversed addressing permutation\n    for (let i = 0; i < n; i++) {\n        const j: number = reverseBits(i, levels);\n        if (j > i) {\n            let temp: number = real[i];\n            real[i] = real[j];\n            real[j] = temp;\n            temp = imag[i];\n            imag[i] = imag[j];\n            imag[j] = temp;\n        }\n    }\n\n    // Cooley-Tukey decimation-in-time radix-2 FFT\n    for (let size = 2; size <= n; size *= 2) {\n        const halfsize: number = size / 2;\n        const tablestep: number = n / size;\n        for (let i = 0; i < n; i += size) {\n            for (let j = i, k = 0; j < i + halfsize; j++, k += tablestep) {\n                const l: number = j + halfsize;\n                const tpre: number = real[l] * cosTable[k] + imag[l] * sinTable[k];\n                const tpim: number = -real[l] * sinTable[k] + imag[l] * cosTable[k];\n                real[l] = real[j] - tpre;\n                imag[l] = imag[j] - tpim;\n                real[j] += tpre;\n                imag[j] += tpim;\n            }\n        }\n    }\n\n    // Returns the integer whose value is the reverse of the lowest 'width' bits of the integer 'val'.\n    function reverseBits(val: number, width: number): number {\n        let result: number = 0;\n        for (let i = 0; i < width; i++) {\n            result = (result << 1) | (val & 1);\n            val >>>= 1;\n        }\n        return result;\n    }\n}\n\n/*\n * Computes the discrete Fourier transform (DFT) of the given complex vector, storing the result back into the vector.\n * The vector can have any length. This requires the convolution function, which in turn requires the radix-2 FFT function.\n * Uses Bluestein's chirp z-transform algorithm.\n */\nfunction transformBluestein(real: Array<number> | Float64Array, imag: Array<number> | Float64Array): void {\n    // Find a power-of-2 convolution length m such that m >= n * 2 + 1\n    const n: number = real.length;\n    if (n != imag.length) throw \"Mismatched lengths\";\n    let m: number = 1;\n    while (m < n * 2 + 1) m *= 2;\n\n    // Trigonometric tables\n    let cosTable = new Array<number>(n);\n    let sinTable = new Array<number>(n);\n    for (let i = 0; i < n; i++) {\n        const j: number = (i * i) % (n * 2); // This is more accurate than j = i * i\n        cosTable[i] = Math.cos((Math.PI * j) / n);\n        sinTable[i] = Math.sin((Math.PI * j) / n);\n    }\n\n    // Temporary vectors and preprocessing\n    let areal: Array<number> = newArrayOfZeros(m);\n    let aimag: Array<number> = newArrayOfZeros(m);\n    for (let i = 0; i < n; i++) {\n        areal[i] = real[i] * cosTable[i] + imag[i] * sinTable[i];\n        aimag[i] = -real[i] * sinTable[i] + imag[i] * cosTable[i];\n    }\n    let breal: Array<number> = newArrayOfZeros(m);\n    let bimag: Array<number> = newArrayOfZeros(m);\n    breal[0] = cosTable[0];\n    bimag[0] = sinTable[0];\n    for (let i = 1; i < n; i++) {\n        breal[i] = breal[m - i] = cosTable[i];\n        bimag[i] = bimag[m - i] = sinTable[i];\n    }\n\n    // Convolution\n    let creal = new Array<number>(m);\n    let cimag = new Array<number>(m);\n    convolveComplex(areal, aimag, breal, bimag, creal, cimag);\n\n    // Postprocessing\n    for (let i = 0; i < n; i++) {\n        real[i] = creal[i] * cosTable[i] + cimag[i] * sinTable[i];\n        imag[i] = -creal[i] * sinTable[i] + cimag[i] * cosTable[i];\n    }\n}\n\n/*\n * Computes the circular convolution of the given real vectors. Each vector's length must be the same.\n */\nfunction convolveReal(\n    xvec: Array<number> | Float64Array,\n    yvec: Array<number> | Float64Array,\n    outvec: Array<number> | Float64Array\n): void {\n    const n: number = xvec.length;\n    if (n != yvec.length || n != outvec.length) throw \"Mismatched lengths\";\n    convolveComplex(xvec, newArrayOfZeros(n), yvec, newArrayOfZeros(n), outvec, newArrayOfZeros(n));\n}\n\n/*\n * Computes the circular convolution of the given complex vectors. Each vector's length must be the same.\n */\nfunction convolveComplex(\n    xreal: Array<number> | Float64Array,\n    ximag: Array<number> | Float64Array,\n    yreal: Array<number> | Float64Array,\n    yimag: Array<number> | Float64Array,\n    outreal: Array<number> | Float64Array,\n    outimag: Array<number> | Float64Array\n): void {\n    const n: number = xreal.length;\n    if (\n        n != ximag.length ||\n        n != yreal.length ||\n        n != yimag.length ||\n        n != outreal.length ||\n        n != outimag.length\n    )\n        throw \"Mismatched lengths\";\n\n    xreal = xreal.slice();\n    ximag = ximag.slice();\n    yreal = yreal.slice();\n    yimag = yimag.slice();\n    fft(xreal, ximag);\n    fft(yreal, yimag);\n\n    for (let i = 0; i < n; i++) {\n        const temp: number = xreal[i] * yreal[i] - ximag[i] * yimag[i];\n        ximag[i] = ximag[i] * yreal[i] + xreal[i] * yimag[i];\n        xreal[i] = temp;\n    }\n    inverseFFT(xreal, ximag);\n\n    for (let i = 0; i < n; i++) {\n        // Scaling (because this FFT implementation omits it)\n        outreal[i] = xreal[i] / n;\n        outimag[i] = ximag[i] / n;\n    }\n}\n\nfunction newArrayOfZeros(n: number): Array<number> {\n    let result: Array<number> = [];\n    for (let i = 0; i < n; i++) result.push(0);\n    return result;\n}\n","// Homebrew typescript implementation of this:\n// https://www.researchgate.net/publication/257017356_On_computing_the_distribution_function_for_the_Poisson_binomial_distribution?enrichId=rgreq-6ff78e1a69dcaf49a733e2dd0e9f2db6-XXX&enrichSource=Y292ZXJQYWdlOzI1NzAxNzM1NjtBUzo1NTg0MDU5OTE1MzA0OTZAMTUxMDE0NTc3MTQ0Mw%3D%3D&el=1_x_3&_esc=publicationCoverPdf\n\nimport _ from \"lodash\";\nimport { fft } from \"./fft\";\n\n// Due to the high complexity of this function, it has been optimized for readability.\n// And even then, it's still pretty spooky.\n\nexport function pbincdf(pp: number[]): number[] {\n    const p: number[] = [];\n    const zeros: number[] = [];\n    const ones: number[] = [];\n    pp.forEach((num) => {\n        num === 0 && zeros.push(0);\n        num === 1 && ones.push(1);\n        num !== 0 && num !== 1 && p.push(num);\n    });\n    const cdf = _pbincdf(p);\n    cdf.forEach((number, i) => (cdf[i] = 1 - number));\n    const result = ones.concat(cdf, zeros);\n    return result;\n}\n\nfunction _pbincdf(p: number[]): number[] {\n    const n = p.length;\n    const nPlusOne = n + 1;\n    const ω = (2 * Math.PI) / nPlusOne;\n    const a = [1];\n    const b = [0];\n    // STEP 1 OF THE ALGORITHM\n    const sigmaLogModulusZ = (l: number): number => {\n        let sum = 0;\n        p.forEach((p_j) => {\n            const e1 = (1 - p_j + p_j * Math.cos(ω * l)) ** 2;\n            const e2 = (p_j * Math.sin(ω * l)) ** 2;\n            sum += 0.5 * Math.log(e1 + e2);\n        });\n        return sum;\n    };\n    const sigmaPrincipalArgz = (l: number): number => {\n        let sum = 0;\n        p.forEach((p_j) => {\n            const y = p_j * Math.sin(ω * l);\n            const x = 1 - p_j + p_j * Math.cos(ω * l);\n            sum += Math.atan2(y, x);\n        });\n        return sum;\n    };\n    for (let l = 1; l <= Math.ceil(n / 2); l++) {\n        const d = Math.exp(sigmaLogModulusZ(l));\n        const sigmaArgZ = sigmaPrincipalArgz(l);\n        a[l] = d * Math.cos(sigmaArgZ);\n        b[l] = d * Math.sin(sigmaArgZ);\n    }\n    // STEP 2 OF THE ALGORITHM\n    for (let l = Math.ceil(n / 2) + 1; l <= n; l++) {\n        a[l] = a[nPlusOne - l];\n        b[l] = -b[nPlusOne - l];\n    }\n    // STEP 3 OF THE ALGORITHM\n    fft(a, b);\n    const ξ = a;\n    // STEP 4 OF THE ALGORITHM\n    const result: number[] = [];\n    ξ.forEach((a, i) => (ξ[i] = a / nPlusOne));\n    result[0] = ξ[0];\n    ξ.forEach((_, m) => {\n        if (m === 0) return;\n        result[m] = result[m - 1] + ξ[m];\n    });\n    return result;\n}\n","import { Houseguest, inJury, GameState } from \"../../model\";\nimport { pbincdf } from \"../poissonbinomial\";\nimport { MAGIC_SUPERIOR_NUMBER, pJurorVotesForHero } from \"./aiApi\";\n\nexport const relationship = (hero: Houseguest, villain: Houseguest) => hero.relationships[villain.id];\n\nexport function favouriteIndex(hero: Houseguest, options: Houseguest[]) {\n    // Return the index of the houseguest that hero has the best relationship with.\n    return highestScore(hero, options, relationship);\n}\n\nfunction highestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let highestIndex = 0;\n    let highestScore = -Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore > highestScore) {\n            highestIndex = i;\n            highestScore = currentScore;\n        }\n    });\n    return highestIndex;\n}\nexport function lowestScore(\n    hero: Houseguest,\n    options: Houseguest[],\n    callback: (hero: Houseguest, villain: Houseguest) => number\n) {\n    let lowestIndex = 0;\n    let lowestScore = Infinity;\n    options.forEach((villain, i) => {\n        const currentScore = callback(hero, villain);\n        if (currentScore < lowestScore) {\n            lowestIndex = i;\n            lowestScore = currentScore;\n        }\n    });\n    return lowestIndex;\n}\n\n// returns the probability that the hero wins the f2 between hero and villian\nexport function pHeroWinsTheFinale(\n    hgs: { hero: Houseguest; villain: Houseguest },\n    jury: Houseguest[]\n): number {\n    const hero = hgs.hero;\n    const villain = hgs.villain;\n    const p: number[] = [];\n    jury.forEach((juror) => {\n        if (juror.id === hero.id || juror.id === villain.id) return;\n        p.push(pJurorVotesForHero(juror, hero, villain));\n    });\n    const cdf = pbincdf(p);\n    return cdf[Math.ceil((jury.length - 2) / 2) - 1];\n}\n\nexport function heroShouldTargetSuperiors(hero: Houseguest, gameState: GameState): boolean {\n    const opponents = gameState.remainingPlayers - 1;\n    const superiors = hero.superiors.size;\n    const inferiors = opponents - superiors;\n\n    if (opponents <= 5) return true;\n    return inferiors / opponents < 2 / 3;\n}\n","import { GameState, Houseguest, inJury } from \"../../model\";\nimport { MAGIC_SUPERIOR_NUMBER } from \"./aiApi\";\nimport { heroShouldTargetSuperiors } from \"./aiUtils\";\nimport { classifyRelationship, RelationshipType } from \"./classifyRelationship\";\n\ninterface RelationshipSummary {\n    type: RelationshipType;\n    relationship: number;\n    id: number;\n    doIWin: boolean;\n    villainPopularity: number;\n}\n\nconst deadValue: RelationshipSummary = {\n    type: RelationshipType.Friend,\n    id: -1,\n    doIWin: true,\n    relationship: 2,\n    villainPopularity: 2,\n};\n\nexport function getRelationshipSummary(hero: Houseguest, villain: Houseguest): RelationshipSummary {\n    const doIWin = !(hero.superiors[villain.id] > MAGIC_SUPERIOR_NUMBER);\n    const type = classifyRelationship(hero.popularity, villain.popularity, hero.relationshipWith(villain));\n    return {\n        id: villain.id,\n        relationship: villain.relationshipWith(hero),\n        type,\n        doIWin,\n        villainPopularity: villain.popularity,\n    };\n}\n\nexport class Targets {\n    private firstTarget: RelationshipSummary = deadValue;\n    private secondTarget: RelationshipSummary = deadValue;\n    private hg: Houseguest;\n\n    constructor(hg: Houseguest) {\n        this.hg = hg;\n    }\n\n    public getTargets(): [number, number] {\n        return [this.firstTarget.id, this.secondTarget.id];\n    }\n    public addTarget(newTarget: RelationshipSummary, gameState: GameState) {\n        if (\n            !(\n                isBetterTarget(this.firstTarget, newTarget, this.hg, gameState) ||\n                isBetterTarget(this.secondTarget, newTarget, this.hg, gameState)\n            )\n        )\n            return;\n        isBetterTarget(this.firstTarget, this.secondTarget, this.hg, gameState)\n            ? (this.firstTarget = newTarget)\n            : (this.secondTarget = newTarget);\n    }\n}\n\n// Statusquo goes with the status quo, underdog tries to disrupt & go after big targets, MoR goes after his personal targets\nexport enum TargetStrategy {\n    StatusQuo,\n    Underdog,\n    MoR,\n}\n\nexport function determineStrategy(hero: Houseguest): TargetStrategy {\n    if (hero.friends === hero.enemies) return TargetStrategy.MoR;\n    return hero.friends > hero.enemies ? TargetStrategy.StatusQuo : TargetStrategy.Underdog;\n}\n\nexport function isBetterTarget(\n    old: RelationshipSummary,\n    neww: RelationshipSummary,\n    hero: Houseguest,\n    gameState: GameState\n): boolean {\n    if (old.relationship === 2) return true;\n    const strategy = determineStrategy(hero);\n    if (strategy === TargetStrategy.StatusQuo)\n        return isBetterTargetStatusQuo(\n            old,\n            neww,\n            inJury(gameState) && heroShouldTargetSuperiors(hero, gameState)\n        );\n    else if (strategy === TargetStrategy.MoR) {\n        return isBetterTargetMoR(old, neww);\n    } else {\n        return isBetterTargetUnderdog(old, neww);\n    }\n}\n\nfunction isBetterTargetMoR(old: RelationshipSummary, neww: RelationshipSummary): boolean {\n    // Is the old target a non-enemy? Then neww is a better target if he is an enemy, or if he's a worse non-enemy.\n    if (old.type !== RelationshipType.Enemy) {\n        return neww.type === RelationshipType.Enemy ? true : neww.relationship < old.relationship;\n    }\n    // So, the old target is an enemy? Then neww must be an enemy to be a better target.\n    // If they are both enemies, the more popular enemy is a better target.\n    return neww.type !== RelationshipType.Enemy ? false : old.villainPopularity < neww.villainPopularity;\n}\n\nfunction isBetterTargetUnderdog(old: RelationshipSummary, neww: RelationshipSummary): boolean {\n    // Is the old target a friend? Then neww is a better target if he is NOT a friend, or if he's a worse friend.\n    if (old.type === RelationshipType.Friend) {\n        return neww.type !== RelationshipType.Friend ? true : neww.relationship < old.relationship;\n    }\n\n    // So, the old target isn't a friend? Then neww will never be a better target if he is a friend.\n    // But if neww isn't a friend, then the best target is the most popular guy.\n    return neww.type === RelationshipType.Friend ? false : old.villainPopularity < neww.villainPopularity;\n}\n\nfunction isBetterTargetStatusQuo(old: RelationshipSummary, neww: RelationshipSummary, jury: boolean) {\n    const newRank = rankRelationshipSummaryStatusQuo(neww, jury);\n    const oldRank = rankRelationshipSummaryStatusQuo(old, jury);\n    if (newRank > oldRank) return false;\n    if (newRank < oldRank) return true;\n    return neww.relationship < old.relationship;\n}\n\n// when \"jury\" is FALSE, the r.doIWin condition is ignored, since !jury is always true.\n// This enables people who are at the top of the game to target people below them and play based on relationships.\nfunction rankRelationshipSummaryStatusQuo(r: RelationshipSummary, jury: boolean): number {\n    if (r.type === RelationshipType.Enemy) return r.doIWin || !jury ? 4 : 1;\n    if (r.type === RelationshipType.Friend) return r.doIWin || !jury ? 6 : 3;\n    return r.doIWin || !jury ? 5 : 2;\n}\n","import { Houseguest, GameState, inJury, exclude } from \"../../model\";\nimport { rng } from \"../BbRandomGenerator\";\nimport { relationship, lowestScore, heroShouldTargetSuperiors } from \"./aiUtils\";\nimport { classifyRelationship, RelationshipType as Relationship } from \"./classifyRelationship\";\nimport { getRelationshipSummary, isBetterTarget } from \"./targets\";\n\ninterface NumberWithLogic {\n    decision: number;\n    reason: string;\n}\n\ninterface HouseguestWithLogic {\n    decision: Houseguest | null;\n    reason: string;\n}\n\n// Return the index of the eviction target.\nexport function castEvictionVote(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): NumberWithLogic {\n    if (inJury(gameState)) {\n        return cutthroatVoteJury(hero, nominees, gameState);\n    } else {\n        return cutthroatVote(hero, nominees);\n    }\n}\n\nexport const MAGIC_SUPERIOR_NUMBER = 0.5;\n\nfunction winningOddsF3(hero: Houseguest, villain1: Houseguest, villain2: Houseguest): number {\n    // chance that hero wins final HoH\n    const heroVs1: number = hero.superiors[villain1.id];\n    const heroVs2: number = hero.superiors[villain2.id];\n    const v1Vs2: number = villain1.superiors[villain2.id];\n\n    if (heroVs1 === undefined)\n        throw new Error(\n            `Tried to get a power comparison that does not exist between ${hero.name} and ${villain1.name} [1]`\n        );\n    if (heroVs2 === undefined)\n        throw new Error(\n            `Tried to get a power comparison that does not exist between ${hero.name} and ${villain2.name} [2]`\n        );\n    if (v1Vs2 === undefined)\n        throw new Error(\n            `Tried to get a power comparison that does not exist between ${villain1.name} and ${villain2.name} [3]`\n        );\n    const heroWins: number = Math.max(heroVs1, heroVs2); // evict the person who beats you more often\n    const v1wins: number = castF3Vote(villain1, hero, villain2).decision === 0 ? 0 : heroVs1;\n    const v2wins: number = castF3Vote(villain2, hero, villain1).decision === 0 ? 0 : heroVs2;\n    return (1 / 3) * heroWins + (1 / 3) * v1wins + (1 / 3) * v2wins;\n}\n\nfunction castF3Vote(hero: Houseguest, nom0: Houseguest, nom1: Houseguest): NumberWithLogic {\n    const decision = hero.superiors[nom0.id] < hero.superiors[nom1.id] ? 0 : 1;\n    return {\n        decision,\n        reason: `I have better odds of beating ${decision ? nom0.name : nom1.name} in the final 2.`,\n    };\n}\n\nfunction castF4vote(hero: Houseguest, nom0: Houseguest, nom1: Houseguest, HoH: Houseguest): NumberWithLogic {\n    const evictNom0 = winningOddsF3(hero, nom1, HoH);\n    const evictNom1 = winningOddsF3(hero, nom0, HoH);\n    const decision = evictNom0 > evictNom1 ? 0 : 1;\n    return {\n        decision,\n        reason: `Evicting ${\n            [nom0, nom1][decision].name\n        } gives me better odds of making it to the end and winning.`,\n    };\n}\n\nfunction cutthroatVoteJury(hero: Houseguest, nominees: Houseguest[], gameState: GameState): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    // this could be changed later\n    const zeroIsInferior = hero.superiors[nom0.id] > MAGIC_SUPERIOR_NUMBER;\n    const oneIsInferior = hero.superiors[nom1.id] > MAGIC_SUPERIOR_NUMBER;\n\n    // hard-coded logic for the F4 and F3 votes\n\n    // In the F3 vote, take the person who you have better odds against to F2\n    if (gameState.remainingPlayers === 3) {\n        return castF3Vote(hero, nom0, nom1);\n    }\n    // In the F4 vote, do some genius level mathematics to predict what gives you the best odds of winning given that the\n    // person who wins the F3 HoH will evict the person they have the worst odds against\n    if (gameState.remainingPlayers === 4) {\n        return castF4vote(\n            hero,\n            nom0,\n            nom1,\n            // all this work just to get the HoH...\n            exclude(\n                Array.from(gameState.nonEvictedHouseguests.values()).map(\n                    (id) => gameState.houseguestCache[id]\n                ),\n                [nom0, nom1, hero]\n            )[0]\n        );\n    }\n\n    // if there is no sup/inf difference, no point in doing special logic for it\n    if (zeroIsInferior === oneIsInferior) {\n        const r0 = classifyRelationship(hero.popularity, nom0.popularity, hero.relationships[nom0.id]);\n        const r1 = classifyRelationship(hero.popularity, nom1.popularity, hero.relationships[nom1.id]);\n        const decision = hero.relationships[nom0.id] < hero.relationships[nom1.id] ? 0 : 1;\n        return r0 === Relationship.Enemy && r1 === Relationship.Enemy\n            ? {\n                  decision,\n                  reason: `Both noms are my enemies, but I dislike ${nominees[decision].name} more.`,\n              }\n            : cutthroatVote(hero, nominees);\n    }\n\n    // Don't evict the last person in the game you can beat\n    if (gameState.remainingPlayers - hero.superiors.size - 1 === 1 && (zeroIsInferior || oneIsInferior)) {\n        const nonVote = zeroIsInferior ? 0 : 1;\n        return {\n            decision: zeroIsInferior ? 1 : 0,\n            reason: `I can't evict ${nominees[nonVote].name}, because they are the last person I can beat.`,\n        };\n    }\n    // the ultimate in omegalul technology\n    if (\n        heroShouldTargetSuperiors(hero, gameState) &&\n        ((zeroIsInferior && !oneIsInferior) || (!zeroIsInferior && oneIsInferior))\n    ) {\n        const decision = zeroIsInferior ? 1 : 0;\n        return {\n            decision,\n            reason: `I can't beat ${nominees[decision].name} in the end.`,\n        };\n    }\n    return cutthroatVote(hero, nominees);\n}\n\n// only works for 2 nominees\nfunction cutthroatVote(hero: Houseguest, nominees: Houseguest[]): NumberWithLogic {\n    const nom0 = nominees[0];\n    const nom1 = nominees[1];\n    const r0 = classifyRelationship(hero.popularity, nom0.popularity, hero.relationships[nom0.id]);\n    const r1 = classifyRelationship(hero.popularity, nom1.popularity, hero.relationships[nom1.id]);\n\n    const nom0isTarget = hero.targets[0] === nom0.id || hero.targets[1] === nom0.id;\n    const nom1isTarget = hero.targets[0] === nom1.id || hero.targets[1] === nom1.id;\n    // KILL TARGETS FIRST\n    if ((nom0isTarget && !nom1isTarget) || (nom1isTarget && !nom0isTarget)) {\n        const decision = nom0isTarget ? 0 : 1;\n        return {\n            decision,\n            reason: `I am targeting ${nominees[decision].name}.`,\n        };\n    }\n\n    if (r0 === Relationship.Enemy && r1 === Relationship.Enemy) {\n        return {\n            decision: nom0.popularity > nom1.popularity ? 0 : 1,\n            reason: \"Both noms are my enemies, so I voted for the more popular one.\",\n        };\n    } else if (\n        (r0 === Relationship.Enemy && r1 !== Relationship.Enemy) ||\n        (r1 === Relationship.Enemy && r0 !== Relationship.Enemy)\n    ) {\n        const vote = r0 === Relationship.Enemy ? 0 : 1;\n        return { decision: vote, reason: `${nominees[vote].name} is my enemy.` };\n    } else if (\n        (r0 !== Relationship.Friend && r1 === Relationship.Friend) ||\n        (r1 !== Relationship.Friend && r0 === Relationship.Friend)\n    ) {\n        const vote = r0 !== Relationship.Friend ? 0 : 1;\n        const nonVote = vote === 0 ? 1 : 0;\n        return { decision: vote, reason: `${nominees[nonVote].name} is my friend.` };\n    }\n    const vote = lowestScore(hero, nominees, relationship);\n    return {\n        decision: vote,\n        reason: `Both noms are my friends. but I like ${nominees[vote === 0 ? 1 : 0].name} more.`,\n    };\n}\n\nexport function backdoorNPlayers(\n    hero: Houseguest,\n    options: Houseguest[],\n    gameState: GameState,\n    n: number\n): NumberWithLogic[] {\n    const result: NumberWithLogic[] = [];\n    const sortedOptions = [...options];\n    // negative value if first is less than second\n    sortedOptions.sort((hg1, hg2) => {\n        return isBetterTarget(\n            getRelationshipSummary(hero, hg1),\n            getRelationshipSummary(hero, hg2),\n            hero,\n            gameState\n        )\n            ? 1\n            : -1;\n    });\n\n    while (result.length < n) {\n        const decision = sortedOptions[result.length];\n        const reason = \"I think you are ugly\";\n        result.push({ decision: decision.id, reason });\n    }\n    return result;\n}\n\nexport function useGoldenVeto(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): HouseguestWithLogic {\n    let result: HouseguestWithLogic;\n    if (hero.id == nominees[0].id || hero.id == nominees[1].id) {\n        result = { decision: hero, reason: \"I am going to save myself.\" };\n    } else {\n        result = useGoldenVetoPreJury(hero, nominees, gameState);\n        if (gameState.remainingPlayers === 4) {\n            result = {\n                decision: null,\n                reason: \"It doesn't make sense to use the veto here.\",\n            };\n        }\n    }\n    return result || null;\n}\n\nfunction useGoldenVetoPreJury(\n    hero: Houseguest,\n    nominees: Houseguest[],\n    gameState: GameState\n): HouseguestWithLogic {\n    let reason = \"Neither of these nominees are my friends.\";\n    let potentialSave: Houseguest | null = null;\n    let alwaysSave: Houseguest | null = null;\n    nominees.forEach((nominee) => {\n        const nomineeIsSuperior: boolean = hero.superiors[nominee.id] > MAGIC_SUPERIOR_NUMBER;\n        if (gameState.remainingPlayers - hero.superiors.size - 1 === 1 && !nomineeIsSuperior) {\n            alwaysSave = nominee;\n            reason = `I have to save ${nominee.name}, because they are the last person I can beat.`;\n        }\n        const relationship = classifyRelationship(\n            hero.popularity,\n            nominee.popularity,\n            hero.relationshipWith(nominee)\n        );\n        if (relationship === Relationship.Friend) {\n            if (potentialSave) {\n                potentialSave =\n                    hero.relationshipWith(nominee) > hero.relationshipWith(potentialSave)\n                        ? nominee\n                        : potentialSave;\n                reason = `Of these noms, I like ${potentialSave.name} the most.`;\n            } else {\n                reason = `${nominee.name} is my friend.`;\n                potentialSave = nominee;\n            }\n        }\n    });\n    if (alwaysSave) {\n        return { decision: alwaysSave, reason };\n    } else if (potentialSave) {\n        return { decision: potentialSave, reason };\n    } else {\n        return { decision: null, reason };\n    }\n}\n\nexport function pJurorVotesForHero(juror: Houseguest, hero: Houseguest, villain: Houseguest): number {\n    const r1 = juror.relationshipWith(hero);\n    const r2 = juror.relationshipWith(villain);\n    const delta = (r1 - r2) / 2;\n    let result = 0.5 + delta;\n    if (result > 1) result = 1;\n    if (result < 0) result = 0;\n    return result;\n}\n\n// Returns the index of the finalist with the highest relationship with juror\n// only works with 2 finalists\nexport function castJuryVote(juror: Houseguest, finalists: Houseguest[]): number {\n    const choice = Math.abs(rng().randomFloat());\n    return choice > pJurorVotesForHero(juror, finalists[0], finalists[1]) ? 1 : 0;\n}\n","import React from \"react\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\nimport styled from \"styled-components\";\n\nconst FullscreenIcon = styled.img`\n    position: -webkit-sticky;\n    position: sticky;\n    top: 20px;\n    right: 20px;\n`;\n\nexport function FullscreenButton(): JSX.Element {\n    return (\n        <FullscreenIcon\n            src={\n                \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAASElEQVRIiWNgGAUEACMa/z+R6ohWz0Sqi0gFLIRcQAAQDAGa+2DoWzAKRgH1wX8G3OULWfqHfkYbsNIUPR5IrQ/gYLQsGngAAEPgCRZjAdYSAAAAAElFTkSuQmCC\"\n            }\n            className=\"button is-rounded\"\n            onClick={() => {\n                isFullscreen$.next(!isFullscreen$.getValue());\n            }}\n        />\n    );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { EpisodeLog } from \"../../../model/logging/episodelog\";\nimport { CenteredBold, Centered, CenteredItallic } from \"../../layout/centered\";\nimport { GameState, getById } from \"../../../model\";\nimport { VoteType, WinnerVote, RunnerUpVote } from \"../../../model/logging/voteType\";\nimport { FullscreenButton } from \"../../mainPage/fullscreenButton\";\nimport { ColorTheme } from \"../../../theme/theme\";\n\nexport const EndgameTableCell = styled.td`\n    padding: 0.1em 0.4em;\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n`;\n\nconst EndgameTable = styled.table`\n    border: 1px solid ${({ theme }: { theme: ColorTheme }) => theme.tableCellBorder};\n    border-collapse: collapse;\n`;\n\nconst Gray = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.grayCell};\n`;\n\nconst White = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.lightGrayCell};\n`;\n\nconst Evicted = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.evictedCell};\n`;\n\nexport const WinnerCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.winnerCell};\n`;\n\nexport const RunnerUpCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.runnerUpCell};\n`;\n\nexport const NomineeCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.nomineeCell};\n`;\n\nexport const HohCell = styled(EndgameTableCell)`\n    background-color: ${({ theme }: { theme: ColorTheme }) => theme.hohCell};\n`;\n\nconst BlackRow = styled.tr`\n    height: 0.4em;\n    background-color: #000000;\n`;\n\nexport function generateVotingTable(gameState: GameState): JSX.Element {\n    const masterLog: EpisodeLog[] = gameState.log;\n    const houseguestCells: JSX.Element[][] = [];\n    gameState.houseguests.forEach((hg, i) => {\n        houseguestCells[hg.id] = [\n            <Gray key={`hg-name---${i}`}>\n                <CenteredBold noMargin={true}>{hg.name}</CenteredBold>\n            </Gray>,\n        ];\n    });\n    const evictionOrder: number[] = [];\n    const topRowCells: JSX.Element[] = [];\n    const preVetoCells: JSX.Element[] = [];\n    const vetoCells: JSX.Element[] = [];\n    const postVetoCells: JSX.Element[] = [];\n    const evictedCells: JSX.Element[] = [];\n    const winnerCells: JSX.Element[] = [];\n    masterLog.forEach((log, i) => {\n        generateTopRow(log, i, topRowCells, masterLog.length - 1);\n        generatePreVetoRow(log, i, preVetoCells);\n        generateVetoRow(log, i, vetoCells);\n        generatePostVetoRow(log, i, postVetoCells);\n        generateEvictedRow(log, i, evictedCells, gameState);\n        if (!log) return;\n        evictionOrder.push(log.evicted);\n        if (log.runnerUp !== undefined) evictionOrder.push(log.runnerUp);\n        if (log.winner !== undefined) evictionOrder.push(log.winner);\n        // add each of the votes to the houseguest cells\n        for (const [key, value] of Object.entries(log.votes)) {\n            // typescript for .. in loops kinda suck so i need to do a sketchy type conversion\n            const id: number = (key as unknown) as number;\n            const vote: VoteType = value;\n            houseguestCells[id].push(vote.render(gameState));\n        }\n        if (log.winner !== undefined && log.runnerUp !== undefined) {\n            houseguestCells[log.winner].push(new WinnerVote().render(gameState));\n            houseguestCells[log.runnerUp].push(new RunnerUpVote().render(gameState));\n            evictedCells.push(\n                <RunnerUpCell key={\"runnerUp\"}>\n                    <CenteredBold noMargin={true}>{getById(gameState, log.runnerUp).name}</CenteredBold>\n                    <Centered noMargin={true}>\n                        <small>Finalist</small> {/** TODO: put \"X votes\" here instead. */}\n                    </Centered>\n                </RunnerUpCell>\n            );\n            winnerCells.push(\n                <WinnerCell key={\"winner\"}>\n                    <CenteredBold noMargin={true}>{getById(gameState, log.winner).name}</CenteredBold>\n                    <Centered noMargin={true}>\n                        <small>Winner</small>\n                    </Centered>\n                </WinnerCell>\n            );\n        }\n    });\n    preVetoCells.push(\n        <White key={`preveto--finale`} rowSpan={3}>\n            <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n        </White>\n    );\n    const winnerRow = <tr>{winnerCells}</tr>;\n    const topRow = <tr>{topRowCells}</tr>;\n    const preVetoRow = <tr>{preVetoCells}</tr>;\n    const vetoRow = <tr>{vetoCells}</tr>;\n    const postVetoRow = <tr>{postVetoCells}</tr>;\n    const blackRow = (\n        <BlackRow>\n            <td colSpan={gameState.houseguests.length} />\n        </BlackRow>\n    );\n    const houseguestRows: JSX.Element[] = [];\n    const evictedRow = <tr>{evictedCells}</tr>;\n    let evictionColSpan = -1;\n    const weeks = evictionOrder.length;\n    evictionOrder.reverse().forEach((id, i) => {\n        if (evictionColSpan > 0) {\n            const weekText = i === 2 ? \"(Finale)\" : `(Week ${weeks - i})`;\n            const isJury = getById(gameState, id).isJury;\n            const colSpan = isJury ? evictionColSpan - 1 : evictionColSpan;\n            const evicted = (\n                <Evicted colSpan={colSpan} key={`evicted-week-${weeks - i}`}>\n                    <CenteredItallic noMargin={true}>Evicted</CenteredItallic>\n                    <CenteredItallic noMargin={true}>\n                        <small>{weekText}</small>\n                    </CenteredItallic>\n                </Evicted>\n            );\n            if (!isJury) {\n                houseguestCells[id].push(evicted); // not jury, they dead\n            } else {\n                const tempList = houseguestCells[id].slice(0, -1);\n                tempList.push(evicted);\n                tempList.push(houseguestCells[id][houseguestCells[id].length - 1]);\n                houseguestCells[id] = tempList;\n            }\n        }\n        houseguestRows.push(<tr key={`hgrow--${id}`}>{houseguestCells[id]}</tr>);\n        evictionColSpan++;\n    });\n\n    return (\n        <div>\n            <FullscreenButton />\n            <EndgameTable>\n                <tbody>\n                    {topRow}\n                    {preVetoRow}\n                    {vetoRow}\n                    {postVetoRow}\n                    {blackRow}\n                    {houseguestRows}\n                    {blackRow}\n                    {evictedRow}\n                    {winnerRow}\n                </tbody>\n            </EndgameTable>\n        </div>\n    );\n}\n\nfunction generateEvictedRow(\n    log: EpisodeLog | undefined,\n    i: number,\n    cells: JSX.Element[],\n    gameState: GameState\n) {\n    if (!log) {\n        cells.push(\n            <Gray key={i} rowSpan={2}>\n                <CenteredBold noMargin={true}>Evicted</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n\n    const voteTextLine1 =\n        log.soleVoter !== undefined\n            ? `${log.soleVoter}'s choice`\n            : `${log.votesInMajority} of ${log.outOf} votes`;\n\n    cells.push(\n        <Evicted key={i} rowSpan={2}>\n            <Centered noMargin={true}>\n                <b>{getById(gameState, log.evicted).name}</b>\n                <br />\n                <small>\n                    {voteTextLine1} <br />\n                    to evict\n                </small>\n            </Centered>\n        </Evicted>\n    );\n}\n\nfunction generatePostVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`postVeto--${i}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(post-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`postVeto--${i}`}>\n            <Centered noMargin={true}>\n                {log.nominationsPostVeto[0]}\n                <br /> {log.nominationsPostVeto[1]}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`veto--${i}`}>\n                <CenteredBold noMargin={true}>Veto Winner</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.vetoWinner === undefined) return;\n\n    cells.push(\n        <White key={`veto--${i}`}>\n            <Centered noMargin={true}>{log.vetoWinner}</Centered>\n        </White>\n    );\n}\n\nfunction generatePreVetoRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[]) {\n    if (!log) {\n        cells.push(\n            <Gray key={`preveto--${i}`}>\n                <CenteredBold noMargin={true}>\n                    Nominations\n                    <br />\n                    <small>(pre-veto)</small>\n                </CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    if (log.nominationsPreVeto.length === 0) {\n        cells.push(\n            <White key={`preveto--${i}`} rowSpan={2}>\n                <CenteredItallic noMargin={true}>(none)</CenteredItallic>\n            </White>\n        );\n        return;\n    }\n    cells.push(\n        <White key={`preveto--${i}`}>\n            <Centered noMargin={true}>\n                {log.nominationsPreVeto[0]}\n                <br /> {log.nominationsPreVeto[1]}\n            </Centered>\n        </White>\n    );\n}\n\nfunction generateTopRow(log: EpisodeLog | undefined, i: number, cells: JSX.Element[], max: number) {\n    if (!log) {\n        cells.push(<Gray key={`toprow--${i}`} />);\n        return;\n    }\n    if (i === max) {\n        cells.push(\n            <Gray key={`toprow--${i}`} colSpan={2}>\n                <CenteredBold noMargin={true}>Finale</CenteredBold>\n            </Gray>\n        );\n        return;\n    }\n    cells.push(\n        <Gray key={`toprow--${i}`}>\n            <CenteredBold noMargin={true}>Week {i}</CenteredBold>\n        </Gray>\n    );\n}\n","import React from \"react\";\nimport { GameState, getById } from \"../gameState\";\nimport { CenteredItallic, Centered } from \"../../components/layout/centered\";\nimport {\n    EndgameTableCell,\n    WinnerCell,\n    RunnerUpCell,\n    NomineeCell,\n    HohCell,\n} from \"../../components/episode/scenes/votingTable\";\n\nlet voteKey = 0;\n\nfunction getKey(): string {\n    return `${voteKey++}-- vote key`;\n}\n\nexport interface VoteType {\n    id: number;\n    render: (state: GameState) => JSX.Element;\n}\n\nexport class NormalVote implements VoteType {\n    id: number;\n    render = (state: GameState) => (\n        <EndgameTableCell key={getKey()}>\n            <Centered noMargin={true}>{getById(state, this.id).name}</Centered>\n        </EndgameTableCell>\n    );\n    constructor(id: number) {\n        this.id = id;\n    }\n}\n\nexport class WinnerVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <WinnerCell key={\"winner---\"}>\n            <Centered noMargin={true}>Winner</Centered>\n        </WinnerCell>\n    );\n}\n\nexport class RunnerUpVote implements VoteType {\n    id: number = 1; // unused\n    render = (state: GameState) => (\n        <RunnerUpCell key={\"runnerUp---\"}>\n            <Centered noMargin={true}>Finalist</Centered>\n        </RunnerUpCell>\n    );\n}\n\nexport class NomineeVote implements VoteType {\n    id: number = -1;\n    evicted: boolean;\n    render = (state: GameState) => (\n        <NomineeCell key={getKey()}>\n            <CenteredItallic noMargin={true}>Nominated</CenteredItallic>\n        </NomineeCell>\n    );\n    constructor(evicted: boolean) {\n        this.evicted = evicted;\n    }\n}\n\nexport class HoHVote implements VoteType {\n    id: number;\n\n    get hohText(): JSX.Element {\n        return (\n            <CenteredItallic noMargin={true}>\n                Head of\n                <br />\n                Household\n            </CenteredItallic>\n        );\n    }\n\n    private hohVote(state: GameState): JSX.Element {\n        return <CenteredItallic noMargin={true}>{getById(state, this.id).name}</CenteredItallic>;\n    }\n\n    render = (state: GameState) => {\n        return <HohCell key={getKey()}>{this.id == -1 ? this.hohText : this.hohVote(state)}</HohCell>;\n    };\n    constructor(id?: number) {\n        this.id = id === undefined ? -1 : id;\n    }\n}\n","import { GameState, getJurors, nonEvictedHouseguests, MutableGameState, Houseguest } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { castJuryVote } from \"../../../utils/ai/aiApi\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport React from \"react\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport { NormalVote } from \"../../../model/logging/voteType\";\n\nexport function juryVoteScene(initialGameState: GameState): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const jurors: Houseguest[] = getJurors(newGameState);\n    const finalists = nonEvictedHouseguests(newGameState);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    jurors.forEach(juror => {\n        const decision = castJuryVote(juror, finalists);\n        const result: ProfileHouseguest = { ...juror };\n        votes[decision].push(result);\n        newGameState.currentLog.votes[juror.id] = new NormalVote(finalists[decision].id);\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const winner = votesFor0 > votesFor1 ? finalists[0] : finalists[1];\n    const runnerUp = votesFor0 < votesFor1 ? finalists[0] : finalists[1];\n    newGameState.currentLog.winner = winner.id;\n    newGameState.currentLog.runnerUp = runnerUp.id;\n    const scene = new Scene({\n        title: \"Jury Votes\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </DividerBox>\n                </div>\n                <Portraits houseguests={finalists} centered={true} />\n                <CenteredBold>{`Congratulations, ${winner.name}... you are the winner of Big Brother!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [newGameState, scene];\n}\n","import React from \"react\";\nimport { EpisodeType, Episode, InitEpisode } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { GameState } from \"../../model\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport { finalHohCompScene } from \"./scenes/finalHohCompScene\";\nimport { finalEvictionScene } from \"./scenes/finalEvictionScene\";\nimport { juryVoteScene } from \"./scenes/juryVoteScene\";\nimport { HasText } from \"../layout/text\";\n\nexport const BigBrotherFinale: EpisodeType = {\n    canPlayWith: (n: number) => n === 3,\n    eliminates: 2,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n};\n\nexport function generateBbFinale(initialGameState: GameState): BigBrotherFinaleEpisode {\n    const title = \"Finale\";\n    const content = (\n        <HasText>\n            <MemoryWall houseguests={initialGameState.houseguests} /> <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n    let currentGameState;\n    let hohCompScene;\n    let finalHoH;\n    const scenes = [];\n    [currentGameState, hohCompScene, finalHoH] = finalHohCompScene(initialGameState);\n    scenes.push(hohCompScene);\n    let finalEviction;\n    [currentGameState, finalEviction] = finalEvictionScene(currentGameState, finalHoH);\n    scenes.push(finalEviction);\n    const [gameState, juryScene] = juryVoteScene(currentGameState);\n    scenes.push(juryScene);\n    return new BigBrotherFinaleEpisode({ gameState, content, title, scenes, type: BigBrotherFinale });\n}\n\nexport class BigBrotherFinaleEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n    readonly type = BigBrotherFinale;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portraits, Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\n\nexport function finalHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n    const final3 = nonEvictedHouseguests(initialGameState);\n    const enduranceWinner = randomPlayer(final3);\n    const enduranceLosers = final3.filter(hg => hg.id !== enduranceWinner.id);\n    const skillWinner = randomPlayer(final3, [enduranceWinner]);\n    const finalHoH = getById(newGameState, randomPlayer([enduranceWinner, skillWinner]).id);\n    finalHoH.hohWins++;\n    const scene: Scene = new Scene({\n        title: \"Final HoH Competition\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>The final 3 houseguests compete in the endurance competition.</Centered>\n                <Portraits houseguests={final3} centered={true} />\n                <Portrait houseguest={enduranceWinner} centered={true} />\n                <CenteredBold>{`${enduranceWinner.name} has won the endurance competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceLosers[0].name} and ${enduranceLosers[1].name} compete in the skill competition.`}</Centered>\n                <Portraits houseguests={enduranceLosers} centered={true} />\n                <Portrait houseguest={skillWinner} centered={true} />\n                <CenteredBold>{`${skillWinner.name} has won the skill competition!`}</CenteredBold>\n                <hr />\n                <Centered>{`${enduranceWinner.name} and ${skillWinner.name} compete in the quiz competition.`}</Centered>\n                <Portraits houseguests={[enduranceWinner, skillWinner]} centered={true} />\n                <Portrait houseguest={finalHoH} centered={true} />\n                <CenteredBold>{`Congratulations ${finalHoH.name}, you are the final Head of Household!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [new GameState(newGameState), scene, finalHoH];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { evictHouseguest } from \"../bigBrotherEpisode\";\nimport { Portrait, Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { HoHVote, NomineeVote } from \"../../../model/logging/voteType\";\n\nexport function finalEvictionScene(initialGameState: GameState, HoH: Houseguest): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    const nominees = nonEvictedHouseguests(newGameState).filter((hg) => hg.id !== HoH.id);\n    newGameState.currentLog.nominationsPostVeto = nominees.map((hg) => hg.name);\n    const { decision: vote, reason } = castEvictionVote(HoH, nominees, newGameState);\n    const evictee = nominees[vote];\n    const survivor = nominees[vote == 1 ? 0 : 1];\n    newGameState.currentLog.soleVoter = HoH.name;\n    newGameState.currentLog.votes[survivor.id] = new NomineeVote(false);\n    newGameState.currentLog.votes[HoH.id] = new HoHVote(evictee.id);\n    newGameState.currentLog.votesInMajority = 1;\n    newGameState.currentLog.outOf = 1;\n    const hoh: ProfileHouseguest = { ...HoH };\n    hoh.tooltip = reason;\n    evictHouseguest(newGameState, evictee.id);\n    const scene: Scene = new Scene({\n        title: \"Final Eviction\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    {`As the final HoH of the season, ${HoH.name}, you may now cast the sole vote to evict.`}\n                </Centered>\n                <Portrait houseguest={hoh} centered={true} />\n                <CenteredBold>{`I vote to evict ${evictee.name}.`}</CenteredBold>\n                <Portraits houseguests={nominees} centered={true} />\n                <Centered>\n                    It's official... {evictee.name}, you will be the final person leaving the Big Brother\n                    House.\n                </Centered>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene];\n}\n","import { Episode, InitEpisode, EpisodeType } from \"./episodes\";\nimport { Scene } from \"./scene\";\nimport { GameState } from \"../../model\";\nimport { evictHouseguest } from \"./bigBrotherEpisode\";\nimport { generateVotingTable } from \"./scenes/votingTable\";\n\nexport const GameOver: EpisodeType = {\n    canPlayWith: (n: number) => n === 1,\n    eliminates: 1,\n    arrowsEnabled: false,\n    hasViewsbar: false\n};\n\nexport function generateGameOver(gameState: GameState): GameOverEpisode {\n    const title = \"Game Over\";\n    const scenes: Scene[] = [];\n    const content = generateVotingTable(gameState);\n    gameState.houseguests.forEach(hg => {\n        evictHouseguest(gameState, hg.id);\n    });\n    return new GameOverEpisode({ gameState, content, title, scenes, type: GameOver });\n}\n\nexport class GameOverEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly gameState: GameState;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n    }\n}\n","import { VoteType } from \"./voteType\";\n\nexport class EpisodeLog {\n    public nominationsPreVeto: string[] = [];\n    public vetoWinner?: string;\n    public winner?: number;\n    public runnerUp?: number;\n    public nominationsPostVeto: string[] = [];\n    public evicted: number = -1;\n    public votes: { [id: string]: VoteType } = {};\n    public votesInMajority: number = -1;\n    public outOf: number = -1;\n    public soleVoter?: string;\n}\n","import { Houseguest, GameState, nonEvictedHouseguests, getById } from \"../model\";\n\nimport { classifyRelationship, RelationshipType } from \"./ai/classifyRelationship\";\n\nimport _ from \"lodash\";\nimport { Graph } from \"./generateCliques\";\n\nclass EdgeMap {\n    public data: { [id: number]: Set<number> } = {};\n    public add(key: number, value: number) {\n        if (!this.data[key]) {\n            this.data[key] = new Set<number>([value]);\n        } else {\n            this.data[key].add(value);\n        }\n    }\n}\n\nfunction generateEdge(\n    hero: Houseguest,\n    villain: Houseguest,\n    relationship: number\n): [number[] | null, number] {\n    const relationshipType = classifyRelationship(hero.popularity, villain.popularity, relationship);\n    if (relationshipType === RelationshipType.Friend) {\n        return [[hero.id, villain.id], 1];\n    }\n    // no edge for non-mutual friends\n    return [null, 0];\n}\n\nexport default function generateGraph(gameState: GameState): Graph {\n    // this algorithm assumes every relationship is mutual,\n    // and will need a face lift if we get non-mutual relationships.\n    const players = nonEvictedHouseguests(gameState);\n    const nodes: number[] = [];\n    const edges: EdgeMap = new EdgeMap();\n    players.forEach((player) => {\n        let friendCount = 0;\n        _.forEach(player.relationships, (relationship, stringId) => {\n            const villainId = parseInt(stringId);\n            const [edge, friends] = generateEdge(player, getById(gameState, villainId), relationship);\n            friendCount += friends;\n            if (villainId > player.id) {\n                if (edge) {\n                    edges.add(player.id, villainId);\n                    edges.add(villainId, player.id);\n                }\n            }\n        });\n        // nodes[player.id] = friendCount; // for pivot later on, thats why friendcount is there unused\n        nodes.push(player.id);\n    });\n    return { nodes, neighbors: (v: number) => edges.data[v] || new Set([]) };\n}\n","import { intersection } from \".\";\nimport { GameState, getById } from \"../model\";\nimport generateGraph from \"./generateGraph\";\nimport { difference } from \"./utilities\";\n\nlet cliques: number[][] = [];\nexport interface Graph {\n    nodes: number[];\n    neighbors: (v: number) => Set<number>;\n}\n\nexport interface Cliques {\n    core: number[];\n    affiliates: number[];\n}\n\nexport function generateCliques(gameState: GameState): Cliques[] {\n    const g = generateGraph(gameState);\n    cliques = [];\n    bronKerbosch(new Set<number>([]), new Set(g.nodes), new Set<number>([]), g);\n    cliques.forEach((clique) => clique.map((id) => getById(gameState, id)));\n    cliques = cliques.filter((clique) => clique.length > 2).sort((a, b) => b.length - a.length);\n    // merge cliques that have a difference of only one person\n    const result: Cliques[] = [];\n    const blacklist: Set<number> = new Set<number>();\n    cliques.forEach((clq, i) => {\n        if (blacklist.has(i)) return;\n        const cliqueI = new Set(clq);\n        let cliquePushed: boolean = false;\n        for (let j = i + 1; j < cliques.length && cliques[j].length === clq.length; j++) {\n            const cliqueJ = new Set(cliques[j]);\n            const core: Set<number> = intersection(cliqueI, cliqueJ);\n            if (core.size === cliqueI.size - 1) {\n                const affiliates: number[] = Array.from(difference(cliqueJ, core));\n                // TODO: make it so that it choses strategically who to include as the in/out groups\n                // ie. it chooses between clique I and clique J, whoever is closer to the core.\n                result.push({ core: clq, affiliates });\n                cliquePushed = true;\n                blacklist.add(j);\n            }\n        }\n        if (!cliquePushed) {\n            result.push({ core: clq, affiliates: [] });\n        }\n    });\n    // Merge duplicate alliances together\n    result.forEach((clq, i) => {\n        for (let j = i + 1; j < result.length; j++) {\n            if (i === j) return;\n            if (JSON.stringify(clq.core) === JSON.stringify(result[j].core)) {\n                result[j].affiliates = result[j].affiliates.concat(clq.affiliates);\n                result.splice(i, 1);\n                j--;\n            }\n        }\n    });\n    // sort result (again...)\n    result.sort((a, b) => b.affiliates.length + b.core.length - (a.affiliates.length + a.core.length));\n    return result;\n}\n\nfunction bronKerbosch(r: Set<number>, p: Set<number>, x: Set<number>, g: Graph) {\n    if (p.size === 0 && x.size === 0) {\n        const values = Array.from(r.values());\n        cliques.push(values);\n        return;\n    }\n    Array.from(p.keys()).forEach((v) => {\n        const rPrime = new Set(r.values()).add(v);\n        const pPrime = new Set([...p].filter((node) => g.neighbors(v).has(node)));\n        const xPrime = new Set([...x].filter((node) => g.neighbors(v).has(node)));\n        bronKerbosch(rPrime, pPrime, xPrime, g);\n        p.delete(v);\n        x.add(v);\n    });\n}\n","import {\n    GameState,\n    MutableGameState,\n    calculatePopularity,\n    nonEvictedHouseguests,\n    inJury,\n    getJurors,\n    getById,\n} from \"../../model/gameState\";\nimport { Episode, Houseguest } from \"../../model\";\nimport { EpisodeType } from \"./episodes\";\nimport { BigBrotherVanilla, generateBbVanilla } from \"./bigBrotherEpisode\";\nimport { BigBrotherFinale, generateBbFinale } from \"./bigBrotherFinale\";\nimport { angleBetween, average, rng, roundTwoDigits } from \"../../utils\";\nimport { pHeroWinsTheFinale } from \"../../utils/ai/aiUtils\";\nimport { classifyRelationship, RelationshipType as Relationship } from \"../../utils/ai/classifyRelationship\";\nimport { GameOver, generateGameOver } from \"./gameOver\";\nimport { EpisodeLog } from \"../../model/logging/episodelog\";\nimport { generateCliques } from \"../../utils/generateCliques\";\nimport { getRelationshipSummary, Targets } from \"../../utils/ai/targets\";\nimport { MAGIC_SUPERIOR_NUMBER } from \"../../utils/ai/aiApi\";\n\nexport function canDisplayCliques(newState: GameState): boolean {\n    return newState.remainingPlayers <= 30;\n}\n\nfunction firstImpressions(houseguests: Houseguest[]) {\n    const sin = Math.sin;\n    const cos = Math.cos;\n    houseguests.forEach((hg) => {\n        // generate random spherical co-ordinates on the unit sphere\n        const u = rng().randomFloat();\n        const v = Math.abs(rng().randomFloat());\n        const θ = 2 * Math.PI * u;\n        const φ = Math.acos(2 * v - 1);\n        // convert spherical co-ords to cartesian co-ords\n        hg.compatibility = [sin(θ) * cos(φ), sin(θ) * sin(φ), cos(θ)];\n    });\n    for (let i = 0; i < houseguests.length; i++) {\n        const iMap = houseguests[i].relationships;\n        for (let j = i + 1; j < houseguests.length; j++) {\n            // creates a bunch of mutual relationships based on points on a sphere\n            const jMap = houseguests[j].relationships;\n            const impression =\n                1 - (2 * angleBetween(houseguests[i].compatibility, houseguests[j].compatibility)) / Math.PI;\n            jMap[i] = impression;\n            iMap[j] = impression;\n        }\n    }\n}\n\nfunction populateSuperiors(houseguests: Houseguest[]) {\n    for (let i = 0; i < houseguests.length; i++) {\n        let size = 0;\n        const hero = houseguests[i];\n        for (let j = i + 1; j < houseguests.length; j++) {\n            const villain = houseguests[j];\n            const pHeroWins = pHeroWinsTheFinale({ hero, villain }, houseguests);\n            hero.superiors[villain.id] = pHeroWins;\n            villain.superiors[hero.id] = 1 - pHeroWins;\n            if (pHeroWins > MAGIC_SUPERIOR_NUMBER) size++;\n            hero.superiors.size = size;\n        }\n    }\n}\n\nfunction updatePowerRankings(houseguests: Houseguest[]) {\n    houseguests.forEach((hg) => {\n        const test2: any = { ...hg.superiors };\n        delete test2[\"size\"];\n        hg.powerRanking = average(Object.values(test2));\n    });\n}\n\nfunction updatePopularity(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach((hg) => {\n        hg.targetingMe = 0;\n        const result = calculatePopularity(hg, nonEvictedHouseguests(gameState));\n        hg.deltaPopularity = (roundTwoDigits(result) - roundTwoDigits(hg.popularity)) / 100;\n        hg.popularity = result;\n    });\n}\n\nfunction updateFriendCounts(gameState: GameState) {\n    const houseguests = nonEvictedHouseguests(gameState);\n    houseguests.forEach((hero: Houseguest) => {\n        let targets = new Targets(hero);\n        let friends = 0;\n        let enemies = 0;\n        houseguests.forEach((villain) => {\n            if (hero.id === villain.id) return;\n            const type = classifyRelationship(\n                hero.popularity,\n                villain.popularity,\n                hero.relationshipWith(villain)\n            );\n            if (type === Relationship.Friend) {\n                friends++;\n            } else if (type === Relationship.Enemy) {\n                enemies++;\n            }\n        });\n        hero.friends = friends;\n        hero.enemies = enemies;\n        houseguests.forEach((villain) => {\n            if (hero.id === villain.id) return;\n            targets.addTarget(getRelationshipSummary(hero, villain), gameState);\n        });\n        hero.targets = targets.getTargets();\n        hero.targets.forEach((target) => {\n            getById(gameState, target).targetingMe++;\n        });\n    });\n}\n\nexport class EpisodeFactory {\n    public nextEpisode(gameState: GameState, episodeType: EpisodeType): Episode {\n        let newState = new MutableGameState(gameState);\n        if (gameState.phase === 0) {\n            firstImpressions(newState.houseguests);\n        }\n        newState.phase++;\n        if (gameState.remainingPlayers > 2) {\n            newState.log[newState.phase] = new EpisodeLog();\n        }\n        // If jury starts this episode, populate superior/inferior data. In the future, every jury ep. (dynamic rels)\n        if (inJury(gameState) && getJurors(gameState).length === 0) {\n            populateSuperiors(nonEvictedHouseguests(newState));\n        }\n        if (inJury(gameState)) {\n            updatePowerRankings(nonEvictedHouseguests(newState));\n        }\n        updatePopularity(newState);\n        gameState.remainingPlayers > 2 && updateFriendCounts(newState);\n        if (canDisplayCliques(newState)) newState.cliques = generateCliques(newState);\n        const finalState = new GameState(newState);\n        switch (episodeType) {\n            case BigBrotherVanilla:\n                return generateBbVanilla(finalState);\n            case BigBrotherFinale:\n                return generateBbFinale(finalState);\n            case GameOver:\n                return generateGameOver(finalState);\n            default:\n                throw new Error(\"Unsupported Episode Type\");\n        }\n    }\n}\n","import {\n    MutableGameState,\n    getById,\n    inJury,\n    nonEvictedHouseguests,\n    GameState,\n    Houseguest,\n    EpisodeType,\n    Episode,\n    InitEpisode,\n} from \"../../model\";\nimport { getFinalists, finalJurySize } from \"../../model/season\";\nimport { generateHohCompScene } from \"./scenes/hohCompScene\";\nimport { generateNomCeremonyScene } from \"./scenes/nomCeremonyScene\";\nimport { generateVetoCompScene } from \"./scenes/vetoCompScene\";\nimport { generateVetoCeremonyScene } from \"./scenes/vetoCeremonyScene\";\nimport { generateEvictionScene } from \"./scenes/evictionScene\";\nimport { NextEpisodeButton } from \"../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Scene } from \"./scene\";\nimport { HasText } from \"../layout/text\";\nimport styled from \"styled-components\";\nimport { weekStartTab$ } from \"../../subjects/subjects\";\nimport { WeekStartWrapper } from \"./bigBrotherWeekstartWrapper\";\nimport { MAGIC_SUPERIOR_NUMBER } from \"../../utils/ai/aiApi\";\n\nexport const BigBrotherVanilla: EpisodeType = {\n    canPlayWith: (n: number) => {\n        return n > 1;\n    },\n    eliminates: 1,\n    arrowsEnabled: true,\n    hasViewsbar: true,\n};\n\nconst TabItem = styled.li`\n    cursor: pointer;\n`;\n\n// Refactoring ideas\n/**\n * Might be best to start passing ids instead of houseguests for HoH/nominees/veto winner\n */\n\nexport function evictHouseguest(gameState: MutableGameState, id: number) {\n    const evictee = getById(gameState, id);\n    if (gameState.currentLog) gameState.currentLog.evicted = evictee.id;\n    evictee.isEvicted = true;\n    if (gameState.remainingPlayers - getFinalists() <= finalJurySize()) {\n        evictee.isJury = true;\n    }\n    if (inJury(gameState)) {\n        nonEvictedHouseguests(gameState).forEach((hg) => {\n            if (hg.superiors[evictee.id] > MAGIC_SUPERIOR_NUMBER) {\n                hg.superiors.size--;\n            }\n            delete hg.superiors[evictee.id];\n        });\n    }\n    gameState.nonEvictedHouseguests.delete(evictee.id);\n    gameState.remainingPlayers--;\n}\n\nfunction Tab(props: { text: string; active: number; id: number; setActive: any }): JSX.Element {\n    return (\n        <TabItem\n            className={props.active === props.id ? \"is-active\" : \"\"}\n            onClick={() => {\n                props.setActive(props.id);\n                weekStartTab$.next(props.id);\n            }}\n        >\n            <a>{props.text}</a>\n        </TabItem>\n    );\n}\n\nfunction Tabs(): JSX.Element {\n    const [active, setActive] = React.useState(weekStartTab$.value);\n    return (\n        <div className=\"tabs is-centered is-fullwidth is-medium\" style={{ marginBottom: 0 }}>\n            <ul style={{ paddingLeft: 0 }}>\n                <Tab text={\"Memory Wall\"} active={active} setActive={setActive} id={0} />\n                <Tab text={\"Alliances\"} active={active} setActive={setActive} id={1} />\n            </ul>\n        </div>\n    );\n}\n\nexport function generateBbVanilla(initialGamestate: GameState): BigBrotherVanillaEpisode {\n    let currentGameState;\n    let hohCompScene;\n    let hoh: Houseguest;\n    const scenes = [];\n    [currentGameState, hohCompScene, hoh] = generateHohCompScene(initialGamestate);\n    scenes.push(hohCompScene);\n\n    let nomCeremonyScene;\n    let nominees: Houseguest[];\n    [currentGameState, nomCeremonyScene, nominees] = generateNomCeremonyScene(currentGameState, hoh);\n    scenes.push(nomCeremonyScene);\n\n    let vetoCompScene;\n    let povWinner: Houseguest;\n    [currentGameState, vetoCompScene, povWinner] = generateVetoCompScene(\n        currentGameState,\n        hoh,\n        nominees[0],\n        nominees[1]\n    );\n    scenes.push(vetoCompScene);\n    let vetoCeremonyScene;\n\n    [currentGameState, vetoCeremonyScene, nominees] = generateVetoCeremonyScene(\n        currentGameState,\n        hoh,\n        nominees,\n        povWinner\n    );\n    scenes.push(vetoCeremonyScene);\n\n    let evictionScene;\n    [currentGameState, evictionScene] = generateEvictionScene(currentGameState, hoh, nominees);\n    scenes.push(evictionScene);\n\n    const title = `Week ${currentGameState.phase}`;\n    const content = (\n        <HasText>\n            <Tabs />\n            <WeekStartWrapper gameState={initialGamestate} />\n            <br />\n            {currentGameState.phase === 1 && <b>Try clicking on houseguests to view their relationships.</b>}\n            <br />\n            <NextEpisodeButton />\n        </HasText>\n    );\n    const gameState = new GameState(currentGameState);\n    return new BigBrotherVanillaEpisode({\n        title,\n        scenes,\n        content,\n        gameState,\n        initialGamestate,\n        type: BigBrotherVanilla,\n    });\n}\nexport class BigBrotherVanillaEpisode extends Episode {\n    readonly title: string;\n    readonly scenes: Scene[];\n    readonly content: JSX.Element;\n    readonly initialGamestate: GameState;\n    readonly gameState: GameState;\n    readonly type = BigBrotherVanilla;\n\n    public constructor(init: InitEpisode) {\n        super(init);\n        this.title = init.title;\n        this.scenes = init.scenes;\n        this.content = init.content;\n        this.gameState = init.gameState;\n        this.initialGamestate = init.initialGamestate || init.gameState;\n    }\n}\n","import { GameState, Houseguest, MutableGameState, randomPlayer } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { HoHVote } from \"../../../model/logging/voteType\";\nimport { heroShouldTargetSuperiors } from \"../../../utils/ai/aiUtils\";\n\nexport function generateHohCompScene(initialGameState: GameState): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    const previousHoh = initialGameState.previousHOH ? [initialGameState.previousHOH] : [];\n    const newHoH: Houseguest = randomPlayer(newGameState.houseguests, previousHoh);\n    newGameState.previousHOH = newHoH;\n    newGameState.currentLog.votes[newHoH.id] = new HoHVote();\n    newHoH.hohWins += 1;\n    const scene = new Scene({\n        title: \"HoH Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>\n                    {previousHoh.length > 0 &&\n                        `Houseguests, it's time to find a new Head of Household. As outgoing HoH, ${previousHoh[0].name} will not compete. `}\n                </Centered>\n                <Portrait centered={true} houseguest={newHoH} />\n                <CenteredBold>{newHoH.name} has won Head of Household!</CenteredBold>\n                <br />\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n\n    return [new GameState(newGameState), scene, newHoH];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    exclude,\n    nonEvictedHouseguests,\n    getById,\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { shuffle } from \"lodash\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\n\nexport function generateNomCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest\n): [GameState, Scene, Houseguest[]] {\n    const newGameState = new MutableGameState(initialGameState);\n    const options = exclude(nonEvictedHouseguests(newGameState), [HoH]);\n    const [nom1, nom2] = [getById(newGameState, HoH.targets[0]), getById(newGameState, HoH.targets[1])];\n    nom1.nominations++;\n    nom2.nominations++;\n    newGameState.currentLog.nominationsPreVeto = [nom1.name, nom2.name];\n    const noms = shuffle([nom1, nom2]);\n    const scene = new Scene({\n        title: \"Nomination Ceremony\",\n        gameState: newGameState,\n        content: (\n            <div>\n                <Centered>\n                    This is the nomination ceremony. It is my responsibility as the Head of Household to\n                    nominate two houseguests for eviction.\n                </Centered>\n                <Portrait centered={true} houseguest={HoH} />\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Centered> My first nominee is...</Centered>\n                        <Portrait centered={true} houseguest={noms[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Centered>My second nominee is...</Centered>\n                        <Portrait centered={true} houseguest={noms[1]} />\n                    </DividerBox>\n                </div>\n                <CenteredBold>{`I have nominated you, ${noms[0].name} and you, ${noms[1].name} for eviction.`}</CenteredBold>\n                <br />\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, [nom1, nom2]];\n}\n","import {\n    GameState,\n    Houseguest,\n    MutableGameState,\n    nonEvictedHouseguests,\n    randomPlayer,\n    getById,\n} from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\n\nexport function generateVetoCompScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nom1: Houseguest,\n    nom2: Houseguest\n): [GameState, Scene, Houseguest] {\n    const newGameState = new MutableGameState(initialGameState);\n\n    // pick players\n    const choices = nonEvictedHouseguests(newGameState);\n    let povPlayers: any[] = [];\n    const everyoneWillPlay = choices.length <= 6;\n\n    if (everyoneWillPlay) {\n        povPlayers.push({ ...HoH });\n        povPlayers.push({ ...nom1 });\n        povPlayers.push({ ...nom2 });\n        while (povPlayers.length < choices.length) {\n            povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        }\n    } else {\n        povPlayers.push({ ...HoH });\n        povPlayers.push({ ...nom1 });\n        povPlayers.push({ ...nom2 });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n        povPlayers.push({ ...randomPlayer(choices, povPlayers) });\n    }\n    let povWinner = randomPlayer(povPlayers);\n    povWinner = getById(newGameState, povWinner.id);\n    povWinner.povWins++;\n    newGameState.currentLog.vetoWinner = povWinner.name;\n    let introText: string;\n    if (everyoneWillPlay) {\n        introText = \"Everyone left in the house will compete in this challenge.\";\n    } else {\n        introText = `${HoH.name}, as Head of Household, and ${nom1.name} and ${nom2.name} as nominees, will compete, as well as 3 others chosen by random draw.`;\n    }\n    const extras = [povPlayers[3]];\n    povPlayers[4] && extras.push(povPlayers[4]);\n    povPlayers[5] && extras.push(povPlayers[5]);\n    const scene = new Scene({\n        title: \"Veto Competition\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>It's time to pick players for the veto competition.</Centered>\n                <Portraits centered={true} houseguests={[HoH, nom1, nom2]} />\n                <Centered>{introText}</Centered>\n                <Portraits centered={true} houseguests={extras} />\n                <Centered>...</Centered>\n                <Portraits centered={true} houseguests={[povWinner]} />\n                <CenteredBold>{`${povWinner.name} has won the Golden Power of Veto!`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    return [new GameState(newGameState), scene, povWinner];\n}\n","import { GameState, Houseguest, getById, exclude } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { useGoldenVeto, backdoorNPlayers } from \"../../../utils/ai/aiApi\";\nimport { Portrait } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { Centered, CenteredBold } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\n\nexport function generateVetoCeremonyScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    initialNominees: Houseguest[],\n    povWinner: Houseguest\n): [GameState, Scene, Houseguest[]] {\n    let povTarget: Houseguest | null = null;\n    let descisionText = \"\";\n    initialNominees[0] = getById(initialGameState, initialNominees[0].id);\n    initialNominees[1] = getById(initialGameState, initialNominees[1].id);\n    HoH = getById(initialGameState, HoH.id);\n    const vetoChoice = useGoldenVeto(povWinner, initialNominees, initialGameState);\n    povTarget = vetoChoice.decision;\n    if (!povTarget) {\n        descisionText += \"... not to use the power of veto.\";\n    } else if (povWinner.id == initialNominees[0].id || povWinner.id == initialNominees[1].id) {\n        descisionText += \"...to use the power of veto on myself.\";\n    } else {\n        descisionText += `...to use the power of veto on ${povTarget.name}.`;\n    }\n    let replacementSpeech = \"\";\n    let nameAReplacement = \"\";\n    let finalNominees: any[] = [...initialNominees];\n    if (povTarget) {\n        const HoHwonPoV = HoH.id === povWinner.id;\n        nameAReplacement += HoHwonPoV\n            ? `Since I have just vetoed one of my nominations, I must name a replacement nominee.`\n            : `${HoH.name}, since I have just vetoed one of your nominations, you must name a replacement nominee.`;\n        const replacementNom = {\n            ...getById(\n                initialGameState,\n                backdoorNPlayers(\n                    HoH,\n                    exclude(initialGameState.houseguests, [\n                        HoH,\n                        initialNominees[0],\n                        initialNominees[1],\n                        povWinner,\n                    ]),\n                    initialGameState,\n                    1\n                )[0].decision\n            ),\n        };\n        const replacementIndex = initialNominees.findIndex((hg) => hg.id === vetoChoice.decision!.id);\n        finalNominees[replacementIndex] = replacementNom;\n        replacementNom.nominations++;\n        getById(initialGameState, replacementNom.id).nominations++;\n        replacementSpeech = `My replacement nominee is ${replacementNom.name}.`;\n    }\n    const scene = new Scene({\n        title: \"Veto Ceremony\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <Centered>This is the Veto Ceremony.</Centered>\n                <Centered>\n                    {`${initialNominees[0].name} and ${initialNominees[1].name} have been nominated for eviction, \n                    but I have the power to veto one of these nominations.`}\n                </Centered>\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={initialNominees[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={initialNominees[1]} />\n                    </DividerBox>\n                </div>\n                <CenteredBold>\n                    I have decided... <br />\n                </CenteredBold>\n                <Portrait centered={true} houseguest={{ ...povWinner, tooltip: vetoChoice.reason }} />\n                <CenteredBold noMargin={true}>{descisionText}</CenteredBold>\n                <Centered>{nameAReplacement}</Centered>\n                {replacementSpeech && <Portrait centered={true} houseguest={HoH} />}\n                <CenteredBold>{replacementSpeech}</CenteredBold>\n                <div className=\"columns is-marginless is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={finalNominees[0]} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portrait centered={true} houseguest={finalNominees[1]} />\n                    </DividerBox>\n                </div>\n                <NextEpisodeButton />\n            </div>\n        ),\n    });\n    initialGameState.currentLog.nominationsPostVeto = [finalNominees[0].name, finalNominees[1].name];\n    return [initialGameState, scene, finalNominees];\n}\n","import { GameState, Houseguest, MutableGameState, nonEvictedHouseguests, getById } from \"../../../model\";\nimport { Scene } from \"../scene\";\nimport { shuffle } from \"lodash\";\nimport { ProfileHouseguest } from \"../../memoryWall\";\nimport { castEvictionVote } from \"../../../utils/ai/aiApi\";\nimport { evictHouseguest } from \"../bigBrotherEpisode\";\nimport { Portraits } from \"../../playerPortrait/portraits\";\nimport { NextEpisodeButton } from \"../../nextEpisodeButton/nextEpisodeButton\";\nimport React from \"react\";\nimport { CenteredBold, Centered } from \"../../layout/centered\";\nimport { DividerBox } from \"../../layout/box\";\nimport { NomineeVote, NormalVote, HoHVote } from \"../../../model/logging/voteType\";\n\nexport function generateEvictionScene(\n    initialGameState: GameState,\n    HoH: Houseguest,\n    nominees: Houseguest[]\n): [GameState, Scene] {\n    const newGameState = new MutableGameState(initialGameState);\n    nominees = shuffle(nominees);\n    const votes: Array<ProfileHouseguest[]> = [[], []];\n    let lastVoter: Houseguest;\n    nonEvictedHouseguests(newGameState).forEach(hg => {\n        if (hg.id !== nominees[0].id && hg.id !== nominees[1].id && hg.id !== HoH.id) {\n            const logic = castEvictionVote(hg, nominees, newGameState);\n            const result: ProfileHouseguest = { ...hg };\n            result.tooltip = logic.reason;\n            newGameState.currentLog.votes[hg.id] = new NormalVote(nominees[logic.decision].id);\n            votes[logic.decision].push(result);\n            lastVoter = hg;\n        }\n    });\n    const votesFor0 = votes[0].length;\n    const votesFor1 = votes[1].length;\n    newGameState.currentLog.outOf = votesFor0 + votesFor1;\n    if (votesFor0 + votesFor1 === 1) {\n        newGameState.currentLog.soleVoter = lastVoter!!.name;\n    }\n    let tieVote = votesFor0 === votesFor1;\n    let tieBreaker = { decision: 0, reason: \"Error you should not be seeing this\" };\n    if (tieVote) {\n        newGameState.currentLog.outOf++;\n        tieBreaker = castEvictionVote(HoH, nominees, newGameState);\n        newGameState.currentLog.votes[HoH.id] = new HoHVote(nominees[tieBreaker.decision].id);\n    }\n    let evictee: Houseguest;\n    if (votesFor0 > votesFor1) {\n        evictee = nominees[0];\n        newGameState.currentLog.votesInMajority = votesFor0;\n    } else if (votesFor1 > votesFor0) {\n        evictee = nominees[1];\n        newGameState.currentLog.votesInMajority = votesFor1;\n    } else {\n        evictee = nominees[tieBreaker.decision];\n        newGameState.currentLog.votesInMajority = votesFor1 + 1;\n    }\n    newGameState.currentLog.votes[nominees[0].id] = new NomineeVote(evictee.id === nominees[0].id);\n    newGameState.currentLog.votes[nominees[1].id] = new NomineeVote(evictee.id !== nominees[0].id);\n\n    evictHouseguest(newGameState, evictee.id);\n    const isUnanimous = votesFor0 === 0 || votesFor1 === 0;\n    const voteCountText = isUnanimous\n        ? \"By a unanimous vote...\"\n        : `By a vote of ${votesFor0} to ${votesFor1}...`;\n\n    const displayHoH: ProfileHouseguest = { ...HoH };\n    displayHoH.tooltip = tieBreaker.reason;\n    const scene = new Scene({\n        title: \"Live Eviction\",\n        gameState: initialGameState,\n        content: (\n            <div>\n                <CenteredBold>{voteCountText}</CenteredBold>\n                <div className=\"columns is-centered\">\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[0]} centered={true} />\n                    </DividerBox>\n                    <DividerBox className=\"column\">\n                        <Portraits houseguests={votes[1]} centered={true} />\n                    </DividerBox>\n                </div>\n                {tieVote && (\n                    <div>\n                        <CenteredBold> We have a tie.</CenteredBold>\n                        <Centered>{`${HoH.name}, as current Head of Household, you must cast the sole vote to evict.`}</Centered>\n                        <Portraits houseguests={[displayHoH]} centered={true} />\n                        <CenteredBold>I vote to evict {`${evictee.name}.`}</CenteredBold>\n                    </div>\n                )}\n                <Portraits\n                    houseguests={[\n                        getById(newGameState, nominees[0].id),\n                        getById(newGameState, nominees[1].id)\n                    ]}\n                    centered={true}\n                />\n                <CenteredBold>{`${evictee.name}... you have been evicted from the Big Brother House.`}</CenteredBold>\n                <NextEpisodeButton />\n            </div>\n        )\n    });\n    return [newGameState, scene];\n}\n","import React from \"react\";\nimport { canDisplayCliques, GameState, getById } from \"../../model\";\nimport { Centered } from \"../layout/centered\";\nimport { HasText } from \"../layout/text\";\nimport { Portraits } from \"../playerPortrait/portraits\";\n\ninterface AllianceListProps {\n    gameState: GameState;\n}\n\nexport function AllianceList(props: AllianceListProps) {\n    if (!canDisplayCliques(props.gameState))\n        return (\n            <HasText>\n                <Centered>\n                    ⚠️ There are too many players left in the game to display the alliances! Try again when\n                    there are 30 or less! ⚠️\n                </Centered>\n            </HasText>\n        );\n    const cliques = props.gameState.cliques;\n    const elements: JSX.Element[] = cliques.map((clique, i) => {\n        if (clique.affiliates.length === 0) {\n            return (\n                <Portraits\n                    centered={true}\n                    detailed={true}\n                    key={`${clique}, ${i}, ${props.gameState.phase}`}\n                    houseguests={clique.core.map((id) => getById(props.gameState, id))}\n                />\n            );\n        }\n        const test2: (number | \"+\")[] = [...clique.core, \"+\", ...clique.affiliates];\n        return (\n            <Portraits\n                centered={true}\n                detailed={true}\n                key={`${clique}, ${i}, ${props.gameState.phase}`}\n                houseguests={test2.map((id) => (id === \"+\" ? \"+\" : getById(props.gameState, id)))}\n            />\n        );\n    });\n    return <div>{elements}</div>;\n}\n","import React from \"react\";\nimport { GameState } from \"../../model\";\nimport { weekStartTab$ } from \"../../subjects/subjects\";\nimport { Subscription } from \"rxjs\";\nimport { MemoryWall } from \"../memoryWall\";\nimport { AllianceList } from \"./allianceList\";\n\ninterface WeekStartWrapperProps {\n    gameState: GameState;\n}\n\ninterface WeekStartWrapperState {\n    tab: number;\n}\n\nexport class WeekStartWrapper extends React.Component<WeekStartWrapperProps, WeekStartWrapperState> {\n    private subs: Subscription[] = [];\n    constructor(props: Readonly<WeekStartWrapperProps>) {\n        super(props);\n        this.state = { tab: weekStartTab$.value };\n    }\n    componentDidMount() {\n        this.subs.push(weekStartTab$.subscribe((tab) => this.setState({ tab })));\n    }\n    componentWillUnmount() {\n        this.subs.forEach((sub) => sub.unsubscribe());\n    }\n\n    render() {\n        if (this.state.tab === 0) {\n            return <MemoryWall houseguests={this.props.gameState.houseguests} />;\n        }\n        return <AllianceList gameState={this.props.gameState} />;\n    }\n}\n","import { Subscription } from \"rxjs\";\nimport { Sidebar } from \"./sidebar\";\nimport { Season } from \"../../model/season\";\nimport { Episode, nonEvictedHouseguests, getById } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport {\n    mainContentStream$,\n    episodes$,\n    switchEpisode$,\n    newEpisode,\n    switchSceneRelative,\n    cast$,\n    getSelectedPlayer,\n    selectedPlayer$,\n    displayMode$,\n} from \"../../subjects/subjects\";\nimport { popularityMode } from \"../../model/portraitDisplayMode\";\n\ninterface IndexedScene {\n    scene: Scene;\n    index: number;\n}\n\nconst LEFT = 37;\nconst RIGHT = 39;\n\nexport class SidebarController {\n    private view: Sidebar;\n    private subscriptions: Subscription[] = [];\n    private season: Season = new Season();\n    private scenes: IndexedScene[] = [];\n    private selectedEpisode: number = 0;\n\n    public constructor(view: Sidebar) {\n        this.view = view;\n        this.subscriptions.push(\n            episodes$.subscribe({\n                next: (episode) => this.onNewEpisode(episode),\n            })\n        );\n        this.subscriptions.push(\n            switchEpisode$.subscribe({\n                next: (value: number) => {\n                    this.switchSceneRelative(value);\n                },\n            })\n        );\n        this.subscriptions.push(\n            cast$.subscribe({\n                next: () => {\n                    this.season = new Season();\n                    this.selectedEpisode = 0;\n                    displayMode$.next(popularityMode);\n                },\n            })\n        );\n    }\n\n    public getSelectedEpisode() {\n        return this.selectedEpisode;\n    }\n\n    public async switchToScene(id: number) {\n        mainContentStream$.next(this.scenes[id].scene.render);\n        this.selectedEpisode = this.scenes[id].index;\n        await this.view.setState({ selectedScene: id });\n        if (getSelectedPlayer() !== null) {\n            selectedPlayer$.next(\n                getById(this.scenes[this.view.state.selectedScene].scene.gameState, getSelectedPlayer()!.id)\n            );\n        }\n    }\n\n    private switchSceneRelative = (delta: number) => {\n        const selectedScene = this.view.state.selectedScene;\n        const renderedScenes = this.scenes.length;\n        const targetScene = selectedScene + delta;\n        if (targetScene < 0) {\n            return;\n        }\n        const lastEpisode = this.view.state.episodes[this.view.state.episodes.length - 1];\n        if (targetScene < renderedScenes) {\n            // Go back to an earlier scene\n            this.switchToScene(targetScene);\n        } else if (targetScene === renderedScenes) {\n            // Generate a new scene, then jump to it\n            const currentGameState = lastEpisode.gameState;\n            const newPlayerCount = nonEvictedHouseguests(lastEpisode.gameState).length;\n            if (newPlayerCount > 0) {\n                newEpisode(this.season.renderEpisode(currentGameState));\n                this.switchSceneRelative(1);\n            }\n        }\n    };\n\n    get handleKeyDown(): (e: any) => void {\n        return this._handleKeyDown.bind(this);\n    }\n\n    private _handleKeyDown(event: any) {\n        const state = this.view.state;\n        if (\n            state.episodes[this.selectedEpisode] === undefined ||\n            !state.episodes[this.selectedEpisode].type.arrowsEnabled\n        ) {\n            return;\n        }\n        if (event.keyCode === LEFT) {\n            switchSceneRelative(-1);\n        } else if (event.keyCode === RIGHT) {\n            switchSceneRelative(1);\n        }\n    }\n\n    private onNewEpisode(episode: Episode | null) {\n        if (!episode) {\n            this.view.setState({ episodes: [], selectedScene: 0 });\n            this.scenes = [];\n        } else {\n            const newState = { ...this.view.state };\n            // starts at -1: prevent OBOE\n            const latestIndex = this.scenes.length === 0 ? -1 : this.scenes[this.scenes.length - 1].index;\n            const index = latestIndex + 1;\n            this.scenes.push({ scene: episode, index });\n            episode.scenes.forEach((scene) => this.scenes.push({ scene, index }));\n            newState.episodes.push(episode);\n            this.view.setState(newState);\n        }\n    }\n\n    public destroy() {\n        this.subscriptions.forEach((sub) => sub.unsubscribe());\n    }\n}\n","import React from \"react\";\nimport { SidebarController } from \"./sidebarController\";\nimport { PregameEpisode } from \"../episode/pregameEpisode\";\nimport { Episode, GameState } from \"../../model\";\nimport { Scene } from \"../episode/scene\";\nimport { newEpisode } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\nimport { HasText } from \"../layout/text\";\ninterface SidebarState {\n    episodes: Episode[];\n    selectedScene: number;\n}\n\nexport class Sidebar extends React.Component<{}, SidebarState> {\n    private controller: SidebarController;\n    public constructor(props: {}) {\n        super(props);\n        this.controller = new SidebarController(this);\n        this.state = { episodes: [], selectedScene: 0 };\n        newEpisode(new PregameEpisode(new GameState([])));\n    }\n\n    public componentDidMount() {\n        document.addEventListener(\"keydown\", this.controller.handleKeyDown);\n    }\n\n    public componentWillUnmount() {\n        this.controller.destroy();\n    }\n\n    public render() {\n        return (\n            <Box style={{ minWidth: 180 }}>\n                <HasText>{this.getEpisodes()}</HasText>\n            </Box>\n        );\n    }\n\n    private getHighlight(title: string, key: number) {\n        if (key === this.state.selectedScene) {\n            return <mark>{title}</mark>;\n        }\n        return title;\n    }\n\n    private getEpisodes() {\n        const result: JSX.Element[] = [];\n        // Weird OBOE to make keys start at 0\n        let episodeKey = -1;\n        let breakKey = 0;\n        this.state.episodes.forEach((episode: Episode) => {\n            const id = ++episodeKey;\n            result.push(\n                <b\n                    key={id}\n                    onClick={() => {\n                        this.controller.switchToScene(id);\n                    }}\n                >\n                    {this.getHighlight(episode.title, id)}\n                </b>\n            );\n            result.push(<br key={--breakKey} />);\n            episode.scenes.forEach((scene: Scene) => {\n                const id = ++episodeKey;\n                if (this.controller.getSelectedEpisode() === episode.gameState.phase) {\n                    result.push(\n                        <a key={id} onClick={() => this.controller.switchToScene(id)}>\n                            {this.getHighlight(scene.title, id)}\n                        </a>\n                    );\n                    result.push(<br key={--breakKey} />);\n                }\n            });\n        });\n        return result;\n    }\n}\n","import styled from \"styled-components\";\nimport React from \"react\";\nimport { mainContentStream$ } from \"../../subjects/subjects\";\nimport { Box } from \"../layout/box\";\n\nconst MainContentAreaWrapper = styled(Box)`\n    overflow-x: auto;\n`;\n\nexport class MainContentArea extends React.Component<{}, { content: any }> {\n    // a simple class that displays whatever it gets fed through the main content stream.\n\n    private contentStream: any;\n\n    public constructor(props: any) {\n        super(props);\n        this.state = { content: null };\n    }\n\n    public componentDidMount() {\n        this.contentStream = mainContentStream$.subscribe((content) => {\n            this.setState({ content });\n        });\n    }\n\n    public componentDidUpdate(prevProps: never, prevState: any) {\n        if (prevState.content !== this.state.content) {\n            window.scrollTo(0, 0);\n        }\n    }\n\n    public componentWillUnmount() {\n        this.contentStream.unsubscribe();\n    }\n\n    public render() {\n        return <MainContentAreaWrapper>{this.state.content}</MainContentAreaWrapper>;\n    }\n}\n","import \"./bulma.scss\";\nimport React from \"react\";\nimport { Sidebar } from \"../sidebar/sidebar\";\nimport { Topbar } from \"../topbar/topBar\";\nimport { MainContentArea } from \"./mainContentArea\";\nimport { MainPageController } from \"./mainPageController\";\n\ninterface MainPageProps {\n    controller: MainPageController;\n}\n\ninterface MainPageState {\n    fullscreen: boolean;\n}\n\nexport class MainPage extends React.Component<MainPageProps, MainPageState> {\n    public constructor(props: MainPageProps) {\n        super(props);\n        this.state = { fullscreen: false };\n        props.controller.inject(this);\n    }\n    public componentDidMount() {\n        this.props.controller.subscribe();\n    }\n    public componentWillUnmount() {\n        this.props.controller.unsubscribe();\n    }\n\n    public render() {\n        const fullscreen = this.state.fullscreen;\n        const hideOnFullscreen = { display: fullscreen ? \"none\" : \"\" };\n        const wrapperStyle = fullscreen\n            ? { margin: \"auto\" }\n            : { margin: \"auto\", maxWidth: 1380, overflow: \"hidden\" };\n        return (\n            <div style={wrapperStyle}>\n                <Topbar style={hideOnFullscreen} />\n                <div className=\"columns\">\n                    <div className=\"column is-narrow\" style={hideOnFullscreen}>\n                        <Sidebar />\n                    </div>\n\n                    <div className=\"column\" style={{ overflowX: \"hidden\" }}>\n                        <MainContentArea />\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","import { MainPage } from \"./mainPage\";\nimport { Subscription } from \"rxjs\";\nimport { isFullscreen$ } from \"../../subjects/subjects\";\n\nexport class MainPageController {\n    private view: MainPage = new MainPage({ controller: this });\n    private subscriptions: Subscription[] = [];\n    public inject(page: MainPage) {\n        this.view = page;\n    }\n\n    public subscribe(): void {\n        this.unsubscribe();\n        this.subscriptions.push(\n            isFullscreen$.subscribe((fullscreen: boolean) => {\n                this.view.setState({ fullscreen });\n            })\n        );\n    }\n\n    public unsubscribe(): void {\n        this.subscriptions.forEach(sub => sub.unsubscribe());\n    }\n}\n","import { createGlobalStyle } from \"styled-components\";\nimport { ColorTheme } from \"./theme\";\n\nexport const GlobalStyles = createGlobalStyle`\n  *,\n  *::after,\n  *::before {\n    box-sizing: border-box;\n  }\n\n  body {\n    background: ${({ theme }: { theme: ColorTheme }) => theme.bg};\n    color: ${({ theme }: { theme: ColorTheme }) => theme.text};\n       transition: all 0.25s linear;\n  }`;\n","import React from \"react\";\nimport { MainPage } from \"./components/mainPage/mainPage\";\nimport { MainPageController } from \"./components/mainPage/mainPageController\";\nimport { ThemeProvider } from \"styled-components\";\nimport { lightTheme, ColorTheme, darkTheme } from \"./theme/theme\";\nimport { GlobalStyles } from \"./theme/globalTheme\";\nimport { theme$ } from \"./subjects/subjects\";\nimport { Subscription } from \"rxjs\";\n\nclass App extends React.Component<{}, { theme: ColorTheme }> {\n    private sub: Subscription | null = null;\n    public constructor(props: any) {\n        super(props);\n        this.state = {\n            theme: darkTheme,\n        };\n    }\n\n    public componentDidMount() {\n        this.sub = theme$.subscribe((theme) => {\n            this.setState({ theme });\n        });\n    }\n\n    public componentWillUnmount() {\n        if (this.sub) this.sub.unsubscribe();\n    }\n\n    render() {\n        return (\n            <ThemeProvider theme={this.state.theme}>\n                <>\n                    <GlobalStyles />\n                    <MainPage controller={new MainPageController()} />\n                </>\n            </ThemeProvider>\n        );\n    }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}